

============================== 2022-02-17 17:58:52.387803 | 0e48aee3-06ac-427f-9d03-215fef6e9e2d ==============================
17:58:52.387803 [info ] [MainThread]: Running with dbt=1.0.1
17:58:52.392967 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
17:58:52.395598 [debug] [MainThread]: Tracking: tracking
17:58:52.421643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4005a47f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4005a62220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4005a620d0>]}
17:58:53.136679 [debug] [MainThread]: Executing "git --help"
17:58:53.177460 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
17:58:53.181467 [debug] [MainThread]: STDERR: "b''"
17:58:53.213696 [debug] [MainThread]: Acquiring new materialize connection "debug"
17:58:53.220982 [debug] [MainThread]: Using materialize connection "debug"
17:58:53.225016 [debug] [MainThread]: On debug: select 1 as id
17:58:53.230491 [debug] [MainThread]: Opening a new connection, currently in state init
17:58:53.290402 [debug] [MainThread]: SQL status: SELECT 1 in 0.06 seconds
17:58:53.303459 [debug] [MainThread]: On debug: Close
17:58:53.309281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072b6f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072d7b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072d7190>]}
17:58:53.988487 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-02-17 18:00:42.937306 | 4353ffc9-652e-450f-adeb-58960b914a26 ==============================
18:00:42.937306 [info ] [MainThread]: Running with dbt=1.0.1
18:00:42.944023 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
18:00:42.946955 [debug] [MainThread]: Tracking: tracking
18:00:42.979619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abdf0>]}
18:00:42.988357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe20>]}


============================== 2022-02-17 18:30:56.659168 | 90794e57-a429-48a3-8b4e-4c5a275d364a ==============================
18:30:56.659168 [info ] [MainThread]: Running with dbt=1.0.1
18:30:56.665401 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, defer=None, state=None, cls=<class 'dbt.task.deps.DepsTask'>, which='deps', rpc_method='deps')
18:30:56.668358 [debug] [MainThread]: Tracking: tracking
18:30:56.697795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728c8e0>]}
18:30:56.709660 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-u2hmn_0i'
18:30:56.713204 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
18:30:57.028544 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
18:30:57.032663 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils.json
18:30:57.326539 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils.json 200
18:30:57.343683 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils/0.1.0.json
18:30:57.627973 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils/0.1.0.json 200
18:30:57.635815 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils.json
18:30:57.836245 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils.json 200
18:30:57.845486 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils/0.1.0.json
18:30:58.065487 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils/0.1.0.json 200
18:30:58.085362 [info ] [MainThread]: Installing MaterializeInc/materialize_dbt_utils
18:30:58.710067 [info ] [MainThread]:   Installed from version 0.1.0
18:30:58.714330 [info ] [MainThread]:   Up to date!
18:30:58.717700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '90794e57-a429-48a3-8b4e-4c5a275d364a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072c6700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072c6940>]}
18:30:58.725715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728c220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728cfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728c850>]}


============================== 2022-02-17 18:31:53.560450 | acc72c13-ece7-41af-92aa-39921711d9d8 ==============================
18:31:53.560450 [info ] [MainThread]: Running with dbt=1.0.1
18:31:53.567562 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
18:31:53.572311 [debug] [MainThread]: Tracking: tracking
18:31:53.601748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072a9dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072a9eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072a9e50>]}
18:31:53.730138 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
18:31:53.733114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'acc72c13-ece7-41af-92aa-39921711d9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072cf910>]}
18:31:54.067582 [debug] [MainThread]: Parsing macros/adapters.sql
18:31:54.170046 [debug] [MainThread]: Parsing macros/catalog.sql
18:31:54.191000 [debug] [MainThread]: Parsing macros/mz_generate_name.sql
18:31:54.199459 [debug] [MainThread]: Parsing macros/relations.sql
18:31:54.237234 [debug] [MainThread]: Parsing macros/materializations/source.sql
18:31:54.263472 [debug] [MainThread]: Parsing macros/materializations/view.sql
18:31:54.284325 [debug] [MainThread]: Parsing macros/materializations/seed.sql
18:31:54.345663 [debug] [MainThread]: Parsing macros/materializations/index.sql
18:31:54.371403 [debug] [MainThread]: Parsing macros/materializations/table.sql
18:31:54.392677 [debug] [MainThread]: Parsing macros/materializations/materialized_view.sql
18:31:54.414122 [debug] [MainThread]: Parsing macros/materializations/sink.sql
18:31:54.435115 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
18:31:54.442031 [debug] [MainThread]: Parsing macros/materializations/helpers.sql
18:31:54.456604 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:31:54.470984 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:31:54.492656 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:31:54.506005 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:31:54.579592 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:31:54.597538 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:31:54.673321 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:31:54.709732 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:31:54.764661 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:31:54.789947 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:31:54.812562 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:31:54.844591 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:31:54.864030 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:31:54.915281 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:31:55.068805 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:31:55.222634 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:31:55.311146 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:31:55.325365 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:31:55.409010 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:31:55.464821 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:31:55.487318 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:31:55.572992 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:31:55.607450 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:31:55.620725 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:31:55.739876 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:31:55.823105 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:31:55.881539 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:31:55.901651 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:31:55.925643 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:31:55.938339 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:31:55.975567 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:31:55.991155 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:31:56.006230 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:31:56.014583 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:31:56.020826 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:31:56.030363 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:31:56.044737 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:31:56.081678 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:31:56.159831 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:31:56.194568 [debug] [MainThread]: Parsing macros/dbt_utils/date_trunc.sql
18:31:56.208013 [debug] [MainThread]: Parsing macros/dbt_utils/dateadd.sql
18:31:56.227320 [debug] [MainThread]: Parsing macros/dbt_utils/datediff.sql
18:31:56.246102 [debug] [MainThread]: Parsing macros/dbt_utils/get_tables_by_pattern_sql.sql
18:31:56.265362 [debug] [MainThread]: Parsing macros/dbt_utils/last_day.sql
18:31:57.857393 [debug] [MainThread]: 1699: static parser successfully parsed examples/marts/flight/fct_twitter_trending.sql
18:31:57.948777 [debug] [MainThread]: 1603: static parser failed on examples/sources/flight/icao_mapping.sql
18:31:57.984715 [debug] [MainThread]: 1602: parser fallback to jinja rendering on examples/sources/flight/icao_mapping.sql
18:31:57.994553 [debug] [MainThread]: 1603: static parser failed on examples/sources/flight/rp_twitter_trending.sql
18:31:58.020532 [debug] [MainThread]: 1602: parser fallback to jinja rendering on examples/sources/flight/rp_twitter_trending.sql
18:31:58.031291 [debug] [MainThread]: 1699: static parser successfully parsed examples/staging/flight/stg_twitter_trending.sql
18:31:58.047503 [debug] [MainThread]: 1699: static parser successfully parsed examples/staging/flight/stg_icao_mapping.sql
18:31:58.065036 [debug] [MainThread]: 1603: static parser failed on templates/marts/core/fct_example.sql
18:31:58.089127 [debug] [MainThread]: 1602: parser fallback to jinja rendering on templates/marts/core/fct_example.sql
18:31:58.098456 [debug] [MainThread]: 1603: static parser failed on templates/sources/new_source/source_example.sql
18:31:58.129218 [debug] [MainThread]: 1602: parser fallback to jinja rendering on templates/sources/new_source/source_example.sql
18:31:58.153872 [debug] [MainThread]: 1603: static parser failed on templates/staging/new_staging_source/stg_inventory_customers.sql
18:31:58.186041 [debug] [MainThread]: 1602: parser fallback to jinja rendering on templates/staging/new_staging_source/stg_inventory_customers.sql
18:31:58.560645 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.templates
- models.examples

18:31:58.598286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'acc72c13-ece7-41af-92aa-39921711d9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027bd2100>]}
18:31:58.669607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'acc72c13-ece7-41af-92aa-39921711d9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027bd2760>]}
18:31:58.673301 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:31:58.682803 [info ] [MainThread]: 
18:31:58.686771 [debug] [MainThread]: Acquiring new materialize connection "master"
18:31:58.698460 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
18:31:58.765639 [debug] [ThreadPool]: Using materialize connection "list_materialize"
18:31:58.769052 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
18:31:58.772414 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:31:58.807334 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
18:31:58.818024 [debug] [ThreadPool]: On list_materialize: Close
18:31:58.828412 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
18:31:58.851733 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
18:31:58.854362 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
18:31:58.856439 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:31:58.863308 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
18:31:58.872501 [debug] [ThreadPool]: On list_materialize_public: Close
18:31:58.879360 [debug] [MainThread]: Using materialize connection "master"
18:31:58.882311 [debug] [MainThread]: On master: BEGIN
18:31:58.885148 [debug] [MainThread]: Opening a new connection, currently in state init
18:31:58.890879 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:31:58.893784 [debug] [MainThread]: Using materialize connection "master"
18:31:58.896183 [debug] [MainThread]: On master: COMMIT
18:31:58.899157 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:31:58.901337 [debug] [MainThread]: On master: Close
18:31:58.904849 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:31:58.908120 [info ] [MainThread]: 
18:31:59.028306 [debug] [Thread-1  ]: Began running node model.mz_hack_day.icao_mapping
18:31:59.032081 [info ] [Thread-1  ]: 1 of 5 START source model public.icao_mapping................................... [RUN]
18:31:59.039263 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.icao_mapping"
18:31:59.043456 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.icao_mapping
18:31:59.048695 [debug] [Thread-1  ]: Compiling model.mz_hack_day.icao_mapping
18:31:59.073431 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.icao_mapping"
18:31:59.111537 [debug] [Thread-1  ]: finished collecting timing info
18:31:59.114965 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.icao_mapping
18:31:59.196850 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
18:31:59.209568 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */
drop source if exists 
      materialize.public.icao_mapping
   cascade
18:31:59.219103 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:31:59.241656 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.02 seconds
18:31:59.312625 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.icao_mapping"
18:31:59.378126 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
18:31:59.381859 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */




CREATE SOURCE 
    materialize.public.icao_mapping

FROM FILE '/tmp/icao24_mapping_airbus.json.gz' COMPRESSION GZIP
FORMAT BYTES;
18:31:59.402510 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.02 seconds
18:31:59.457889 [debug] [Thread-1  ]: finished collecting timing info
18:31:59.462573 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: Close
18:31:59.467654 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acc72c13-ece7-41af-92aa-39921711d9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027ea9e80>]}
18:31:59.471478 [info ] [Thread-1  ]: 1 of 5 OK created source model public.icao_mapping.............................. [[32mCREATE SOURCE[0m in 0.43s]
18:31:59.475333 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.icao_mapping
18:31:59.478215 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_flight_information
18:31:59.482950 [info ] [Thread-1  ]: 2 of 5 START source model public.rp_flight_information.......................... [RUN]
18:31:59.486898 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_flight_information"
18:31:59.489452 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_flight_information
18:31:59.491898 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_flight_information
18:31:59.513050 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_flight_information"
18:31:59.520493 [debug] [Thread-1  ]: finished collecting timing info
18:31:59.523139 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_flight_information
18:31:59.533680 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
18:31:59.536385 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */
drop source if exists 
      materialize.public.rp_flight_information
   cascade
18:31:59.539372 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:31:59.546390 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
18:31:59.555204 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_flight_information"
18:31:59.562807 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
18:31:59.565324 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */




CREATE SOURCE 
    materialize.public.rp_flight_information

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'flight_information'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
18:31:59.592669 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.03 seconds
18:31:59.602949 [debug] [Thread-1  ]: finished collecting timing info
18:31:59.605386 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: Close
18:31:59.609410 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acc72c13-ece7-41af-92aa-39921711d9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027ebbfa0>]}
18:31:59.613201 [info ] [Thread-1  ]: 2 of 5 OK created source model public.rp_flight_information..................... [[32mCREATE SOURCE[0m in 0.12s]
18:31:59.616445 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_flight_information
18:31:59.619523 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_icao_mapping
18:31:59.622548 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_icao_mapping................................. [RUN]
18:31:59.626877 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_icao_mapping"
18:31:59.629389 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_icao_mapping
18:31:59.631642 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_icao_mapping
18:31:59.651645 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_icao_mapping"
18:31:59.667004 [debug] [Thread-1  ]: finished collecting timing info
18:31:59.669340 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_icao_mapping
18:31:59.744821 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
18:31:59.749870 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
drop view if exists "materialize"."public"."stg_icao_mapping" cascade
18:31:59.767409 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:31:59.790373 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.02 seconds
18:31:59.827841 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_icao_mapping"
18:31:59.854229 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
18:31:59.856522 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
create view "materialize"."public"."stg_icao_mapping"
  as (
    /*

The purpose of this staging model is to create a icao_mapping staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."icao_mapping"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

    (data->>'icao24')::string AS icao24,
           (data->>'manufacturericao')::string AS manufacturericao,
           (data->>'manufacturername')::string AS manufacturername,
           (data->>'model')::string AS model,
           (data->>'typecode')::string AS typecode,
           (data->>'icaoaircrafttype')::string AS icaoaircrafttype,
           (data->>'operator')::string AS operator,
           (data->>'operatorcallsign')::string AS operatorcallsign,
           (data->>'operatoricao')::string AS operatoricao,
           (data->>'built')::string AS built,
           (data->>'categorydescription')::string AS categorydescription

    FROM casted

)

SELECT * FROM renamed
  );
18:31:59.866660 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
18:31:59.876741 [debug] [Thread-1  ]: finished collecting timing info
18:31:59.880526 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: Close
18:31:59.884875 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acc72c13-ece7-41af-92aa-39921711d9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4030706580>]}
18:31:59.889152 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_icao_mapping............................ [[32mCREATE VIEW[0m in 0.26s]
18:31:59.895226 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_icao_mapping
18:31:59.897655 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_flight_information
18:31:59.900490 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_flight_information........................... [RUN]
18:31:59.904237 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_flight_information"
18:31:59.906825 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_flight_information
18:31:59.911166 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_flight_information
18:31:59.932974 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_flight_information"
18:31:59.940806 [debug] [Thread-1  ]: finished collecting timing info
18:31:59.944195 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_flight_information
18:31:59.963249 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
18:31:59.965894 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
drop view if exists "materialize"."public"."stg_flight_information" cascade
18:31:59.968071 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:31:59.974334 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
18:31:59.986503 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_flight_information"
18:31:59.995213 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
18:31:59.998058 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
create view "materialize"."public"."stg_flight_information"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_flight_information"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'icao24')::string as icao24,
       (data->>'callsign')::string as callsign,
       (data->>'origin_country')::string as origin_country,
       (data->>'time_position')::numeric as time_position,
       (data->>'last_contact')::numeric as last_contact,
       (data->>'longitude')::double as longitude,
       (data->>'latitude')::double as latitude,
       (data->>'baro_altitude')::double as baro_altitude,
       (data->>'on_ground')::boolean as on_ground,
       (data->>'velocity')::double as velocity,
       (data->>'true_track')::double as true_track,
       (data->>'vertical_rate')::string as vertical_rate,
       (data->>'sensors')::string as sensors,
       (data->>'geo_altitude')::string as geo_altitude,
       (data->>'squawk')::string as squawk,
       (data->>'spi')::string as spi,
       (data->>'position_source')::string as position_source

    FROM casted

)

SELECT * FROM renamed
  );
18:32:00.012894 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
18:32:00.024189 [debug] [Thread-1  ]: finished collecting timing info
18:32:00.031393 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: Close
18:32:00.038411 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acc72c13-ece7-41af-92aa-39921711d9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c11700>]}
18:32:00.044593 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_flight_information...................... [[32mCREATE VIEW[0m in 0.13s]
18:32:00.049211 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_flight_information
18:32:00.055659 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_flight
18:32:00.059811 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_flight........................... [RUN]
18:32:00.064411 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_flight"
18:32:00.067148 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_flight
18:32:00.071063 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_flight
18:32:00.098595 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_flight"
18:32:00.116367 [debug] [Thread-1  ]: finished collecting timing info
18:32:00.118858 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_flight
18:32:00.169856 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
18:32:00.173109 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
drop view if exists "materialize"."public"."fct_flight" cascade
18:32:00.175499 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:32:00.181863 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
18:32:00.197947 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_flight"
18:32:00.211675 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
18:32:00.213971 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
create materialized view "materialize"."public"."fct_flight"
  as (
    


SELECT fi.icao24,
       manufacturername,
       model,
       operator,
       origin_country,
       time_position,
       longitude,
       latitude
FROM "materialize"."public"."stg_flight_information" fi
JOIN "materialize"."public"."stg_icao_mapping" icao ON fi.icao24 = icao.icao24
  );
18:32:00.227558 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
18:32:00.246201 [debug] [Thread-1  ]: finished collecting timing info
18:32:00.249198 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: Close
18:32:00.252946 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acc72c13-ece7-41af-92aa-39921711d9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4030719f40>]}
18:32:00.256658 [info ] [Thread-1  ]: 5 of 5 OK created materializedview model public.fct_flight...................... [[32mCREATE VIEW[0m in 0.19s]
18:32:00.259841 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_flight
18:32:00.266471 [debug] [MainThread]: Acquiring new materialize connection "master"
18:32:00.269398 [debug] [MainThread]: Using materialize connection "master"
18:32:00.271439 [debug] [MainThread]: On master: BEGIN
18:32:00.273586 [debug] [MainThread]: Opening a new connection, currently in state closed
18:32:00.280576 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:32:00.286402 [debug] [MainThread]: Using materialize connection "master"
18:32:00.288749 [debug] [MainThread]: On master: COMMIT
18:32:00.292041 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:32:00.295090 [debug] [MainThread]: On master: Close
18:32:00.299161 [info ] [MainThread]: 
18:32:00.303668 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.61s.
18:32:00.306862 [debug] [MainThread]: Connection 'master' was properly closed.
18:32:00.309181 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_flight' was properly closed.
18:32:00.358724 [info ] [MainThread]: 
18:32:00.362212 [info ] [MainThread]: [32mCompleted successfully[0m
18:32:00.366323 [info ] [MainThread]: 
18:32:00.370617 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
18:32:00.378270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073ac820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073acdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073acac0>]}


============================== 2022-02-17 18:32:31.082990 | 6e4506e0-d357-4c03-8637-b2209330bc15 ==============================
18:32:31.082990 [info ] [MainThread]: Running with dbt=1.0.1
18:32:31.092997 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, compile=True, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.generate.GenerateTask'>, which='generate', rpc_method='docs.generate')
18:32:31.098247 [debug] [MainThread]: Tracking: tracking
18:32:31.134354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aad00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aadf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aad90>]}
18:32:31.574062 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:32:31.577441 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:32:31.582796 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.templates
- models.examples

18:32:31.631759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e4506e0-d357-4c03-8637-b2209330bc15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073d40d0>]}
18:32:31.716840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e4506e0-d357-4c03-8637-b2209330bc15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007316910>]}
18:32:31.723616 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:32:31.739007 [info ] [MainThread]: 
18:32:31.749676 [debug] [MainThread]: Acquiring new materialize connection "master"
18:32:31.779250 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
18:32:31.854566 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
18:32:31.858251 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
18:32:31.861412 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:32:31.896108 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.03 seconds
18:32:31.907395 [debug] [ThreadPool]: On list_materialize_public: Close
18:32:31.921338 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:32:31.925070 [info ] [MainThread]: 
18:32:31.981327 [debug] [Thread-1  ]: Began running node model.mz_hack_day.icao_mapping
18:32:31.989851 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.icao_mapping"
18:32:31.996767 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.icao_mapping
18:32:32.001741 [debug] [Thread-1  ]: Compiling model.mz_hack_day.icao_mapping
18:32:32.038095 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.icao_mapping"
18:32:32.046211 [debug] [Thread-1  ]: finished collecting timing info
18:32:32.048976 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.icao_mapping
18:32:32.052215 [debug] [Thread-1  ]: finished collecting timing info
18:32:32.055882 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.icao_mapping
18:32:32.059107 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_flight_information
18:32:32.062369 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_flight_information"
18:32:32.064799 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_flight_information
18:32:32.067051 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_flight_information
18:32:32.087706 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_flight_information"
18:32:32.095554 [debug] [Thread-1  ]: finished collecting timing info
18:32:32.098452 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_flight_information
18:32:32.101015 [debug] [Thread-1  ]: finished collecting timing info
18:32:32.104378 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_flight_information
18:32:32.106521 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_icao_mapping
18:32:32.109831 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_icao_mapping"
18:32:32.112541 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_icao_mapping
18:32:32.115405 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_icao_mapping
18:32:32.136009 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_icao_mapping"
18:32:32.144856 [debug] [Thread-1  ]: finished collecting timing info
18:32:32.147103 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_icao_mapping
18:32:32.149368 [debug] [Thread-1  ]: finished collecting timing info
18:32:32.153266 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_icao_mapping
18:32:32.157030 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_flight_information
18:32:32.160251 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_flight_information"
18:32:32.162357 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_flight_information
18:32:32.165231 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_flight_information
18:32:32.185988 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_flight_information"
18:32:32.192416 [debug] [Thread-1  ]: finished collecting timing info
18:32:32.195063 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_flight_information
18:32:32.197705 [debug] [Thread-1  ]: finished collecting timing info
18:32:32.201170 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_flight_information
18:32:32.207685 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_flight
18:32:32.211330 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_flight"
18:32:32.214280 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_flight
18:32:32.216450 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_flight
18:32:32.237156 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_flight"
18:32:32.244564 [debug] [Thread-1  ]: finished collecting timing info
18:32:32.247108 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_flight
18:32:32.249281 [debug] [Thread-1  ]: finished collecting timing info
18:32:32.253391 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_flight
18:32:32.258737 [debug] [MainThread]: Connection 'master' was properly closed.
18:32:32.261075 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_flight' was properly closed.
18:32:32.301387 [info ] [MainThread]: Done.
18:32:32.361150 [debug] [MainThread]: Acquiring new materialize connection "generate_catalog"
18:32:32.363555 [info ] [MainThread]: Building catalog
18:32:32.375288 [debug] [ThreadPool]: Acquiring new materialize connection "materialize.information_schema"
18:32:32.431359 [debug] [ThreadPool]: Using materialize connection "materialize.information_schema"
18:32:32.434761 [debug] [ThreadPool]: On materialize.information_schema: BEGIN
18:32:32.438576 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:32:32.445670 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:32:32.448424 [debug] [ThreadPool]: Using materialize connection "materialize.information_schema"
18:32:32.450852 [debug] [ThreadPool]: On materialize.information_schema: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "materialize.information_schema"} */

    
    

    select
        'materialize' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        col.type as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join (select mz_columns.name as attname, position as attnum, mz_relations.oid as attrelid, FALSE as attisdropped, mz_columns.type as type
          from mz_columns join mz_relations on mz_columns.id = mz_relations.id)
          as col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
18:32:32.507532 [debug] [ThreadPool]: SQL status: SELECT 41 in 0.02 seconds
18:32:32.601647 [debug] [ThreadPool]: On materialize.information_schema: ROLLBACK
18:32:32.604640 [debug] [ThreadPool]: On materialize.information_schema: Close
18:32:32.672584 [info ] [MainThread]: Catalog written to /usr/app/dbt/target/catalog.json
18:32:32.677269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aad00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40294e71f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40294e77c0>]}
18:32:33.362630 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
18:32:33.366263 [debug] [MainThread]: Connection 'materialize.information_schema' was properly closed.


============================== 2022-02-17 18:33:06.455752 | 03ef597f-b0a8-4c98-8b48-ecf48d863c3b ==============================
18:33:06.455752 [info ] [MainThread]: Running with dbt=1.0.1
18:33:06.463102 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8080, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
18:33:06.466069 [debug] [MainThread]: Tracking: tracking
18:33:06.498289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728cdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728cee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728ce80>]}
18:33:06.579534 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
18:33:06.583492 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
18:33:06.587009 [info ] [MainThread]: 
18:33:06.591817 [info ] [MainThread]: 
18:33:06.596247 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-02-19 11:38:01.522083 | ed3dd23d-a44a-498d-ad79-fb5d8506908a ==============================
11:38:01.522083 [info ] [MainThread]: Running with dbt=1.0.1
11:38:01.527535 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
11:38:01.530372 [debug] [MainThread]: Tracking: tracking
11:38:01.562722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4005bbaf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4005bbad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4005bbae80>]}
11:38:02.538277 [debug] [MainThread]: Executing "git --help"
11:38:02.586001 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
11:38:02.591290 [debug] [MainThread]: STDERR: "b''"
11:38:02.616900 [debug] [MainThread]: Acquiring new materialize connection "debug"
11:38:02.620903 [debug] [MainThread]: Using materialize connection "debug"
11:38:02.625026 [debug] [MainThread]: On debug: select 1 as id
11:38:02.629924 [debug] [MainThread]: Opening a new connection, currently in state init
11:38:02.686098 [debug] [MainThread]: SQL status: SELECT 1 in 0.06 seconds
11:38:02.699619 [debug] [MainThread]: On debug: Close
11:38:02.706325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073d8100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073d8460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073d8ee0>]}
11:38:03.381741 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-02-19 11:38:39.900540 | cf6f859b-ab73-4fe9-9d5a-902d696f5a6d ==============================
11:38:39.900540 [info ] [MainThread]: Running with dbt=1.0.1
11:38:39.910777 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
11:38:39.920436 [debug] [MainThread]: Tracking: tracking
11:38:39.949864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abdc0>]}
11:38:40.423848 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
11:38:40.427243 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/examples/marts/inventory/fct_inventory.sql
11:38:40.430195 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/examples/sources/inventory/inventory_customers.sql
11:38:40.433573 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/examples/sources/inventory/src_inventory.yml
11:38:40.544818 [debug] [MainThread]: 1699: static parser successfully parsed examples/marts/inventory/fct_inventory.sql
11:38:40.657600 [debug] [MainThread]: 1603: static parser failed on examples/sources/inventory/inventory_customers.sql
11:38:40.700452 [debug] [MainThread]: 1602: parser fallback to jinja rendering on examples/sources/inventory/inventory_customers.sql
11:38:40.763887 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'inventory_customer' in the 'models' section of file 'models/examples/sources/inventory/src_inventory.yml'
11:38:40.808813 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.templates
- models.examples

11:38:40.852028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf6f859b-ab73-4fe9-9d5a-902d696f5a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c6a0d0>]}
11:38:40.910315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf6f859b-ab73-4fe9-9d5a-902d696f5a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007329c70>]}
11:38:40.913552 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
11:38:40.925977 [info ] [MainThread]: 
11:38:40.930806 [debug] [MainThread]: Acquiring new materialize connection "master"
11:38:40.958038 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
11:38:41.049515 [debug] [ThreadPool]: Using materialize connection "list_materialize"
11:38:41.052828 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
11:38:41.055568 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:38:41.088339 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
11:38:41.099450 [debug] [ThreadPool]: On list_materialize: Close
11:38:41.111127 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
11:38:41.137324 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
11:38:41.140320 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
11:38:41.142881 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:38:41.149765 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
11:38:41.159999 [debug] [ThreadPool]: On list_materialize_public: Close
11:38:41.167868 [debug] [MainThread]: Using materialize connection "master"
11:38:41.172698 [debug] [MainThread]: On master: BEGIN
11:38:41.174886 [debug] [MainThread]: Opening a new connection, currently in state init
11:38:41.180643 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:38:41.183077 [debug] [MainThread]: Using materialize connection "master"
11:38:41.185525 [debug] [MainThread]: On master: COMMIT
11:38:41.188505 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:38:41.190802 [debug] [MainThread]: On master: Close
11:38:41.194315 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
11:38:41.197164 [info ] [MainThread]: 
11:38:41.334303 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_inventory
11:38:41.338392 [info ] [Thread-1  ]: 1 of 7 START view model public.fct_inventory.................................... [RUN]
11:38:41.346352 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_inventory"
11:38:41.350548 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_inventory
11:38:41.352907 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_inventory
11:38:41.362834 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_inventory"
11:38:41.376273 [debug] [Thread-1  ]: finished collecting timing info
11:38:41.378749 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_inventory
11:38:41.459830 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_inventory"
11:38:41.463865 [debug] [Thread-1  ]: On model.mz_hack_day.fct_inventory: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_inventory"} */
drop view if exists "materialize"."public"."fct_inventory" cascade
11:38:41.467011 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:38:41.478552 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:38:41.537909 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_inventory"
11:38:41.551262 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_inventory"
11:38:41.553589 [debug] [Thread-1  ]: On model.mz_hack_day.fct_inventory: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_inventory"} */
create view "materialize"."public"."fct_inventory"
  as (
    CREATE MATERIALIZED VIEW inventory_customers_view AS
SELECT * FROM inventory_customers;
  );
11:38:41.557605 [debug] [Thread-1  ]: Postgres adapter: Postgres error: Expected SELECT, VALUES, or a subquery in the query body, found CREATE
LINE 4:     CREATE MATERIALIZED VIEW inventory_customers_view AS
            ^

11:38:41.560501 [debug] [Thread-1  ]: finished collecting timing info
11:38:41.562827 [debug] [Thread-1  ]: On model.mz_hack_day.fct_inventory: Close
11:38:41.566325 [debug] [Thread-1  ]: Database Error in model fct_inventory (models/examples/marts/inventory/fct_inventory.sql)
  Expected SELECT, VALUES, or a subquery in the query body, found CREATE
  LINE 4:     CREATE MATERIALIZED VIEW inventory_customers_view AS
              ^
  compiled SQL at target/run/mz_hack_day/models/examples/marts/inventory/fct_inventory.sql
11:38:41.569569 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf6f859b-ab73-4fe9-9d5a-902d696f5a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4030784e20>]}
11:38:41.572843 [error] [Thread-1  ]: 1 of 7 ERROR creating view model public.fct_inventory........................... [[31mERROR[0m in 0.22s]
11:38:41.576120 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_inventory
11:38:41.578639 [debug] [Thread-1  ]: Began running node model.mz_hack_day.icao_mapping
11:38:41.581420 [info ] [Thread-1  ]: 2 of 7 START source model public.icao_mapping................................... [RUN]
11:38:41.585402 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.icao_mapping"
11:38:41.587943 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.icao_mapping
11:38:41.590150 [debug] [Thread-1  ]: Compiling model.mz_hack_day.icao_mapping
11:38:41.612994 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.icao_mapping"
11:38:41.622873 [debug] [Thread-1  ]: finished collecting timing info
11:38:41.625728 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.icao_mapping
11:38:41.690049 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:38:41.692783 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */
drop source if exists 
      materialize.public.icao_mapping
   cascade
11:38:41.695652 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:38:41.702081 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:38:41.717239 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.icao_mapping"
11:38:41.727317 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:38:41.729815 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */




CREATE SOURCE 
    materialize.public.icao_mapping

FROM FILE '/tmp/icao24_mapping_airbus.json.gz' COMPRESSION GZIP
FORMAT BYTES;
11:38:41.741813 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:38:41.796676 [debug] [Thread-1  ]: finished collecting timing info
11:38:41.799939 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: Close
11:38:41.804837 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf6f859b-ab73-4fe9-9d5a-902d696f5a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40307708b0>]}
11:38:41.808374 [info ] [Thread-1  ]: 2 of 7 OK created source model public.icao_mapping.............................. [[32mCREATE SOURCE[0m in 0.22s]
11:38:41.812687 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.icao_mapping
11:38:41.815788 [debug] [Thread-1  ]: Began running node model.mz_hack_day.inventory_customers
11:38:41.818869 [info ] [Thread-1  ]: 3 of 7 START source model public.inventory_customers............................ [RUN]
11:38:41.822748 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.inventory_customers"
11:38:41.825373 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.inventory_customers
11:38:41.827467 [debug] [Thread-1  ]: Compiling model.mz_hack_day.inventory_customers
11:38:41.848917 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.inventory_customers"
11:38:41.858098 [debug] [Thread-1  ]: finished collecting timing info
11:38:41.860604 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.inventory_customers
11:38:41.872048 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:38:41.874736 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */
drop source if exists 
      materialize.public.inventory_customers
   cascade
11:38:41.877410 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:38:41.883365 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:38:41.892853 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.inventory_customers"
11:38:41.902057 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:38:41.904407 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */




CREATE SOURCE 
    materialize.public.inventory_customers

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'dbserver1.inventory.customers'
FORMAT AVRO USING CONFLUENT SCHEMA REGISTRY 'http://redpanda:8081'
ENVELOPE DEBEZIUM;
11:38:42.429435 [debug] [Thread-1  ]: Postgres adapter: Postgres error: fetching latest schema for subject 'dbserver1.inventory.customers-value' from registry: subject not found

11:38:42.432944 [debug] [Thread-1  ]: finished collecting timing info
11:38:42.434979 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: Close
11:38:42.438103 [debug] [Thread-1  ]: Database Error in model inventory_customers (models/examples/sources/inventory/inventory_customers.sql)
  fetching latest schema for subject 'dbserver1.inventory.customers-value' from registry: subject not found
  compiled SQL at target/run/mz_hack_day/models/examples/sources/inventory/inventory_customers.sql
11:38:42.441070 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf6f859b-ab73-4fe9-9d5a-902d696f5a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x403075a7f0>]}
11:38:42.445150 [error] [Thread-1  ]: 3 of 7 ERROR creating source model public.inventory_customers................... [[31mERROR[0m in 0.62s]
11:38:42.448504 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.inventory_customers
11:38:42.450751 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_flight_information
11:38:42.453116 [info ] [Thread-1  ]: 4 of 7 START source model public.rp_flight_information.......................... [RUN]
11:38:42.456885 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_flight_information"
11:38:42.459257 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_flight_information
11:38:42.461685 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_flight_information
11:38:42.483097 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_flight_information"
11:38:42.490692 [debug] [Thread-1  ]: finished collecting timing info
11:38:42.493434 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_flight_information
11:38:42.504535 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:38:42.507286 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */
drop source if exists 
      materialize.public.rp_flight_information
   cascade
11:38:42.509247 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:38:42.515396 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:38:42.524639 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_flight_information"
11:38:42.531354 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:38:42.533453 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */




CREATE SOURCE 
    materialize.public.rp_flight_information

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'flight_information'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
11:38:42.545275 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:38:42.554878 [debug] [Thread-1  ]: finished collecting timing info
11:38:42.557828 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: Close
11:38:42.561687 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf6f859b-ab73-4fe9-9d5a-902d696f5a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40307706a0>]}
11:38:42.564985 [info ] [Thread-1  ]: 4 of 7 OK created source model public.rp_flight_information..................... [[32mCREATE SOURCE[0m in 0.11s]
11:38:42.567898 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_flight_information
11:38:42.570290 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_icao_mapping
11:38:42.573024 [info ] [Thread-1  ]: 5 of 7 START view model public.stg_icao_mapping................................. [RUN]
11:38:42.577052 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_icao_mapping"
11:38:42.579275 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_icao_mapping
11:38:42.581160 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_icao_mapping
11:38:42.602595 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_icao_mapping"
11:38:42.610107 [debug] [Thread-1  ]: finished collecting timing info
11:38:42.612346 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_icao_mapping
11:38:42.634009 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:38:42.637701 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
drop view if exists "materialize"."public"."stg_icao_mapping" cascade
11:38:42.640061 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:38:42.645870 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:38:42.655915 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_icao_mapping"
11:38:42.664601 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:38:42.666584 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
create view "materialize"."public"."stg_icao_mapping"
  as (
    /*

The purpose of this staging model is to create a icao_mapping staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."icao_mapping"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

    (data->>'icao24')::string AS icao24,
           (data->>'manufacturericao')::string AS manufacturericao,
           (data->>'manufacturername')::string AS manufacturername,
           (data->>'model')::string AS model,
           (data->>'typecode')::string AS typecode,
           (data->>'icaoaircrafttype')::string AS icaoaircrafttype,
           (data->>'operator')::string AS operator,
           (data->>'operatorcallsign')::string AS operatorcallsign,
           (data->>'operatoricao')::string AS operatoricao,
           (data->>'built')::string AS built,
           (data->>'categorydescription')::string AS categorydescription

    FROM casted

)

SELECT * FROM renamed
  );
11:38:42.678667 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:38:42.689050 [debug] [Thread-1  ]: finished collecting timing info
11:38:42.691292 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: Close
11:38:42.694619 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf6f859b-ab73-4fe9-9d5a-902d696f5a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x403079ee50>]}
11:38:42.698106 [info ] [Thread-1  ]: 5 of 7 OK created view model public.stg_icao_mapping............................ [[32mCREATE VIEW[0m in 0.12s]
11:38:42.701178 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_icao_mapping
11:38:42.703896 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_flight_information
11:38:42.706473 [info ] [Thread-1  ]: 6 of 7 START view model public.stg_flight_information........................... [RUN]
11:38:42.710083 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_flight_information"
11:38:42.712173 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_flight_information
11:38:42.714732 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_flight_information
11:38:42.737100 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_flight_information"
11:38:42.744775 [debug] [Thread-1  ]: finished collecting timing info
11:38:42.746850 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_flight_information
11:38:42.764927 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:38:42.768010 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
drop view if exists "materialize"."public"."stg_flight_information" cascade
11:38:42.770457 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:38:42.779064 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:38:42.789512 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_flight_information"
11:38:42.796840 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:38:42.799351 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
create view "materialize"."public"."stg_flight_information"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_flight_information"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'icao24')::string as icao24,
       (data->>'callsign')::string as callsign,
       (data->>'origin_country')::string as origin_country,
       (data->>'time_position')::numeric as time_position,
       (data->>'last_contact')::numeric as last_contact,
       (data->>'longitude')::double as longitude,
       (data->>'latitude')::double as latitude,
       (data->>'baro_altitude')::double as baro_altitude,
       (data->>'on_ground')::boolean as on_ground,
       (data->>'velocity')::double as velocity,
       (data->>'true_track')::double as true_track,
       (data->>'vertical_rate')::string as vertical_rate,
       (data->>'sensors')::string as sensors,
       (data->>'geo_altitude')::string as geo_altitude,
       (data->>'squawk')::string as squawk,
       (data->>'spi')::string as spi,
       (data->>'position_source')::string as position_source

    FROM casted

)

SELECT * FROM renamed
  );
11:38:42.808627 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:38:42.819077 [debug] [Thread-1  ]: finished collecting timing info
11:38:42.821668 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: Close
11:38:42.825653 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf6f859b-ab73-4fe9-9d5a-902d696f5a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c17670>]}
11:38:42.828967 [info ] [Thread-1  ]: 6 of 7 OK created view model public.stg_flight_information...................... [[32mCREATE VIEW[0m in 0.12s]
11:38:42.831967 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_flight_information
11:38:42.837344 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_flight
11:38:42.839939 [info ] [Thread-1  ]: 7 of 7 START materializedview model public.fct_flight........................... [RUN]
11:38:42.843357 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_flight"
11:38:42.845376 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_flight
11:38:42.847326 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_flight
11:38:42.868568 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_flight"
11:38:42.878280 [debug] [Thread-1  ]: finished collecting timing info
11:38:42.880493 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_flight
11:38:42.936139 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:38:42.939417 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
drop view if exists "materialize"."public"."fct_flight" cascade
11:38:42.941920 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:38:42.947609 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:38:42.965547 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_flight"
11:38:42.974841 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:38:42.977686 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
create materialized view "materialize"."public"."fct_flight"
  as (
    


SELECT fi.icao24,
       manufacturername,
       model,
       operator,
       origin_country,
       time_position,
       longitude,
       latitude
FROM "materialize"."public"."stg_flight_information" fi
JOIN "materialize"."public"."stg_icao_mapping" icao ON fi.icao24 = icao.icao24
  );
11:38:42.990354 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:38:43.002886 [debug] [Thread-1  ]: finished collecting timing info
11:38:43.006467 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: Close
11:38:43.010313 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf6f859b-ab73-4fe9-9d5a-902d696f5a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x403076f340>]}
11:38:43.013811 [info ] [Thread-1  ]: 7 of 7 OK created materializedview model public.fct_flight...................... [[32mCREATE VIEW[0m in 0.17s]
11:38:43.017382 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_flight
11:38:43.024134 [debug] [MainThread]: Acquiring new materialize connection "master"
11:38:43.029691 [debug] [MainThread]: Using materialize connection "master"
11:38:43.033886 [debug] [MainThread]: On master: BEGIN
11:38:43.037026 [debug] [MainThread]: Opening a new connection, currently in state closed
11:38:43.045333 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:38:43.051589 [debug] [MainThread]: Using materialize connection "master"
11:38:43.055408 [debug] [MainThread]: On master: COMMIT
11:38:43.058800 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:38:43.062958 [debug] [MainThread]: On master: Close
11:38:43.067829 [info ] [MainThread]: 
11:38:43.071977 [info ] [MainThread]: Finished running 3 view models, 3 source models, 1 materializedview model in 2.14s.
11:38:43.076028 [debug] [MainThread]: Connection 'master' was properly closed.
11:38:43.079909 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_flight' was properly closed.
11:38:43.129452 [info ] [MainThread]: 
11:38:43.131934 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
11:38:43.135024 [info ] [MainThread]: 
11:38:43.138415 [error] [MainThread]: [33mDatabase Error in model fct_inventory (models/examples/marts/inventory/fct_inventory.sql)[0m
11:38:43.142135 [error] [MainThread]:   Expected SELECT, VALUES, or a subquery in the query body, found CREATE
11:38:43.145955 [error] [MainThread]:   LINE 4:     CREATE MATERIALIZED VIEW inventory_customers_view AS
11:38:43.151312 [error] [MainThread]:               ^
11:38:43.154596 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/examples/marts/inventory/fct_inventory.sql
11:38:43.158975 [info ] [MainThread]: 
11:38:43.162766 [error] [MainThread]: [33mDatabase Error in model inventory_customers (models/examples/sources/inventory/inventory_customers.sql)[0m
11:38:43.166435 [error] [MainThread]:   fetching latest schema for subject 'dbserver1.inventory.customers-value' from registry: subject not found
11:38:43.169977 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/examples/sources/inventory/inventory_customers.sql
11:38:43.173515 [info ] [MainThread]: 
11:38:43.176685 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
11:38:43.180956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4030770c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4030770f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x404a0ccf70>]}


============================== 2022-02-19 11:41:47.588925 | b2725de8-4272-4dda-804c-f845307591e1 ==============================
11:41:47.588925 [info ] [MainThread]: Running with dbt=1.0.1
11:41:47.598349 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
11:41:47.601215 [debug] [MainThread]: Tracking: tracking
11:41:47.632769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abdc0>]}
11:41:48.027032 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
11:41:48.029781 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
11:41:48.034568 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.examples
- models.templates

11:41:48.082099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2725de8-4272-4dda-804c-f845307591e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073d70d0>]}
11:41:48.147109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2725de8-4272-4dda-804c-f845307591e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007324190>]}
11:41:48.154296 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
11:41:48.166218 [info ] [MainThread]: 
11:41:48.173331 [debug] [MainThread]: Acquiring new materialize connection "master"
11:41:48.196254 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
11:41:48.283100 [debug] [ThreadPool]: Using materialize connection "list_materialize"
11:41:48.286412 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
11:41:48.288378 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:41:48.321402 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
11:41:48.332818 [debug] [ThreadPool]: On list_materialize: Close
11:41:48.344126 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
11:41:48.368773 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
11:41:48.371873 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
11:41:48.374325 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:41:48.381234 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
11:41:48.390823 [debug] [ThreadPool]: On list_materialize_public: Close
11:41:48.399177 [debug] [MainThread]: Using materialize connection "master"
11:41:48.401448 [debug] [MainThread]: On master: BEGIN
11:41:48.403396 [debug] [MainThread]: Opening a new connection, currently in state init
11:41:48.408925 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:41:48.412404 [debug] [MainThread]: Using materialize connection "master"
11:41:48.414569 [debug] [MainThread]: On master: COMMIT
11:41:48.417276 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:41:48.419391 [debug] [MainThread]: On master: Close
11:41:48.422219 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
11:41:48.424845 [info ] [MainThread]: 
11:41:48.443656 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_inventory
11:41:48.448763 [info ] [Thread-1  ]: 1 of 7 START view model public.fct_inventory.................................... [RUN]
11:41:48.453878 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_inventory"
11:41:48.456525 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_inventory
11:41:48.458902 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_inventory
11:41:48.469109 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_inventory"
11:41:48.480699 [debug] [Thread-1  ]: finished collecting timing info
11:41:48.483413 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_inventory
11:41:48.569169 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_inventory"
11:41:48.576170 [debug] [Thread-1  ]: On model.mz_hack_day.fct_inventory: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_inventory"} */
drop view if exists "materialize"."public"."fct_inventory" cascade
11:41:48.578555 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:41:48.584872 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:41:48.646711 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_inventory"
11:41:48.655131 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_inventory"
11:41:48.657448 [debug] [Thread-1  ]: On model.mz_hack_day.fct_inventory: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_inventory"} */
create view "materialize"."public"."fct_inventory"
  as (
    CREATE MATERIALIZED VIEW inventory_customers_view AS
SELECT * FROM inventory_customers;
  );
11:41:48.661341 [debug] [Thread-1  ]: Postgres adapter: Postgres error: Expected SELECT, VALUES, or a subquery in the query body, found CREATE
LINE 4:     CREATE MATERIALIZED VIEW inventory_customers_view AS
            ^

11:41:48.664276 [debug] [Thread-1  ]: finished collecting timing info
11:41:48.666354 [debug] [Thread-1  ]: On model.mz_hack_day.fct_inventory: Close
11:41:48.670125 [debug] [Thread-1  ]: Database Error in model fct_inventory (models/examples/marts/inventory/fct_inventory.sql)
  Expected SELECT, VALUES, or a subquery in the query body, found CREATE
  LINE 4:     CREATE MATERIALIZED VIEW inventory_customers_view AS
              ^
  compiled SQL at target/run/mz_hack_day/models/examples/marts/inventory/fct_inventory.sql
11:41:48.674118 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2725de8-4272-4dda-804c-f845307591e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40295f0bb0>]}
11:41:48.677831 [error] [Thread-1  ]: 1 of 7 ERROR creating view model public.fct_inventory........................... [[31mERROR[0m in 0.22s]
11:41:48.682192 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_inventory
11:41:48.685165 [debug] [Thread-1  ]: Began running node model.mz_hack_day.icao_mapping
11:41:48.688889 [info ] [Thread-1  ]: 2 of 7 START source model public.icao_mapping................................... [RUN]
11:41:48.692623 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.icao_mapping"
11:41:48.694865 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.icao_mapping
11:41:48.697474 [debug] [Thread-1  ]: Compiling model.mz_hack_day.icao_mapping
11:41:48.735250 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.icao_mapping"
11:41:48.743785 [debug] [Thread-1  ]: finished collecting timing info
11:41:48.745964 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.icao_mapping
11:41:48.808503 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:41:48.811553 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */
drop source if exists 
      materialize.public.icao_mapping
   cascade
11:41:48.814101 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:41:48.824835 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:41:48.840709 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.icao_mapping"
11:41:48.846536 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:41:48.849171 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */




CREATE SOURCE 
    materialize.public.icao_mapping

FROM FILE '/tmp/icao24_mapping_airbus.json.gz' COMPRESSION GZIP
FORMAT BYTES;
11:41:48.858772 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:41:48.916597 [debug] [Thread-1  ]: finished collecting timing info
11:41:48.919627 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: Close
11:41:48.923336 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2725de8-4272-4dda-804c-f845307591e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400747c3d0>]}
11:41:48.926503 [info ] [Thread-1  ]: 2 of 7 OK created source model public.icao_mapping.............................. [[32mCREATE SOURCE[0m in 0.23s]
11:41:48.929470 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.icao_mapping
11:41:48.931723 [debug] [Thread-1  ]: Began running node model.mz_hack_day.inventory_customers
11:41:48.934683 [info ] [Thread-1  ]: 3 of 7 START source model public.inventory_customers............................ [RUN]
11:41:48.938621 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.inventory_customers"
11:41:48.941026 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.inventory_customers
11:41:48.942937 [debug] [Thread-1  ]: Compiling model.mz_hack_day.inventory_customers
11:41:48.965126 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.inventory_customers"
11:41:48.972305 [debug] [Thread-1  ]: finished collecting timing info
11:41:48.974976 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.inventory_customers
11:41:48.986361 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:41:48.988436 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */
drop source if exists 
      materialize.public.inventory_customers
   cascade
11:41:48.990241 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:41:48.996831 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:41:49.006264 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.inventory_customers"
11:41:49.014428 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:41:49.016591 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */




CREATE SOURCE 
    materialize.public.inventory_customers

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'dbserver1.inventory.customers'
FORMAT AVRO USING CONFLUENT SCHEMA REGISTRY 'http://redpanda:8081'
ENVELOPE DEBEZIUM;
11:41:49.039507 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.02 seconds
11:41:49.049792 [debug] [Thread-1  ]: finished collecting timing info
11:41:49.052732 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: Close
11:41:49.056536 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2725de8-4272-4dda-804c-f845307591e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4029630a00>]}
11:41:49.060243 [info ] [Thread-1  ]: 3 of 7 OK created source model public.inventory_customers....................... [[32mCREATE SOURCE[0m in 0.12s]
11:41:49.063438 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.inventory_customers
11:41:49.066231 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_flight_information
11:41:49.069153 [info ] [Thread-1  ]: 4 of 7 START source model public.rp_flight_information.......................... [RUN]
11:41:49.073533 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_flight_information"
11:41:49.077157 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_flight_information
11:41:49.079208 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_flight_information
11:41:49.102059 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_flight_information"
11:41:49.108606 [debug] [Thread-1  ]: finished collecting timing info
11:41:49.111386 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_flight_information
11:41:49.122133 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:41:49.124417 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */
drop source if exists 
      materialize.public.rp_flight_information
   cascade
11:41:49.126341 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:41:49.136813 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:41:49.150637 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_flight_information"
11:41:49.157148 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:41:49.160789 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */




CREATE SOURCE 
    materialize.public.rp_flight_information

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'flight_information'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
11:41:49.170839 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:41:49.182822 [debug] [Thread-1  ]: finished collecting timing info
11:41:49.185735 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: Close
11:41:49.189634 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2725de8-4272-4dda-804c-f845307591e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x402964a670>]}
11:41:49.193431 [info ] [Thread-1  ]: 4 of 7 OK created source model public.rp_flight_information..................... [[32mCREATE SOURCE[0m in 0.12s]
11:41:49.196586 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_flight_information
11:41:49.198947 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_icao_mapping
11:41:49.202226 [info ] [Thread-1  ]: 5 of 7 START view model public.stg_icao_mapping................................. [RUN]
11:41:49.206065 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_icao_mapping"
11:41:49.209871 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_icao_mapping
11:41:49.212509 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_icao_mapping
11:41:49.234487 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_icao_mapping"
11:41:49.242487 [debug] [Thread-1  ]: finished collecting timing info
11:41:49.245292 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_icao_mapping
11:41:49.263723 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:41:49.266681 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
drop view if exists "materialize"."public"."stg_icao_mapping" cascade
11:41:49.268853 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:41:49.274274 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:41:49.284718 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_icao_mapping"
11:41:49.292546 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:41:49.294685 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
create view "materialize"."public"."stg_icao_mapping"
  as (
    /*

The purpose of this staging model is to create a icao_mapping staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."icao_mapping"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

    (data->>'icao24')::string AS icao24,
           (data->>'manufacturericao')::string AS manufacturericao,
           (data->>'manufacturername')::string AS manufacturername,
           (data->>'model')::string AS model,
           (data->>'typecode')::string AS typecode,
           (data->>'icaoaircrafttype')::string AS icaoaircrafttype,
           (data->>'operator')::string AS operator,
           (data->>'operatorcallsign')::string AS operatorcallsign,
           (data->>'operatoricao')::string AS operatoricao,
           (data->>'built')::string AS built,
           (data->>'categorydescription')::string AS categorydescription

    FROM casted

)

SELECT * FROM renamed
  );
11:41:49.302851 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:41:49.313271 [debug] [Thread-1  ]: finished collecting timing info
11:41:49.316133 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: Close
11:41:49.320287 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2725de8-4272-4dda-804c-f845307591e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4029604790>]}
11:41:49.323605 [info ] [Thread-1  ]: 5 of 7 OK created view model public.stg_icao_mapping............................ [[32mCREATE VIEW[0m in 0.11s]
11:41:49.326557 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_icao_mapping
11:41:49.329382 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_flight_information
11:41:49.331928 [info ] [Thread-1  ]: 6 of 7 START view model public.stg_flight_information........................... [RUN]
11:41:49.335818 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_flight_information"
11:41:49.338423 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_flight_information
11:41:49.342623 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_flight_information
11:41:49.367824 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_flight_information"
11:41:49.375247 [debug] [Thread-1  ]: finished collecting timing info
11:41:49.378136 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_flight_information
11:41:49.396625 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:41:49.399690 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
drop view if exists "materialize"."public"."stg_flight_information" cascade
11:41:49.403133 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:41:49.409417 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:41:49.419752 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_flight_information"
11:41:49.426292 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:41:49.428607 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
create view "materialize"."public"."stg_flight_information"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_flight_information"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'icao24')::string as icao24,
       (data->>'callsign')::string as callsign,
       (data->>'origin_country')::string as origin_country,
       (data->>'time_position')::numeric as time_position,
       (data->>'last_contact')::numeric as last_contact,
       (data->>'longitude')::double as longitude,
       (data->>'latitude')::double as latitude,
       (data->>'baro_altitude')::double as baro_altitude,
       (data->>'on_ground')::boolean as on_ground,
       (data->>'velocity')::double as velocity,
       (data->>'true_track')::double as true_track,
       (data->>'vertical_rate')::string as vertical_rate,
       (data->>'sensors')::string as sensors,
       (data->>'geo_altitude')::string as geo_altitude,
       (data->>'squawk')::string as squawk,
       (data->>'spi')::string as spi,
       (data->>'position_source')::string as position_source

    FROM casted

)

SELECT * FROM renamed
  );
11:41:49.438125 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:41:49.447877 [debug] [Thread-1  ]: finished collecting timing info
11:41:49.450472 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: Close
11:41:49.454163 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2725de8-4272-4dda-804c-f845307591e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400747cbe0>]}
11:41:49.457581 [info ] [Thread-1  ]: 6 of 7 OK created view model public.stg_flight_information...................... [[32mCREATE VIEW[0m in 0.12s]
11:41:49.460760 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_flight_information
11:41:49.466322 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_flight
11:41:49.469247 [info ] [Thread-1  ]: 7 of 7 START materializedview model public.fct_flight........................... [RUN]
11:41:49.473047 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_flight"
11:41:49.476896 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_flight
11:41:49.479521 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_flight
11:41:49.502353 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_flight"
11:41:49.510472 [debug] [Thread-1  ]: finished collecting timing info
11:41:49.512800 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_flight
11:41:49.569591 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:41:49.572605 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
drop view if exists "materialize"."public"."fct_flight" cascade
11:41:49.575971 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:41:49.582132 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:41:49.601388 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_flight"
11:41:49.610372 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:41:49.613171 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
create materialized view "materialize"."public"."fct_flight"
  as (
    


SELECT fi.icao24,
       manufacturername,
       model,
       operator,
       origin_country,
       time_position,
       longitude,
       latitude
FROM "materialize"."public"."stg_flight_information" fi
JOIN "materialize"."public"."stg_icao_mapping" icao ON fi.icao24 = icao.icao24
  );
11:41:49.628965 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:41:49.649516 [debug] [Thread-1  ]: finished collecting timing info
11:41:49.652466 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: Close
11:41:49.656841 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2725de8-4272-4dda-804c-f845307591e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4029656eb0>]}
11:41:49.661332 [info ] [Thread-1  ]: 7 of 7 OK created materializedview model public.fct_flight...................... [[32mCREATE VIEW[0m in 0.18s]
11:41:49.664937 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_flight
11:41:49.671351 [debug] [MainThread]: Acquiring new materialize connection "master"
11:41:49.674271 [debug] [MainThread]: Using materialize connection "master"
11:41:49.678894 [debug] [MainThread]: On master: BEGIN
11:41:49.681253 [debug] [MainThread]: Opening a new connection, currently in state closed
11:41:49.686862 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:41:49.689429 [debug] [MainThread]: Using materialize connection "master"
11:41:49.693093 [debug] [MainThread]: On master: COMMIT
11:41:49.696305 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:41:49.699337 [debug] [MainThread]: On master: Close
11:41:49.703453 [info ] [MainThread]: 
11:41:49.706398 [info ] [MainThread]: Finished running 3 view models, 3 source models, 1 materializedview model in 1.53s.
11:41:49.709437 [debug] [MainThread]: Connection 'master' was properly closed.
11:41:49.711676 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_flight' was properly closed.
11:41:49.752285 [info ] [MainThread]: 
11:41:49.755289 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
11:41:49.758167 [info ] [MainThread]: 
11:41:49.760672 [error] [MainThread]: [33mDatabase Error in model fct_inventory (models/examples/marts/inventory/fct_inventory.sql)[0m
11:41:49.763329 [error] [MainThread]:   Expected SELECT, VALUES, or a subquery in the query body, found CREATE
11:41:49.765887 [error] [MainThread]:   LINE 4:     CREATE MATERIALIZED VIEW inventory_customers_view AS
11:41:49.769323 [error] [MainThread]:               ^
11:41:49.772741 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/examples/marts/inventory/fct_inventory.sql
11:41:49.776672 [info ] [MainThread]: 
11:41:49.779843 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
11:41:49.783770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x402961c130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4029643670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40296600d0>]}


============================== 2022-02-19 11:49:34.943407 | 7cff2cd1-a53b-4abc-bff3-2f5b2626e8c1 ==============================
11:49:34.943407 [info ] [MainThread]: Running with dbt=1.0.1
11:49:34.951439 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
11:49:34.954102 [debug] [MainThread]: Tracking: tracking
11:49:34.989442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe20>]}
11:49:35.369920 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
11:49:35.373478 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/examples/staging/inventory/stg_inventory_customers.sql
11:49:35.376426 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/examples/staging/inventory/stg_inventory.yml
11:49:35.379411 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/examples/marts/inventory/fct_inventory.yml
11:49:35.382545 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/examples/marts/inventory/fct_inventory.sql
11:49:35.506591 [debug] [MainThread]: 1699: static parser successfully parsed examples/staging/inventory/stg_inventory_customers.sql
11:49:35.601465 [debug] [MainThread]: 1699: static parser successfully parsed examples/marts/inventory/fct_inventory.sql
11:49:35.699384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073ba130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073bfac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073bf9a0>]}


============================== 2022-02-19 11:50:19.314172 | da75f871-68ca-4f9c-9fcb-873feea984d0 ==============================
11:50:19.314172 [info ] [MainThread]: Running with dbt=1.0.1
11:50:19.327714 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
11:50:19.330842 [debug] [MainThread]: Tracking: tracking
11:50:19.360014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abdf0>]}
11:50:19.751002 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
11:50:19.754643 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/examples/marts/inventory/fct_inventory.yml
11:50:19.757444 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/examples/staging/inventory/stg_inventory_customers.sql
11:50:19.760552 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/examples/staging/inventory/stg_inventory.yml
11:50:19.764361 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/examples/marts/inventory/fct_inventory.sql
11:50:19.880497 [debug] [MainThread]: 1699: static parser successfully parsed examples/staging/inventory/stg_inventory_customers.sql
11:50:19.982255 [debug] [MainThread]: 1699: static parser successfully parsed examples/marts/inventory/fct_inventory.sql
11:50:20.126121 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.templates
- models.examples

11:50:20.168257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da75f871-68ca-4f9c-9fcb-873feea984d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c300d0>]}
11:50:20.227208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da75f871-68ca-4f9c-9fcb-873feea984d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400739ce50>]}
11:50:20.230380 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
11:50:20.241166 [info ] [MainThread]: 
11:50:20.245428 [debug] [MainThread]: Acquiring new materialize connection "master"
11:50:20.256330 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
11:50:20.335734 [debug] [ThreadPool]: Using materialize connection "list_materialize"
11:50:20.339292 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
11:50:20.342539 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:50:20.373123 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
11:50:20.384565 [debug] [ThreadPool]: On list_materialize: Close
11:50:20.400573 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
11:50:20.426220 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
11:50:20.429758 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
11:50:20.432177 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:50:20.439017 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
11:50:20.448770 [debug] [ThreadPool]: On list_materialize_public: Close
11:50:20.457342 [debug] [MainThread]: Using materialize connection "master"
11:50:20.459701 [debug] [MainThread]: On master: BEGIN
11:50:20.461751 [debug] [MainThread]: Opening a new connection, currently in state init
11:50:20.467473 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:50:20.470345 [debug] [MainThread]: Using materialize connection "master"
11:50:20.472851 [debug] [MainThread]: On master: COMMIT
11:50:20.475724 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:50:20.477605 [debug] [MainThread]: On master: Close
11:50:20.480677 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
11:50:20.483558 [info ] [MainThread]: 
11:50:20.509830 [debug] [Thread-1  ]: Began running node model.mz_hack_day.icao_mapping
11:50:20.513623 [info ] [Thread-1  ]: 1 of 8 START source model public.icao_mapping................................... [RUN]
11:50:20.518177 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.icao_mapping"
11:50:20.520345 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.icao_mapping
11:50:20.522458 [debug] [Thread-1  ]: Compiling model.mz_hack_day.icao_mapping
11:50:20.556738 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.icao_mapping"
11:50:20.562846 [debug] [Thread-1  ]: finished collecting timing info
11:50:20.565814 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.icao_mapping
11:50:20.632677 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:50:20.636379 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */
drop source if exists 
      materialize.public.icao_mapping
   cascade
11:50:20.639514 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:50:20.652324 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:50:20.703563 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.icao_mapping"
11:50:20.711204 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:50:20.713425 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */




CREATE SOURCE 
    materialize.public.icao_mapping

FROM FILE '/tmp/icao24_mapping_airbus.json.gz' COMPRESSION GZIP
FORMAT BYTES;
11:50:20.723700 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:50:20.778131 [debug] [Thread-1  ]: finished collecting timing info
11:50:20.781372 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: Close
11:50:20.785201 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da75f871-68ca-4f9c-9fcb-873feea984d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073b3af0>]}
11:50:20.789235 [info ] [Thread-1  ]: 1 of 8 OK created source model public.icao_mapping.............................. [[32mCREATE SOURCE[0m in 0.27s]
11:50:20.793027 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.icao_mapping
11:50:20.795675 [debug] [Thread-1  ]: Began running node model.mz_hack_day.inventory_customers
11:50:20.798320 [info ] [Thread-1  ]: 2 of 8 START source model public.inventory_customers............................ [RUN]
11:50:20.802633 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.inventory_customers"
11:50:20.807233 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.inventory_customers
11:50:20.813970 [debug] [Thread-1  ]: Compiling model.mz_hack_day.inventory_customers
11:50:20.838159 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.inventory_customers"
11:50:20.846138 [debug] [Thread-1  ]: finished collecting timing info
11:50:20.848448 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.inventory_customers
11:50:20.859568 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:50:20.862295 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */
drop source if exists 
      materialize.public.inventory_customers
   cascade
11:50:20.864425 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:50:20.874550 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:50:20.883690 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.inventory_customers"
11:50:20.888947 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:50:20.891201 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */




CREATE SOURCE 
    materialize.public.inventory_customers

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'dbserver1.inventory.customers'
FORMAT AVRO USING CONFLUENT SCHEMA REGISTRY 'http://redpanda:8081'
ENVELOPE DEBEZIUM;
11:50:20.908379 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.02 seconds
11:50:20.920085 [debug] [Thread-1  ]: finished collecting timing info
11:50:20.922523 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: Close
11:50:20.926326 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da75f871-68ca-4f9c-9fcb-873feea984d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f2aa30>]}
11:50:20.929624 [info ] [Thread-1  ]: 2 of 8 OK created source model public.inventory_customers....................... [[32mCREATE SOURCE[0m in 0.12s]
11:50:20.932483 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.inventory_customers
11:50:20.935249 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_flight_information
11:50:20.938714 [info ] [Thread-1  ]: 3 of 8 START source model public.rp_flight_information.......................... [RUN]
11:50:20.942492 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_flight_information"
11:50:20.944833 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_flight_information
11:50:20.947024 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_flight_information
11:50:20.967995 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_flight_information"
11:50:20.975504 [debug] [Thread-1  ]: finished collecting timing info
11:50:20.978072 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_flight_information
11:50:20.989414 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:50:20.991928 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */
drop source if exists 
      materialize.public.rp_flight_information
   cascade
11:50:20.994043 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:50:21.002738 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:50:21.010992 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_flight_information"
11:50:21.016118 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:50:21.018043 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */




CREATE SOURCE 
    materialize.public.rp_flight_information

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'flight_information'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
11:50:21.027440 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:50:21.038304 [debug] [Thread-1  ]: finished collecting timing info
11:50:21.040973 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: Close
11:50:21.044595 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da75f871-68ca-4f9c-9fcb-873feea984d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f361c0>]}
11:50:21.048128 [info ] [Thread-1  ]: 3 of 8 OK created source model public.rp_flight_information..................... [[32mCREATE SOURCE[0m in 0.10s]
11:50:21.051202 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_flight_information
11:50:21.053575 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_icao_mapping
11:50:21.056567 [info ] [Thread-1  ]: 4 of 8 START view model public.stg_icao_mapping................................. [RUN]
11:50:21.060377 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_icao_mapping"
11:50:21.062698 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_icao_mapping
11:50:21.064844 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_icao_mapping
11:50:21.085941 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_icao_mapping"
11:50:21.093493 [debug] [Thread-1  ]: finished collecting timing info
11:50:21.095827 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_icao_mapping
11:50:21.173019 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:50:21.175857 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
drop view if exists "materialize"."public"."stg_icao_mapping" cascade
11:50:21.178150 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:50:21.185271 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:50:21.213299 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_icao_mapping"
11:50:21.220522 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:50:21.223108 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
create view "materialize"."public"."stg_icao_mapping"
  as (
    /*

The purpose of this staging model is to create a icao_mapping staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."icao_mapping"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

    (data->>'icao24')::string AS icao24,
           (data->>'manufacturericao')::string AS manufacturericao,
           (data->>'manufacturername')::string AS manufacturername,
           (data->>'model')::string AS model,
           (data->>'typecode')::string AS typecode,
           (data->>'icaoaircrafttype')::string AS icaoaircrafttype,
           (data->>'operator')::string AS operator,
           (data->>'operatorcallsign')::string AS operatorcallsign,
           (data->>'operatoricao')::string AS operatoricao,
           (data->>'built')::string AS built,
           (data->>'categorydescription')::string AS categorydescription

    FROM casted

)

SELECT * FROM renamed
  );
11:50:21.232470 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:50:21.242787 [debug] [Thread-1  ]: finished collecting timing info
11:50:21.245060 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: Close
11:50:21.248423 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da75f871-68ca-4f9c-9fcb-873feea984d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f45130>]}
11:50:21.251937 [info ] [Thread-1  ]: 4 of 8 OK created view model public.stg_icao_mapping............................ [[32mCREATE VIEW[0m in 0.19s]
11:50:21.254853 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_icao_mapping
11:50:21.257186 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_inventory_customers
11:50:21.259640 [info ] [Thread-1  ]: 5 of 8 START view model public.stg_inventory_customers.......................... [RUN]
11:50:21.263720 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_inventory_customers"
11:50:21.266333 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_inventory_customers
11:50:21.268372 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_inventory_customers
11:50:21.287083 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_inventory_customers"
11:50:21.296325 [debug] [Thread-1  ]: finished collecting timing info
11:50:21.299282 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_inventory_customers
11:50:21.321513 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_inventory_customers"
11:50:21.324639 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_inventory_customers"} */
drop view if exists "materialize"."public"."stg_inventory_customers" cascade
11:50:21.327223 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:50:21.333180 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:50:21.343507 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_inventory_customers"
11:50:21.352129 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_inventory_customers"
11:50:21.354217 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_inventory_customers"} */
create view "materialize"."public"."stg_inventory_customers"
  as (
    /*

The purpose of this model is to create an inventory_customers staging model.

 */





WITH source AS (

    SELECT * FROM "materialize"."public"."inventory_customers"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'id')::numeric as id,
       (data->>'first_name')::string as first_name,
       (data->>'last_name')::string as last_name,
       (data->>'email')::string as email

    FROM casted

)

SELECT * FROM renamed
  );
11:50:21.358316 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "data" does not exist

11:50:21.361196 [debug] [Thread-1  ]: finished collecting timing info
11:50:21.363211 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: Close
11:50:21.366179 [debug] [Thread-1  ]: Database Error in model stg_inventory_customers (models/examples/staging/inventory/stg_inventory_customers.sql)
  column "data" does not exist
  compiled SQL at target/run/mz_hack_day/models/examples/staging/inventory/stg_inventory_customers.sql
11:50:21.368891 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da75f871-68ca-4f9c-9fcb-873feea984d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f6c2b0>]}
11:50:21.372010 [error] [Thread-1  ]: 5 of 8 ERROR creating view model public.stg_inventory_customers................. [[31mERROR[0m in 0.11s]
11:50:21.375631 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_inventory_customers
11:50:21.377819 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_flight_information
11:50:21.381174 [info ] [Thread-1  ]: 6 of 8 START view model public.stg_flight_information........................... [RUN]
11:50:21.385052 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_flight_information"
11:50:21.387250 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_flight_information
11:50:21.389530 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_flight_information
11:50:21.411226 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_flight_information"
11:50:21.417206 [debug] [Thread-1  ]: finished collecting timing info
11:50:21.419187 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_flight_information
11:50:21.437139 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:50:21.440244 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
drop view if exists "materialize"."public"."stg_flight_information" cascade
11:50:21.442439 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:50:21.448522 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:50:21.460026 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_flight_information"
11:50:21.466281 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:50:21.468598 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
create view "materialize"."public"."stg_flight_information"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_flight_information"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'icao24')::string as icao24,
       (data->>'callsign')::string as callsign,
       (data->>'origin_country')::string as origin_country,
       (data->>'time_position')::numeric as time_position,
       (data->>'last_contact')::numeric as last_contact,
       (data->>'longitude')::double as longitude,
       (data->>'latitude')::double as latitude,
       (data->>'baro_altitude')::double as baro_altitude,
       (data->>'on_ground')::boolean as on_ground,
       (data->>'velocity')::double as velocity,
       (data->>'true_track')::double as true_track,
       (data->>'vertical_rate')::string as vertical_rate,
       (data->>'sensors')::string as sensors,
       (data->>'geo_altitude')::string as geo_altitude,
       (data->>'squawk')::string as squawk,
       (data->>'spi')::string as spi,
       (data->>'position_source')::string as position_source

    FROM casted

)

SELECT * FROM renamed
  );
11:50:21.477528 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:50:21.487239 [debug] [Thread-1  ]: finished collecting timing info
11:50:21.489507 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: Close
11:50:21.493850 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da75f871-68ca-4f9c-9fcb-873feea984d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f35e80>]}
11:50:21.497760 [info ] [Thread-1  ]: 6 of 8 OK created view model public.stg_flight_information...................... [[32mCREATE VIEW[0m in 0.11s]
11:50:21.501045 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_flight_information
11:50:21.504337 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_inventory
11:50:21.511206 [info ] [Thread-1  ]: 7 of 8 SKIP relation public.fct_inventory....................................... [[33mSKIP[0m]
11:50:21.532485 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_inventory
11:50:21.549973 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_flight
11:50:21.578123 [info ] [Thread-1  ]: 8 of 8 START materializedview model public.fct_flight........................... [RUN]
11:50:21.584225 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_flight"
11:50:21.588426 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_flight
11:50:21.594165 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_flight
11:50:21.633819 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_flight"
11:50:21.676948 [debug] [Thread-1  ]: finished collecting timing info
11:50:21.681482 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_flight
11:50:21.745024 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:50:21.749664 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
drop view if exists "materialize"."public"."fct_flight" cascade
11:50:21.751974 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:50:21.758008 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:50:21.775305 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_flight"
11:50:21.784503 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:50:21.786586 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
create materialized view "materialize"."public"."fct_flight"
  as (
    


SELECT fi.icao24,
       manufacturername,
       model,
       operator,
       origin_country,
       time_position,
       longitude,
       latitude
FROM "materialize"."public"."stg_flight_information" fi
JOIN "materialize"."public"."stg_icao_mapping" icao ON fi.icao24 = icao.icao24
  );
11:50:21.797949 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:50:21.810505 [debug] [Thread-1  ]: finished collecting timing info
11:50:21.813495 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: Close
11:50:21.817913 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da75f871-68ca-4f9c-9fcb-873feea984d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073e7b20>]}
11:50:21.821400 [info ] [Thread-1  ]: 8 of 8 OK created materializedview model public.fct_flight...................... [[32mCREATE VIEW[0m in 0.23s]
11:50:21.825142 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_flight
11:50:21.832719 [debug] [MainThread]: Acquiring new materialize connection "master"
11:50:21.836192 [debug] [MainThread]: Using materialize connection "master"
11:50:21.839089 [debug] [MainThread]: On master: BEGIN
11:50:21.841344 [debug] [MainThread]: Opening a new connection, currently in state closed
11:50:21.846572 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:50:21.849485 [debug] [MainThread]: Using materialize connection "master"
11:50:21.851679 [debug] [MainThread]: On master: COMMIT
11:50:21.854268 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:50:21.856378 [debug] [MainThread]: On master: Close
11:50:21.860333 [info ] [MainThread]: 
11:50:21.863405 [info ] [MainThread]: Finished running 3 source models, 3 view models, 2 materializedview models in 1.62s.
11:50:21.866430 [debug] [MainThread]: Connection 'master' was properly closed.
11:50:21.868261 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_flight' was properly closed.
11:50:21.909368 [info ] [MainThread]: 
11:50:21.912790 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
11:50:21.915807 [info ] [MainThread]: 
11:50:21.918362 [error] [MainThread]: [33mDatabase Error in model stg_inventory_customers (models/examples/staging/inventory/stg_inventory_customers.sql)[0m
11:50:21.920705 [error] [MainThread]:   column "data" does not exist
11:50:21.923448 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/examples/staging/inventory/stg_inventory_customers.sql
11:50:21.926310 [info ] [MainThread]: 
11:50:21.928685 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=1 TOTAL=8
11:50:21.931574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f2fc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027dac9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027db31c0>]}


============================== 2022-02-19 11:54:39.818968 | 4f7c8d9e-fdec-4d74-9ca4-a54c83fdd73a ==============================
11:54:39.818968 [info ] [MainThread]: Running with dbt=1.0.1
11:54:39.825652 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
11:54:39.829352 [debug] [MainThread]: Tracking: tracking
11:54:39.865317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abdf0>]}
11:54:40.244179 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
11:54:40.251259 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/examples/staging/inventory/stg_inventory_customers.sql
11:54:40.366917 [debug] [MainThread]: 1699: static parser successfully parsed examples/staging/inventory/stg_inventory_customers.sql
11:54:40.565306 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.templates
- models.examples

11:54:40.609332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f7c8d9e-fdec-4d74-9ca4-a54c83fdd73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2df40>]}
11:54:40.668002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f7c8d9e-fdec-4d74-9ca4-a54c83fdd73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400733cbb0>]}
11:54:40.671461 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
11:54:40.685644 [info ] [MainThread]: 
11:54:40.691455 [debug] [MainThread]: Acquiring new materialize connection "master"
11:54:40.706843 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
11:54:40.783028 [debug] [ThreadPool]: Using materialize connection "list_materialize"
11:54:40.786294 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
11:54:40.788928 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:54:40.822679 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
11:54:40.833653 [debug] [ThreadPool]: On list_materialize: Close
11:54:40.846465 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
11:54:40.870956 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
11:54:40.873480 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
11:54:40.876018 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:54:40.883558 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
11:54:40.893240 [debug] [ThreadPool]: On list_materialize_public: Close
11:54:40.901440 [debug] [MainThread]: Using materialize connection "master"
11:54:40.903835 [debug] [MainThread]: On master: BEGIN
11:54:40.905946 [debug] [MainThread]: Opening a new connection, currently in state init
11:54:40.912033 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:54:40.915266 [debug] [MainThread]: Using materialize connection "master"
11:54:40.917171 [debug] [MainThread]: On master: COMMIT
11:54:40.919910 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:54:40.922166 [debug] [MainThread]: On master: Close
11:54:40.925520 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
11:54:40.928583 [info ] [MainThread]: 
11:54:40.948027 [debug] [Thread-1  ]: Began running node model.mz_hack_day.icao_mapping
11:54:40.953744 [info ] [Thread-1  ]: 1 of 8 START source model public.icao_mapping................................... [RUN]
11:54:40.960698 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.icao_mapping"
11:54:40.963021 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.icao_mapping
11:54:40.965145 [debug] [Thread-1  ]: Compiling model.mz_hack_day.icao_mapping
11:54:41.003928 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.icao_mapping"
11:54:41.011396 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.014164 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.icao_mapping
11:54:41.076459 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:54:41.079792 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */
drop source if exists 
      materialize.public.icao_mapping
   cascade
11:54:41.082155 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:54:41.091794 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:54:41.135396 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.icao_mapping"
11:54:41.142174 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:54:41.144404 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */




CREATE SOURCE 
    materialize.public.icao_mapping

FROM FILE '/tmp/icao24_mapping_airbus.json.gz' COMPRESSION GZIP
FORMAT BYTES;
11:54:41.153518 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:54:41.207711 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.210631 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: Close
11:54:41.214400 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f7c8d9e-fdec-4d74-9ca4-a54c83fdd73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2d8b0>]}
11:54:41.217756 [info ] [Thread-1  ]: 1 of 8 OK created source model public.icao_mapping.............................. [[32mCREATE SOURCE[0m in 0.25s]
11:54:41.221410 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.icao_mapping
11:54:41.224159 [debug] [Thread-1  ]: Began running node model.mz_hack_day.inventory_customers
11:54:41.230532 [info ] [Thread-1  ]: 2 of 8 START source model public.inventory_customers............................ [RUN]
11:54:41.237289 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.inventory_customers"
11:54:41.240891 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.inventory_customers
11:54:41.245629 [debug] [Thread-1  ]: Compiling model.mz_hack_day.inventory_customers
11:54:41.272893 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.inventory_customers"
11:54:41.287676 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.293620 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.inventory_customers
11:54:41.304849 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:54:41.307250 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */
drop source if exists 
      materialize.public.inventory_customers
   cascade
11:54:41.309420 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:54:41.318691 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:54:41.327253 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.inventory_customers"
11:54:41.333481 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:54:41.336901 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */




CREATE SOURCE 
    materialize.public.inventory_customers

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'dbserver1.inventory.customers'
FORMAT AVRO USING CONFLUENT SCHEMA REGISTRY 'http://redpanda:8081'
ENVELOPE DEBEZIUM;
11:54:41.353832 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:54:41.364805 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.367525 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: Close
11:54:41.371487 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f7c8d9e-fdec-4d74-9ca4-a54c83fdd73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c52e50>]}
11:54:41.375233 [info ] [Thread-1  ]: 2 of 8 OK created source model public.inventory_customers....................... [[32mCREATE SOURCE[0m in 0.14s]
11:54:41.378481 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.inventory_customers
11:54:41.381624 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_flight_information
11:54:41.384858 [info ] [Thread-1  ]: 3 of 8 START source model public.rp_flight_information.......................... [RUN]
11:54:41.388529 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_flight_information"
11:54:41.391828 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_flight_information
11:54:41.394361 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_flight_information
11:54:41.416761 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_flight_information"
11:54:41.428457 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.431124 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_flight_information
11:54:41.442909 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:54:41.445724 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */
drop source if exists 
      materialize.public.rp_flight_information
   cascade
11:54:41.447732 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:54:41.456593 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:54:41.465179 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_flight_information"
11:54:41.470361 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:54:41.472505 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */




CREATE SOURCE 
    materialize.public.rp_flight_information

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'flight_information'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
11:54:41.482484 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:54:41.492769 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.495404 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: Close
11:54:41.499182 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f7c8d9e-fdec-4d74-9ca4-a54c83fdd73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f367c0>]}
11:54:41.502560 [info ] [Thread-1  ]: 3 of 8 OK created source model public.rp_flight_information..................... [[32mCREATE SOURCE[0m in 0.11s]
11:54:41.505596 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_flight_information
11:54:41.508519 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_icao_mapping
11:54:41.511769 [info ] [Thread-1  ]: 4 of 8 START view model public.stg_icao_mapping................................. [RUN]
11:54:41.515419 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_icao_mapping"
11:54:41.517527 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_icao_mapping
11:54:41.519756 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_icao_mapping
11:54:41.543657 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_icao_mapping"
11:54:41.551707 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.554585 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_icao_mapping
11:54:41.633639 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:54:41.636692 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
drop view if exists "materialize"."public"."stg_icao_mapping" cascade
11:54:41.638909 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:54:41.645202 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:54:41.672767 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_icao_mapping"
11:54:41.679708 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:54:41.682220 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
create view "materialize"."public"."stg_icao_mapping"
  as (
    /*

The purpose of this staging model is to create a icao_mapping staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."icao_mapping"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

    (data->>'icao24')::string AS icao24,
           (data->>'manufacturericao')::string AS manufacturericao,
           (data->>'manufacturername')::string AS manufacturername,
           (data->>'model')::string AS model,
           (data->>'typecode')::string AS typecode,
           (data->>'icaoaircrafttype')::string AS icaoaircrafttype,
           (data->>'operator')::string AS operator,
           (data->>'operatorcallsign')::string AS operatorcallsign,
           (data->>'operatoricao')::string AS operatoricao,
           (data->>'built')::string AS built,
           (data->>'categorydescription')::string AS categorydescription

    FROM casted

)

SELECT * FROM renamed
  );
11:54:41.691775 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:54:41.703495 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.706238 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: Close
11:54:41.709877 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f7c8d9e-fdec-4d74-9ca4-a54c83fdd73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f36c10>]}
11:54:41.713550 [info ] [Thread-1  ]: 4 of 8 OK created view model public.stg_icao_mapping............................ [[32mCREATE VIEW[0m in 0.20s]
11:54:41.717216 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_icao_mapping
11:54:41.719739 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_inventory_customers
11:54:41.722622 [info ] [Thread-1  ]: 5 of 8 START view model public.stg_inventory_customers.......................... [RUN]
11:54:41.725882 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_inventory_customers"
11:54:41.727947 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_inventory_customers
11:54:41.729939 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_inventory_customers
11:54:41.750181 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_inventory_customers"
11:54:41.758863 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.761438 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_inventory_customers
11:54:41.778750 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_inventory_customers"
11:54:41.781374 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_inventory_customers"} */
drop view if exists "materialize"."public"."stg_inventory_customers" cascade
11:54:41.783433 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:54:41.789314 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:54:41.799265 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_inventory_customers"
11:54:41.806601 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_inventory_customers"
11:54:41.808981 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_inventory_customers"} */
create view "materialize"."public"."stg_inventory_customers"
  as (
    /*

The purpose of this model is to create an inventory_customers staging model.

 */





WITH source AS (

    SELECT * FROM "materialize"."public"."inventory_customers"

),

-- converted AS (
--
--     SELECT convert_from(data, 'utf8') AS data FROM source
--
-- ),

casted AS (

    SELECT cast(source AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'id')::numeric as id,
       (data->>'first_name')::string as first_name,
       (data->>'last_name')::string as last_name,
       (data->>'email')::string as email

    FROM casted

)

SELECT * FROM renamed
  );
11:54:41.813106 [debug] [Thread-1  ]: Postgres adapter: Postgres error: unknown catalog item 'converted'

11:54:41.815734 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.817841 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: Close
11:54:41.820741 [debug] [Thread-1  ]: Database Error in model stg_inventory_customers (models/examples/staging/inventory/stg_inventory_customers.sql)
  unknown catalog item 'converted'
  compiled SQL at target/run/mz_hack_day/models/examples/staging/inventory/stg_inventory_customers.sql
11:54:41.823909 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f7c8d9e-fdec-4d74-9ca4-a54c83fdd73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f8af10>]}
11:54:41.826764 [error] [Thread-1  ]: 5 of 8 ERROR creating view model public.stg_inventory_customers................. [[31mERROR[0m in 0.10s]
11:54:41.829736 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_inventory_customers
11:54:41.832160 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_flight_information
11:54:41.835052 [info ] [Thread-1  ]: 6 of 8 START view model public.stg_flight_information........................... [RUN]
11:54:41.839287 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_flight_information"
11:54:41.841626 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_flight_information
11:54:41.845915 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_flight_information
11:54:41.873508 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_flight_information"
11:54:41.879997 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.882695 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_flight_information
11:54:41.901149 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:54:41.903457 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
drop view if exists "materialize"."public"."stg_flight_information" cascade
11:54:41.906320 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:54:41.912065 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:54:41.921732 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_flight_information"
11:54:41.927575 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:54:41.930397 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
create view "materialize"."public"."stg_flight_information"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_flight_information"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'icao24')::string as icao24,
       (data->>'callsign')::string as callsign,
       (data->>'origin_country')::string as origin_country,
       (data->>'time_position')::numeric as time_position,
       (data->>'last_contact')::numeric as last_contact,
       (data->>'longitude')::double as longitude,
       (data->>'latitude')::double as latitude,
       (data->>'baro_altitude')::double as baro_altitude,
       (data->>'on_ground')::boolean as on_ground,
       (data->>'velocity')::double as velocity,
       (data->>'true_track')::double as true_track,
       (data->>'vertical_rate')::string as vertical_rate,
       (data->>'sensors')::string as sensors,
       (data->>'geo_altitude')::string as geo_altitude,
       (data->>'squawk')::string as squawk,
       (data->>'spi')::string as spi,
       (data->>'position_source')::string as position_source

    FROM casted

)

SELECT * FROM renamed
  );
11:54:41.940260 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:54:41.950275 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.952381 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: Close
11:54:41.955765 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f7c8d9e-fdec-4d74-9ca4-a54c83fdd73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f6e250>]}
11:54:41.958832 [info ] [Thread-1  ]: 6 of 8 OK created view model public.stg_flight_information...................... [[32mCREATE VIEW[0m in 0.12s]
11:54:41.961604 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_flight_information
11:54:41.963594 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_inventory
11:54:41.965915 [info ] [Thread-1  ]: 7 of 8 SKIP relation public.fct_inventory....................................... [[33mSKIP[0m]
11:54:41.968540 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_inventory
11:54:41.970611 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_flight
11:54:41.973663 [info ] [Thread-1  ]: 8 of 8 START materializedview model public.fct_flight........................... [RUN]
11:54:41.978519 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_flight"
11:54:41.983191 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_flight
11:54:41.986706 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_flight
11:54:42.008330 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_flight"
11:54:42.014993 [debug] [Thread-1  ]: finished collecting timing info
11:54:42.017327 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_flight
11:54:42.072497 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:54:42.076156 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
drop view if exists "materialize"."public"."fct_flight" cascade
11:54:42.078818 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:54:42.085244 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:54:42.102594 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_flight"
11:54:42.109494 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:54:42.111676 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
create materialized view "materialize"."public"."fct_flight"
  as (
    


SELECT fi.icao24,
       manufacturername,
       model,
       operator,
       origin_country,
       time_position,
       longitude,
       latitude
FROM "materialize"."public"."stg_flight_information" fi
JOIN "materialize"."public"."stg_icao_mapping" icao ON fi.icao24 = icao.icao24
  );
11:54:42.123730 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:54:42.136736 [debug] [Thread-1  ]: finished collecting timing info
11:54:42.140542 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: Close
11:54:42.144663 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f7c8d9e-fdec-4d74-9ca4-a54c83fdd73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027dc6c70>]}
11:54:42.148844 [info ] [Thread-1  ]: 8 of 8 OK created materializedview model public.fct_flight...................... [[32mCREATE VIEW[0m in 0.17s]
11:54:42.152563 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_flight
11:54:42.159842 [debug] [MainThread]: Acquiring new materialize connection "master"
11:54:42.162549 [debug] [MainThread]: Using materialize connection "master"
11:54:42.165060 [debug] [MainThread]: On master: BEGIN
11:54:42.167363 [debug] [MainThread]: Opening a new connection, currently in state closed
11:54:42.173302 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:54:42.176184 [debug] [MainThread]: Using materialize connection "master"
11:54:42.179157 [debug] [MainThread]: On master: COMMIT
11:54:42.183367 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:54:42.186110 [debug] [MainThread]: On master: Close
11:54:42.189755 [info ] [MainThread]: 
11:54:42.193102 [info ] [MainThread]: Finished running 3 source models, 3 view models, 2 materializedview models in 1.50s.
11:54:42.197492 [debug] [MainThread]: Connection 'master' was properly closed.
11:54:42.199901 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_flight' was properly closed.
11:54:42.242568 [info ] [MainThread]: 
11:54:42.245689 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
11:54:42.248641 [info ] [MainThread]: 
11:54:42.251154 [error] [MainThread]: [33mDatabase Error in model stg_inventory_customers (models/examples/staging/inventory/stg_inventory_customers.sql)[0m
11:54:42.253671 [error] [MainThread]:   unknown catalog item 'converted'
11:54:42.256031 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/examples/staging/inventory/stg_inventory_customers.sql
11:54:42.260528 [info ] [MainThread]: 
11:54:42.264634 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=1 TOTAL=8
11:54:42.268030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f90100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f90160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027dae520>]}


============================== 2022-02-19 11:55:40.517281 | a34945c3-90e7-4533-bd87-76e80692f33a ==============================
11:55:40.517281 [info ] [MainThread]: Running with dbt=1.0.1
11:55:40.526221 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
11:55:40.529211 [debug] [MainThread]: Tracking: tracking
11:55:40.557085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abdf0>]}
11:55:40.927338 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
11:55:40.932192 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/examples/staging/inventory/stg_inventory_customers.sql
11:55:41.045211 [debug] [MainThread]: 1699: static parser successfully parsed examples/staging/inventory/stg_inventory_customers.sql
11:55:41.246377 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.templates
- models.examples

11:55:41.290052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a34945c3-90e7-4533-bd87-76e80692f33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2df40>]}
11:55:41.358441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a34945c3-90e7-4533-bd87-76e80692f33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400733cbb0>]}
11:55:41.362197 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
11:55:41.374039 [info ] [MainThread]: 
11:55:41.378620 [debug] [MainThread]: Acquiring new materialize connection "master"
11:55:41.389973 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
11:55:41.469092 [debug] [ThreadPool]: Using materialize connection "list_materialize"
11:55:41.472188 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
11:55:41.474110 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:55:41.507003 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
11:55:41.518564 [debug] [ThreadPool]: On list_materialize: Close
11:55:41.529823 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
11:55:41.555602 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
11:55:41.558906 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
11:55:41.561063 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:55:41.568558 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
11:55:41.579057 [debug] [ThreadPool]: On list_materialize_public: Close
11:55:41.587811 [debug] [MainThread]: Using materialize connection "master"
11:55:41.590312 [debug] [MainThread]: On master: BEGIN
11:55:41.593113 [debug] [MainThread]: Opening a new connection, currently in state init
11:55:41.598670 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:55:41.601504 [debug] [MainThread]: Using materialize connection "master"
11:55:41.603623 [debug] [MainThread]: On master: COMMIT
11:55:41.606664 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:55:41.609050 [debug] [MainThread]: On master: Close
11:55:41.613426 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
11:55:41.617318 [info ] [MainThread]: 
11:55:41.637315 [debug] [Thread-1  ]: Began running node model.mz_hack_day.icao_mapping
11:55:41.641423 [info ] [Thread-1  ]: 1 of 8 START source model public.icao_mapping................................... [RUN]
11:55:41.647438 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.icao_mapping"
11:55:41.662769 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.icao_mapping
11:55:41.682317 [debug] [Thread-1  ]: Compiling model.mz_hack_day.icao_mapping
11:55:41.735032 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.icao_mapping"
11:55:41.742189 [debug] [Thread-1  ]: finished collecting timing info
11:55:41.744403 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.icao_mapping
11:55:41.806199 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:55:41.809401 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */
drop source if exists 
      materialize.public.icao_mapping
   cascade
11:55:41.811790 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:55:41.822111 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:55:41.865281 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.icao_mapping"
11:55:41.872462 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:55:41.875122 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */




CREATE SOURCE 
    materialize.public.icao_mapping

FROM FILE '/tmp/icao24_mapping_airbus.json.gz' COMPRESSION GZIP
FORMAT BYTES;
11:55:41.886571 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:55:41.939753 [debug] [Thread-1  ]: finished collecting timing info
11:55:41.943066 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: Close
11:55:41.947107 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a34945c3-90e7-4533-bd87-76e80692f33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2de20>]}
11:55:41.950782 [info ] [Thread-1  ]: 1 of 8 OK created source model public.icao_mapping.............................. [[32mCREATE SOURCE[0m in 0.30s]
11:55:41.954162 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.icao_mapping
11:55:41.956274 [debug] [Thread-1  ]: Began running node model.mz_hack_day.inventory_customers
11:55:41.959155 [info ] [Thread-1  ]: 2 of 8 START source model public.inventory_customers............................ [RUN]
11:55:41.963146 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.inventory_customers"
11:55:41.965345 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.inventory_customers
11:55:41.967550 [debug] [Thread-1  ]: Compiling model.mz_hack_day.inventory_customers
11:55:41.989542 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.inventory_customers"
11:55:41.999016 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.003328 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.inventory_customers
11:55:42.021790 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:55:42.024883 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */
drop source if exists 
      materialize.public.inventory_customers
   cascade
11:55:42.031059 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:55:42.041517 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:55:42.050305 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.inventory_customers"
11:55:42.056779 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:55:42.058541 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */




CREATE SOURCE 
    materialize.public.inventory_customers

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'dbserver1.inventory.customers'
FORMAT AVRO USING CONFLUENT SCHEMA REGISTRY 'http://redpanda:8081'
ENVELOPE DEBEZIUM;
11:55:42.076793 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.02 seconds
11:55:42.087338 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.089936 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: Close
11:55:42.093364 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a34945c3-90e7-4533-bd87-76e80692f33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c52e50>]}
11:55:42.096774 [info ] [Thread-1  ]: 2 of 8 OK created source model public.inventory_customers....................... [[32mCREATE SOURCE[0m in 0.13s]
11:55:42.099592 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.inventory_customers
11:55:42.101805 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_flight_information
11:55:42.108366 [info ] [Thread-1  ]: 3 of 8 START source model public.rp_flight_information.......................... [RUN]
11:55:42.112498 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_flight_information"
11:55:42.115119 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_flight_information
11:55:42.117737 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_flight_information
11:55:42.139166 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_flight_information"
11:55:42.147951 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.150022 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_flight_information
11:55:42.161389 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:55:42.164005 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */
drop source if exists 
      materialize.public.rp_flight_information
   cascade
11:55:42.166228 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:55:42.180009 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:55:42.188903 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_flight_information"
11:55:42.194117 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:55:42.196347 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */




CREATE SOURCE 
    materialize.public.rp_flight_information

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'flight_information'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
11:55:42.206024 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:55:42.216318 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.219215 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: Close
11:55:42.222704 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a34945c3-90e7-4533-bd87-76e80692f33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f33e20>]}
11:55:42.225960 [info ] [Thread-1  ]: 3 of 8 OK created source model public.rp_flight_information..................... [[32mCREATE SOURCE[0m in 0.11s]
11:55:42.228824 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_flight_information
11:55:42.231515 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_icao_mapping
11:55:42.234520 [info ] [Thread-1  ]: 4 of 8 START view model public.stg_icao_mapping................................. [RUN]
11:55:42.238266 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_icao_mapping"
11:55:42.240512 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_icao_mapping
11:55:42.244787 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_icao_mapping
11:55:42.265611 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_icao_mapping"
11:55:42.272309 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.276141 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_icao_mapping
11:55:42.363779 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:55:42.366841 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
drop view if exists "materialize"."public"."stg_icao_mapping" cascade
11:55:42.368989 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:55:42.374192 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:55:42.401996 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_icao_mapping"
11:55:42.410497 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:55:42.412630 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
create view "materialize"."public"."stg_icao_mapping"
  as (
    /*

The purpose of this staging model is to create a icao_mapping staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."icao_mapping"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

    (data->>'icao24')::string AS icao24,
           (data->>'manufacturericao')::string AS manufacturericao,
           (data->>'manufacturername')::string AS manufacturername,
           (data->>'model')::string AS model,
           (data->>'typecode')::string AS typecode,
           (data->>'icaoaircrafttype')::string AS icaoaircrafttype,
           (data->>'operator')::string AS operator,
           (data->>'operatorcallsign')::string AS operatorcallsign,
           (data->>'operatoricao')::string AS operatoricao,
           (data->>'built')::string AS built,
           (data->>'categorydescription')::string AS categorydescription

    FROM casted

)

SELECT * FROM renamed
  );
11:55:42.429451 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:55:42.439763 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.442124 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: Close
11:55:42.445462 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a34945c3-90e7-4533-bd87-76e80692f33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f33c10>]}
11:55:42.448694 [info ] [Thread-1  ]: 4 of 8 OK created view model public.stg_icao_mapping............................ [[32mCREATE VIEW[0m in 0.21s]
11:55:42.452072 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_icao_mapping
11:55:42.454310 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_inventory_customers
11:55:42.457058 [info ] [Thread-1  ]: 5 of 8 START view model public.stg_inventory_customers.......................... [RUN]
11:55:42.460621 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_inventory_customers"
11:55:42.462909 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_inventory_customers
11:55:42.464802 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_inventory_customers
11:55:42.483435 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_inventory_customers"
11:55:42.489840 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.492472 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_inventory_customers
11:55:42.510343 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_inventory_customers"
11:55:42.512958 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_inventory_customers"} */
drop view if exists "materialize"."public"."stg_inventory_customers" cascade
11:55:42.515198 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:55:42.521597 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:55:42.531331 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_inventory_customers"
11:55:42.538075 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_inventory_customers"
11:55:42.540369 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_inventory_customers"} */
create view "materialize"."public"."stg_inventory_customers"
  as (
    /*

The purpose of this model is to create an inventory_customers staging model.

 */





WITH source AS (

    SELECT * FROM "materialize"."public"."inventory_customers"

),

converted AS (

    SELECT convert_from(value, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'id')::numeric as id,
       (data->>'first_name')::string as first_name,
       (data->>'last_name')::string as last_name,
       (data->>'email')::string as email

    FROM casted

)

SELECT * FROM renamed
  );
11:55:42.544394 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "value" does not exist

11:55:42.546935 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.549286 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: Close
11:55:42.552938 [debug] [Thread-1  ]: Database Error in model stg_inventory_customers (models/examples/staging/inventory/stg_inventory_customers.sql)
  column "value" does not exist
  compiled SQL at target/run/mz_hack_day/models/examples/staging/inventory/stg_inventory_customers.sql
11:55:42.556217 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a34945c3-90e7-4533-bd87-76e80692f33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f8af10>]}
11:55:42.559161 [error] [Thread-1  ]: 5 of 8 ERROR creating view model public.stg_inventory_customers................. [[31mERROR[0m in 0.10s]
11:55:42.562418 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_inventory_customers
11:55:42.564614 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_flight_information
11:55:42.567369 [info ] [Thread-1  ]: 6 of 8 START view model public.stg_flight_information........................... [RUN]
11:55:42.571065 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_flight_information"
11:55:42.573003 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_flight_information
11:55:42.575537 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_flight_information
11:55:42.600223 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_flight_information"
11:55:42.607173 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.609777 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_flight_information
11:55:42.627465 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:55:42.630220 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
drop view if exists "materialize"."public"."stg_flight_information" cascade
11:55:42.632320 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:55:42.638089 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:55:42.648138 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_flight_information"
11:55:42.653805 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:55:42.656176 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
create view "materialize"."public"."stg_flight_information"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_flight_information"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'icao24')::string as icao24,
       (data->>'callsign')::string as callsign,
       (data->>'origin_country')::string as origin_country,
       (data->>'time_position')::numeric as time_position,
       (data->>'last_contact')::numeric as last_contact,
       (data->>'longitude')::double as longitude,
       (data->>'latitude')::double as latitude,
       (data->>'baro_altitude')::double as baro_altitude,
       (data->>'on_ground')::boolean as on_ground,
       (data->>'velocity')::double as velocity,
       (data->>'true_track')::double as true_track,
       (data->>'vertical_rate')::string as vertical_rate,
       (data->>'sensors')::string as sensors,
       (data->>'geo_altitude')::string as geo_altitude,
       (data->>'squawk')::string as squawk,
       (data->>'spi')::string as spi,
       (data->>'position_source')::string as position_source

    FROM casted

)

SELECT * FROM renamed
  );
11:55:42.665862 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:55:42.675419 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.677777 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: Close
11:55:42.681562 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a34945c3-90e7-4533-bd87-76e80692f33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f6e310>]}
11:55:42.684819 [info ] [Thread-1  ]: 6 of 8 OK created view model public.stg_flight_information...................... [[32mCREATE VIEW[0m in 0.11s]
11:55:42.687538 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_flight_information
11:55:42.690163 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_inventory
11:55:42.692294 [info ] [Thread-1  ]: 7 of 8 SKIP relation public.fct_inventory....................................... [[33mSKIP[0m]
11:55:42.695609 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_inventory
11:55:42.698016 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_flight
11:55:42.700507 [info ] [Thread-1  ]: 8 of 8 START materializedview model public.fct_flight........................... [RUN]
11:55:42.705341 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_flight"
11:55:42.708004 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_flight
11:55:42.709959 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_flight
11:55:42.730406 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_flight"
11:55:42.739244 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.742246 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_flight
11:55:42.796542 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:55:42.799985 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
drop view if exists "materialize"."public"."fct_flight" cascade
11:55:42.802413 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:55:42.808275 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:55:42.825557 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_flight"
11:55:42.832219 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:55:42.834470 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
create materialized view "materialize"."public"."fct_flight"
  as (
    


SELECT fi.icao24,
       manufacturername,
       model,
       operator,
       origin_country,
       time_position,
       longitude,
       latitude
FROM "materialize"."public"."stg_flight_information" fi
JOIN "materialize"."public"."stg_icao_mapping" icao ON fi.icao24 = icao.icao24
  );
11:55:42.847005 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:55:42.860804 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.864222 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: Close
11:55:42.868777 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a34945c3-90e7-4533-bd87-76e80692f33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027dc6c70>]}
11:55:42.872999 [info ] [Thread-1  ]: 8 of 8 OK created materializedview model public.fct_flight...................... [[32mCREATE VIEW[0m in 0.16s]
11:55:42.877160 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_flight
11:55:42.884635 [debug] [MainThread]: Acquiring new materialize connection "master"
11:55:42.887446 [debug] [MainThread]: Using materialize connection "master"
11:55:42.890133 [debug] [MainThread]: On master: BEGIN
11:55:42.892557 [debug] [MainThread]: Opening a new connection, currently in state closed
11:55:42.898502 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:55:42.901435 [debug] [MainThread]: Using materialize connection "master"
11:55:42.903359 [debug] [MainThread]: On master: COMMIT
11:55:42.906410 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:55:42.909028 [debug] [MainThread]: On master: Close
11:55:42.912499 [info ] [MainThread]: 
11:55:42.915441 [info ] [MainThread]: Finished running 3 source models, 3 view models, 2 materializedview models in 1.53s.
11:55:42.917963 [debug] [MainThread]: Connection 'master' was properly closed.
11:55:42.919767 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_flight' was properly closed.
11:55:42.962476 [info ] [MainThread]: 
11:55:42.965907 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
11:55:42.969127 [info ] [MainThread]: 
11:55:42.971917 [error] [MainThread]: [33mDatabase Error in model stg_inventory_customers (models/examples/staging/inventory/stg_inventory_customers.sql)[0m
11:55:42.974505 [error] [MainThread]:   column "value" does not exist
11:55:42.976808 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/examples/staging/inventory/stg_inventory_customers.sql
11:55:42.981641 [info ] [MainThread]: 
11:55:42.985348 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=1 TOTAL=8
11:55:42.991018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f90100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f901f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2d3a0>]}


============================== 2022-02-19 11:58:06.757368 | 99e1ef94-ad08-444e-a8c6-219ba27e33bc ==============================
11:58:06.757368 [info ] [MainThread]: Running with dbt=1.0.1
11:58:06.764171 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
11:58:06.767686 [debug] [MainThread]: Tracking: tracking
11:58:06.800170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abdf0>]}
11:58:07.161076 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
11:58:07.165736 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/examples/staging/inventory/stg_inventory_customers.sql
11:58:07.282214 [debug] [MainThread]: 1699: static parser successfully parsed examples/staging/inventory/stg_inventory_customers.sql
11:58:07.479623 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.examples
- models.templates

11:58:07.521835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99e1ef94-ad08-444e-a8c6-219ba27e33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2df40>]}
11:58:07.581943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99e1ef94-ad08-444e-a8c6-219ba27e33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007339bb0>]}
11:58:07.585306 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
11:58:07.596416 [info ] [MainThread]: 
11:58:07.600922 [debug] [MainThread]: Acquiring new materialize connection "master"
11:58:07.613617 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
11:58:07.691095 [debug] [ThreadPool]: Using materialize connection "list_materialize"
11:58:07.694051 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
11:58:07.696678 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:58:07.725483 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
11:58:07.738175 [debug] [ThreadPool]: On list_materialize: Close
11:58:07.768456 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
11:58:07.798791 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
11:58:07.802444 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
11:58:07.804201 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:58:07.810973 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
11:58:07.820882 [debug] [ThreadPool]: On list_materialize_public: Close
11:58:07.829384 [debug] [MainThread]: Using materialize connection "master"
11:58:07.832078 [debug] [MainThread]: On master: BEGIN
11:58:07.834578 [debug] [MainThread]: Opening a new connection, currently in state init
11:58:07.840125 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:58:07.842678 [debug] [MainThread]: Using materialize connection "master"
11:58:07.844979 [debug] [MainThread]: On master: COMMIT
11:58:07.848360 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:58:07.850492 [debug] [MainThread]: On master: Close
11:58:07.853414 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
11:58:07.856075 [info ] [MainThread]: 
11:58:07.873632 [debug] [Thread-1  ]: Began running node model.mz_hack_day.icao_mapping
11:58:07.877659 [info ] [Thread-1  ]: 1 of 8 START source model public.icao_mapping................................... [RUN]
11:58:07.881360 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.icao_mapping"
11:58:07.884503 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.icao_mapping
11:58:07.888192 [debug] [Thread-1  ]: Compiling model.mz_hack_day.icao_mapping
11:58:07.923373 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.icao_mapping"
11:58:07.931698 [debug] [Thread-1  ]: finished collecting timing info
11:58:07.934124 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.icao_mapping
11:58:07.995101 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:58:07.998351 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */
drop source if exists 
      materialize.public.icao_mapping
   cascade
11:58:08.000363 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:58:08.015295 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:58:08.057881 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.icao_mapping"
11:58:08.065577 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:58:08.068266 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */




CREATE SOURCE 
    materialize.public.icao_mapping

FROM FILE '/tmp/icao24_mapping_airbus.json.gz' COMPRESSION GZIP
FORMAT BYTES;
11:58:08.079623 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:58:08.132486 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.135690 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: Close
11:58:08.139148 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99e1ef94-ad08-444e-a8c6-219ba27e33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2d190>]}
11:58:08.142978 [info ] [Thread-1  ]: 1 of 8 OK created source model public.icao_mapping.............................. [[32mCREATE SOURCE[0m in 0.26s]
11:58:08.146846 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.icao_mapping
11:58:08.149199 [debug] [Thread-1  ]: Began running node model.mz_hack_day.inventory_customers
11:58:08.152592 [info ] [Thread-1  ]: 2 of 8 START source model public.inventory_customers............................ [RUN]
11:58:08.156421 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.inventory_customers"
11:58:08.159965 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.inventory_customers
11:58:08.162186 [debug] [Thread-1  ]: Compiling model.mz_hack_day.inventory_customers
11:58:08.188013 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.inventory_customers"
11:58:08.196218 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.198823 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.inventory_customers
11:58:08.210131 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:58:08.212766 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */
drop source if exists 
      materialize.public.inventory_customers
   cascade
11:58:08.214723 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:58:08.223671 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:58:08.232470 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.inventory_customers"
11:58:08.238782 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:58:08.240912 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */




CREATE SOURCE 
    materialize.public.inventory_customers

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'dbserver1.inventory.customers'
FORMAT AVRO USING CONFLUENT SCHEMA REGISTRY 'http://redpanda:8081'
ENVELOPE DEBEZIUM;
11:58:08.258355 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.02 seconds
11:58:08.268833 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.271548 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: Close
11:58:08.274970 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99e1ef94-ad08-444e-a8c6-219ba27e33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c52e50>]}
11:58:08.278318 [info ] [Thread-1  ]: 2 of 8 OK created source model public.inventory_customers....................... [[32mCREATE SOURCE[0m in 0.12s]
11:58:08.281437 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.inventory_customers
11:58:08.284059 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_flight_information
11:58:08.286994 [info ] [Thread-1  ]: 3 of 8 START source model public.rp_flight_information.......................... [RUN]
11:58:08.291094 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_flight_information"
11:58:08.293138 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_flight_information
11:58:08.296194 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_flight_information
11:58:08.319978 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_flight_information"
11:58:08.326177 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.328460 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_flight_information
11:58:08.340199 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:58:08.342697 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */
drop source if exists 
      materialize.public.rp_flight_information
   cascade
11:58:08.344751 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:58:08.354779 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:58:08.363432 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_flight_information"
11:58:08.368593 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:58:08.371618 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */




CREATE SOURCE 
    materialize.public.rp_flight_information

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'flight_information'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
11:58:08.381204 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:58:08.391027 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.393879 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: Close
11:58:08.397770 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99e1ef94-ad08-444e-a8c6-219ba27e33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f376a0>]}
11:58:08.401484 [info ] [Thread-1  ]: 3 of 8 OK created source model public.rp_flight_information..................... [[32mCREATE SOURCE[0m in 0.11s]
11:58:08.404463 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_flight_information
11:58:08.407024 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_icao_mapping
11:58:08.409836 [info ] [Thread-1  ]: 4 of 8 START view model public.stg_icao_mapping................................. [RUN]
11:58:08.413936 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_icao_mapping"
11:58:08.416039 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_icao_mapping
11:58:08.417920 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_icao_mapping
11:58:08.438727 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_icao_mapping"
11:58:08.445940 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.448436 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_icao_mapping
11:58:08.523868 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:58:08.527352 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
drop view if exists "materialize"."public"."stg_icao_mapping" cascade
11:58:08.529564 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:58:08.535671 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:58:08.563342 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_icao_mapping"
11:58:08.570462 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:58:08.572529 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
create view "materialize"."public"."stg_icao_mapping"
  as (
    /*

The purpose of this staging model is to create a icao_mapping staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."icao_mapping"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

    (data->>'icao24')::string AS icao24,
           (data->>'manufacturericao')::string AS manufacturericao,
           (data->>'manufacturername')::string AS manufacturername,
           (data->>'model')::string AS model,
           (data->>'typecode')::string AS typecode,
           (data->>'icaoaircrafttype')::string AS icaoaircrafttype,
           (data->>'operator')::string AS operator,
           (data->>'operatorcallsign')::string AS operatorcallsign,
           (data->>'operatoricao')::string AS operatoricao,
           (data->>'built')::string AS built,
           (data->>'categorydescription')::string AS categorydescription

    FROM casted

)

SELECT * FROM renamed
  );
11:58:08.582982 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:58:08.592984 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.596122 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: Close
11:58:08.600081 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99e1ef94-ad08-444e-a8c6-219ba27e33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f37bb0>]}
11:58:08.603573 [info ] [Thread-1  ]: 4 of 8 OK created view model public.stg_icao_mapping............................ [[32mCREATE VIEW[0m in 0.19s]
11:58:08.606638 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_icao_mapping
11:58:08.609595 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_inventory_customers
11:58:08.612048 [info ] [Thread-1  ]: 5 of 8 START view model public.stg_inventory_customers.......................... [RUN]
11:58:08.615695 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_inventory_customers"
11:58:08.618045 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_inventory_customers
11:58:08.620354 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_inventory_customers
11:58:08.640051 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_inventory_customers"
11:58:08.646965 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.649565 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_inventory_customers
11:58:08.668077 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_inventory_customers"
11:58:08.670683 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_inventory_customers"} */
drop view if exists "materialize"."public"."stg_inventory_customers" cascade
11:58:08.672938 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:58:08.678728 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:58:08.688542 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_inventory_customers"
11:58:08.693715 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_inventory_customers"
11:58:08.695824 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_inventory_customers"} */
create view "materialize"."public"."stg_inventory_customers"
  as (
    /*

The purpose of this model is to create an inventory_customers staging model.

 */





WITH source AS (

    SELECT * FROM "materialize"."public"."inventory_customers"

),

renamed AS (

    SELECT

       (data->>'id')::numeric as id,
       (data->>'first_name')::string as first_name,
       (data->>'last_name')::string as last_name,
       (data->>'email')::string as email

    FROM source

)

SELECT * FROM renamed
  );
11:58:08.699912 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "data" does not exist

11:58:08.702782 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.704879 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: Close
11:58:08.708696 [debug] [Thread-1  ]: Database Error in model stg_inventory_customers (models/examples/staging/inventory/stg_inventory_customers.sql)
  column "data" does not exist
  compiled SQL at target/run/mz_hack_day/models/examples/staging/inventory/stg_inventory_customers.sql
11:58:08.711376 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99e1ef94-ad08-444e-a8c6-219ba27e33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f8af10>]}
11:58:08.714359 [error] [Thread-1  ]: 5 of 8 ERROR creating view model public.stg_inventory_customers................. [[31mERROR[0m in 0.10s]
11:58:08.717156 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_inventory_customers
11:58:08.720057 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_flight_information
11:58:08.723291 [info ] [Thread-1  ]: 6 of 8 START view model public.stg_flight_information........................... [RUN]
11:58:08.726649 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_flight_information"
11:58:08.728963 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_flight_information
11:58:08.730880 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_flight_information
11:58:08.759441 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_flight_information"
11:58:08.765958 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.768523 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_flight_information
11:58:08.787001 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:58:08.791414 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
drop view if exists "materialize"."public"."stg_flight_information" cascade
11:58:08.793696 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:58:08.800933 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:58:08.811508 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_flight_information"
11:58:08.818438 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:58:08.820908 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
create view "materialize"."public"."stg_flight_information"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_flight_information"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'icao24')::string as icao24,
       (data->>'callsign')::string as callsign,
       (data->>'origin_country')::string as origin_country,
       (data->>'time_position')::numeric as time_position,
       (data->>'last_contact')::numeric as last_contact,
       (data->>'longitude')::double as longitude,
       (data->>'latitude')::double as latitude,
       (data->>'baro_altitude')::double as baro_altitude,
       (data->>'on_ground')::boolean as on_ground,
       (data->>'velocity')::double as velocity,
       (data->>'true_track')::double as true_track,
       (data->>'vertical_rate')::string as vertical_rate,
       (data->>'sensors')::string as sensors,
       (data->>'geo_altitude')::string as geo_altitude,
       (data->>'squawk')::string as squawk,
       (data->>'spi')::string as spi,
       (data->>'position_source')::string as position_source

    FROM casted

)

SELECT * FROM renamed
  );
11:58:08.834325 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:58:08.847576 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.850818 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: Close
11:58:08.854766 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99e1ef94-ad08-444e-a8c6-219ba27e33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f6e430>]}
11:58:08.858420 [info ] [Thread-1  ]: 6 of 8 OK created view model public.stg_flight_information...................... [[32mCREATE VIEW[0m in 0.13s]
11:58:08.861454 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_flight_information
11:58:08.863659 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_inventory
11:58:08.867064 [info ] [Thread-1  ]: 7 of 8 SKIP relation public.fct_inventory....................................... [[33mSKIP[0m]
11:58:08.870057 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_inventory
11:58:08.872283 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_flight
11:58:08.874718 [info ] [Thread-1  ]: 8 of 8 START materializedview model public.fct_flight........................... [RUN]
11:58:08.878411 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_flight"
11:58:08.880511 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_flight
11:58:08.882947 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_flight
11:58:08.906221 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_flight"
11:58:08.913297 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.915276 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_flight
11:58:08.969852 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:58:08.972751 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
drop view if exists "materialize"."public"."fct_flight" cascade
11:58:08.974881 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:58:08.980709 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:58:08.997893 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_flight"
11:58:09.004953 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:58:09.007025 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
create materialized view "materialize"."public"."fct_flight"
  as (
    


SELECT fi.icao24,
       manufacturername,
       model,
       operator,
       origin_country,
       time_position,
       longitude,
       latitude
FROM "materialize"."public"."stg_flight_information" fi
JOIN "materialize"."public"."stg_icao_mapping" icao ON fi.icao24 = icao.icao24
  );
11:58:09.019483 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:58:09.031449 [debug] [Thread-1  ]: finished collecting timing info
11:58:09.034818 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: Close
11:58:09.038825 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99e1ef94-ad08-444e-a8c6-219ba27e33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027dc6c70>]}
11:58:09.042663 [info ] [Thread-1  ]: 8 of 8 OK created materializedview model public.fct_flight...................... [[32mCREATE VIEW[0m in 0.16s]
11:58:09.045787 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_flight
11:58:09.052690 [debug] [MainThread]: Acquiring new materialize connection "master"
11:58:09.055749 [debug] [MainThread]: Using materialize connection "master"
11:58:09.057968 [debug] [MainThread]: On master: BEGIN
11:58:09.060995 [debug] [MainThread]: Opening a new connection, currently in state closed
11:58:09.068327 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:58:09.072752 [debug] [MainThread]: Using materialize connection "master"
11:58:09.075595 [debug] [MainThread]: On master: COMMIT
11:58:09.078560 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:58:09.080630 [debug] [MainThread]: On master: Close
11:58:09.084145 [info ] [MainThread]: 
11:58:09.087203 [info ] [MainThread]: Finished running 3 source models, 3 view models, 2 materializedview models in 1.48s.
11:58:09.090317 [debug] [MainThread]: Connection 'master' was properly closed.
11:58:09.093566 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_flight' was properly closed.
11:58:09.138069 [info ] [MainThread]: 
11:58:09.141754 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
11:58:09.144569 [info ] [MainThread]: 
11:58:09.147152 [error] [MainThread]: [33mDatabase Error in model stg_inventory_customers (models/examples/staging/inventory/stg_inventory_customers.sql)[0m
11:58:09.149818 [error] [MainThread]:   column "data" does not exist
11:58:09.152169 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/examples/staging/inventory/stg_inventory_customers.sql
11:58:09.155594 [info ] [MainThread]: 
11:58:09.158110 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=1 TOTAL=8
11:58:09.162109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f90100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f90160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2d610>]}


============================== 2022-02-19 11:58:59.208660 | abe62d1c-7830-40d7-9151-1669e98e224d ==============================
11:58:59.208660 [info ] [MainThread]: Running with dbt=1.0.1
11:58:59.216677 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
11:58:59.220167 [debug] [MainThread]: Tracking: tracking
11:58:59.250409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abdf0>]}
11:58:59.632767 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
11:58:59.636796 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/examples/staging/inventory/stg_inventory_customers.sql
11:58:59.750054 [debug] [MainThread]: 1699: static parser successfully parsed examples/staging/inventory/stg_inventory_customers.sql
11:58:59.948507 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.templates
- models.examples

11:58:59.990585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abe62d1c-7830-40d7-9151-1669e98e224d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2df40>]}
11:59:00.062415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abe62d1c-7830-40d7-9151-1669e98e224d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007339bb0>]}
11:59:00.065917 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
11:59:00.077101 [info ] [MainThread]: 
11:59:00.081624 [debug] [MainThread]: Acquiring new materialize connection "master"
11:59:00.092675 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
11:59:00.168762 [debug] [ThreadPool]: Using materialize connection "list_materialize"
11:59:00.171823 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
11:59:00.174660 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:59:00.205709 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
11:59:00.216184 [debug] [ThreadPool]: On list_materialize: Close
11:59:00.228261 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
11:59:00.253203 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
11:59:00.256060 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
11:59:00.258251 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:59:00.267711 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
11:59:00.277320 [debug] [ThreadPool]: On list_materialize_public: Close
11:59:00.285461 [debug] [MainThread]: Using materialize connection "master"
11:59:00.288066 [debug] [MainThread]: On master: BEGIN
11:59:00.290229 [debug] [MainThread]: Opening a new connection, currently in state init
11:59:00.296143 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:59:00.299206 [debug] [MainThread]: Using materialize connection "master"
11:59:00.301348 [debug] [MainThread]: On master: COMMIT
11:59:00.304126 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:59:00.306411 [debug] [MainThread]: On master: Close
11:59:00.309561 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
11:59:00.312760 [info ] [MainThread]: 
11:59:00.331216 [debug] [Thread-1  ]: Began running node model.mz_hack_day.icao_mapping
11:59:00.334638 [info ] [Thread-1  ]: 1 of 8 START source model public.icao_mapping................................... [RUN]
11:59:00.338473 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.icao_mapping"
11:59:00.340669 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.icao_mapping
11:59:00.342699 [debug] [Thread-1  ]: Compiling model.mz_hack_day.icao_mapping
11:59:00.385077 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.icao_mapping"
11:59:00.395212 [debug] [Thread-1  ]: finished collecting timing info
11:59:00.397878 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.icao_mapping
11:59:00.460173 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:59:00.463278 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */
drop source if exists 
      materialize.public.icao_mapping
   cascade
11:59:00.465216 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:59:00.476243 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:59:00.519129 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.icao_mapping"
11:59:00.526278 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:59:00.528747 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */




CREATE SOURCE 
    materialize.public.icao_mapping

FROM FILE '/tmp/icao24_mapping_airbus.json.gz' COMPRESSION GZIP
FORMAT BYTES;
11:59:00.538475 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:59:00.591625 [debug] [Thread-1  ]: finished collecting timing info
11:59:00.594719 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: Close
11:59:00.598946 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abe62d1c-7830-40d7-9151-1669e98e224d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2df10>]}
11:59:00.602272 [info ] [Thread-1  ]: 1 of 8 OK created source model public.icao_mapping.............................. [[32mCREATE SOURCE[0m in 0.26s]
11:59:00.606238 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.icao_mapping
11:59:00.608592 [debug] [Thread-1  ]: Began running node model.mz_hack_day.inventory_customers
11:59:00.611558 [info ] [Thread-1  ]: 2 of 8 START source model public.inventory_customers............................ [RUN]
11:59:00.615278 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.inventory_customers"
11:59:00.617360 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.inventory_customers
11:59:00.619522 [debug] [Thread-1  ]: Compiling model.mz_hack_day.inventory_customers
11:59:00.640732 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.inventory_customers"
11:59:00.647629 [debug] [Thread-1  ]: finished collecting timing info
11:59:00.650111 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.inventory_customers
11:59:00.660436 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:59:00.662635 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */
drop source if exists 
      materialize.public.inventory_customers
   cascade
11:59:00.664611 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:59:00.674284 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:59:00.682518 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.inventory_customers"
11:59:00.688464 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:59:00.690224 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */




CREATE SOURCE 
    materialize.public.inventory_customers

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'dbserver1.inventory.customers'
FORMAT AVRO USING CONFLUENT SCHEMA REGISTRY 'http://redpanda:8081'
ENVELOPE DEBEZIUM;
11:59:00.706580 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:59:00.717267 [debug] [Thread-1  ]: finished collecting timing info
11:59:00.719877 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: Close
11:59:00.723943 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abe62d1c-7830-40d7-9151-1669e98e224d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d95e50>]}
11:59:00.727769 [info ] [Thread-1  ]: 2 of 8 OK created source model public.inventory_customers....................... [[32mCREATE SOURCE[0m in 0.11s]
11:59:00.730932 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.inventory_customers
11:59:00.733494 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_flight_information
11:59:00.736679 [info ] [Thread-1  ]: 3 of 8 START source model public.rp_flight_information.......................... [RUN]
11:59:00.740206 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_flight_information"
11:59:00.742310 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_flight_information
11:59:00.744417 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_flight_information
11:59:00.765341 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_flight_information"
11:59:00.771712 [debug] [Thread-1  ]: finished collecting timing info
11:59:00.773991 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_flight_information
11:59:00.785628 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:59:00.788147 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */
drop source if exists 
      materialize.public.rp_flight_information
   cascade
11:59:00.791683 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:59:00.800066 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:59:00.808187 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_flight_information"
11:59:00.814305 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:59:00.816193 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */




CREATE SOURCE 
    materialize.public.rp_flight_information

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'flight_information'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
11:59:00.825566 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:59:00.835537 [debug] [Thread-1  ]: finished collecting timing info
11:59:00.837910 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: Close
11:59:00.841397 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abe62d1c-7830-40d7-9151-1669e98e224d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f35d00>]}
11:59:00.844735 [info ] [Thread-1  ]: 3 of 8 OK created source model public.rp_flight_information..................... [[32mCREATE SOURCE[0m in 0.10s]
11:59:00.847918 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_flight_information
11:59:00.850111 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_icao_mapping
11:59:00.852620 [info ] [Thread-1  ]: 4 of 8 START view model public.stg_icao_mapping................................. [RUN]
11:59:00.856302 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_icao_mapping"
11:59:00.858458 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_icao_mapping
11:59:00.860656 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_icao_mapping
11:59:00.881787 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_icao_mapping"
11:59:00.889394 [debug] [Thread-1  ]: finished collecting timing info
11:59:00.894533 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_icao_mapping
11:59:00.970454 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:59:00.973919 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
drop view if exists "materialize"."public"."stg_icao_mapping" cascade
11:59:00.976498 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:59:00.982225 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:59:01.009835 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_icao_mapping"
11:59:01.016490 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:59:01.018931 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
create view "materialize"."public"."stg_icao_mapping"
  as (
    /*

The purpose of this staging model is to create a icao_mapping staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."icao_mapping"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

    (data->>'icao24')::string AS icao24,
           (data->>'manufacturericao')::string AS manufacturericao,
           (data->>'manufacturername')::string AS manufacturername,
           (data->>'model')::string AS model,
           (data->>'typecode')::string AS typecode,
           (data->>'icaoaircrafttype')::string AS icaoaircrafttype,
           (data->>'operator')::string AS operator,
           (data->>'operatorcallsign')::string AS operatorcallsign,
           (data->>'operatoricao')::string AS operatoricao,
           (data->>'built')::string AS built,
           (data->>'categorydescription')::string AS categorydescription

    FROM casted

)

SELECT * FROM renamed
  );
11:59:01.028496 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:59:01.038460 [debug] [Thread-1  ]: finished collecting timing info
11:59:01.040792 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: Close
11:59:01.044146 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abe62d1c-7830-40d7-9151-1669e98e224d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f35c10>]}
11:59:01.047374 [info ] [Thread-1  ]: 4 of 8 OK created view model public.stg_icao_mapping............................ [[32mCREATE VIEW[0m in 0.19s]
11:59:01.050453 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_icao_mapping
11:59:01.052668 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_inventory_customers
11:59:01.055415 [info ] [Thread-1  ]: 5 of 8 START view model public.stg_inventory_customers.......................... [RUN]
11:59:01.059426 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_inventory_customers"
11:59:01.061829 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_inventory_customers
11:59:01.064091 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_inventory_customers
11:59:01.083364 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_inventory_customers"
11:59:01.090307 [debug] [Thread-1  ]: finished collecting timing info
11:59:01.092300 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_inventory_customers
11:59:01.110216 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_inventory_customers"
11:59:01.113081 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_inventory_customers"} */
drop view if exists "materialize"."public"."stg_inventory_customers" cascade
11:59:01.115383 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:59:01.121015 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:59:01.130801 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_inventory_customers"
11:59:01.136744 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_inventory_customers"
11:59:01.138760 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_inventory_customers"} */
create view "materialize"."public"."stg_inventory_customers"
  as (
    /*

The purpose of this model is to create an inventory_customers staging model.

 */





WITH source AS (

    SELECT * FROM "materialize"."public"."inventory_customers"

),

renamed AS (

    SELECT

       id::numeric as id,
       first_name::string as first_name,
       last_name::string as last_name,
       email::string as email

    FROM source

)

SELECT * FROM renamed
  );
11:59:01.147483 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:59:01.157413 [debug] [Thread-1  ]: finished collecting timing info
11:59:01.159772 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: Close
11:59:01.163513 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abe62d1c-7830-40d7-9151-1669e98e224d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027dc7b80>]}
11:59:01.166768 [info ] [Thread-1  ]: 5 of 8 OK created view model public.stg_inventory_customers..................... [[32mCREATE VIEW[0m in 0.10s]
11:59:01.170694 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_inventory_customers
11:59:01.172920 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_flight_information
11:59:01.175737 [info ] [Thread-1  ]: 6 of 8 START view model public.stg_flight_information........................... [RUN]
11:59:01.179621 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_flight_information"
11:59:01.181918 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_flight_information
11:59:01.184309 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_flight_information
11:59:01.208836 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_flight_information"
11:59:01.214810 [debug] [Thread-1  ]: finished collecting timing info
11:59:01.217105 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_flight_information
11:59:01.234326 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:59:01.236893 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
drop view if exists "materialize"."public"."stg_flight_information" cascade
11:59:01.239118 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:59:01.245297 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:59:01.255448 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_flight_information"
11:59:01.261444 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:59:01.263687 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
create view "materialize"."public"."stg_flight_information"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_flight_information"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'icao24')::string as icao24,
       (data->>'callsign')::string as callsign,
       (data->>'origin_country')::string as origin_country,
       (data->>'time_position')::numeric as time_position,
       (data->>'last_contact')::numeric as last_contact,
       (data->>'longitude')::double as longitude,
       (data->>'latitude')::double as latitude,
       (data->>'baro_altitude')::double as baro_altitude,
       (data->>'on_ground')::boolean as on_ground,
       (data->>'velocity')::double as velocity,
       (data->>'true_track')::double as true_track,
       (data->>'vertical_rate')::string as vertical_rate,
       (data->>'sensors')::string as sensors,
       (data->>'geo_altitude')::string as geo_altitude,
       (data->>'squawk')::string as squawk,
       (data->>'spi')::string as spi,
       (data->>'position_source')::string as position_source

    FROM casted

)

SELECT * FROM renamed
  );
11:59:01.272951 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:59:01.282747 [debug] [Thread-1  ]: finished collecting timing info
11:59:01.285259 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: Close
11:59:01.290850 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abe62d1c-7830-40d7-9151-1669e98e224d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f85bb0>]}
11:59:01.294275 [info ] [Thread-1  ]: 6 of 8 OK created view model public.stg_flight_information...................... [[32mCREATE VIEW[0m in 0.11s]
11:59:01.297413 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_flight_information
11:59:01.300093 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_inventory
11:59:01.302869 [info ] [Thread-1  ]: 7 of 8 START materializedview model public.fct_inventory........................ [RUN]
11:59:01.306466 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_inventory"
11:59:01.308915 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_inventory
11:59:01.311128 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_inventory
11:59:01.328693 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_inventory"
11:59:01.335064 [debug] [Thread-1  ]: finished collecting timing info
11:59:01.337048 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_inventory
11:59:01.391478 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_inventory"
11:59:01.402154 [debug] [Thread-1  ]: On model.mz_hack_day.fct_inventory: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_inventory"} */
drop view if exists "materialize"."public"."fct_inventory" cascade
11:59:01.405138 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:59:01.412520 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:59:01.436284 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_inventory"
11:59:01.442930 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_inventory"
11:59:01.445179 [debug] [Thread-1  ]: On model.mz_hack_day.fct_inventory: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_inventory"} */
create materialized view "materialize"."public"."fct_inventory"
  as (
    


select *
from "materialize"."public"."stg_inventory_customers"
  );
11:59:01.455644 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:59:01.467106 [debug] [Thread-1  ]: finished collecting timing info
11:59:01.469986 [debug] [Thread-1  ]: On model.mz_hack_day.fct_inventory: Close
11:59:01.473589 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abe62d1c-7830-40d7-9151-1669e98e224d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073bbfa0>]}
11:59:01.477551 [info ] [Thread-1  ]: 7 of 8 OK created materializedview model public.fct_inventory................... [[32mCREATE VIEW[0m in 0.17s]
11:59:01.480643 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_inventory
11:59:01.483113 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_flight
11:59:01.485768 [info ] [Thread-1  ]: 8 of 8 START materializedview model public.fct_flight........................... [RUN]
11:59:01.489699 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_flight"
11:59:01.491882 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_flight
11:59:01.494245 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_flight
11:59:01.516642 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_flight"
11:59:01.522870 [debug] [Thread-1  ]: finished collecting timing info
11:59:01.525522 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_flight
11:59:01.542509 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:59:01.545133 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
drop view if exists "materialize"."public"."fct_flight" cascade
11:59:01.547364 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:59:01.552754 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:59:01.561384 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_flight"
11:59:01.567073 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:59:01.570018 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
create materialized view "materialize"."public"."fct_flight"
  as (
    


SELECT fi.icao24,
       manufacturername,
       model,
       operator,
       origin_country,
       time_position,
       longitude,
       latitude
FROM "materialize"."public"."stg_flight_information" fi
JOIN "materialize"."public"."stg_icao_mapping" icao ON fi.icao24 = icao.icao24
  );
11:59:01.580449 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:59:01.591874 [debug] [Thread-1  ]: finished collecting timing info
11:59:01.594629 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: Close
11:59:01.598908 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abe62d1c-7830-40d7-9151-1669e98e224d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f6a6a0>]}
11:59:01.602518 [info ] [Thread-1  ]: 8 of 8 OK created materializedview model public.fct_flight...................... [[32mCREATE VIEW[0m in 0.11s]
11:59:01.606478 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_flight
11:59:01.613742 [debug] [MainThread]: Acquiring new materialize connection "master"
11:59:01.616783 [debug] [MainThread]: Using materialize connection "master"
11:59:01.619157 [debug] [MainThread]: On master: BEGIN
11:59:01.621614 [debug] [MainThread]: Opening a new connection, currently in state closed
11:59:01.626953 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:59:01.629410 [debug] [MainThread]: Using materialize connection "master"
11:59:01.631301 [debug] [MainThread]: On master: COMMIT
11:59:01.633844 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:59:01.636444 [debug] [MainThread]: On master: Close
11:59:01.640063 [info ] [MainThread]: 
11:59:01.643011 [info ] [MainThread]: Finished running 3 source models, 3 view models, 2 materializedview models in 1.56s.
11:59:01.646139 [debug] [MainThread]: Connection 'master' was properly closed.
11:59:01.648497 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_flight' was properly closed.
11:59:01.689113 [info ] [MainThread]: 
11:59:01.691745 [info ] [MainThread]: [32mCompleted successfully[0m
11:59:01.695158 [info ] [MainThread]: 
11:59:01.697884 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
11:59:01.702301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f45910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027db47c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027daf4c0>]}


============================== 2022-02-22 19:21:51.426887 | 1dedc050-6de1-4bdf-bf16-2dc0233de123 ==============================
19:21:51.426887 [info ] [MainThread]: Running with dbt=1.0.1
19:21:51.432100 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, defer=None, state=None, cls=<class 'dbt.task.deps.DepsTask'>, which='deps', rpc_method='deps')
19:21:51.434676 [debug] [MainThread]: Tracking: tracking
19:21:51.464873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007399250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007399160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073991c0>]}
19:21:51.478530 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-yl1r9ggk'
19:21:51.482366 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
19:21:51.831519 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
19:21:51.835895 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils.json
19:21:52.296521 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils.json 200
19:21:52.316991 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils/0.1.0.json
19:21:52.889276 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils/0.1.0.json 200
19:21:52.897396 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils.json
19:21:53.087288 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils.json 200
19:21:53.096298 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils/0.1.0.json
19:21:53.269517 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils/0.1.0.json 200
19:21:53.274117 [info ] [MainThread]: Installing MaterializeInc/materialize_dbt_utils
19:21:53.943417 [info ] [MainThread]:   Installed from version 0.1.0
19:21:53.946202 [info ] [MainThread]:   Up to date!
19:21:53.949067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1dedc050-6de1-4bdf-bf16-2dc0233de123', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073c7820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073c7a00>]}
19:21:53.951971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007399d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007399af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073991c0>]}


============================== 2022-02-22 19:39:19.173757 | 1c37cfd2-b071-4e7f-9365-f6105620c931 ==============================
19:39:19.173757 [info ] [MainThread]: Running with dbt=1.0.1
19:39:19.180426 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:39:19.183094 [debug] [MainThread]: Tracking: tracking
19:39:19.212565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072c5700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072c57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072c5790>]}
19:39:19.592732 [debug] [MainThread]: Partial parsing enabled: 19 files deleted, 6 files added, 0 files changed.
19:39:19.596963 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
19:39:19.600182 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:39:19.603855 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter.yml
19:39:19.606488 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/twitter_trending/sources/twitter/src_twitter.yml
19:39:19.609334 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter.yml
19:39:19.612026 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/twitter_trending/sources/twitter/rp_twitter_trending.sql
19:39:19.615736 [debug] [MainThread]: Partial parsing: model.mz_hack_day.stg_example not found in child_map
19:39:19.617698 [debug] [MainThread]: Partial parsing: deleted file: mz_hack_day://models/templates/staging/new_staging_source/stg_example.sql
19:39:19.619921 [debug] [MainThread]: Partial parsing: deleted file: mz_hack_day://models/examples/staging/inventory/stg_inventory_customers.sql
19:39:19.621921 [debug] [MainThread]: Partial parsing: model.mz_hack_day.source_example not found in child_map
19:39:19.623735 [debug] [MainThread]: Partial parsing: deleted file: mz_hack_day://models/templates/sources/new_source/source_example.sql
19:39:19.625622 [debug] [MainThread]: Partial parsing: deleted file: mz_hack_day://models/examples/sources/inventory/inventory_customers.sql
19:39:19.627753 [debug] [MainThread]: Partial parsing: deleted file: mz_hack_day://models/examples/marts/inventory/fct_inventory.sql
19:39:19.629715 [debug] [MainThread]: Partial parsing: deleted file: mz_hack_day://models/examples/sources/flight/rp_flight_information.sql
19:39:19.631628 [debug] [MainThread]: Partial parsing: deleted file: mz_hack_day://models/examples/staging/flight/stg_flight_information.sql
19:39:19.634190 [debug] [MainThread]: Partial parsing: deleted file: mz_hack_day://models/examples/staging/flight/stg_icao_mapping.sql
19:39:19.636244 [debug] [MainThread]: Partial parsing: deleted file: mz_hack_day://models/examples/sources/flight/icao_mapping.sql
19:39:19.638131 [debug] [MainThread]: Partial parsing: deleted file: mz_hack_day://models/examples/marts/flight/fct_flight.sql
19:39:19.640300 [debug] [MainThread]: Partial parsing: model.mz_hack_day.fct_example not found in child_map
19:39:19.642180 [debug] [MainThread]: Partial parsing: deleted file: mz_hack_day://models/templates/marts/core/fct_example.sql
19:39:19.744003 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
19:39:19.835074 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
19:39:19.854119 [debug] [MainThread]: 1603: static parser failed on twitter_trending/sources/twitter/rp_twitter_trending.sql
19:39:19.892912 [debug] [MainThread]: 1602: parser fallback to jinja rendering on twitter_trending/sources/twitter/rp_twitter_trending.sql
19:39:19.959911 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'fct_twitter_trending' in the 'models' section of file 'models/twitter_trending/marts/twitter/fct_twitter.yml'
19:39:19.967905 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'rp_trending_data' in the 'models' section of file 'models/twitter_trending/sources/twitter/src_twitter.yml'
19:39:19.986330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073be8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c1ac70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073c91c0>]}


============================== 2022-02-22 19:40:29.688792 | e968da6f-bdd9-4ed7-a61c-661452c71694 ==============================
19:40:29.688792 [info ] [MainThread]: Running with dbt=1.0.1
19:40:29.696036 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:40:29.699912 [debug] [MainThread]: Tracking: tracking
19:40:29.726694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acdf0>]}
19:40:29.900639 [info ] [MainThread]: Unable to do partial parsing because profile has changed
19:40:29.904931 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
19:40:29.908006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e968da6f-bdd9-4ed7-a61c-661452c71694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072a4e50>]}
19:40:30.052198 [debug] [MainThread]: Parsing macros/adapters.sql
19:40:30.144170 [debug] [MainThread]: Parsing macros/catalog.sql
19:40:30.165179 [debug] [MainThread]: Parsing macros/mz_generate_name.sql
19:40:30.172365 [debug] [MainThread]: Parsing macros/relations.sql
19:40:30.207190 [debug] [MainThread]: Parsing macros/materializations/source.sql
19:40:30.228713 [debug] [MainThread]: Parsing macros/materializations/view.sql
19:40:30.247398 [debug] [MainThread]: Parsing macros/materializations/seed.sql
19:40:30.306079 [debug] [MainThread]: Parsing macros/materializations/index.sql
19:40:30.326417 [debug] [MainThread]: Parsing macros/materializations/table.sql
19:40:30.346368 [debug] [MainThread]: Parsing macros/materializations/materialized_view.sql
19:40:30.365190 [debug] [MainThread]: Parsing macros/materializations/sink.sql
19:40:30.385115 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
19:40:30.391533 [debug] [MainThread]: Parsing macros/materializations/helpers.sql
19:40:30.406424 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
19:40:30.420214 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
19:40:30.439670 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
19:40:30.453110 [debug] [MainThread]: Parsing macros/adapters/relation.sql
19:40:30.528172 [debug] [MainThread]: Parsing macros/adapters/schema.sql
19:40:30.546299 [debug] [MainThread]: Parsing macros/adapters/columns.sql
19:40:30.621918 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
19:40:30.656394 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
19:40:30.709644 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
19:40:30.733863 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
19:40:30.754654 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
19:40:30.783967 [debug] [MainThread]: Parsing macros/materializations/configs.sql
19:40:30.802231 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
19:40:30.850211 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
19:40:30.969997 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
19:40:31.096634 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
19:40:31.193167 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
19:40:31.208194 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
19:40:31.292143 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
19:40:31.348405 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
19:40:31.372328 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
19:40:31.457016 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
19:40:31.490603 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
19:40:31.503322 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
19:40:31.619806 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
19:40:31.696760 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
19:40:31.750456 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
19:40:31.768646 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
19:40:31.790686 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
19:40:31.801914 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
19:40:31.837202 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
19:40:31.851465 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
19:40:31.865635 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
19:40:31.872355 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
19:40:31.877326 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
19:40:31.885072 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
19:40:31.896657 [debug] [MainThread]: Parsing macros/etc/statement.sql
19:40:31.930416 [debug] [MainThread]: Parsing macros/etc/datetime.sql
19:40:31.993824 [debug] [MainThread]: Parsing tests/generic/builtin.sql
19:40:32.017892 [debug] [MainThread]: Parsing macros/dbt_utils/date_trunc.sql
19:40:32.023430 [debug] [MainThread]: Parsing macros/dbt_utils/dateadd.sql
19:40:32.029270 [debug] [MainThread]: Parsing macros/dbt_utils/datediff.sql
19:40:32.035171 [debug] [MainThread]: Parsing macros/dbt_utils/get_tables_by_pattern_sql.sql
19:40:32.043543 [debug] [MainThread]: Parsing macros/dbt_utils/last_day.sql
19:40:33.416179 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
19:40:33.500035 [debug] [MainThread]: 1603: static parser failed on twitter_trending/sources/twitter/rp_twitter_trending.sql
19:40:33.536408 [debug] [MainThread]: 1602: parser fallback to jinja rendering on twitter_trending/sources/twitter/rp_twitter_trending.sql
19:40:33.546371 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
19:40:33.685063 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'fct_twitter_trending' in the 'models' section of file 'models/twitter_trending/marts/twitter/fct_twitter.yml'
19:40:33.693477 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'rp_trending_data' in the 'models' section of file 'models/twitter_trending/sources/twitter/src_twitter.yml'
19:40:33.716256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c35280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c1da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c1d910>]}


============================== 2022-02-22 19:41:54.741630 | 82058250-4248-4162-a827-b1749b4b7428 ==============================
19:41:54.741630 [info ] [MainThread]: Running with dbt=1.0.1
19:41:54.749996 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:41:54.754128 [debug] [MainThread]: Tracking: tracking
19:41:54.789826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace20>]}
19:41:54.959941 [info ] [MainThread]: Unable to do partial parsing because profile has changed
19:41:54.963646 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
19:41:54.966767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '82058250-4248-4162-a827-b1749b4b7428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728d7c0>]}
19:41:55.141044 [debug] [MainThread]: Parsing macros/adapters.sql
19:41:55.229364 [debug] [MainThread]: Parsing macros/catalog.sql
19:41:55.248775 [debug] [MainThread]: Parsing macros/mz_generate_name.sql
19:41:55.255681 [debug] [MainThread]: Parsing macros/relations.sql
19:41:55.287622 [debug] [MainThread]: Parsing macros/materializations/source.sql
19:41:55.308654 [debug] [MainThread]: Parsing macros/materializations/view.sql
19:41:55.328532 [debug] [MainThread]: Parsing macros/materializations/seed.sql
19:41:55.391633 [debug] [MainThread]: Parsing macros/materializations/index.sql
19:41:55.413478 [debug] [MainThread]: Parsing macros/materializations/table.sql
19:41:55.433276 [debug] [MainThread]: Parsing macros/materializations/materialized_view.sql
19:41:55.451935 [debug] [MainThread]: Parsing macros/materializations/sink.sql
19:41:55.472875 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
19:41:55.478909 [debug] [MainThread]: Parsing macros/materializations/helpers.sql
19:41:55.492733 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
19:41:55.507835 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
19:41:55.528536 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
19:41:55.542049 [debug] [MainThread]: Parsing macros/adapters/relation.sql
19:41:55.616419 [debug] [MainThread]: Parsing macros/adapters/schema.sql
19:41:55.633918 [debug] [MainThread]: Parsing macros/adapters/columns.sql
19:41:55.708162 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
19:41:55.744660 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
19:41:55.799051 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
19:41:55.823481 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
19:41:55.845057 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
19:41:55.875063 [debug] [MainThread]: Parsing macros/materializations/configs.sql
19:41:55.893786 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
19:41:55.942235 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
19:41:56.064454 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
19:41:56.196158 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
19:41:56.295552 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
19:41:56.309668 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
19:41:56.396464 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
19:41:56.456117 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
19:41:56.483127 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
19:41:56.582249 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
19:41:56.624533 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
19:41:56.639809 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
19:41:56.768894 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
19:41:56.852875 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
19:41:56.916350 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
19:41:56.947541 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
19:41:56.974146 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
19:41:56.989464 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
19:41:57.034443 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
19:41:57.054293 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
19:41:57.073830 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
19:41:57.083945 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
19:41:57.093175 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
19:41:57.104985 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
19:41:57.119939 [debug] [MainThread]: Parsing macros/etc/statement.sql
19:41:57.239975 [debug] [MainThread]: Parsing macros/etc/datetime.sql
19:41:57.331472 [debug] [MainThread]: Parsing tests/generic/builtin.sql
19:41:57.359993 [debug] [MainThread]: Parsing macros/dbt_utils/date_trunc.sql
19:41:57.369976 [debug] [MainThread]: Parsing macros/dbt_utils/dateadd.sql
19:41:57.378875 [debug] [MainThread]: Parsing macros/dbt_utils/datediff.sql
19:41:57.388120 [debug] [MainThread]: Parsing macros/dbt_utils/get_tables_by_pattern_sql.sql
19:41:57.398167 [debug] [MainThread]: Parsing macros/dbt_utils/last_day.sql
19:41:58.798441 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
19:41:58.899619 [debug] [MainThread]: 1603: static parser failed on twitter_trending/sources/twitter/rp_twitter_trending.sql
19:41:58.942331 [debug] [MainThread]: 1602: parser fallback to jinja rendering on twitter_trending/sources/twitter/rp_twitter_trending.sql
19:41:58.953827 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
19:41:59.235786 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

19:41:59.279143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82058250-4248-4162-a827-b1749b4b7428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073a3c40>]}
19:41:59.332264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82058250-4248-4162-a827-b1749b4b7428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073a3e80>]}
19:41:59.336406 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:41:59.349099 [info ] [MainThread]: 
19:41:59.355652 [debug] [MainThread]: Acquiring new materialize connection "master"
19:41:59.365757 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
19:41:59.458609 [debug] [ThreadPool]: Using materialize connection "list_materialize"
19:41:59.461716 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
19:41:59.464514 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:41:59.502113 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.04 seconds
19:41:59.513133 [debug] [ThreadPool]: On list_materialize: Close
19:41:59.523910 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
19:41:59.547138 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
19:41:59.549893 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
19:41:59.552321 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:41:59.560080 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
19:41:59.569724 [debug] [ThreadPool]: On list_materialize_public: Close
19:41:59.576820 [debug] [MainThread]: Using materialize connection "master"
19:41:59.579411 [debug] [MainThread]: On master: BEGIN
19:41:59.581617 [debug] [MainThread]: Opening a new connection, currently in state init
19:41:59.587704 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:41:59.591003 [debug] [MainThread]: Using materialize connection "master"
19:41:59.593675 [debug] [MainThread]: On master: COMMIT
19:41:59.596816 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:41:59.598947 [debug] [MainThread]: On master: Close
19:41:59.602145 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:41:59.605198 [info ] [MainThread]: 
19:41:59.720502 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
19:41:59.724337 [info ] [Thread-1  ]: 1 of 3 START source model public.rp_twitter_trending............................ [RUN]
19:41:59.728817 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
19:41:59.731363 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
19:41:59.733962 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
19:41:59.755919 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
19:41:59.774349 [debug] [Thread-1  ]: finished collecting timing info
19:41:59.776691 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
19:41:59.831501 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:41:59.834495 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
19:41:59.837272 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:41:59.845188 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
19:41:59.894790 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
19:41:59.920406 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:41:59.923165 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_trending_data

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
19:41:59.938765 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
19:41:59.987793 [debug] [Thread-1  ]: finished collecting timing info
19:41:59.990737 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
19:41:59.994609 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82058250-4248-4162-a827-b1749b4b7428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c91490>]}
19:41:59.998110 [info ] [Thread-1  ]: 1 of 3 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.27s]
19:42:00.001794 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
19:42:00.007329 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
19:42:00.011416 [info ] [Thread-1  ]: 2 of 3 START view model public.stg_twitter_trending............................. [RUN]
19:42:00.015100 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
19:42:00.017616 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
19:42:00.020115 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
19:42:00.038842 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
19:42:00.052200 [debug] [Thread-1  ]: finished collecting timing info
19:42:00.054573 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
19:42:00.121397 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:42:00.124619 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
19:42:00.127365 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:42:00.133703 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
19:42:00.159261 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
19:42:00.173811 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:42:00.176063 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_twitter_trending"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'location'->>'name')::string as location_name,
       (data->>'location'->>'country')::string as location_country,
       (data->>'trends'->>'name')::string as trend_name,
       (data->>'trends'->>'tweet_volume')::numeric as tweet_volume

    FROM casted

)

SELECT * FROM renamed
  );
19:42:00.180361 [debug] [Thread-1  ]: Postgres adapter: Postgres error: unknown catalog item 'materialize.public.rp_twitter_trending'

19:42:00.183514 [debug] [Thread-1  ]: finished collecting timing info
19:42:00.185939 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
19:42:00.189846 [debug] [Thread-1  ]: Database Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)
  unknown catalog item 'materialize.public.rp_twitter_trending'
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:42:00.192796 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82058250-4248-4162-a827-b1749b4b7428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4030814f40>]}
19:42:00.195826 [error] [Thread-1  ]: 2 of 3 ERROR creating view model public.stg_twitter_trending.................... [[31mERROR[0m in 0.18s]
19:42:00.199014 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
19:42:00.203326 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
19:42:00.205732 [info ] [Thread-1  ]: 3 of 3 SKIP relation public.fct_twitter_trending................................ [[33mSKIP[0m]
19:42:00.209294 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
19:42:00.218674 [debug] [MainThread]: Acquiring new materialize connection "master"
19:42:00.225742 [debug] [MainThread]: Using materialize connection "master"
19:42:00.228104 [debug] [MainThread]: On master: BEGIN
19:42:00.230725 [debug] [MainThread]: Opening a new connection, currently in state closed
19:42:00.236823 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:42:00.239265 [debug] [MainThread]: Using materialize connection "master"
19:42:00.241365 [debug] [MainThread]: On master: COMMIT
19:42:00.244043 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:42:00.245975 [debug] [MainThread]: On master: Close
19:42:00.249376 [info ] [MainThread]: 
19:42:00.252357 [info ] [MainThread]: Finished running 1 source model, 1 view model, 1 materializedview model in 0.89s.
19:42:00.255308 [debug] [MainThread]: Connection 'master' was properly closed.
19:42:00.257306 [debug] [MainThread]: Connection 'model.mz_hack_day.stg_twitter_trending' was properly closed.
19:42:00.292845 [info ] [MainThread]: 
19:42:00.295896 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:42:00.298664 [info ] [MainThread]: 
19:42:00.301208 [error] [MainThread]: [33mDatabase Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)[0m
19:42:00.304039 [error] [MainThread]:   unknown catalog item 'materialize.public.rp_twitter_trending'
19:42:00.307354 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:42:00.310410 [info ] [MainThread]: 
19:42:00.313776 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
19:42:00.317355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027bfe7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027bfe640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4030814c40>]}


============================== 2022-02-22 19:43:04.947868 | 204f6846-3deb-4382-b8b5-46559aa64705 ==============================
19:43:04.947868 [info ] [MainThread]: Running with dbt=1.0.1
19:43:04.954313 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:43:04.956745 [debug] [MainThread]: Tracking: tracking
19:43:04.989486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace20>]}
19:43:05.293071 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:43:05.297702 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/sources/twitter/rp_twitter_trending.sql
19:43:05.384562 [debug] [MainThread]: 1603: static parser failed on twitter_trending/sources/twitter/rp_twitter_trending.sql
19:43:05.483619 [debug] [MainThread]: 1602: parser fallback to jinja rendering on twitter_trending/sources/twitter/rp_twitter_trending.sql
19:43:05.569164 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

19:43:05.606206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '204f6846-3deb-4382-b8b5-46559aa64705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073fb0d0>]}
19:43:05.654461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '204f6846-3deb-4382-b8b5-46559aa64705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007295d30>]}
19:43:05.657770 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:43:05.665102 [info ] [MainThread]: 
19:43:05.669156 [debug] [MainThread]: Acquiring new materialize connection "master"
19:43:05.678714 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
19:43:05.746762 [debug] [ThreadPool]: Using materialize connection "list_materialize"
19:43:05.749596 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
19:43:05.752031 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:43:05.778824 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
19:43:05.789187 [debug] [ThreadPool]: On list_materialize: Close
19:43:05.797953 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
19:43:05.820608 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
19:43:05.823141 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
19:43:05.825393 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:43:05.832803 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
19:43:05.842549 [debug] [ThreadPool]: On list_materialize_public: Close
19:43:05.848036 [debug] [MainThread]: Using materialize connection "master"
19:43:05.850397 [debug] [MainThread]: On master: BEGIN
19:43:05.852495 [debug] [MainThread]: Opening a new connection, currently in state init
19:43:05.858771 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:43:05.861693 [debug] [MainThread]: Using materialize connection "master"
19:43:05.864873 [debug] [MainThread]: On master: COMMIT
19:43:05.867439 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:43:05.869767 [debug] [MainThread]: On master: Close
19:43:05.872817 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:43:05.875421 [info ] [MainThread]: 
19:43:05.892132 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
19:43:05.895454 [info ] [Thread-1  ]: 1 of 3 START source model public.rp_twitter_trending............................ [RUN]
19:43:05.899991 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
19:43:05.903752 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
19:43:05.905848 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
19:43:05.926647 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
19:43:05.934297 [debug] [Thread-1  ]: finished collecting timing info
19:43:05.936976 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
19:43:05.992318 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:43:05.995387 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
19:43:05.998017 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:43:06.004561 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
19:43:06.050380 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
19:43:06.058765 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:43:06.060941 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
19:43:06.071804 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
19:43:06.119879 [debug] [Thread-1  ]: finished collecting timing info
19:43:06.123343 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
19:43:06.127433 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '204f6846-3deb-4382-b8b5-46559aa64705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007585490>]}
19:43:06.131319 [info ] [Thread-1  ]: 1 of 3 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.23s]
19:43:06.134928 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
19:43:06.140435 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
19:43:06.143138 [info ] [Thread-1  ]: 2 of 3 START view model public.stg_twitter_trending............................. [RUN]
19:43:06.146783 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
19:43:06.148847 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
19:43:06.150818 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
19:43:06.171487 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
19:43:06.180169 [debug] [Thread-1  ]: finished collecting timing info
19:43:06.182500 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
19:43:06.248950 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:43:06.251688 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
19:43:06.253768 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:43:06.259425 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
19:43:06.284784 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
19:43:06.292773 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:43:06.294889 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_twitter_trending"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'location'->>'name')::string as location_name,
       (data->>'location'->>'country')::string as location_country,
       (data->>'trends'->>'name')::string as trend_name,
       (data->>'trends'->>'tweet_volume')::numeric as tweet_volume

    FROM casted

)

SELECT * FROM renamed
  );
19:43:06.298914 [debug] [Thread-1  ]: Postgres adapter: Postgres error: no overload for text ->> unknown: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts

19:43:06.302464 [debug] [Thread-1  ]: finished collecting timing info
19:43:06.304958 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
19:43:06.307981 [debug] [Thread-1  ]: Database Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)
  no overload for text ->> unknown: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:43:06.310876 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '204f6846-3deb-4382-b8b5-46559aa64705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073a6df0>]}
19:43:06.313855 [error] [Thread-1  ]: 2 of 3 ERROR creating view model public.stg_twitter_trending.................... [[31mERROR[0m in 0.16s]
19:43:06.316878 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
19:43:06.320717 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
19:43:06.324043 [info ] [Thread-1  ]: 3 of 3 SKIP relation public.fct_twitter_trending................................ [[33mSKIP[0m]
19:43:06.326825 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
19:43:06.332786 [debug] [MainThread]: Acquiring new materialize connection "master"
19:43:06.335700 [debug] [MainThread]: Using materialize connection "master"
19:43:06.337733 [debug] [MainThread]: On master: BEGIN
19:43:06.339799 [debug] [MainThread]: Opening a new connection, currently in state closed
19:43:06.346768 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:43:06.349339 [debug] [MainThread]: Using materialize connection "master"
19:43:06.351546 [debug] [MainThread]: On master: COMMIT
19:43:06.354301 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:43:06.356682 [debug] [MainThread]: On master: Close
19:43:06.359910 [info ] [MainThread]: 
19:43:06.362983 [info ] [MainThread]: Finished running 1 source model, 1 view model, 1 materializedview model in 0.69s.
19:43:06.365478 [debug] [MainThread]: Connection 'master' was properly closed.
19:43:06.367742 [debug] [MainThread]: Connection 'model.mz_hack_day.stg_twitter_trending' was properly closed.
19:43:06.401386 [info ] [MainThread]: 
19:43:06.404249 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:43:06.407048 [info ] [MainThread]: 
19:43:06.409430 [error] [MainThread]: [33mDatabase Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)[0m
19:43:06.412295 [error] [MainThread]:   no overload for text ->> unknown: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
19:43:06.415155 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:43:06.418832 [info ] [MainThread]: 
19:43:06.421939 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
19:43:06.425332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007338280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40075668e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ce8e0>]}


============================== 2022-02-22 19:44:19.750656 | 9589aa83-34cf-4071-b262-a78a3e856500 ==============================
19:44:19.750656 [info ] [MainThread]: Running with dbt=1.0.1
19:44:19.757588 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:44:19.761716 [debug] [MainThread]: Tracking: tracking
19:44:19.788486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace20>]}
19:44:20.102649 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:44:20.107167 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:44:20.210926 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
19:44:20.395372 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

19:44:20.431649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9589aa83-34cf-4071-b262-a78a3e856500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027bf90d0>]}
19:44:20.479530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9589aa83-34cf-4071-b262-a78a3e856500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728fd90>]}
19:44:20.482724 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:44:20.490622 [info ] [MainThread]: 
19:44:20.494447 [debug] [MainThread]: Acquiring new materialize connection "master"
19:44:20.501777 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
19:44:20.567895 [debug] [ThreadPool]: Using materialize connection "list_materialize"
19:44:20.570725 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
19:44:20.573615 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:44:20.602580 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
19:44:20.612389 [debug] [ThreadPool]: On list_materialize: Close
19:44:20.620862 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
19:44:20.643164 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
19:44:20.645688 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
19:44:20.647833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:44:20.655192 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
19:44:20.664493 [debug] [ThreadPool]: On list_materialize_public: Close
19:44:20.669962 [debug] [MainThread]: Using materialize connection "master"
19:44:20.672391 [debug] [MainThread]: On master: BEGIN
19:44:20.674338 [debug] [MainThread]: Opening a new connection, currently in state init
19:44:20.679852 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:44:20.682269 [debug] [MainThread]: Using materialize connection "master"
19:44:20.685125 [debug] [MainThread]: On master: COMMIT
19:44:20.688191 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:44:20.690669 [debug] [MainThread]: On master: Close
19:44:20.693891 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:44:20.696871 [info ] [MainThread]: 
19:44:20.714343 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
19:44:20.717514 [info ] [Thread-1  ]: 1 of 3 START source model public.rp_twitter_trending............................ [RUN]
19:44:20.722183 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
19:44:20.724494 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
19:44:20.726498 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
19:44:20.756349 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
19:44:20.763002 [debug] [Thread-1  ]: finished collecting timing info
19:44:20.765353 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
19:44:20.823933 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:44:20.827087 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
19:44:20.829392 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:44:20.838938 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
19:44:20.878428 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
19:44:20.885477 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:44:20.887921 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
19:44:20.898165 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
19:44:20.948719 [debug] [Thread-1  ]: finished collecting timing info
19:44:20.951479 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
19:44:20.954990 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9589aa83-34cf-4071-b262-a78a3e856500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d8afd0>]}
19:44:20.958610 [info ] [Thread-1  ]: 1 of 3 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.23s]
19:44:20.962410 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
19:44:20.967775 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
19:44:20.970422 [info ] [Thread-1  ]: 2 of 3 START view model public.stg_twitter_trending............................. [RUN]
19:44:20.973888 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
19:44:20.976285 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
19:44:20.978326 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
19:44:20.996116 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
19:44:21.002437 [debug] [Thread-1  ]: finished collecting timing info
19:44:21.004830 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
19:44:21.074824 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:44:21.078265 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
19:44:21.080788 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:44:21.086544 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
19:44:21.112710 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
19:44:21.120236 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:44:21.123154 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_twitter_trending"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->'location'->'name')::string as location_name,
       (data->'location'->'country')::string as location_country,
       (data->'trends'->'name')::string as trend_name,
       (data->'trends'->'tweet_volume')::numeric as tweet_volume

    FROM casted

)

SELECT * FROM renamed
  );
19:44:21.132422 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
19:44:21.141386 [debug] [Thread-1  ]: finished collecting timing info
19:44:21.143677 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
19:44:21.147176 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9589aa83-34cf-4071-b262-a78a3e856500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ecd670>]}
19:44:21.150733 [info ] [Thread-1  ]: 2 of 3 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.17s]
19:44:21.153420 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
19:44:21.157646 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
19:44:21.160124 [info ] [Thread-1  ]: 3 of 3 START materializedview model public.fct_twitter_trending................. [RUN]
19:44:21.163409 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
19:44:21.165385 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
19:44:21.167263 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
19:44:21.184856 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
19:44:21.199262 [debug] [Thread-1  ]: finished collecting timing info
19:44:21.201542 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
19:44:21.250925 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
19:44:21.253515 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
19:44:21.255789 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:44:21.261854 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
19:44:21.277807 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
19:44:21.292503 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
19:44:21.295312 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


SELECT tt.location_name, tt.location_country, tt.trend_name, tt.tweet_count
FROM "materialize"."public"."stg_twitter_trending" tt
  );
19:44:21.299753 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "tt.tweet_count" does not exist

19:44:21.304310 [debug] [Thread-1  ]: finished collecting timing info
19:44:21.306907 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
19:44:21.310685 [debug] [Thread-1  ]: Database Error in model fct_twitter_trending (models/twitter_trending/marts/twitter/fct_twitter_trending.sql)
  column "tt.tweet_count" does not exist
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/marts/twitter/fct_twitter_trending.sql
19:44:21.313733 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9589aa83-34cf-4071-b262-a78a3e856500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ef7850>]}
19:44:21.316881 [error] [Thread-1  ]: 3 of 3 ERROR creating materializedview model public.fct_twitter_trending........ [[31mERROR[0m in 0.15s]
19:44:21.321569 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
19:44:21.329364 [debug] [MainThread]: Acquiring new materialize connection "master"
19:44:21.331659 [debug] [MainThread]: Using materialize connection "master"
19:44:21.333774 [debug] [MainThread]: On master: BEGIN
19:44:21.335908 [debug] [MainThread]: Opening a new connection, currently in state closed
19:44:21.340982 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:44:21.343450 [debug] [MainThread]: Using materialize connection "master"
19:44:21.345375 [debug] [MainThread]: On master: COMMIT
19:44:21.348175 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:44:21.350662 [debug] [MainThread]: On master: Close
19:44:21.354229 [info ] [MainThread]: 
19:44:21.357478 [info ] [MainThread]: Finished running 1 source model, 1 view model, 1 materializedview model in 0.86s.
19:44:21.359923 [debug] [MainThread]: Connection 'master' was properly closed.
19:44:21.362156 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
19:44:21.397503 [info ] [MainThread]: 
19:44:21.400251 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:44:21.402859 [info ] [MainThread]: 
19:44:21.405294 [error] [MainThread]: [33mDatabase Error in model fct_twitter_trending (models/twitter_trending/marts/twitter/fct_twitter_trending.sql)[0m
19:44:21.407819 [error] [MainThread]:   column "tt.tweet_count" does not exist
19:44:21.410478 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/marts/twitter/fct_twitter_trending.sql
19:44:21.412916 [info ] [MainThread]: 
19:44:21.415547 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
19:44:21.418478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400733a220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d672e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049eef670>]}


============================== 2022-02-22 19:46:25.091077 | ba5a79a8-a36f-4610-9eb1-a3594e6c5193 ==============================
19:46:25.091077 [info ] [MainThread]: Running with dbt=1.0.1
19:46:25.097434 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:46:25.100157 [debug] [MainThread]: Tracking: tracking
19:46:25.125760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd90>]}
19:46:25.432111 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:46:25.436226 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
19:46:25.542110 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
19:46:25.713919 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

19:46:25.749884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba5a79a8-a36f-4610-9eb1-a3594e6c5193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027bfb0d0>]}
19:46:25.794299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba5a79a8-a36f-4610-9eb1-a3594e6c5193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072d0640>]}
19:46:25.797428 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:46:25.805203 [info ] [MainThread]: 
19:46:25.808679 [debug] [MainThread]: Acquiring new materialize connection "master"
19:46:25.817156 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
19:46:25.882875 [debug] [ThreadPool]: Using materialize connection "list_materialize"
19:46:25.886308 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
19:46:25.889245 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:46:25.916203 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
19:46:25.926212 [debug] [ThreadPool]: On list_materialize: Close
19:46:25.935288 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
19:46:25.958523 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
19:46:25.961397 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
19:46:25.964272 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:46:25.971220 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
19:46:25.980265 [debug] [ThreadPool]: On list_materialize_public: Close
19:46:25.985391 [debug] [MainThread]: Using materialize connection "master"
19:46:25.987811 [debug] [MainThread]: On master: BEGIN
19:46:25.990077 [debug] [MainThread]: Opening a new connection, currently in state init
19:46:25.996283 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:46:25.999060 [debug] [MainThread]: Using materialize connection "master"
19:46:26.000969 [debug] [MainThread]: On master: COMMIT
19:46:26.003807 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:46:26.006135 [debug] [MainThread]: On master: Close
19:46:26.010129 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:46:26.013073 [info ] [MainThread]: 
19:46:26.030288 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
19:46:26.033666 [info ] [Thread-1  ]: 1 of 3 START source model public.rp_twitter_trending............................ [RUN]
19:46:26.038847 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
19:46:26.041485 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
19:46:26.043820 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
19:46:26.072441 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
19:46:26.080547 [debug] [Thread-1  ]: finished collecting timing info
19:46:26.084075 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
19:46:26.138680 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:46:26.141421 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
19:46:26.143987 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:46:26.153369 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
19:46:26.192483 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
19:46:26.201600 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:46:26.203983 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
19:46:26.233594 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
19:46:26.281064 [debug] [Thread-1  ]: finished collecting timing info
19:46:26.284410 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
19:46:26.288343 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a79a8-a36f-4610-9eb1-a3594e6c5193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d8bf10>]}
19:46:26.291601 [info ] [Thread-1  ]: 1 of 3 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.25s]
19:46:26.294766 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
19:46:26.300359 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
19:46:26.303257 [info ] [Thread-1  ]: 2 of 3 START view model public.stg_twitter_trending............................. [RUN]
19:46:26.306472 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
19:46:26.308619 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
19:46:26.310754 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
19:46:26.328760 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
19:46:26.335313 [debug] [Thread-1  ]: finished collecting timing info
19:46:26.337744 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
19:46:26.406275 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:46:26.409259 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
19:46:26.411744 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:46:26.418217 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
19:46:26.443144 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
19:46:26.448993 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:46:26.451122 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_twitter_trending"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->'location'->'name')::string as location_name,
       (data->'location'->'country')::string as location_country,
       (data->'trends'->'name')::string as trend_name,
       (data->'trends'->'tweet_volume')::numeric as tweet_volume

    FROM casted

)

SELECT * FROM renamed
  );
19:46:26.460748 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
19:46:26.470386 [debug] [Thread-1  ]: finished collecting timing info
19:46:26.472735 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
19:46:26.476089 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a79a8-a36f-4610-9eb1-a3594e6c5193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049dcfeb0>]}
19:46:26.479739 [info ] [Thread-1  ]: 2 of 3 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.17s]
19:46:26.482716 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
19:46:26.486729 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
19:46:26.489829 [info ] [Thread-1  ]: 3 of 3 START materializedview model public.fct_twitter_trending................. [RUN]
19:46:26.493441 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
19:46:26.495433 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
19:46:26.497472 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
19:46:26.515083 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
19:46:26.521332 [debug] [Thread-1  ]: finished collecting timing info
19:46:26.523624 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
19:46:26.581853 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
19:46:26.585230 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
19:46:26.587817 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:46:26.594960 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
19:46:26.611611 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
19:46:26.618575 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
19:46:26.620740 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


SELECT location_name, location_country, trend_name, tweet_volume
FROM "materialize"."public"."stg_twitter_trending"
  );
19:46:26.630820 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
19:46:26.641547 [debug] [Thread-1  ]: finished collecting timing info
19:46:26.644095 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
19:46:26.647653 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a79a8-a36f-4610-9eb1-a3594e6c5193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d73220>]}
19:46:26.651726 [info ] [Thread-1  ]: 3 of 3 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.15s]
19:46:26.655063 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
19:46:26.660966 [debug] [MainThread]: Acquiring new materialize connection "master"
19:46:26.663359 [debug] [MainThread]: Using materialize connection "master"
19:46:26.665263 [debug] [MainThread]: On master: BEGIN
19:46:26.667066 [debug] [MainThread]: Opening a new connection, currently in state closed
19:46:26.672311 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:46:26.674786 [debug] [MainThread]: Using materialize connection "master"
19:46:26.676988 [debug] [MainThread]: On master: COMMIT
19:46:26.679599 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:46:26.681802 [debug] [MainThread]: On master: Close
19:46:26.684981 [info ] [MainThread]: 
19:46:26.687611 [info ] [MainThread]: Finished running 1 source model, 1 view model, 1 materializedview model in 0.88s.
19:46:26.690678 [debug] [MainThread]: Connection 'master' was properly closed.
19:46:26.693059 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
19:46:26.726464 [info ] [MainThread]: 
19:46:26.729267 [info ] [MainThread]: [32mCompleted successfully[0m
19:46:26.732288 [info ] [MainThread]: 
19:46:26.734844 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
19:46:26.737817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c40b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c495b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5ae80>]}


============================== 2022-02-22 19:53:40.568844 | 703fd9be-8b6f-4d6f-a513-de73311dc596 ==============================
19:53:40.568844 [info ] [MainThread]: Running with dbt=1.0.1
19:53:40.576493 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:53:40.579502 [debug] [MainThread]: Tracking: tracking
19:53:40.605543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072adc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072add60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072add00>]}
19:53:40.949307 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
19:53:40.954380 [debug] [MainThread]: Partial parsing: update schema file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter.yml
19:53:40.956897 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
19:53:40.960382 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:53:41.063563 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
19:53:41.149363 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
19:53:41.267014 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

19:53:41.303666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '703fd9be-8b6f-4d6f-a513-de73311dc596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027bfc0d0>]}
19:53:41.353417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '703fd9be-8b6f-4d6f-a513-de73311dc596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728feb0>]}
19:53:41.357317 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:53:41.365484 [info ] [MainThread]: 
19:53:41.370219 [debug] [MainThread]: Acquiring new materialize connection "master"
19:53:41.378526 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
19:53:41.450337 [debug] [ThreadPool]: Using materialize connection "list_materialize"
19:53:41.453456 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
19:53:41.455671 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:53:41.485314 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
19:53:41.496125 [debug] [ThreadPool]: On list_materialize: Close
19:53:41.505347 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
19:53:41.528440 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
19:53:41.531244 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
19:53:41.533314 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:53:41.540617 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
19:53:41.550428 [debug] [ThreadPool]: On list_materialize_public: Close
19:53:41.555782 [debug] [MainThread]: Using materialize connection "master"
19:53:41.558577 [debug] [MainThread]: On master: BEGIN
19:53:41.560582 [debug] [MainThread]: Opening a new connection, currently in state init
19:53:41.566138 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:53:41.568521 [debug] [MainThread]: Using materialize connection "master"
19:53:41.570726 [debug] [MainThread]: On master: COMMIT
19:53:41.574010 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:53:41.576162 [debug] [MainThread]: On master: Close
19:53:41.579174 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:53:41.581750 [info ] [MainThread]: 
19:53:41.598222 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
19:53:41.601701 [info ] [Thread-1  ]: 1 of 3 START source model public.rp_twitter_trending............................ [RUN]
19:53:41.606864 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
19:53:41.609476 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
19:53:41.612126 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
19:53:41.643861 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
19:53:41.649493 [debug] [Thread-1  ]: finished collecting timing info
19:53:41.651673 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
19:53:41.708402 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:53:41.711402 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
19:53:41.713807 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:53:41.724440 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
19:53:41.765750 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
19:53:41.773281 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:53:41.775373 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
19:53:41.786503 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
19:53:41.836027 [debug] [Thread-1  ]: finished collecting timing info
19:53:41.838783 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
19:53:41.842746 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '703fd9be-8b6f-4d6f-a513-de73311dc596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d92d00>]}
19:53:41.846402 [info ] [Thread-1  ]: 1 of 3 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.24s]
19:53:41.850177 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
19:53:41.854999 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
19:53:41.857840 [info ] [Thread-1  ]: 2 of 3 START view model public.stg_twitter_trending............................. [RUN]
19:53:41.861855 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
19:53:41.864152 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
19:53:41.866276 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
19:53:41.887392 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
19:53:41.897645 [debug] [Thread-1  ]: finished collecting timing info
19:53:41.900543 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
19:53:41.981907 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:53:41.984856 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
19:53:41.987386 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:53:41.994613 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
19:53:42.020951 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
19:53:42.027781 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:53:42.030322 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_twitter_trending"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),


renamed AS (

    SELECT

       (data->'location'->'name')::string as location_name,
       (data->'location'->'country')::string as location_country,
       (data->'trends')::array as trends,

    FROM casted

)

final AS (

    SELECT
        location_name,
        location_country,
        trends,
    FROM renamed

)

SELECT * FROM renamed
  );
19:53:42.034229 [debug] [Thread-1  ]: Postgres adapter: Postgres error: expected expression, but found reserved keyword
LINE 41:     FROM casted
             ^

19:53:42.037839 [debug] [Thread-1  ]: finished collecting timing info
19:53:42.040134 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
19:53:42.043188 [debug] [Thread-1  ]: Database Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)
  expected expression, but found reserved keyword
  LINE 41:     FROM casted
               ^
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:53:42.045893 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '703fd9be-8b6f-4d6f-a513-de73311dc596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2fac0>]}
19:53:42.049308 [error] [Thread-1  ]: 2 of 3 ERROR creating view model public.stg_twitter_trending.................... [[31mERROR[0m in 0.18s]
19:53:42.052648 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
19:53:42.057740 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
19:53:42.060559 [info ] [Thread-1  ]: 3 of 3 SKIP relation public.fct_twitter_trending................................ [[33mSKIP[0m]
19:53:42.063480 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
19:53:42.069327 [debug] [MainThread]: Acquiring new materialize connection "master"
19:53:42.072109 [debug] [MainThread]: Using materialize connection "master"
19:53:42.074630 [debug] [MainThread]: On master: BEGIN
19:53:42.076699 [debug] [MainThread]: Opening a new connection, currently in state closed
19:53:42.082243 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:53:42.084853 [debug] [MainThread]: Using materialize connection "master"
19:53:42.087130 [debug] [MainThread]: On master: COMMIT
19:53:42.089929 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:53:42.092116 [debug] [MainThread]: On master: Close
19:53:42.095251 [info ] [MainThread]: 
19:53:42.098240 [info ] [MainThread]: Finished running 1 source model, 1 view model, 1 materializedview model in 0.73s.
19:53:42.100905 [debug] [MainThread]: Connection 'master' was properly closed.
19:53:42.103031 [debug] [MainThread]: Connection 'model.mz_hack_day.stg_twitter_trending' was properly closed.
19:53:42.136611 [info ] [MainThread]: 
19:53:42.139360 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:53:42.142207 [info ] [MainThread]: 
19:53:42.144627 [error] [MainThread]: [33mDatabase Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)[0m
19:53:42.147490 [error] [MainThread]:   expected expression, but found reserved keyword
19:53:42.150269 [error] [MainThread]:   LINE 41:     FROM casted
19:53:42.152884 [error] [MainThread]:                ^
19:53:42.155668 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:53:42.158602 [info ] [MainThread]: 
19:53:42.160906 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
19:53:42.165477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072adf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d67100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2f730>]}


============================== 2022-02-22 19:54:06.093716 | 28f109f8-c590-4dc4-8f71-5ecd6299a8ec ==============================
19:54:06.093716 [info ] [MainThread]: Running with dbt=1.0.1
19:54:06.101057 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:54:06.104577 [debug] [MainThread]: Tracking: tracking
19:54:06.130413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aadc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aaeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aae50>]}
19:54:06.450304 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:54:06.454700 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:54:06.583271 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
19:54:06.776391 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

19:54:06.817072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28f109f8-c590-4dc4-8f71-5ecd6299a8ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027bfc0d0>]}
19:54:06.882140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28f109f8-c590-4dc4-8f71-5ecd6299a8ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007293d00>]}
19:54:06.885349 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:54:06.893895 [info ] [MainThread]: 
19:54:06.898325 [debug] [MainThread]: Acquiring new materialize connection "master"
19:54:06.906338 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
19:54:06.980045 [debug] [ThreadPool]: Using materialize connection "list_materialize"
19:54:06.983362 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
19:54:06.986877 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:54:07.015153 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
19:54:07.025839 [debug] [ThreadPool]: On list_materialize: Close
19:54:07.034296 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
19:54:07.057041 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
19:54:07.059987 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
19:54:07.062288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:54:07.069096 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
19:54:07.078970 [debug] [ThreadPool]: On list_materialize_public: Close
19:54:07.084351 [debug] [MainThread]: Using materialize connection "master"
19:54:07.086836 [debug] [MainThread]: On master: BEGIN
19:54:07.088567 [debug] [MainThread]: Opening a new connection, currently in state init
19:54:07.094234 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:54:07.097058 [debug] [MainThread]: Using materialize connection "master"
19:54:07.099293 [debug] [MainThread]: On master: COMMIT
19:54:07.101907 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:54:07.104539 [debug] [MainThread]: On master: Close
19:54:07.107723 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:54:07.111086 [info ] [MainThread]: 
19:54:07.128127 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
19:54:07.132160 [info ] [Thread-1  ]: 1 of 3 START source model public.rp_twitter_trending............................ [RUN]
19:54:07.136910 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
19:54:07.139319 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
19:54:07.141640 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
19:54:07.171569 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
19:54:07.179223 [debug] [Thread-1  ]: finished collecting timing info
19:54:07.181832 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
19:54:07.241105 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:54:07.244254 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
19:54:07.246814 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:54:07.256067 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
19:54:07.297852 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
19:54:07.309779 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:54:07.315688 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
19:54:07.331008 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
19:54:07.386954 [debug] [Thread-1  ]: finished collecting timing info
19:54:07.392266 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
19:54:07.400934 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28f109f8-c590-4dc4-8f71-5ecd6299a8ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d8bfd0>]}
19:54:07.406204 [info ] [Thread-1  ]: 1 of 3 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.26s]
19:54:07.414676 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
19:54:07.422102 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
19:54:07.428252 [info ] [Thread-1  ]: 2 of 3 START view model public.stg_twitter_trending............................. [RUN]
19:54:07.434693 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
19:54:07.437124 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
19:54:07.439400 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
19:54:07.459875 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
19:54:07.469867 [debug] [Thread-1  ]: finished collecting timing info
19:54:07.474645 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
19:54:07.557145 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:54:07.560592 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
19:54:07.564009 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:54:07.572136 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
19:54:07.602585 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
19:54:07.610917 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:54:07.614380 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_twitter_trending"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),


renamed AS (

    SELECT

       (data->'location'->'name')::string as location_name,
       (data->'location'->'country')::string as location_country,
       (data->'trends')::array as trends

    FROM casted

)

final AS (

    SELECT
        location_name,
        location_country,
        trends,
    FROM renamed

)

SELECT * FROM renamed
  );
19:54:07.619514 [debug] [Thread-1  ]: Postgres adapter: Postgres error: Expected SELECT, VALUES, or a subquery in the query body, found identifier "final"
LINE 45: final AS (
         ^

19:54:07.622474 [debug] [Thread-1  ]: finished collecting timing info
19:54:07.625104 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
19:54:07.628434 [debug] [Thread-1  ]: Database Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)
  Expected SELECT, VALUES, or a subquery in the query body, found identifier "final"
  LINE 45: final AS (
           ^
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:54:07.631556 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28f109f8-c590-4dc4-8f71-5ecd6299a8ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d68e20>]}
19:54:07.635236 [error] [Thread-1  ]: 2 of 3 ERROR creating view model public.stg_twitter_trending.................... [[31mERROR[0m in 0.20s]
19:54:07.638557 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
19:54:07.642210 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
19:54:07.644386 [info ] [Thread-1  ]: 3 of 3 SKIP relation public.fct_twitter_trending................................ [[33mSKIP[0m]
19:54:07.648375 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
19:54:07.654519 [debug] [MainThread]: Acquiring new materialize connection "master"
19:54:07.657083 [debug] [MainThread]: Using materialize connection "master"
19:54:07.659257 [debug] [MainThread]: On master: BEGIN
19:54:07.661452 [debug] [MainThread]: Opening a new connection, currently in state closed
19:54:07.666852 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:54:07.669749 [debug] [MainThread]: Using materialize connection "master"
19:54:07.672272 [debug] [MainThread]: On master: COMMIT
19:54:07.675581 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:54:07.678046 [debug] [MainThread]: On master: Close
19:54:07.681130 [info ] [MainThread]: 
19:54:07.683919 [info ] [MainThread]: Finished running 1 source model, 1 view model, 1 materializedview model in 0.78s.
19:54:07.686412 [debug] [MainThread]: Connection 'master' was properly closed.
19:54:07.688744 [debug] [MainThread]: Connection 'model.mz_hack_day.stg_twitter_trending' was properly closed.
19:54:07.727853 [info ] [MainThread]: 
19:54:07.730921 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:54:07.736115 [info ] [MainThread]: 
19:54:07.739840 [error] [MainThread]: [33mDatabase Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)[0m
19:54:07.743212 [error] [MainThread]:   Expected SELECT, VALUES, or a subquery in the query body, found identifier "final"
19:54:07.748737 [error] [MainThread]:   LINE 45: final AS (
19:54:07.751941 [error] [MainThread]:            ^
19:54:07.754877 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:54:07.757263 [info ] [MainThread]: 
19:54:07.761967 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
19:54:07.767700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5ce20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5cdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ee3910>]}


============================== 2022-02-22 19:54:46.931310 | 0f04e46a-7684-4b7e-8581-993197ad208d ==============================
19:54:46.931310 [info ] [MainThread]: Running with dbt=1.0.1
19:54:46.944856 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:54:46.947974 [debug] [MainThread]: Tracking: tracking
19:54:46.978771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abdf0>]}
19:54:47.322938 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:54:47.327340 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:54:47.435457 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
19:54:47.618833 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

19:54:47.658818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f04e46a-7684-4b7e-8581-993197ad208d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027bfd0d0>]}
19:54:47.709534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f04e46a-7684-4b7e-8581-993197ad208d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072a4d90>]}
19:54:47.712754 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:54:47.720910 [info ] [MainThread]: 
19:54:47.725625 [debug] [MainThread]: Acquiring new materialize connection "master"
19:54:47.734349 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
19:54:47.812757 [debug] [ThreadPool]: Using materialize connection "list_materialize"
19:54:47.816177 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
19:54:47.818232 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:54:47.846868 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
19:54:47.857712 [debug] [ThreadPool]: On list_materialize: Close
19:54:47.867177 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
19:54:47.899067 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
19:54:47.904424 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
19:54:47.908622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:54:47.920658 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
19:54:47.933674 [debug] [ThreadPool]: On list_materialize_public: Close
19:54:47.939991 [debug] [MainThread]: Using materialize connection "master"
19:54:47.943781 [debug] [MainThread]: On master: BEGIN
19:54:47.947805 [debug] [MainThread]: Opening a new connection, currently in state init
19:54:47.956561 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:54:47.961015 [debug] [MainThread]: Using materialize connection "master"
19:54:47.963955 [debug] [MainThread]: On master: COMMIT
19:54:47.969381 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:54:47.972707 [debug] [MainThread]: On master: Close
19:54:47.976846 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:54:47.980241 [info ] [MainThread]: 
19:54:48.003654 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
19:54:48.007936 [info ] [Thread-1  ]: 1 of 3 START source model public.rp_twitter_trending............................ [RUN]
19:54:48.014735 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
19:54:48.017514 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
19:54:48.019437 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
19:54:48.051661 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
19:54:48.058783 [debug] [Thread-1  ]: finished collecting timing info
19:54:48.060968 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
19:54:48.120386 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:54:48.123050 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
19:54:48.125552 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:54:48.134876 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
19:54:48.176910 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
19:54:48.183880 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:54:48.186187 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
19:54:48.198683 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
19:54:48.252214 [debug] [Thread-1  ]: finished collecting timing info
19:54:48.255926 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
19:54:48.261985 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f04e46a-7684-4b7e-8581-993197ad208d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d8af40>]}
19:54:48.266031 [info ] [Thread-1  ]: 1 of 3 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.25s]
19:54:48.269891 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
19:54:48.275945 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
19:54:48.278539 [info ] [Thread-1  ]: 2 of 3 START view model public.stg_twitter_trending............................. [RUN]
19:54:48.281908 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
19:54:48.284385 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
19:54:48.287057 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
19:54:48.306746 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
19:54:48.313261 [debug] [Thread-1  ]: finished collecting timing info
19:54:48.315772 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
19:54:48.391571 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:54:48.394413 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
19:54:48.396858 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:54:48.403282 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
19:54:48.429331 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
19:54:48.435792 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:54:48.437880 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_twitter_trending"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),


renamed AS (

    SELECT

       (data->'location'->'name')::string as location_name,
       (data->'location'->'country')::string as location_country,
       (data->'trends')::array as trends

    FROM casted

),

final AS (

    SELECT
        location_name,
        location_country,
        trends,
    FROM renamed

)

SELECT * FROM final
  );
19:54:48.441774 [debug] [Thread-1  ]: Postgres adapter: Postgres error: expected expression, but found reserved keyword
LINE 51:     FROM renamed
             ^

19:54:48.444311 [debug] [Thread-1  ]: finished collecting timing info
19:54:48.446742 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
19:54:48.450149 [debug] [Thread-1  ]: Database Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)
  expected expression, but found reserved keyword
  LINE 51:     FROM renamed
               ^
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:54:48.453491 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f04e46a-7684-4b7e-8581-993197ad208d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d67d90>]}
19:54:48.457293 [error] [Thread-1  ]: 2 of 3 ERROR creating view model public.stg_twitter_trending.................... [[31mERROR[0m in 0.17s]
19:54:48.460417 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
19:54:48.464837 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
19:54:48.467357 [info ] [Thread-1  ]: 3 of 3 SKIP relation public.fct_twitter_trending................................ [[33mSKIP[0m]
19:54:48.470056 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
19:54:48.477126 [debug] [MainThread]: Acquiring new materialize connection "master"
19:54:48.479747 [debug] [MainThread]: Using materialize connection "master"
19:54:48.481823 [debug] [MainThread]: On master: BEGIN
19:54:48.484748 [debug] [MainThread]: Opening a new connection, currently in state closed
19:54:48.490956 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:54:48.493688 [debug] [MainThread]: Using materialize connection "master"
19:54:48.496182 [debug] [MainThread]: On master: COMMIT
19:54:48.499511 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:54:48.501863 [debug] [MainThread]: On master: Close
19:54:48.505408 [info ] [MainThread]: 
19:54:48.508051 [info ] [MainThread]: Finished running 1 source model, 1 view model, 1 materializedview model in 0.78s.
19:54:48.511875 [debug] [MainThread]: Connection 'master' was properly closed.
19:54:48.514844 [debug] [MainThread]: Connection 'model.mz_hack_day.stg_twitter_trending' was properly closed.
19:54:48.550477 [info ] [MainThread]: 
19:54:48.553288 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:54:48.556001 [info ] [MainThread]: 
19:54:48.558724 [error] [MainThread]: [33mDatabase Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)[0m
19:54:48.561317 [error] [MainThread]:   expected expression, but found reserved keyword
19:54:48.564046 [error] [MainThread]:   LINE 51:     FROM renamed
19:54:48.567002 [error] [MainThread]:                ^
19:54:48.569951 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:54:48.574267 [info ] [MainThread]: 
19:54:48.577336 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
19:54:48.580499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5cd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ee18b0>]}


============================== 2022-02-22 19:55:20.601514 | 7d3a3045-4d6e-4678-b327-d7c02d93d536 ==============================
19:55:20.601514 [info ] [MainThread]: Running with dbt=1.0.1
19:55:20.608130 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:55:20.611119 [debug] [MainThread]: Tracking: tracking
19:55:20.637074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728adc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728aeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728ae50>]}
19:55:21.057163 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:55:21.061598 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:55:21.170327 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
19:55:21.344730 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

19:55:21.385356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d3a3045-4d6e-4678-b327-d7c02d93d536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027bfd0d0>]}
19:55:21.436966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d3a3045-4d6e-4678-b327-d7c02d93d536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072a2d00>]}
19:55:21.442016 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:55:21.451975 [info ] [MainThread]: 
19:55:21.457133 [debug] [MainThread]: Acquiring new materialize connection "master"
19:55:21.469230 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
19:55:21.542895 [debug] [ThreadPool]: Using materialize connection "list_materialize"
19:55:21.545878 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
19:55:21.549976 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:55:21.583090 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
19:55:21.601737 [debug] [ThreadPool]: On list_materialize: Close
19:55:21.612084 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
19:55:21.637377 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
19:55:21.640322 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
19:55:21.642511 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:55:21.650276 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
19:55:21.659755 [debug] [ThreadPool]: On list_materialize_public: Close
19:55:21.665131 [debug] [MainThread]: Using materialize connection "master"
19:55:21.667583 [debug] [MainThread]: On master: BEGIN
19:55:21.669468 [debug] [MainThread]: Opening a new connection, currently in state init
19:55:21.675140 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:55:21.678196 [debug] [MainThread]: Using materialize connection "master"
19:55:21.680172 [debug] [MainThread]: On master: COMMIT
19:55:21.683195 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:55:21.685654 [debug] [MainThread]: On master: Close
19:55:21.688758 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:55:21.691715 [info ] [MainThread]: 
19:55:21.708727 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
19:55:21.712588 [info ] [Thread-1  ]: 1 of 3 START source model public.rp_twitter_trending............................ [RUN]
19:55:21.717640 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
19:55:21.720197 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
19:55:21.723005 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
19:55:21.755954 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
19:55:21.762983 [debug] [Thread-1  ]: finished collecting timing info
19:55:21.765192 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
19:55:21.821500 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:55:21.824211 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
19:55:21.826800 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:55:21.839512 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
19:55:21.882611 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
19:55:21.892330 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:55:21.894747 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
19:55:21.904857 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
19:55:21.954012 [debug] [Thread-1  ]: finished collecting timing info
19:55:21.957170 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
19:55:21.960503 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d3a3045-4d6e-4678-b327-d7c02d93d536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d8bfd0>]}
19:55:21.963771 [info ] [Thread-1  ]: 1 of 3 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.24s]
19:55:21.966978 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
19:55:21.972155 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
19:55:21.974703 [info ] [Thread-1  ]: 2 of 3 START view model public.stg_twitter_trending............................. [RUN]
19:55:21.978431 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
19:55:21.980383 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
19:55:21.983175 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
19:55:22.002387 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
19:55:22.009389 [debug] [Thread-1  ]: finished collecting timing info
19:55:22.011739 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
19:55:22.084307 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:55:22.087067 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
19:55:22.089327 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:55:22.095537 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
19:55:22.120986 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
19:55:22.127475 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:55:22.129575 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT

       (data->'location'->'name')::string as location_name,
       (data->'location'->'country')::string as location_country,
       (data->'trends')::array as trends
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        trends
    FROM renamed
)

SELECT * FROM final
  );
19:55:22.133306 [debug] [Thread-1  ]: Postgres adapter: Postgres error: unknown catalog item 'array'

19:55:22.137139 [debug] [Thread-1  ]: finished collecting timing info
19:55:22.139624 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
19:55:22.143214 [debug] [Thread-1  ]: Database Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)
  unknown catalog item 'array'
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:55:22.146331 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d3a3045-4d6e-4678-b327-d7c02d93d536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d69e80>]}
19:55:22.149326 [error] [Thread-1  ]: 2 of 3 ERROR creating view model public.stg_twitter_trending.................... [[31mERROR[0m in 0.17s]
19:55:22.152251 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
19:55:22.155777 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
19:55:22.157778 [info ] [Thread-1  ]: 3 of 3 SKIP relation public.fct_twitter_trending................................ [[33mSKIP[0m]
19:55:22.161258 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
19:55:22.167386 [debug] [MainThread]: Acquiring new materialize connection "master"
19:55:22.170787 [debug] [MainThread]: Using materialize connection "master"
19:55:22.173153 [debug] [MainThread]: On master: BEGIN
19:55:22.175706 [debug] [MainThread]: Opening a new connection, currently in state closed
19:55:22.181580 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:55:22.184483 [debug] [MainThread]: Using materialize connection "master"
19:55:22.186741 [debug] [MainThread]: On master: COMMIT
19:55:22.189727 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:55:22.192512 [debug] [MainThread]: On master: Close
19:55:22.196129 [info ] [MainThread]: 
19:55:22.199235 [info ] [MainThread]: Finished running 1 source model, 1 view model, 1 materializedview model in 0.74s.
19:55:22.202029 [debug] [MainThread]: Connection 'master' was properly closed.
19:55:22.204748 [debug] [MainThread]: Connection 'model.mz_hack_day.stg_twitter_trending' was properly closed.
19:55:22.239783 [info ] [MainThread]: 
19:55:22.242543 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:55:22.245290 [info ] [MainThread]: 
19:55:22.247714 [error] [MainThread]: [33mDatabase Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)[0m
19:55:22.250244 [error] [MainThread]:   unknown catalog item 'array'
19:55:22.252461 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:55:22.254738 [info ] [MainThread]: 
19:55:22.257247 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
19:55:22.260086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5bdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d69b20>]}


============================== 2022-02-22 19:57:02.268783 | b76dd00a-8dd4-4e0d-99e2-a41c34911d27 ==============================
19:57:02.268783 [info ] [MainThread]: Running with dbt=1.0.1
19:57:02.275454 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:57:02.278731 [debug] [MainThread]: Tracking: tracking
19:57:02.304317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aed60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aedf0>]}
19:57:02.604556 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
19:57:02.607321 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
19:57:02.611395 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

19:57:02.652732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b76dd00a-8dd4-4e0d-99e2-a41c34911d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073b6af0>]}
19:57:02.699764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b76dd00a-8dd4-4e0d-99e2-a41c34911d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072a5b50>]}
19:57:02.703040 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:57:02.711118 [info ] [MainThread]: 
19:57:02.714847 [debug] [MainThread]: Acquiring new materialize connection "master"
19:57:02.724928 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
19:57:02.792560 [debug] [ThreadPool]: Using materialize connection "list_materialize"
19:57:02.795373 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
19:57:02.797889 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:57:02.827234 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
19:57:02.837652 [debug] [ThreadPool]: On list_materialize: Close
19:57:02.846515 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
19:57:02.872454 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
19:57:02.875874 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
19:57:02.878923 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:57:02.886859 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
19:57:02.897259 [debug] [ThreadPool]: On list_materialize_public: Close
19:57:02.904957 [debug] [MainThread]: Using materialize connection "master"
19:57:02.909020 [debug] [MainThread]: On master: BEGIN
19:57:02.912375 [debug] [MainThread]: Opening a new connection, currently in state init
19:57:02.919557 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:57:02.922469 [debug] [MainThread]: Using materialize connection "master"
19:57:02.924366 [debug] [MainThread]: On master: COMMIT
19:57:02.927318 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:57:02.929440 [debug] [MainThread]: On master: Close
19:57:02.932468 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:57:02.935477 [info ] [MainThread]: 
19:57:02.951485 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
19:57:02.957262 [info ] [Thread-1  ]: 1 of 3 START source model public.rp_twitter_trending............................ [RUN]
19:57:02.960896 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
19:57:02.963669 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
19:57:02.966709 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
19:57:02.996167 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
19:57:03.003411 [debug] [Thread-1  ]: finished collecting timing info
19:57:03.005890 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
19:57:03.064489 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:57:03.067345 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
19:57:03.069595 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:57:03.079369 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
19:57:03.118158 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
19:57:03.125438 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:57:03.127344 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
19:57:03.137774 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
19:57:03.186202 [debug] [Thread-1  ]: finished collecting timing info
19:57:03.189072 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
19:57:03.192912 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b76dd00a-8dd4-4e0d-99e2-a41c34911d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400743cb80>]}
19:57:03.197431 [info ] [Thread-1  ]: 1 of 3 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.23s]
19:57:03.201320 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
19:57:03.206265 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
19:57:03.208755 [info ] [Thread-1  ]: 2 of 3 START view model public.stg_twitter_trending............................. [RUN]
19:57:03.212143 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
19:57:03.214016 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
19:57:03.216371 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
19:57:03.233756 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
19:57:03.239719 [debug] [Thread-1  ]: finished collecting timing info
19:57:03.241660 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
19:57:03.307769 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:57:03.310793 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
19:57:03.313008 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:57:03.319282 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
19:57:03.344308 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
19:57:03.352570 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:57:03.355113 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT

       (data->'location'->'name')::string as location_name,
       (data->'location'->'country')::string as location_country,
       (data->'trends')::array as trends
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        trends
    FROM renamed
)

SELECT * FROM final
  );
19:57:03.359781 [debug] [Thread-1  ]: Postgres adapter: Postgres error: unknown catalog item 'array'

19:57:03.362889 [debug] [Thread-1  ]: finished collecting timing info
19:57:03.365034 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
19:57:03.368016 [debug] [Thread-1  ]: Database Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)
  unknown catalog item 'array'
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:57:03.370862 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b76dd00a-8dd4-4e0d-99e2-a41c34911d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40294e9a30>]}
19:57:03.373947 [error] [Thread-1  ]: 2 of 3 ERROR creating view model public.stg_twitter_trending.................... [[31mERROR[0m in 0.16s]
19:57:03.377081 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
19:57:03.381363 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
19:57:03.383805 [info ] [Thread-1  ]: 3 of 3 SKIP relation public.fct_twitter_trending................................ [[33mSKIP[0m]
19:57:03.386699 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
19:57:03.392250 [debug] [MainThread]: Acquiring new materialize connection "master"
19:57:03.394599 [debug] [MainThread]: Using materialize connection "master"
19:57:03.396578 [debug] [MainThread]: On master: BEGIN
19:57:03.398426 [debug] [MainThread]: Opening a new connection, currently in state closed
19:57:03.403709 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:57:03.406528 [debug] [MainThread]: Using materialize connection "master"
19:57:03.408557 [debug] [MainThread]: On master: COMMIT
19:57:03.411357 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:57:03.413523 [debug] [MainThread]: On master: Close
19:57:03.418139 [info ] [MainThread]: 
19:57:03.421970 [info ] [MainThread]: Finished running 1 source model, 1 view model, 1 materializedview model in 0.70s.
19:57:03.425357 [debug] [MainThread]: Connection 'master' was properly closed.
19:57:03.427591 [debug] [MainThread]: Connection 'model.mz_hack_day.stg_twitter_trending' was properly closed.
19:57:03.460360 [info ] [MainThread]: 
19:57:03.463003 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:57:03.465578 [info ] [MainThread]: 
19:57:03.467971 [error] [MainThread]: [33mDatabase Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)[0m
19:57:03.470733 [error] [MainThread]:   unknown catalog item 'array'
19:57:03.473339 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:57:03.475760 [info ] [MainThread]: 
19:57:03.478289 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
19:57:03.481016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400fc7e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400fc7e100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40294e9730>]}


============================== 2022-02-22 19:57:59.065391 | 32f74228-3f2e-4c4c-bfe1-116135192a7b ==============================
19:57:59.065391 [info ] [MainThread]: Running with dbt=1.0.1
19:57:59.072245 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:57:59.074904 [debug] [MainThread]: Tracking: tracking
19:57:59.102733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acdf0>]}
19:57:59.418907 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:57:59.423361 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:57:59.526958 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
19:57:59.698053 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

19:57:59.735730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32f74228-3f2e-4c4c-bfe1-116135192a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027bfc0d0>]}
19:57:59.782400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32f74228-3f2e-4c4c-bfe1-116135192a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728f670>]}
19:57:59.785292 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:57:59.793210 [info ] [MainThread]: 
19:57:59.797113 [debug] [MainThread]: Acquiring new materialize connection "master"
19:57:59.806184 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
19:57:59.876914 [debug] [ThreadPool]: Using materialize connection "list_materialize"
19:57:59.879791 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
19:57:59.882920 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:57:59.909964 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
19:57:59.920256 [debug] [ThreadPool]: On list_materialize: Close
19:57:59.928798 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
19:57:59.951437 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
19:57:59.954177 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
19:57:59.956407 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:57:59.963755 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
19:57:59.973518 [debug] [ThreadPool]: On list_materialize_public: Close
19:57:59.980137 [debug] [MainThread]: Using materialize connection "master"
19:57:59.982557 [debug] [MainThread]: On master: BEGIN
19:57:59.984598 [debug] [MainThread]: Opening a new connection, currently in state init
19:57:59.990356 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:57:59.992850 [debug] [MainThread]: Using materialize connection "master"
19:57:59.994912 [debug] [MainThread]: On master: COMMIT
19:57:59.998015 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:58:00.000653 [debug] [MainThread]: On master: Close
19:58:00.004028 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:58:00.007205 [info ] [MainThread]: 
19:58:00.024297 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
19:58:00.028662 [info ] [Thread-1  ]: 1 of 3 START source model public.rp_twitter_trending............................ [RUN]
19:58:00.036582 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
19:58:00.039557 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
19:58:00.042164 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
19:58:00.072309 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
19:58:00.080196 [debug] [Thread-1  ]: finished collecting timing info
19:58:00.083158 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
19:58:00.140848 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:58:00.143793 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
19:58:00.146477 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:58:00.157994 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
19:58:00.196561 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
19:58:00.203008 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:58:00.205412 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
19:58:00.216145 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
19:58:00.263805 [debug] [Thread-1  ]: finished collecting timing info
19:58:00.266567 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
19:58:00.270990 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32f74228-3f2e-4c4c-bfe1-116135192a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d8bf40>]}
19:58:00.274594 [info ] [Thread-1  ]: 1 of 3 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.24s]
19:58:00.278236 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
19:58:00.282987 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
19:58:00.286333 [info ] [Thread-1  ]: 2 of 3 START view model public.stg_twitter_trending............................. [RUN]
19:58:00.289943 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
19:58:00.292394 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
19:58:00.295033 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
19:58:00.314232 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
19:58:00.321162 [debug] [Thread-1  ]: finished collecting timing info
19:58:00.324356 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
19:58:00.401261 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:58:00.404016 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
19:58:00.406108 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:58:00.412909 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
19:58:00.442617 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
19:58:00.449581 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:58:00.451896 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT

       (data->'location'->'name')::string as location_name,
       (data->'location'->'country')::string as location_country,
       (data->'trends')::json[] as trends
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        trends
    FROM renamed
)

SELECT * FROM final
  );
19:58:00.455817 [debug] [Thread-1  ]: Postgres adapter: Postgres error: CAST does not support casting from jsonb to jsonb[]

19:58:00.458466 [debug] [Thread-1  ]: finished collecting timing info
19:58:00.460814 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
19:58:00.464208 [debug] [Thread-1  ]: Database Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)
  CAST does not support casting from jsonb to jsonb[]
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:58:00.467316 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32f74228-3f2e-4c4c-bfe1-116135192a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d68ca0>]}
19:58:00.470444 [error] [Thread-1  ]: 2 of 3 ERROR creating view model public.stg_twitter_trending.................... [[31mERROR[0m in 0.18s]
19:58:00.473387 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
19:58:00.477112 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
19:58:00.479201 [info ] [Thread-1  ]: 3 of 3 SKIP relation public.fct_twitter_trending................................ [[33mSKIP[0m]
19:58:00.482391 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
19:58:00.488064 [debug] [MainThread]: Acquiring new materialize connection "master"
19:58:00.491095 [debug] [MainThread]: Using materialize connection "master"
19:58:00.493934 [debug] [MainThread]: On master: BEGIN
19:58:00.496381 [debug] [MainThread]: Opening a new connection, currently in state closed
19:58:00.501888 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:58:00.505209 [debug] [MainThread]: Using materialize connection "master"
19:58:00.507204 [debug] [MainThread]: On master: COMMIT
19:58:00.510181 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:58:00.512558 [debug] [MainThread]: On master: Close
19:58:00.515930 [info ] [MainThread]: 
19:58:00.518557 [info ] [MainThread]: Finished running 1 source model, 1 view model, 1 materializedview model in 0.72s.
19:58:00.522464 [debug] [MainThread]: Connection 'master' was properly closed.
19:58:00.524610 [debug] [MainThread]: Connection 'model.mz_hack_day.stg_twitter_trending' was properly closed.
19:58:00.561347 [info ] [MainThread]: 
19:58:00.564240 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:58:00.567104 [info ] [MainThread]: 
19:58:00.569644 [error] [MainThread]: [33mDatabase Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)[0m
19:58:00.573448 [error] [MainThread]:   CAST does not support casting from jsonb to jsonb[]
19:58:00.576932 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:58:00.580110 [info ] [MainThread]: 
19:58:00.582760 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
19:58:00.587139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d68a30>]}


============================== 2022-02-22 19:58:31.280277 | 9a0d3ba8-0f72-4b8c-a926-508493fdb2c9 ==============================
19:58:31.280277 [info ] [MainThread]: Running with dbt=1.0.1
19:58:31.286634 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:58:31.289314 [debug] [MainThread]: Tracking: tracking
19:58:31.317028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe20>]}
19:58:31.630653 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:58:31.635108 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:58:31.739322 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
19:58:31.909421 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

19:58:31.946730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a0d3ba8-0f72-4b8c-a926-508493fdb2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027bfc0d0>]}
19:58:31.996160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a0d3ba8-0f72-4b8c-a926-508493fdb2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007284e50>]}
19:58:31.999238 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:58:32.007447 [info ] [MainThread]: 
19:58:32.011180 [debug] [MainThread]: Acquiring new materialize connection "master"
19:58:32.019458 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
19:58:32.085719 [debug] [ThreadPool]: Using materialize connection "list_materialize"
19:58:32.089329 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
19:58:32.091413 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:58:32.120259 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
19:58:32.130716 [debug] [ThreadPool]: On list_materialize: Close
19:58:32.138920 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
19:58:32.161168 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
19:58:32.163848 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
19:58:32.165949 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:58:32.173521 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
19:58:32.182829 [debug] [ThreadPool]: On list_materialize_public: Close
19:58:32.188398 [debug] [MainThread]: Using materialize connection "master"
19:58:32.190891 [debug] [MainThread]: On master: BEGIN
19:58:32.192957 [debug] [MainThread]: Opening a new connection, currently in state init
19:58:32.198187 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:58:32.200814 [debug] [MainThread]: Using materialize connection "master"
19:58:32.202798 [debug] [MainThread]: On master: COMMIT
19:58:32.205614 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:58:32.207983 [debug] [MainThread]: On master: Close
19:58:32.211265 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:58:32.213936 [info ] [MainThread]: 
19:58:32.232349 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
19:58:32.235993 [info ] [Thread-1  ]: 1 of 3 START source model public.rp_twitter_trending............................ [RUN]
19:58:32.241496 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
19:58:32.244676 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
19:58:32.247724 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
19:58:32.284624 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
19:58:32.292080 [debug] [Thread-1  ]: finished collecting timing info
19:58:32.294282 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
19:58:32.349562 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:58:32.352494 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
19:58:32.354948 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:58:32.364265 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
19:58:32.402747 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
19:58:32.409703 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:58:32.411986 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
19:58:32.422354 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
19:58:32.470378 [debug] [Thread-1  ]: finished collecting timing info
19:58:32.473330 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
19:58:32.478530 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a0d3ba8-0f72-4b8c-a926-508493fdb2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d8bfa0>]}
19:58:32.482622 [info ] [Thread-1  ]: 1 of 3 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.24s]
19:58:32.486059 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
19:58:32.491493 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
19:58:32.494390 [info ] [Thread-1  ]: 2 of 3 START view model public.stg_twitter_trending............................. [RUN]
19:58:32.497874 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
19:58:32.499902 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
19:58:32.502080 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
19:58:32.520833 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
19:58:32.528490 [debug] [Thread-1  ]: finished collecting timing info
19:58:32.530757 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
19:58:32.599962 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:58:32.603119 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
19:58:32.605281 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:58:32.611543 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
19:58:32.636343 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
19:58:32.644339 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:58:32.646720 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT

       (data->'location'->'name')::string as location_name,
       (data->'location'->'country')::string as location_country,
       (data->'trends')::jsonb as trends
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        trends
    FROM renamed
)

SELECT * FROM final
  );
19:58:32.655756 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
19:58:32.665246 [debug] [Thread-1  ]: finished collecting timing info
19:58:32.667532 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
19:58:32.671181 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a0d3ba8-0f72-4b8c-a926-508493fdb2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049dbfdf0>]}
19:58:32.674839 [info ] [Thread-1  ]: 2 of 3 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.17s]
19:58:32.677730 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
19:58:32.681744 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
19:58:32.684614 [info ] [Thread-1  ]: 3 of 3 START materializedview model public.fct_twitter_trending................. [RUN]
19:58:32.688870 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
19:58:32.692961 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
19:58:32.694974 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
19:58:32.711752 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
19:58:32.719580 [debug] [Thread-1  ]: finished collecting timing info
19:58:32.721596 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
19:58:32.771601 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
19:58:32.774140 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
19:58:32.776404 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:58:32.781956 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
19:58:32.798044 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
19:58:32.804701 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
19:58:32.806802 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


SELECT location_name, location_country, trends
FROM "materialize"."public"."stg_twitter_trending"
  );
19:58:32.816733 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
19:58:32.827338 [debug] [Thread-1  ]: finished collecting timing info
19:58:32.830205 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
19:58:32.833934 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a0d3ba8-0f72-4b8c-a926-508493fdb2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d74250>]}
19:58:32.837931 [info ] [Thread-1  ]: 3 of 3 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.15s]
19:58:32.840699 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
19:58:32.847372 [debug] [MainThread]: Acquiring new materialize connection "master"
19:58:32.849966 [debug] [MainThread]: Using materialize connection "master"
19:58:32.852211 [debug] [MainThread]: On master: BEGIN
19:58:32.854503 [debug] [MainThread]: Opening a new connection, currently in state closed
19:58:32.860319 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:58:32.863132 [debug] [MainThread]: Using materialize connection "master"
19:58:32.865358 [debug] [MainThread]: On master: COMMIT
19:58:32.868068 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:58:32.870956 [debug] [MainThread]: On master: Close
19:58:32.874496 [info ] [MainThread]: 
19:58:32.877303 [info ] [MainThread]: Finished running 1 source model, 1 view model, 1 materializedview model in 0.86s.
19:58:32.880851 [debug] [MainThread]: Connection 'master' was properly closed.
19:58:32.883766 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
19:58:32.922381 [info ] [MainThread]: 
19:58:32.925520 [info ] [MainThread]: [32mCompleted successfully[0m
19:58:32.930101 [info ] [MainThread]: 
19:58:32.934065 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
19:58:32.938560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049de37c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049de37f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5beb0>]}


============================== 2022-02-22 20:00:59.730629 | 3b7584ff-c25a-4862-a323-ff7605c57106 ==============================
20:00:59.730629 [info ] [MainThread]: Running with dbt=1.0.1
20:00:59.737851 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
20:00:59.740492 [debug] [MainThread]: Tracking: tracking
20:00:59.766546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acdf0>]}
20:01:00.091385 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
20:01:00.096042 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
20:01:00.205211 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
20:01:00.380738 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

20:01:00.417951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b7584ff-c25a-4862-a323-ff7605c57106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027bfd0d0>]}
20:01:00.463328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b7584ff-c25a-4862-a323-ff7605c57106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072a4d00>]}
20:01:00.466359 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
20:01:00.474304 [info ] [MainThread]: 
20:01:00.478010 [debug] [MainThread]: Acquiring new materialize connection "master"
20:01:00.486992 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
20:01:00.555509 [debug] [ThreadPool]: Using materialize connection "list_materialize"
20:01:00.558567 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
20:01:00.560842 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:01:00.590891 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
20:01:00.601377 [debug] [ThreadPool]: On list_materialize: Close
20:01:00.611944 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
20:01:00.636317 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
20:01:00.639500 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
20:01:00.641513 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:01:00.649352 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
20:01:00.659070 [debug] [ThreadPool]: On list_materialize_public: Close
20:01:00.664584 [debug] [MainThread]: Using materialize connection "master"
20:01:00.667262 [debug] [MainThread]: On master: BEGIN
20:01:00.670023 [debug] [MainThread]: Opening a new connection, currently in state init
20:01:00.675865 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:01:00.678528 [debug] [MainThread]: Using materialize connection "master"
20:01:00.680481 [debug] [MainThread]: On master: COMMIT
20:01:00.683811 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:01:00.685902 [debug] [MainThread]: On master: Close
20:01:00.688921 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
20:01:00.691950 [info ] [MainThread]: 
20:01:00.708234 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
20:01:00.711674 [info ] [Thread-1  ]: 1 of 3 START source model public.rp_twitter_trending............................ [RUN]
20:01:00.716665 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
20:01:00.719013 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
20:01:00.721052 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
20:01:00.751856 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
20:01:00.758367 [debug] [Thread-1  ]: finished collecting timing info
20:01:00.761843 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
20:01:00.820070 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
20:01:00.822736 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
20:01:00.824790 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:01:00.835093 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
20:01:00.874291 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
20:01:00.880685 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
20:01:00.883141 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
20:01:00.892946 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
20:01:00.943013 [debug] [Thread-1  ]: finished collecting timing info
20:01:00.945784 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
20:01:00.949780 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b7584ff-c25a-4862-a323-ff7605c57106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d8af40>]}
20:01:00.953086 [info ] [Thread-1  ]: 1 of 3 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.23s]
20:01:00.956531 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
20:01:00.962633 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
20:01:00.965284 [info ] [Thread-1  ]: 2 of 3 START view model public.stg_twitter_trending............................. [RUN]
20:01:00.968674 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
20:01:00.970640 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
20:01:00.972533 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
20:01:00.990541 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
20:01:00.997301 [debug] [Thread-1  ]: finished collecting timing info
20:01:00.999465 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
20:01:01.078006 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
20:01:01.082030 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
20:01:01.084589 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:01:01.091370 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
20:01:01.120190 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
20:01:01.127606 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
20:01:01.130183 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT

       (data->'location'->'name')::string as location_name,
       (data->'location'->'country')::string as location_country,
       (data->'trends'->'trends')::jsonb as trends
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        trends
    FROM renamed
)

SELECT * FROM final
  );
20:01:01.138816 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
20:01:01.148576 [debug] [Thread-1  ]: finished collecting timing info
20:01:01.150678 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
20:01:01.154191 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b7584ff-c25a-4862-a323-ff7605c57106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ed71f0>]}
20:01:01.157555 [info ] [Thread-1  ]: 2 of 3 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.19s]
20:01:01.160550 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
20:01:01.164719 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
20:01:01.167439 [info ] [Thread-1  ]: 3 of 3 START materializedview model public.fct_twitter_trending................. [RUN]
20:01:01.171357 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
20:01:01.173422 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
20:01:01.176607 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
20:01:01.193942 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
20:01:01.200470 [debug] [Thread-1  ]: finished collecting timing info
20:01:01.203757 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
20:01:01.256224 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
20:01:01.259494 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
20:01:01.262251 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:01:01.269390 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
20:01:01.285722 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
20:01:01.292505 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
20:01:01.295600 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


SELECT location_name, location_country, trends
FROM "materialize"."public"."stg_twitter_trending"
  );
20:01:01.304997 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
20:01:01.315188 [debug] [Thread-1  ]: finished collecting timing info
20:01:01.317399 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
20:01:01.320795 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b7584ff-c25a-4862-a323-ff7605c57106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d6f220>]}
20:01:01.324086 [info ] [Thread-1  ]: 3 of 3 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.15s]
20:01:01.327110 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
20:01:01.332606 [debug] [MainThread]: Acquiring new materialize connection "master"
20:01:01.334961 [debug] [MainThread]: Using materialize connection "master"
20:01:01.337171 [debug] [MainThread]: On master: BEGIN
20:01:01.339350 [debug] [MainThread]: Opening a new connection, currently in state closed
20:01:01.345511 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:01:01.348039 [debug] [MainThread]: Using materialize connection "master"
20:01:01.350391 [debug] [MainThread]: On master: COMMIT
20:01:01.353633 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:01:01.355714 [debug] [MainThread]: On master: Close
20:01:01.358742 [info ] [MainThread]: 
20:01:01.361314 [info ] [MainThread]: Finished running 1 source model, 1 view model, 1 materializedview model in 0.88s.
20:01:01.364083 [debug] [MainThread]: Connection 'master' was properly closed.
20:01:01.366408 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
20:01:01.399943 [info ] [MainThread]: 
20:01:01.402840 [info ] [MainThread]: [32mCompleted successfully[0m
20:01:01.406032 [info ] [MainThread]: 
20:01:01.408947 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
20:01:01.411880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d8c520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072cf250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5de80>]}


============================== 2022-02-22 20:02:14.608556 | cde53d8a-5211-472a-957e-7690059d3668 ==============================
20:02:14.608556 [info ] [MainThread]: Running with dbt=1.0.1
20:02:14.615106 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
20:02:14.617766 [debug] [MainThread]: Tracking: tracking
20:02:14.646236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acdf0>]}
20:02:14.967946 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
20:02:14.972675 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
20:02:15.078795 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
20:02:15.256573 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

20:02:15.296699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cde53d8a-5211-472a-957e-7690059d3668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027bfd0d0>]}
20:02:15.343679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cde53d8a-5211-472a-957e-7690059d3668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007292dc0>]}
20:02:15.346892 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
20:02:15.354973 [info ] [MainThread]: 
20:02:15.359038 [debug] [MainThread]: Acquiring new materialize connection "master"
20:02:15.368049 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
20:02:15.445449 [debug] [ThreadPool]: Using materialize connection "list_materialize"
20:02:15.448765 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
20:02:15.452970 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:02:15.482263 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
20:02:15.492352 [debug] [ThreadPool]: On list_materialize: Close
20:02:15.500537 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
20:02:15.524130 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
20:02:15.526726 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
20:02:15.528850 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:02:15.535993 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
20:02:15.545551 [debug] [ThreadPool]: On list_materialize_public: Close
20:02:15.551260 [debug] [MainThread]: Using materialize connection "master"
20:02:15.554260 [debug] [MainThread]: On master: BEGIN
20:02:15.556993 [debug] [MainThread]: Opening a new connection, currently in state init
20:02:15.562723 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:02:15.565495 [debug] [MainThread]: Using materialize connection "master"
20:02:15.567622 [debug] [MainThread]: On master: COMMIT
20:02:15.571025 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:02:15.573425 [debug] [MainThread]: On master: Close
20:02:15.576683 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
20:02:15.579488 [info ] [MainThread]: 
20:02:15.595552 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
20:02:15.598948 [info ] [Thread-1  ]: 1 of 3 START source model public.rp_twitter_trending............................ [RUN]
20:02:15.604226 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
20:02:15.607218 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
20:02:15.609798 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
20:02:15.641281 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
20:02:15.647472 [debug] [Thread-1  ]: finished collecting timing info
20:02:15.650462 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
20:02:15.709032 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
20:02:15.712254 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
20:02:15.715093 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:02:15.728854 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
20:02:15.769890 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
20:02:15.776288 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
20:02:15.778658 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
20:02:15.788252 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
20:02:15.836460 [debug] [Thread-1  ]: finished collecting timing info
20:02:15.840119 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
20:02:15.843847 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cde53d8a-5211-472a-957e-7690059d3668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d8bf40>]}
20:02:15.846997 [info ] [Thread-1  ]: 1 of 3 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.24s]
20:02:15.850272 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
20:02:15.855531 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
20:02:15.858576 [info ] [Thread-1  ]: 2 of 3 START view model public.stg_twitter_trending............................. [RUN]
20:02:15.862268 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
20:02:15.864780 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
20:02:15.867274 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
20:02:15.886157 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
20:02:15.893205 [debug] [Thread-1  ]: finished collecting timing info
20:02:15.895400 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
20:02:15.967626 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
20:02:15.970364 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
20:02:15.972480 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:02:15.978687 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
20:02:16.005338 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
20:02:16.012591 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
20:02:16.015278 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT

       (data->'location'->'name')::string as location_name,
       (data->'location'->'country')::string as location_country,
       (data->'trends'->0->'trends')::jsonb as trends
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        trends
    FROM renamed
)

SELECT * FROM final
  );
20:02:16.025040 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
20:02:16.034826 [debug] [Thread-1  ]: finished collecting timing info
20:02:16.036884 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
20:02:16.040198 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cde53d8a-5211-472a-957e-7690059d3668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ed71f0>]}
20:02:16.043519 [info ] [Thread-1  ]: 2 of 3 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.18s]
20:02:16.046573 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
20:02:16.050713 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
20:02:16.053562 [info ] [Thread-1  ]: 3 of 3 START materializedview model public.fct_twitter_trending................. [RUN]
20:02:16.057354 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
20:02:16.059374 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
20:02:16.061374 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
20:02:16.080799 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
20:02:16.088420 [debug] [Thread-1  ]: finished collecting timing info
20:02:16.091033 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
20:02:16.141125 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
20:02:16.143963 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
20:02:16.146268 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:02:16.152082 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
20:02:16.167224 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
20:02:16.173611 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
20:02:16.175903 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


SELECT location_name, location_country, trends
FROM "materialize"."public"."stg_twitter_trending"
  );
20:02:16.187172 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
20:02:16.197061 [debug] [Thread-1  ]: finished collecting timing info
20:02:16.199302 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
20:02:16.202519 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cde53d8a-5211-472a-957e-7690059d3668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ee6220>]}
20:02:16.206191 [info ] [Thread-1  ]: 3 of 3 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.15s]
20:02:16.209086 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
20:02:16.215071 [debug] [MainThread]: Acquiring new materialize connection "master"
20:02:16.217473 [debug] [MainThread]: Using materialize connection "master"
20:02:16.220186 [debug] [MainThread]: On master: BEGIN
20:02:16.222268 [debug] [MainThread]: Opening a new connection, currently in state closed
20:02:16.228078 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:02:16.231846 [debug] [MainThread]: Using materialize connection "master"
20:02:16.234405 [debug] [MainThread]: On master: COMMIT
20:02:16.237752 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:02:16.240412 [debug] [MainThread]: On master: Close
20:02:16.243538 [info ] [MainThread]: 
20:02:16.246697 [info ] [MainThread]: Finished running 1 source model, 1 view model, 1 materializedview model in 0.89s.
20:02:16.249602 [debug] [MainThread]: Connection 'master' was properly closed.
20:02:16.251634 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
20:02:16.287369 [info ] [MainThread]: 
20:02:16.290248 [info ] [MainThread]: [32mCompleted successfully[0m
20:02:16.293418 [info ] [MainThread]: 
20:02:16.296460 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
20:02:16.299526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ee2820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c4c910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5df40>]}
