

============================== 2022-02-17 17:58:52.387803 | 0e48aee3-06ac-427f-9d03-215fef6e9e2d ==============================
17:58:52.387803 [info ] [MainThread]: Running with dbt=1.0.1
17:58:52.392967 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
17:58:52.395598 [debug] [MainThread]: Tracking: tracking
17:58:52.421643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4005a47f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4005a62220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4005a620d0>]}
17:58:53.136679 [debug] [MainThread]: Executing "git --help"
17:58:53.177460 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
17:58:53.181467 [debug] [MainThread]: STDERR: "b''"
17:58:53.213696 [debug] [MainThread]: Acquiring new materialize connection "debug"
17:58:53.220982 [debug] [MainThread]: Using materialize connection "debug"
17:58:53.225016 [debug] [MainThread]: On debug: select 1 as id
17:58:53.230491 [debug] [MainThread]: Opening a new connection, currently in state init
17:58:53.290402 [debug] [MainThread]: SQL status: SELECT 1 in 0.06 seconds
17:58:53.303459 [debug] [MainThread]: On debug: Close
17:58:53.309281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072b6f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072d7b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072d7190>]}
17:58:53.988487 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-02-17 18:00:42.937306 | 4353ffc9-652e-450f-adeb-58960b914a26 ==============================
18:00:42.937306 [info ] [MainThread]: Running with dbt=1.0.1
18:00:42.944023 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
18:00:42.946955 [debug] [MainThread]: Tracking: tracking
18:00:42.979619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abdf0>]}
18:00:42.988357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe20>]}


============================== 2022-02-17 18:30:56.659168 | 90794e57-a429-48a3-8b4e-4c5a275d364a ==============================
18:30:56.659168 [info ] [MainThread]: Running with dbt=1.0.1
18:30:56.665401 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, defer=None, state=None, cls=<class 'dbt.task.deps.DepsTask'>, which='deps', rpc_method='deps')
18:30:56.668358 [debug] [MainThread]: Tracking: tracking
18:30:56.697795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728c8e0>]}
18:30:56.709660 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-u2hmn_0i'
18:30:56.713204 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
18:30:57.028544 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
18:30:57.032663 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils.json
18:30:57.326539 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils.json 200
18:30:57.343683 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils/0.1.0.json
18:30:57.627973 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils/0.1.0.json 200
18:30:57.635815 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils.json
18:30:57.836245 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils.json 200
18:30:57.845486 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils/0.1.0.json
18:30:58.065487 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils/0.1.0.json 200
18:30:58.085362 [info ] [MainThread]: Installing MaterializeInc/materialize_dbt_utils
18:30:58.710067 [info ] [MainThread]:   Installed from version 0.1.0
18:30:58.714330 [info ] [MainThread]:   Up to date!
18:30:58.717700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '90794e57-a429-48a3-8b4e-4c5a275d364a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072c6700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072c6940>]}
18:30:58.725715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728c220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728cfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728c850>]}


============================== 2022-02-17 18:31:53.560450 | acc72c13-ece7-41af-92aa-39921711d9d8 ==============================
18:31:53.560450 [info ] [MainThread]: Running with dbt=1.0.1
18:31:53.567562 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
18:31:53.572311 [debug] [MainThread]: Tracking: tracking
18:31:53.601748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072a9dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072a9eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072a9e50>]}
18:31:53.730138 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
18:31:53.733114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'acc72c13-ece7-41af-92aa-39921711d9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072cf910>]}
18:31:54.067582 [debug] [MainThread]: Parsing macros/adapters.sql
18:31:54.170046 [debug] [MainThread]: Parsing macros/catalog.sql
18:31:54.191000 [debug] [MainThread]: Parsing macros/mz_generate_name.sql
18:31:54.199459 [debug] [MainThread]: Parsing macros/relations.sql
18:31:54.237234 [debug] [MainThread]: Parsing macros/materializations/source.sql
18:31:54.263472 [debug] [MainThread]: Parsing macros/materializations/view.sql
18:31:54.284325 [debug] [MainThread]: Parsing macros/materializations/seed.sql
18:31:54.345663 [debug] [MainThread]: Parsing macros/materializations/index.sql
18:31:54.371403 [debug] [MainThread]: Parsing macros/materializations/table.sql
18:31:54.392677 [debug] [MainThread]: Parsing macros/materializations/materialized_view.sql
18:31:54.414122 [debug] [MainThread]: Parsing macros/materializations/sink.sql
18:31:54.435115 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
18:31:54.442031 [debug] [MainThread]: Parsing macros/materializations/helpers.sql
18:31:54.456604 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:31:54.470984 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:31:54.492656 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:31:54.506005 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:31:54.579592 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:31:54.597538 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:31:54.673321 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:31:54.709732 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:31:54.764661 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:31:54.789947 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:31:54.812562 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:31:54.844591 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:31:54.864030 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:31:54.915281 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:31:55.068805 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:31:55.222634 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:31:55.311146 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:31:55.325365 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:31:55.409010 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:31:55.464821 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:31:55.487318 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:31:55.572992 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:31:55.607450 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:31:55.620725 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:31:55.739876 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:31:55.823105 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:31:55.881539 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:31:55.901651 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:31:55.925643 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:31:55.938339 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:31:55.975567 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:31:55.991155 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:31:56.006230 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:31:56.014583 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:31:56.020826 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:31:56.030363 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:31:56.044737 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:31:56.081678 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:31:56.159831 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:31:56.194568 [debug] [MainThread]: Parsing macros/dbt_utils/date_trunc.sql
18:31:56.208013 [debug] [MainThread]: Parsing macros/dbt_utils/dateadd.sql
18:31:56.227320 [debug] [MainThread]: Parsing macros/dbt_utils/datediff.sql
18:31:56.246102 [debug] [MainThread]: Parsing macros/dbt_utils/get_tables_by_pattern_sql.sql
18:31:56.265362 [debug] [MainThread]: Parsing macros/dbt_utils/last_day.sql
18:31:57.857393 [debug] [MainThread]: 1699: static parser successfully parsed examples/marts/flight/fct_flight.sql
18:31:57.948777 [debug] [MainThread]: 1603: static parser failed on examples/sources/flight/icao_mapping.sql
18:31:57.984715 [debug] [MainThread]: 1602: parser fallback to jinja rendering on examples/sources/flight/icao_mapping.sql
18:31:57.994553 [debug] [MainThread]: 1603: static parser failed on examples/sources/flight/rp_flight_information.sql
18:31:58.020532 [debug] [MainThread]: 1602: parser fallback to jinja rendering on examples/sources/flight/rp_flight_information.sql
18:31:58.031291 [debug] [MainThread]: 1699: static parser successfully parsed examples/staging/flight/stg_flight_information.sql
18:31:58.047503 [debug] [MainThread]: 1699: static parser successfully parsed examples/staging/flight/stg_icao_mapping.sql
18:31:58.065036 [debug] [MainThread]: 1603: static parser failed on templates/marts/core/fct_example.sql
18:31:58.089127 [debug] [MainThread]: 1602: parser fallback to jinja rendering on templates/marts/core/fct_example.sql
18:31:58.098456 [debug] [MainThread]: 1603: static parser failed on templates/sources/new_source/source_example.sql
18:31:58.129218 [debug] [MainThread]: 1602: parser fallback to jinja rendering on templates/sources/new_source/source_example.sql
18:31:58.153872 [debug] [MainThread]: 1603: static parser failed on templates/staging/new_staging_source/stg_inventory_customers.sql
18:31:58.186041 [debug] [MainThread]: 1602: parser fallback to jinja rendering on templates/staging/new_staging_source/stg_inventory_customers.sql
18:31:58.560645 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.templates
- models.examples

18:31:58.598286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'acc72c13-ece7-41af-92aa-39921711d9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027bd2100>]}
18:31:58.669607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'acc72c13-ece7-41af-92aa-39921711d9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027bd2760>]}
18:31:58.673301 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:31:58.682803 [info ] [MainThread]: 
18:31:58.686771 [debug] [MainThread]: Acquiring new materialize connection "master"
18:31:58.698460 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
18:31:58.765639 [debug] [ThreadPool]: Using materialize connection "list_materialize"
18:31:58.769052 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
18:31:58.772414 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:31:58.807334 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
18:31:58.818024 [debug] [ThreadPool]: On list_materialize: Close
18:31:58.828412 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
18:31:58.851733 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
18:31:58.854362 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
18:31:58.856439 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:31:58.863308 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
18:31:58.872501 [debug] [ThreadPool]: On list_materialize_public: Close
18:31:58.879360 [debug] [MainThread]: Using materialize connection "master"
18:31:58.882311 [debug] [MainThread]: On master: BEGIN
18:31:58.885148 [debug] [MainThread]: Opening a new connection, currently in state init
18:31:58.890879 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:31:58.893784 [debug] [MainThread]: Using materialize connection "master"
18:31:58.896183 [debug] [MainThread]: On master: COMMIT
18:31:58.899157 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:31:58.901337 [debug] [MainThread]: On master: Close
18:31:58.904849 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:31:58.908120 [info ] [MainThread]: 
18:31:59.028306 [debug] [Thread-1  ]: Began running node model.mz_hack_day.icao_mapping
18:31:59.032081 [info ] [Thread-1  ]: 1 of 5 START source model public.icao_mapping................................... [RUN]
18:31:59.039263 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.icao_mapping"
18:31:59.043456 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.icao_mapping
18:31:59.048695 [debug] [Thread-1  ]: Compiling model.mz_hack_day.icao_mapping
18:31:59.073431 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.icao_mapping"
18:31:59.111537 [debug] [Thread-1  ]: finished collecting timing info
18:31:59.114965 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.icao_mapping
18:31:59.196850 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
18:31:59.209568 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */
drop source if exists 
      materialize.public.icao_mapping
   cascade
18:31:59.219103 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:31:59.241656 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.02 seconds
18:31:59.312625 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.icao_mapping"
18:31:59.378126 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
18:31:59.381859 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */




CREATE SOURCE 
    materialize.public.icao_mapping

FROM FILE '/tmp/icao24_mapping_airbus.json.gz' COMPRESSION GZIP
FORMAT BYTES;
18:31:59.402510 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.02 seconds
18:31:59.457889 [debug] [Thread-1  ]: finished collecting timing info
18:31:59.462573 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: Close
18:31:59.467654 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acc72c13-ece7-41af-92aa-39921711d9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027ea9e80>]}
18:31:59.471478 [info ] [Thread-1  ]: 1 of 5 OK created source model public.icao_mapping.............................. [[32mCREATE SOURCE[0m in 0.43s]
18:31:59.475333 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.icao_mapping
18:31:59.478215 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_flight_information
18:31:59.482950 [info ] [Thread-1  ]: 2 of 5 START source model public.rp_flight_information.......................... [RUN]
18:31:59.486898 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_flight_information"
18:31:59.489452 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_flight_information
18:31:59.491898 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_flight_information
18:31:59.513050 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_flight_information"
18:31:59.520493 [debug] [Thread-1  ]: finished collecting timing info
18:31:59.523139 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_flight_information
18:31:59.533680 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
18:31:59.536385 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */
drop source if exists 
      materialize.public.rp_flight_information
   cascade
18:31:59.539372 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:31:59.546390 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
18:31:59.555204 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_flight_information"
18:31:59.562807 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
18:31:59.565324 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */




CREATE SOURCE 
    materialize.public.rp_flight_information

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'flight_information'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
18:31:59.592669 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.03 seconds
18:31:59.602949 [debug] [Thread-1  ]: finished collecting timing info
18:31:59.605386 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: Close
18:31:59.609410 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acc72c13-ece7-41af-92aa-39921711d9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027ebbfa0>]}
18:31:59.613201 [info ] [Thread-1  ]: 2 of 5 OK created source model public.rp_flight_information..................... [[32mCREATE SOURCE[0m in 0.12s]
18:31:59.616445 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_flight_information
18:31:59.619523 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_icao_mapping
18:31:59.622548 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_icao_mapping................................. [RUN]
18:31:59.626877 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_icao_mapping"
18:31:59.629389 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_icao_mapping
18:31:59.631642 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_icao_mapping
18:31:59.651645 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_icao_mapping"
18:31:59.667004 [debug] [Thread-1  ]: finished collecting timing info
18:31:59.669340 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_icao_mapping
18:31:59.744821 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
18:31:59.749870 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
drop view if exists "materialize"."public"."stg_icao_mapping" cascade
18:31:59.767409 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:31:59.790373 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.02 seconds
18:31:59.827841 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_icao_mapping"
18:31:59.854229 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
18:31:59.856522 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
create view "materialize"."public"."stg_icao_mapping"
  as (
    /*

The purpose of this staging model is to create a icao_mapping staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."icao_mapping"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

    (data->>'icao24')::string AS icao24,
           (data->>'manufacturericao')::string AS manufacturericao,
           (data->>'manufacturername')::string AS manufacturername,
           (data->>'model')::string AS model,
           (data->>'typecode')::string AS typecode,
           (data->>'icaoaircrafttype')::string AS icaoaircrafttype,
           (data->>'operator')::string AS operator,
           (data->>'operatorcallsign')::string AS operatorcallsign,
           (data->>'operatoricao')::string AS operatoricao,
           (data->>'built')::string AS built,
           (data->>'categorydescription')::string AS categorydescription

    FROM casted

)

SELECT * FROM renamed
  );
18:31:59.866660 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
18:31:59.876741 [debug] [Thread-1  ]: finished collecting timing info
18:31:59.880526 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: Close
18:31:59.884875 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acc72c13-ece7-41af-92aa-39921711d9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4030706580>]}
18:31:59.889152 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_icao_mapping............................ [[32mCREATE VIEW[0m in 0.26s]
18:31:59.895226 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_icao_mapping
18:31:59.897655 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_flight_information
18:31:59.900490 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_flight_information........................... [RUN]
18:31:59.904237 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_flight_information"
18:31:59.906825 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_flight_information
18:31:59.911166 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_flight_information
18:31:59.932974 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_flight_information"
18:31:59.940806 [debug] [Thread-1  ]: finished collecting timing info
18:31:59.944195 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_flight_information
18:31:59.963249 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
18:31:59.965894 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
drop view if exists "materialize"."public"."stg_flight_information" cascade
18:31:59.968071 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:31:59.974334 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
18:31:59.986503 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_flight_information"
18:31:59.995213 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
18:31:59.998058 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
create view "materialize"."public"."stg_flight_information"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_flight_information"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'icao24')::string as icao24,
       (data->>'callsign')::string as callsign,
       (data->>'origin_country')::string as origin_country,
       (data->>'time_position')::numeric as time_position,
       (data->>'last_contact')::numeric as last_contact,
       (data->>'longitude')::double as longitude,
       (data->>'latitude')::double as latitude,
       (data->>'baro_altitude')::double as baro_altitude,
       (data->>'on_ground')::boolean as on_ground,
       (data->>'velocity')::double as velocity,
       (data->>'true_track')::double as true_track,
       (data->>'vertical_rate')::string as vertical_rate,
       (data->>'sensors')::string as sensors,
       (data->>'geo_altitude')::string as geo_altitude,
       (data->>'squawk')::string as squawk,
       (data->>'spi')::string as spi,
       (data->>'position_source')::string as position_source

    FROM casted

)

SELECT * FROM renamed
  );
18:32:00.012894 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
18:32:00.024189 [debug] [Thread-1  ]: finished collecting timing info
18:32:00.031393 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: Close
18:32:00.038411 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acc72c13-ece7-41af-92aa-39921711d9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c11700>]}
18:32:00.044593 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_flight_information...................... [[32mCREATE VIEW[0m in 0.13s]
18:32:00.049211 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_flight_information
18:32:00.055659 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_flight
18:32:00.059811 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_flight........................... [RUN]
18:32:00.064411 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_flight"
18:32:00.067148 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_flight
18:32:00.071063 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_flight
18:32:00.098595 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_flight"
18:32:00.116367 [debug] [Thread-1  ]: finished collecting timing info
18:32:00.118858 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_flight
18:32:00.169856 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
18:32:00.173109 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
drop view if exists "materialize"."public"."fct_flight" cascade
18:32:00.175499 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:32:00.181863 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
18:32:00.197947 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_flight"
18:32:00.211675 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
18:32:00.213971 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
create materialized view "materialize"."public"."fct_flight"
  as (
    


SELECT fi.icao24,
       manufacturername,
       model,
       operator,
       origin_country,
       time_position,
       longitude,
       latitude
FROM "materialize"."public"."stg_flight_information" fi
JOIN "materialize"."public"."stg_icao_mapping" icao ON fi.icao24 = icao.icao24
  );
18:32:00.227558 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
18:32:00.246201 [debug] [Thread-1  ]: finished collecting timing info
18:32:00.249198 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: Close
18:32:00.252946 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acc72c13-ece7-41af-92aa-39921711d9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4030719f40>]}
18:32:00.256658 [info ] [Thread-1  ]: 5 of 5 OK created materializedview model public.fct_flight...................... [[32mCREATE VIEW[0m in 0.19s]
18:32:00.259841 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_flight
18:32:00.266471 [debug] [MainThread]: Acquiring new materialize connection "master"
18:32:00.269398 [debug] [MainThread]: Using materialize connection "master"
18:32:00.271439 [debug] [MainThread]: On master: BEGIN
18:32:00.273586 [debug] [MainThread]: Opening a new connection, currently in state closed
18:32:00.280576 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:32:00.286402 [debug] [MainThread]: Using materialize connection "master"
18:32:00.288749 [debug] [MainThread]: On master: COMMIT
18:32:00.292041 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:32:00.295090 [debug] [MainThread]: On master: Close
18:32:00.299161 [info ] [MainThread]: 
18:32:00.303668 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.61s.
18:32:00.306862 [debug] [MainThread]: Connection 'master' was properly closed.
18:32:00.309181 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_flight' was properly closed.
18:32:00.358724 [info ] [MainThread]: 
18:32:00.362212 [info ] [MainThread]: [32mCompleted successfully[0m
18:32:00.366323 [info ] [MainThread]: 
18:32:00.370617 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
18:32:00.378270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073ac820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073acdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073acac0>]}


============================== 2022-02-17 18:32:31.082990 | 6e4506e0-d357-4c03-8637-b2209330bc15 ==============================
18:32:31.082990 [info ] [MainThread]: Running with dbt=1.0.1
18:32:31.092997 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, compile=True, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.generate.GenerateTask'>, which='generate', rpc_method='docs.generate')
18:32:31.098247 [debug] [MainThread]: Tracking: tracking
18:32:31.134354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aad00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aadf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aad90>]}
18:32:31.574062 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:32:31.577441 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:32:31.582796 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.templates
- models.examples

18:32:31.631759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e4506e0-d357-4c03-8637-b2209330bc15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073d40d0>]}
18:32:31.716840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e4506e0-d357-4c03-8637-b2209330bc15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007316910>]}
18:32:31.723616 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:32:31.739007 [info ] [MainThread]: 
18:32:31.749676 [debug] [MainThread]: Acquiring new materialize connection "master"
18:32:31.779250 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
18:32:31.854566 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
18:32:31.858251 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
18:32:31.861412 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:32:31.896108 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.03 seconds
18:32:31.907395 [debug] [ThreadPool]: On list_materialize_public: Close
18:32:31.921338 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:32:31.925070 [info ] [MainThread]: 
18:32:31.981327 [debug] [Thread-1  ]: Began running node model.mz_hack_day.icao_mapping
18:32:31.989851 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.icao_mapping"
18:32:31.996767 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.icao_mapping
18:32:32.001741 [debug] [Thread-1  ]: Compiling model.mz_hack_day.icao_mapping
18:32:32.038095 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.icao_mapping"
18:32:32.046211 [debug] [Thread-1  ]: finished collecting timing info
18:32:32.048976 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.icao_mapping
18:32:32.052215 [debug] [Thread-1  ]: finished collecting timing info
18:32:32.055882 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.icao_mapping
18:32:32.059107 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_flight_information
18:32:32.062369 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_flight_information"
18:32:32.064799 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_flight_information
18:32:32.067051 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_flight_information
18:32:32.087706 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_flight_information"
18:32:32.095554 [debug] [Thread-1  ]: finished collecting timing info
18:32:32.098452 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_flight_information
18:32:32.101015 [debug] [Thread-1  ]: finished collecting timing info
18:32:32.104378 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_flight_information
18:32:32.106521 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_icao_mapping
18:32:32.109831 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_icao_mapping"
18:32:32.112541 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_icao_mapping
18:32:32.115405 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_icao_mapping
18:32:32.136009 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_icao_mapping"
18:32:32.144856 [debug] [Thread-1  ]: finished collecting timing info
18:32:32.147103 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_icao_mapping
18:32:32.149368 [debug] [Thread-1  ]: finished collecting timing info
18:32:32.153266 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_icao_mapping
18:32:32.157030 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_flight_information
18:32:32.160251 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_flight_information"
18:32:32.162357 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_flight_information
18:32:32.165231 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_flight_information
18:32:32.185988 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_flight_information"
18:32:32.192416 [debug] [Thread-1  ]: finished collecting timing info
18:32:32.195063 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_flight_information
18:32:32.197705 [debug] [Thread-1  ]: finished collecting timing info
18:32:32.201170 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_flight_information
18:32:32.207685 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_flight
18:32:32.211330 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_flight"
18:32:32.214280 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_flight
18:32:32.216450 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_flight
18:32:32.237156 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_flight"
18:32:32.244564 [debug] [Thread-1  ]: finished collecting timing info
18:32:32.247108 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_flight
18:32:32.249281 [debug] [Thread-1  ]: finished collecting timing info
18:32:32.253391 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_flight
18:32:32.258737 [debug] [MainThread]: Connection 'master' was properly closed.
18:32:32.261075 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_flight' was properly closed.
18:32:32.301387 [info ] [MainThread]: Done.
18:32:32.361150 [debug] [MainThread]: Acquiring new materialize connection "generate_catalog"
18:32:32.363555 [info ] [MainThread]: Building catalog
18:32:32.375288 [debug] [ThreadPool]: Acquiring new materialize connection "materialize.information_schema"
18:32:32.431359 [debug] [ThreadPool]: Using materialize connection "materialize.information_schema"
18:32:32.434761 [debug] [ThreadPool]: On materialize.information_schema: BEGIN
18:32:32.438576 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:32:32.445670 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:32:32.448424 [debug] [ThreadPool]: Using materialize connection "materialize.information_schema"
18:32:32.450852 [debug] [ThreadPool]: On materialize.information_schema: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "materialize.information_schema"} */

    
    

    select
        'materialize' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        col.type as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join (select mz_columns.name as attname, position as attnum, mz_relations.oid as attrelid, FALSE as attisdropped, mz_columns.type as type
          from mz_columns join mz_relations on mz_columns.id = mz_relations.id)
          as col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
18:32:32.507532 [debug] [ThreadPool]: SQL status: SELECT 41 in 0.02 seconds
18:32:32.601647 [debug] [ThreadPool]: On materialize.information_schema: ROLLBACK
18:32:32.604640 [debug] [ThreadPool]: On materialize.information_schema: Close
18:32:32.672584 [info ] [MainThread]: Catalog written to /usr/app/dbt/target/catalog.json
18:32:32.677269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aad00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40294e71f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40294e77c0>]}
18:32:33.362630 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
18:32:33.366263 [debug] [MainThread]: Connection 'materialize.information_schema' was properly closed.


============================== 2022-02-17 18:33:06.455752 | 03ef597f-b0a8-4c98-8b48-ecf48d863c3b ==============================
18:33:06.455752 [info ] [MainThread]: Running with dbt=1.0.1
18:33:06.463102 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8080, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
18:33:06.466069 [debug] [MainThread]: Tracking: tracking
18:33:06.498289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728cdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728cee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728ce80>]}
18:33:06.579534 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
18:33:06.583492 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
18:33:06.587009 [info ] [MainThread]: 
18:33:06.591817 [info ] [MainThread]: 
18:33:06.596247 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-02-19 11:38:01.522083 | ed3dd23d-a44a-498d-ad79-fb5d8506908a ==============================
11:38:01.522083 [info ] [MainThread]: Running with dbt=1.0.1
11:38:01.527535 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
11:38:01.530372 [debug] [MainThread]: Tracking: tracking
11:38:01.562722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4005bbaf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4005bbad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4005bbae80>]}
11:38:02.538277 [debug] [MainThread]: Executing "git --help"
11:38:02.586001 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
11:38:02.591290 [debug] [MainThread]: STDERR: "b''"
11:38:02.616900 [debug] [MainThread]: Acquiring new materialize connection "debug"
11:38:02.620903 [debug] [MainThread]: Using materialize connection "debug"
11:38:02.625026 [debug] [MainThread]: On debug: select 1 as id
11:38:02.629924 [debug] [MainThread]: Opening a new connection, currently in state init
11:38:02.686098 [debug] [MainThread]: SQL status: SELECT 1 in 0.06 seconds
11:38:02.699619 [debug] [MainThread]: On debug: Close
11:38:02.706325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073d8100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073d8460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073d8ee0>]}
11:38:03.381741 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-02-19 11:38:39.900540 | cf6f859b-ab73-4fe9-9d5a-902d696f5a6d ==============================
11:38:39.900540 [info ] [MainThread]: Running with dbt=1.0.1
11:38:39.910777 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
11:38:39.920436 [debug] [MainThread]: Tracking: tracking
11:38:39.949864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abdc0>]}
11:38:40.423848 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
11:38:40.427243 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/examples/marts/inventory/fct_inventory.sql
11:38:40.430195 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/examples/sources/inventory/inventory_customers.sql
11:38:40.433573 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/examples/sources/inventory/src_inventory.yml
11:38:40.544818 [debug] [MainThread]: 1699: static parser successfully parsed examples/marts/inventory/fct_inventory.sql
11:38:40.657600 [debug] [MainThread]: 1603: static parser failed on examples/sources/inventory/inventory_customers.sql
11:38:40.700452 [debug] [MainThread]: 1602: parser fallback to jinja rendering on examples/sources/inventory/inventory_customers.sql
11:38:40.763887 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'inventory_customer' in the 'models' section of file 'models/examples/sources/inventory/src_inventory.yml'
11:38:40.808813 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.templates
- models.examples

11:38:40.852028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf6f859b-ab73-4fe9-9d5a-902d696f5a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c6a0d0>]}
11:38:40.910315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf6f859b-ab73-4fe9-9d5a-902d696f5a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007329c70>]}
11:38:40.913552 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
11:38:40.925977 [info ] [MainThread]: 
11:38:40.930806 [debug] [MainThread]: Acquiring new materialize connection "master"
11:38:40.958038 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
11:38:41.049515 [debug] [ThreadPool]: Using materialize connection "list_materialize"
11:38:41.052828 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
11:38:41.055568 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:38:41.088339 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
11:38:41.099450 [debug] [ThreadPool]: On list_materialize: Close
11:38:41.111127 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
11:38:41.137324 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
11:38:41.140320 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
11:38:41.142881 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:38:41.149765 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
11:38:41.159999 [debug] [ThreadPool]: On list_materialize_public: Close
11:38:41.167868 [debug] [MainThread]: Using materialize connection "master"
11:38:41.172698 [debug] [MainThread]: On master: BEGIN
11:38:41.174886 [debug] [MainThread]: Opening a new connection, currently in state init
11:38:41.180643 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:38:41.183077 [debug] [MainThread]: Using materialize connection "master"
11:38:41.185525 [debug] [MainThread]: On master: COMMIT
11:38:41.188505 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:38:41.190802 [debug] [MainThread]: On master: Close
11:38:41.194315 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
11:38:41.197164 [info ] [MainThread]: 
11:38:41.334303 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_inventory
11:38:41.338392 [info ] [Thread-1  ]: 1 of 7 START view model public.fct_inventory.................................... [RUN]
11:38:41.346352 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_inventory"
11:38:41.350548 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_inventory
11:38:41.352907 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_inventory
11:38:41.362834 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_inventory"
11:38:41.376273 [debug] [Thread-1  ]: finished collecting timing info
11:38:41.378749 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_inventory
11:38:41.459830 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_inventory"
11:38:41.463865 [debug] [Thread-1  ]: On model.mz_hack_day.fct_inventory: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_inventory"} */
drop view if exists "materialize"."public"."fct_inventory" cascade
11:38:41.467011 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:38:41.478552 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:38:41.537909 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_inventory"
11:38:41.551262 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_inventory"
11:38:41.553589 [debug] [Thread-1  ]: On model.mz_hack_day.fct_inventory: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_inventory"} */
create view "materialize"."public"."fct_inventory"
  as (
    CREATE MATERIALIZED VIEW inventory_customers_view AS
SELECT * FROM inventory_customers;
  );
11:38:41.557605 [debug] [Thread-1  ]: Postgres adapter: Postgres error: Expected SELECT, VALUES, or a subquery in the query body, found CREATE
LINE 4:     CREATE MATERIALIZED VIEW inventory_customers_view AS
            ^

11:38:41.560501 [debug] [Thread-1  ]: finished collecting timing info
11:38:41.562827 [debug] [Thread-1  ]: On model.mz_hack_day.fct_inventory: Close
11:38:41.566325 [debug] [Thread-1  ]: Database Error in model fct_inventory (models/examples/marts/inventory/fct_inventory.sql)
  Expected SELECT, VALUES, or a subquery in the query body, found CREATE
  LINE 4:     CREATE MATERIALIZED VIEW inventory_customers_view AS
              ^
  compiled SQL at target/run/mz_hack_day/models/examples/marts/inventory/fct_inventory.sql
11:38:41.569569 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf6f859b-ab73-4fe9-9d5a-902d696f5a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4030784e20>]}
11:38:41.572843 [error] [Thread-1  ]: 1 of 7 ERROR creating view model public.fct_inventory........................... [[31mERROR[0m in 0.22s]
11:38:41.576120 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_inventory
11:38:41.578639 [debug] [Thread-1  ]: Began running node model.mz_hack_day.icao_mapping
11:38:41.581420 [info ] [Thread-1  ]: 2 of 7 START source model public.icao_mapping................................... [RUN]
11:38:41.585402 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.icao_mapping"
11:38:41.587943 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.icao_mapping
11:38:41.590150 [debug] [Thread-1  ]: Compiling model.mz_hack_day.icao_mapping
11:38:41.612994 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.icao_mapping"
11:38:41.622873 [debug] [Thread-1  ]: finished collecting timing info
11:38:41.625728 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.icao_mapping
11:38:41.690049 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:38:41.692783 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */
drop source if exists 
      materialize.public.icao_mapping
   cascade
11:38:41.695652 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:38:41.702081 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:38:41.717239 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.icao_mapping"
11:38:41.727317 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:38:41.729815 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */




CREATE SOURCE 
    materialize.public.icao_mapping

FROM FILE '/tmp/icao24_mapping_airbus.json.gz' COMPRESSION GZIP
FORMAT BYTES;
11:38:41.741813 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:38:41.796676 [debug] [Thread-1  ]: finished collecting timing info
11:38:41.799939 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: Close
11:38:41.804837 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf6f859b-ab73-4fe9-9d5a-902d696f5a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40307708b0>]}
11:38:41.808374 [info ] [Thread-1  ]: 2 of 7 OK created source model public.icao_mapping.............................. [[32mCREATE SOURCE[0m in 0.22s]
11:38:41.812687 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.icao_mapping
11:38:41.815788 [debug] [Thread-1  ]: Began running node model.mz_hack_day.inventory_customers
11:38:41.818869 [info ] [Thread-1  ]: 3 of 7 START source model public.inventory_customers............................ [RUN]
11:38:41.822748 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.inventory_customers"
11:38:41.825373 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.inventory_customers
11:38:41.827467 [debug] [Thread-1  ]: Compiling model.mz_hack_day.inventory_customers
11:38:41.848917 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.inventory_customers"
11:38:41.858098 [debug] [Thread-1  ]: finished collecting timing info
11:38:41.860604 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.inventory_customers
11:38:41.872048 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:38:41.874736 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */
drop source if exists 
      materialize.public.inventory_customers
   cascade
11:38:41.877410 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:38:41.883365 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:38:41.892853 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.inventory_customers"
11:38:41.902057 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:38:41.904407 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */




CREATE SOURCE 
    materialize.public.inventory_customers

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'dbserver1.inventory.customers'
FORMAT AVRO USING CONFLUENT SCHEMA REGISTRY 'http://redpanda:8081'
ENVELOPE DEBEZIUM;
11:38:42.429435 [debug] [Thread-1  ]: Postgres adapter: Postgres error: fetching latest schema for subject 'dbserver1.inventory.customers-value' from registry: subject not found

11:38:42.432944 [debug] [Thread-1  ]: finished collecting timing info
11:38:42.434979 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: Close
11:38:42.438103 [debug] [Thread-1  ]: Database Error in model inventory_customers (models/examples/sources/inventory/inventory_customers.sql)
  fetching latest schema for subject 'dbserver1.inventory.customers-value' from registry: subject not found
  compiled SQL at target/run/mz_hack_day/models/examples/sources/inventory/inventory_customers.sql
11:38:42.441070 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf6f859b-ab73-4fe9-9d5a-902d696f5a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x403075a7f0>]}
11:38:42.445150 [error] [Thread-1  ]: 3 of 7 ERROR creating source model public.inventory_customers................... [[31mERROR[0m in 0.62s]
11:38:42.448504 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.inventory_customers
11:38:42.450751 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_flight_information
11:38:42.453116 [info ] [Thread-1  ]: 4 of 7 START source model public.rp_flight_information.......................... [RUN]
11:38:42.456885 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_flight_information"
11:38:42.459257 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_flight_information
11:38:42.461685 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_flight_information
11:38:42.483097 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_flight_information"
11:38:42.490692 [debug] [Thread-1  ]: finished collecting timing info
11:38:42.493434 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_flight_information
11:38:42.504535 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:38:42.507286 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */
drop source if exists 
      materialize.public.rp_flight_information
   cascade
11:38:42.509247 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:38:42.515396 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:38:42.524639 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_flight_information"
11:38:42.531354 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:38:42.533453 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */




CREATE SOURCE 
    materialize.public.rp_flight_information

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'flight_information'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
11:38:42.545275 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:38:42.554878 [debug] [Thread-1  ]: finished collecting timing info
11:38:42.557828 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: Close
11:38:42.561687 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf6f859b-ab73-4fe9-9d5a-902d696f5a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40307706a0>]}
11:38:42.564985 [info ] [Thread-1  ]: 4 of 7 OK created source model public.rp_flight_information..................... [[32mCREATE SOURCE[0m in 0.11s]
11:38:42.567898 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_flight_information
11:38:42.570290 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_icao_mapping
11:38:42.573024 [info ] [Thread-1  ]: 5 of 7 START view model public.stg_icao_mapping................................. [RUN]
11:38:42.577052 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_icao_mapping"
11:38:42.579275 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_icao_mapping
11:38:42.581160 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_icao_mapping
11:38:42.602595 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_icao_mapping"
11:38:42.610107 [debug] [Thread-1  ]: finished collecting timing info
11:38:42.612346 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_icao_mapping
11:38:42.634009 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:38:42.637701 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
drop view if exists "materialize"."public"."stg_icao_mapping" cascade
11:38:42.640061 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:38:42.645870 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:38:42.655915 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_icao_mapping"
11:38:42.664601 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:38:42.666584 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
create view "materialize"."public"."stg_icao_mapping"
  as (
    /*

The purpose of this staging model is to create a icao_mapping staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."icao_mapping"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

    (data->>'icao24')::string AS icao24,
           (data->>'manufacturericao')::string AS manufacturericao,
           (data->>'manufacturername')::string AS manufacturername,
           (data->>'model')::string AS model,
           (data->>'typecode')::string AS typecode,
           (data->>'icaoaircrafttype')::string AS icaoaircrafttype,
           (data->>'operator')::string AS operator,
           (data->>'operatorcallsign')::string AS operatorcallsign,
           (data->>'operatoricao')::string AS operatoricao,
           (data->>'built')::string AS built,
           (data->>'categorydescription')::string AS categorydescription

    FROM casted

)

SELECT * FROM renamed
  );
11:38:42.678667 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:38:42.689050 [debug] [Thread-1  ]: finished collecting timing info
11:38:42.691292 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: Close
11:38:42.694619 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf6f859b-ab73-4fe9-9d5a-902d696f5a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x403079ee50>]}
11:38:42.698106 [info ] [Thread-1  ]: 5 of 7 OK created view model public.stg_icao_mapping............................ [[32mCREATE VIEW[0m in 0.12s]
11:38:42.701178 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_icao_mapping
11:38:42.703896 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_flight_information
11:38:42.706473 [info ] [Thread-1  ]: 6 of 7 START view model public.stg_flight_information........................... [RUN]
11:38:42.710083 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_flight_information"
11:38:42.712173 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_flight_information
11:38:42.714732 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_flight_information
11:38:42.737100 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_flight_information"
11:38:42.744775 [debug] [Thread-1  ]: finished collecting timing info
11:38:42.746850 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_flight_information
11:38:42.764927 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:38:42.768010 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
drop view if exists "materialize"."public"."stg_flight_information" cascade
11:38:42.770457 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:38:42.779064 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:38:42.789512 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_flight_information"
11:38:42.796840 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:38:42.799351 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
create view "materialize"."public"."stg_flight_information"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_flight_information"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'icao24')::string as icao24,
       (data->>'callsign')::string as callsign,
       (data->>'origin_country')::string as origin_country,
       (data->>'time_position')::numeric as time_position,
       (data->>'last_contact')::numeric as last_contact,
       (data->>'longitude')::double as longitude,
       (data->>'latitude')::double as latitude,
       (data->>'baro_altitude')::double as baro_altitude,
       (data->>'on_ground')::boolean as on_ground,
       (data->>'velocity')::double as velocity,
       (data->>'true_track')::double as true_track,
       (data->>'vertical_rate')::string as vertical_rate,
       (data->>'sensors')::string as sensors,
       (data->>'geo_altitude')::string as geo_altitude,
       (data->>'squawk')::string as squawk,
       (data->>'spi')::string as spi,
       (data->>'position_source')::string as position_source

    FROM casted

)

SELECT * FROM renamed
  );
11:38:42.808627 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:38:42.819077 [debug] [Thread-1  ]: finished collecting timing info
11:38:42.821668 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: Close
11:38:42.825653 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf6f859b-ab73-4fe9-9d5a-902d696f5a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c17670>]}
11:38:42.828967 [info ] [Thread-1  ]: 6 of 7 OK created view model public.stg_flight_information...................... [[32mCREATE VIEW[0m in 0.12s]
11:38:42.831967 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_flight_information
11:38:42.837344 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_flight
11:38:42.839939 [info ] [Thread-1  ]: 7 of 7 START materializedview model public.fct_flight........................... [RUN]
11:38:42.843357 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_flight"
11:38:42.845376 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_flight
11:38:42.847326 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_flight
11:38:42.868568 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_flight"
11:38:42.878280 [debug] [Thread-1  ]: finished collecting timing info
11:38:42.880493 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_flight
11:38:42.936139 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:38:42.939417 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
drop view if exists "materialize"."public"."fct_flight" cascade
11:38:42.941920 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:38:42.947609 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:38:42.965547 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_flight"
11:38:42.974841 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:38:42.977686 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
create materialized view "materialize"."public"."fct_flight"
  as (
    


SELECT fi.icao24,
       manufacturername,
       model,
       operator,
       origin_country,
       time_position,
       longitude,
       latitude
FROM "materialize"."public"."stg_flight_information" fi
JOIN "materialize"."public"."stg_icao_mapping" icao ON fi.icao24 = icao.icao24
  );
11:38:42.990354 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:38:43.002886 [debug] [Thread-1  ]: finished collecting timing info
11:38:43.006467 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: Close
11:38:43.010313 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf6f859b-ab73-4fe9-9d5a-902d696f5a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x403076f340>]}
11:38:43.013811 [info ] [Thread-1  ]: 7 of 7 OK created materializedview model public.fct_flight...................... [[32mCREATE VIEW[0m in 0.17s]
11:38:43.017382 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_flight
11:38:43.024134 [debug] [MainThread]: Acquiring new materialize connection "master"
11:38:43.029691 [debug] [MainThread]: Using materialize connection "master"
11:38:43.033886 [debug] [MainThread]: On master: BEGIN
11:38:43.037026 [debug] [MainThread]: Opening a new connection, currently in state closed
11:38:43.045333 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:38:43.051589 [debug] [MainThread]: Using materialize connection "master"
11:38:43.055408 [debug] [MainThread]: On master: COMMIT
11:38:43.058800 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:38:43.062958 [debug] [MainThread]: On master: Close
11:38:43.067829 [info ] [MainThread]: 
11:38:43.071977 [info ] [MainThread]: Finished running 3 view models, 3 source models, 1 materializedview model in 2.14s.
11:38:43.076028 [debug] [MainThread]: Connection 'master' was properly closed.
11:38:43.079909 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_flight' was properly closed.
11:38:43.129452 [info ] [MainThread]: 
11:38:43.131934 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
11:38:43.135024 [info ] [MainThread]: 
11:38:43.138415 [error] [MainThread]: [33mDatabase Error in model fct_inventory (models/examples/marts/inventory/fct_inventory.sql)[0m
11:38:43.142135 [error] [MainThread]:   Expected SELECT, VALUES, or a subquery in the query body, found CREATE
11:38:43.145955 [error] [MainThread]:   LINE 4:     CREATE MATERIALIZED VIEW inventory_customers_view AS
11:38:43.151312 [error] [MainThread]:               ^
11:38:43.154596 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/examples/marts/inventory/fct_inventory.sql
11:38:43.158975 [info ] [MainThread]: 
11:38:43.162766 [error] [MainThread]: [33mDatabase Error in model inventory_customers (models/examples/sources/inventory/inventory_customers.sql)[0m
11:38:43.166435 [error] [MainThread]:   fetching latest schema for subject 'dbserver1.inventory.customers-value' from registry: subject not found
11:38:43.169977 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/examples/sources/inventory/inventory_customers.sql
11:38:43.173515 [info ] [MainThread]: 
11:38:43.176685 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
11:38:43.180956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4030770c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4030770f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x404a0ccf70>]}


============================== 2022-02-19 11:41:47.588925 | b2725de8-4272-4dda-804c-f845307591e1 ==============================
11:41:47.588925 [info ] [MainThread]: Running with dbt=1.0.1
11:41:47.598349 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
11:41:47.601215 [debug] [MainThread]: Tracking: tracking
11:41:47.632769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abdc0>]}
11:41:48.027032 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
11:41:48.029781 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
11:41:48.034568 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.examples
- models.templates

11:41:48.082099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2725de8-4272-4dda-804c-f845307591e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073d70d0>]}
11:41:48.147109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2725de8-4272-4dda-804c-f845307591e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007324190>]}
11:41:48.154296 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
11:41:48.166218 [info ] [MainThread]: 
11:41:48.173331 [debug] [MainThread]: Acquiring new materialize connection "master"
11:41:48.196254 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
11:41:48.283100 [debug] [ThreadPool]: Using materialize connection "list_materialize"
11:41:48.286412 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
11:41:48.288378 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:41:48.321402 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
11:41:48.332818 [debug] [ThreadPool]: On list_materialize: Close
11:41:48.344126 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
11:41:48.368773 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
11:41:48.371873 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
11:41:48.374325 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:41:48.381234 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
11:41:48.390823 [debug] [ThreadPool]: On list_materialize_public: Close
11:41:48.399177 [debug] [MainThread]: Using materialize connection "master"
11:41:48.401448 [debug] [MainThread]: On master: BEGIN
11:41:48.403396 [debug] [MainThread]: Opening a new connection, currently in state init
11:41:48.408925 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:41:48.412404 [debug] [MainThread]: Using materialize connection "master"
11:41:48.414569 [debug] [MainThread]: On master: COMMIT
11:41:48.417276 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:41:48.419391 [debug] [MainThread]: On master: Close
11:41:48.422219 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
11:41:48.424845 [info ] [MainThread]: 
11:41:48.443656 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_inventory
11:41:48.448763 [info ] [Thread-1  ]: 1 of 7 START view model public.fct_inventory.................................... [RUN]
11:41:48.453878 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_inventory"
11:41:48.456525 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_inventory
11:41:48.458902 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_inventory
11:41:48.469109 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_inventory"
11:41:48.480699 [debug] [Thread-1  ]: finished collecting timing info
11:41:48.483413 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_inventory
11:41:48.569169 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_inventory"
11:41:48.576170 [debug] [Thread-1  ]: On model.mz_hack_day.fct_inventory: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_inventory"} */
drop view if exists "materialize"."public"."fct_inventory" cascade
11:41:48.578555 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:41:48.584872 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:41:48.646711 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_inventory"
11:41:48.655131 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_inventory"
11:41:48.657448 [debug] [Thread-1  ]: On model.mz_hack_day.fct_inventory: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_inventory"} */
create view "materialize"."public"."fct_inventory"
  as (
    CREATE MATERIALIZED VIEW inventory_customers_view AS
SELECT * FROM inventory_customers;
  );
11:41:48.661341 [debug] [Thread-1  ]: Postgres adapter: Postgres error: Expected SELECT, VALUES, or a subquery in the query body, found CREATE
LINE 4:     CREATE MATERIALIZED VIEW inventory_customers_view AS
            ^

11:41:48.664276 [debug] [Thread-1  ]: finished collecting timing info
11:41:48.666354 [debug] [Thread-1  ]: On model.mz_hack_day.fct_inventory: Close
11:41:48.670125 [debug] [Thread-1  ]: Database Error in model fct_inventory (models/examples/marts/inventory/fct_inventory.sql)
  Expected SELECT, VALUES, or a subquery in the query body, found CREATE
  LINE 4:     CREATE MATERIALIZED VIEW inventory_customers_view AS
              ^
  compiled SQL at target/run/mz_hack_day/models/examples/marts/inventory/fct_inventory.sql
11:41:48.674118 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2725de8-4272-4dda-804c-f845307591e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40295f0bb0>]}
11:41:48.677831 [error] [Thread-1  ]: 1 of 7 ERROR creating view model public.fct_inventory........................... [[31mERROR[0m in 0.22s]
11:41:48.682192 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_inventory
11:41:48.685165 [debug] [Thread-1  ]: Began running node model.mz_hack_day.icao_mapping
11:41:48.688889 [info ] [Thread-1  ]: 2 of 7 START source model public.icao_mapping................................... [RUN]
11:41:48.692623 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.icao_mapping"
11:41:48.694865 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.icao_mapping
11:41:48.697474 [debug] [Thread-1  ]: Compiling model.mz_hack_day.icao_mapping
11:41:48.735250 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.icao_mapping"
11:41:48.743785 [debug] [Thread-1  ]: finished collecting timing info
11:41:48.745964 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.icao_mapping
11:41:48.808503 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:41:48.811553 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */
drop source if exists 
      materialize.public.icao_mapping
   cascade
11:41:48.814101 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:41:48.824835 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:41:48.840709 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.icao_mapping"
11:41:48.846536 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:41:48.849171 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */




CREATE SOURCE 
    materialize.public.icao_mapping

FROM FILE '/tmp/icao24_mapping_airbus.json.gz' COMPRESSION GZIP
FORMAT BYTES;
11:41:48.858772 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:41:48.916597 [debug] [Thread-1  ]: finished collecting timing info
11:41:48.919627 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: Close
11:41:48.923336 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2725de8-4272-4dda-804c-f845307591e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400747c3d0>]}
11:41:48.926503 [info ] [Thread-1  ]: 2 of 7 OK created source model public.icao_mapping.............................. [[32mCREATE SOURCE[0m in 0.23s]
11:41:48.929470 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.icao_mapping
11:41:48.931723 [debug] [Thread-1  ]: Began running node model.mz_hack_day.inventory_customers
11:41:48.934683 [info ] [Thread-1  ]: 3 of 7 START source model public.inventory_customers............................ [RUN]
11:41:48.938621 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.inventory_customers"
11:41:48.941026 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.inventory_customers
11:41:48.942937 [debug] [Thread-1  ]: Compiling model.mz_hack_day.inventory_customers
11:41:48.965126 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.inventory_customers"
11:41:48.972305 [debug] [Thread-1  ]: finished collecting timing info
11:41:48.974976 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.inventory_customers
11:41:48.986361 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:41:48.988436 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */
drop source if exists 
      materialize.public.inventory_customers
   cascade
11:41:48.990241 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:41:48.996831 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:41:49.006264 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.inventory_customers"
11:41:49.014428 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:41:49.016591 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */




CREATE SOURCE 
    materialize.public.inventory_customers

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'dbserver1.inventory.customers'
FORMAT AVRO USING CONFLUENT SCHEMA REGISTRY 'http://redpanda:8081'
ENVELOPE DEBEZIUM;
11:41:49.039507 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.02 seconds
11:41:49.049792 [debug] [Thread-1  ]: finished collecting timing info
11:41:49.052732 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: Close
11:41:49.056536 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2725de8-4272-4dda-804c-f845307591e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4029630a00>]}
11:41:49.060243 [info ] [Thread-1  ]: 3 of 7 OK created source model public.inventory_customers....................... [[32mCREATE SOURCE[0m in 0.12s]
11:41:49.063438 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.inventory_customers
11:41:49.066231 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_flight_information
11:41:49.069153 [info ] [Thread-1  ]: 4 of 7 START source model public.rp_flight_information.......................... [RUN]
11:41:49.073533 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_flight_information"
11:41:49.077157 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_flight_information
11:41:49.079208 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_flight_information
11:41:49.102059 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_flight_information"
11:41:49.108606 [debug] [Thread-1  ]: finished collecting timing info
11:41:49.111386 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_flight_information
11:41:49.122133 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:41:49.124417 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */
drop source if exists 
      materialize.public.rp_flight_information
   cascade
11:41:49.126341 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:41:49.136813 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:41:49.150637 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_flight_information"
11:41:49.157148 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:41:49.160789 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */




CREATE SOURCE 
    materialize.public.rp_flight_information

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'flight_information'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
11:41:49.170839 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:41:49.182822 [debug] [Thread-1  ]: finished collecting timing info
11:41:49.185735 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: Close
11:41:49.189634 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2725de8-4272-4dda-804c-f845307591e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x402964a670>]}
11:41:49.193431 [info ] [Thread-1  ]: 4 of 7 OK created source model public.rp_flight_information..................... [[32mCREATE SOURCE[0m in 0.12s]
11:41:49.196586 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_flight_information
11:41:49.198947 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_icao_mapping
11:41:49.202226 [info ] [Thread-1  ]: 5 of 7 START view model public.stg_icao_mapping................................. [RUN]
11:41:49.206065 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_icao_mapping"
11:41:49.209871 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_icao_mapping
11:41:49.212509 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_icao_mapping
11:41:49.234487 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_icao_mapping"
11:41:49.242487 [debug] [Thread-1  ]: finished collecting timing info
11:41:49.245292 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_icao_mapping
11:41:49.263723 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:41:49.266681 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
drop view if exists "materialize"."public"."stg_icao_mapping" cascade
11:41:49.268853 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:41:49.274274 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:41:49.284718 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_icao_mapping"
11:41:49.292546 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:41:49.294685 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
create view "materialize"."public"."stg_icao_mapping"
  as (
    /*

The purpose of this staging model is to create a icao_mapping staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."icao_mapping"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

    (data->>'icao24')::string AS icao24,
           (data->>'manufacturericao')::string AS manufacturericao,
           (data->>'manufacturername')::string AS manufacturername,
           (data->>'model')::string AS model,
           (data->>'typecode')::string AS typecode,
           (data->>'icaoaircrafttype')::string AS icaoaircrafttype,
           (data->>'operator')::string AS operator,
           (data->>'operatorcallsign')::string AS operatorcallsign,
           (data->>'operatoricao')::string AS operatoricao,
           (data->>'built')::string AS built,
           (data->>'categorydescription')::string AS categorydescription

    FROM casted

)

SELECT * FROM renamed
  );
11:41:49.302851 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:41:49.313271 [debug] [Thread-1  ]: finished collecting timing info
11:41:49.316133 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: Close
11:41:49.320287 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2725de8-4272-4dda-804c-f845307591e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4029604790>]}
11:41:49.323605 [info ] [Thread-1  ]: 5 of 7 OK created view model public.stg_icao_mapping............................ [[32mCREATE VIEW[0m in 0.11s]
11:41:49.326557 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_icao_mapping
11:41:49.329382 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_flight_information
11:41:49.331928 [info ] [Thread-1  ]: 6 of 7 START view model public.stg_flight_information........................... [RUN]
11:41:49.335818 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_flight_information"
11:41:49.338423 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_flight_information
11:41:49.342623 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_flight_information
11:41:49.367824 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_flight_information"
11:41:49.375247 [debug] [Thread-1  ]: finished collecting timing info
11:41:49.378136 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_flight_information
11:41:49.396625 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:41:49.399690 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
drop view if exists "materialize"."public"."stg_flight_information" cascade
11:41:49.403133 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:41:49.409417 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:41:49.419752 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_flight_information"
11:41:49.426292 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:41:49.428607 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
create view "materialize"."public"."stg_flight_information"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_flight_information"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'icao24')::string as icao24,
       (data->>'callsign')::string as callsign,
       (data->>'origin_country')::string as origin_country,
       (data->>'time_position')::numeric as time_position,
       (data->>'last_contact')::numeric as last_contact,
       (data->>'longitude')::double as longitude,
       (data->>'latitude')::double as latitude,
       (data->>'baro_altitude')::double as baro_altitude,
       (data->>'on_ground')::boolean as on_ground,
       (data->>'velocity')::double as velocity,
       (data->>'true_track')::double as true_track,
       (data->>'vertical_rate')::string as vertical_rate,
       (data->>'sensors')::string as sensors,
       (data->>'geo_altitude')::string as geo_altitude,
       (data->>'squawk')::string as squawk,
       (data->>'spi')::string as spi,
       (data->>'position_source')::string as position_source

    FROM casted

)

SELECT * FROM renamed
  );
11:41:49.438125 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:41:49.447877 [debug] [Thread-1  ]: finished collecting timing info
11:41:49.450472 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: Close
11:41:49.454163 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2725de8-4272-4dda-804c-f845307591e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400747cbe0>]}
11:41:49.457581 [info ] [Thread-1  ]: 6 of 7 OK created view model public.stg_flight_information...................... [[32mCREATE VIEW[0m in 0.12s]
11:41:49.460760 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_flight_information
11:41:49.466322 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_flight
11:41:49.469247 [info ] [Thread-1  ]: 7 of 7 START materializedview model public.fct_flight........................... [RUN]
11:41:49.473047 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_flight"
11:41:49.476896 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_flight
11:41:49.479521 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_flight
11:41:49.502353 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_flight"
11:41:49.510472 [debug] [Thread-1  ]: finished collecting timing info
11:41:49.512800 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_flight
11:41:49.569591 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:41:49.572605 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
drop view if exists "materialize"."public"."fct_flight" cascade
11:41:49.575971 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:41:49.582132 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:41:49.601388 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_flight"
11:41:49.610372 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:41:49.613171 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
create materialized view "materialize"."public"."fct_flight"
  as (
    


SELECT fi.icao24,
       manufacturername,
       model,
       operator,
       origin_country,
       time_position,
       longitude,
       latitude
FROM "materialize"."public"."stg_flight_information" fi
JOIN "materialize"."public"."stg_icao_mapping" icao ON fi.icao24 = icao.icao24
  );
11:41:49.628965 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:41:49.649516 [debug] [Thread-1  ]: finished collecting timing info
11:41:49.652466 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: Close
11:41:49.656841 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2725de8-4272-4dda-804c-f845307591e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4029656eb0>]}
11:41:49.661332 [info ] [Thread-1  ]: 7 of 7 OK created materializedview model public.fct_flight...................... [[32mCREATE VIEW[0m in 0.18s]
11:41:49.664937 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_flight
11:41:49.671351 [debug] [MainThread]: Acquiring new materialize connection "master"
11:41:49.674271 [debug] [MainThread]: Using materialize connection "master"
11:41:49.678894 [debug] [MainThread]: On master: BEGIN
11:41:49.681253 [debug] [MainThread]: Opening a new connection, currently in state closed
11:41:49.686862 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:41:49.689429 [debug] [MainThread]: Using materialize connection "master"
11:41:49.693093 [debug] [MainThread]: On master: COMMIT
11:41:49.696305 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:41:49.699337 [debug] [MainThread]: On master: Close
11:41:49.703453 [info ] [MainThread]: 
11:41:49.706398 [info ] [MainThread]: Finished running 3 view models, 3 source models, 1 materializedview model in 1.53s.
11:41:49.709437 [debug] [MainThread]: Connection 'master' was properly closed.
11:41:49.711676 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_flight' was properly closed.
11:41:49.752285 [info ] [MainThread]: 
11:41:49.755289 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
11:41:49.758167 [info ] [MainThread]: 
11:41:49.760672 [error] [MainThread]: [33mDatabase Error in model fct_inventory (models/examples/marts/inventory/fct_inventory.sql)[0m
11:41:49.763329 [error] [MainThread]:   Expected SELECT, VALUES, or a subquery in the query body, found CREATE
11:41:49.765887 [error] [MainThread]:   LINE 4:     CREATE MATERIALIZED VIEW inventory_customers_view AS
11:41:49.769323 [error] [MainThread]:               ^
11:41:49.772741 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/examples/marts/inventory/fct_inventory.sql
11:41:49.776672 [info ] [MainThread]: 
11:41:49.779843 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
11:41:49.783770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x402961c130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4029643670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40296600d0>]}


============================== 2022-02-19 11:49:34.943407 | 7cff2cd1-a53b-4abc-bff3-2f5b2626e8c1 ==============================
11:49:34.943407 [info ] [MainThread]: Running with dbt=1.0.1
11:49:34.951439 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
11:49:34.954102 [debug] [MainThread]: Tracking: tracking
11:49:34.989442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe20>]}
11:49:35.369920 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
11:49:35.373478 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/examples/staging/inventory/stg_inventory_customers.sql
11:49:35.376426 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/examples/staging/inventory/stg_inventory.yml
11:49:35.379411 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/examples/marts/inventory/fct_inventory.yml
11:49:35.382545 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/examples/marts/inventory/fct_inventory.sql
11:49:35.506591 [debug] [MainThread]: 1699: static parser successfully parsed examples/staging/inventory/stg_inventory_customers.sql
11:49:35.601465 [debug] [MainThread]: 1699: static parser successfully parsed examples/marts/inventory/fct_inventory.sql
11:49:35.699384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073ba130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073bfac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073bf9a0>]}


============================== 2022-02-19 11:50:19.314172 | da75f871-68ca-4f9c-9fcb-873feea984d0 ==============================
11:50:19.314172 [info ] [MainThread]: Running with dbt=1.0.1
11:50:19.327714 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
11:50:19.330842 [debug] [MainThread]: Tracking: tracking
11:50:19.360014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abdf0>]}
11:50:19.751002 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
11:50:19.754643 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/examples/marts/inventory/fct_inventory.yml
11:50:19.757444 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/examples/staging/inventory/stg_inventory_customers.sql
11:50:19.760552 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/examples/staging/inventory/stg_inventory.yml
11:50:19.764361 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/examples/marts/inventory/fct_inventory.sql
11:50:19.880497 [debug] [MainThread]: 1699: static parser successfully parsed examples/staging/inventory/stg_inventory_customers.sql
11:50:19.982255 [debug] [MainThread]: 1699: static parser successfully parsed examples/marts/inventory/fct_inventory.sql
11:50:20.126121 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.templates
- models.examples

11:50:20.168257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da75f871-68ca-4f9c-9fcb-873feea984d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c300d0>]}
11:50:20.227208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da75f871-68ca-4f9c-9fcb-873feea984d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400739ce50>]}
11:50:20.230380 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
11:50:20.241166 [info ] [MainThread]: 
11:50:20.245428 [debug] [MainThread]: Acquiring new materialize connection "master"
11:50:20.256330 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
11:50:20.335734 [debug] [ThreadPool]: Using materialize connection "list_materialize"
11:50:20.339292 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
11:50:20.342539 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:50:20.373123 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
11:50:20.384565 [debug] [ThreadPool]: On list_materialize: Close
11:50:20.400573 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
11:50:20.426220 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
11:50:20.429758 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
11:50:20.432177 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:50:20.439017 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
11:50:20.448770 [debug] [ThreadPool]: On list_materialize_public: Close
11:50:20.457342 [debug] [MainThread]: Using materialize connection "master"
11:50:20.459701 [debug] [MainThread]: On master: BEGIN
11:50:20.461751 [debug] [MainThread]: Opening a new connection, currently in state init
11:50:20.467473 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:50:20.470345 [debug] [MainThread]: Using materialize connection "master"
11:50:20.472851 [debug] [MainThread]: On master: COMMIT
11:50:20.475724 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:50:20.477605 [debug] [MainThread]: On master: Close
11:50:20.480677 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
11:50:20.483558 [info ] [MainThread]: 
11:50:20.509830 [debug] [Thread-1  ]: Began running node model.mz_hack_day.icao_mapping
11:50:20.513623 [info ] [Thread-1  ]: 1 of 8 START source model public.icao_mapping................................... [RUN]
11:50:20.518177 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.icao_mapping"
11:50:20.520345 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.icao_mapping
11:50:20.522458 [debug] [Thread-1  ]: Compiling model.mz_hack_day.icao_mapping
11:50:20.556738 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.icao_mapping"
11:50:20.562846 [debug] [Thread-1  ]: finished collecting timing info
11:50:20.565814 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.icao_mapping
11:50:20.632677 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:50:20.636379 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */
drop source if exists 
      materialize.public.icao_mapping
   cascade
11:50:20.639514 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:50:20.652324 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:50:20.703563 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.icao_mapping"
11:50:20.711204 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:50:20.713425 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */




CREATE SOURCE 
    materialize.public.icao_mapping

FROM FILE '/tmp/icao24_mapping_airbus.json.gz' COMPRESSION GZIP
FORMAT BYTES;
11:50:20.723700 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:50:20.778131 [debug] [Thread-1  ]: finished collecting timing info
11:50:20.781372 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: Close
11:50:20.785201 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da75f871-68ca-4f9c-9fcb-873feea984d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073b3af0>]}
11:50:20.789235 [info ] [Thread-1  ]: 1 of 8 OK created source model public.icao_mapping.............................. [[32mCREATE SOURCE[0m in 0.27s]
11:50:20.793027 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.icao_mapping
11:50:20.795675 [debug] [Thread-1  ]: Began running node model.mz_hack_day.inventory_customers
11:50:20.798320 [info ] [Thread-1  ]: 2 of 8 START source model public.inventory_customers............................ [RUN]
11:50:20.802633 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.inventory_customers"
11:50:20.807233 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.inventory_customers
11:50:20.813970 [debug] [Thread-1  ]: Compiling model.mz_hack_day.inventory_customers
11:50:20.838159 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.inventory_customers"
11:50:20.846138 [debug] [Thread-1  ]: finished collecting timing info
11:50:20.848448 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.inventory_customers
11:50:20.859568 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:50:20.862295 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */
drop source if exists 
      materialize.public.inventory_customers
   cascade
11:50:20.864425 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:50:20.874550 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:50:20.883690 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.inventory_customers"
11:50:20.888947 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:50:20.891201 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */




CREATE SOURCE 
    materialize.public.inventory_customers

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'dbserver1.inventory.customers'
FORMAT AVRO USING CONFLUENT SCHEMA REGISTRY 'http://redpanda:8081'
ENVELOPE DEBEZIUM;
11:50:20.908379 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.02 seconds
11:50:20.920085 [debug] [Thread-1  ]: finished collecting timing info
11:50:20.922523 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: Close
11:50:20.926326 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da75f871-68ca-4f9c-9fcb-873feea984d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f2aa30>]}
11:50:20.929624 [info ] [Thread-1  ]: 2 of 8 OK created source model public.inventory_customers....................... [[32mCREATE SOURCE[0m in 0.12s]
11:50:20.932483 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.inventory_customers
11:50:20.935249 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_flight_information
11:50:20.938714 [info ] [Thread-1  ]: 3 of 8 START source model public.rp_flight_information.......................... [RUN]
11:50:20.942492 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_flight_information"
11:50:20.944833 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_flight_information
11:50:20.947024 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_flight_information
11:50:20.967995 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_flight_information"
11:50:20.975504 [debug] [Thread-1  ]: finished collecting timing info
11:50:20.978072 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_flight_information
11:50:20.989414 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:50:20.991928 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */
drop source if exists 
      materialize.public.rp_flight_information
   cascade
11:50:20.994043 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:50:21.002738 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:50:21.010992 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_flight_information"
11:50:21.016118 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:50:21.018043 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */




CREATE SOURCE 
    materialize.public.rp_flight_information

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'flight_information'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
11:50:21.027440 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:50:21.038304 [debug] [Thread-1  ]: finished collecting timing info
11:50:21.040973 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: Close
11:50:21.044595 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da75f871-68ca-4f9c-9fcb-873feea984d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f361c0>]}
11:50:21.048128 [info ] [Thread-1  ]: 3 of 8 OK created source model public.rp_flight_information..................... [[32mCREATE SOURCE[0m in 0.10s]
11:50:21.051202 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_flight_information
11:50:21.053575 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_icao_mapping
11:50:21.056567 [info ] [Thread-1  ]: 4 of 8 START view model public.stg_icao_mapping................................. [RUN]
11:50:21.060377 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_icao_mapping"
11:50:21.062698 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_icao_mapping
11:50:21.064844 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_icao_mapping
11:50:21.085941 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_icao_mapping"
11:50:21.093493 [debug] [Thread-1  ]: finished collecting timing info
11:50:21.095827 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_icao_mapping
11:50:21.173019 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:50:21.175857 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
drop view if exists "materialize"."public"."stg_icao_mapping" cascade
11:50:21.178150 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:50:21.185271 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:50:21.213299 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_icao_mapping"
11:50:21.220522 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:50:21.223108 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
create view "materialize"."public"."stg_icao_mapping"
  as (
    /*

The purpose of this staging model is to create a icao_mapping staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."icao_mapping"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

    (data->>'icao24')::string AS icao24,
           (data->>'manufacturericao')::string AS manufacturericao,
           (data->>'manufacturername')::string AS manufacturername,
           (data->>'model')::string AS model,
           (data->>'typecode')::string AS typecode,
           (data->>'icaoaircrafttype')::string AS icaoaircrafttype,
           (data->>'operator')::string AS operator,
           (data->>'operatorcallsign')::string AS operatorcallsign,
           (data->>'operatoricao')::string AS operatoricao,
           (data->>'built')::string AS built,
           (data->>'categorydescription')::string AS categorydescription

    FROM casted

)

SELECT * FROM renamed
  );
11:50:21.232470 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:50:21.242787 [debug] [Thread-1  ]: finished collecting timing info
11:50:21.245060 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: Close
11:50:21.248423 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da75f871-68ca-4f9c-9fcb-873feea984d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f45130>]}
11:50:21.251937 [info ] [Thread-1  ]: 4 of 8 OK created view model public.stg_icao_mapping............................ [[32mCREATE VIEW[0m in 0.19s]
11:50:21.254853 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_icao_mapping
11:50:21.257186 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_inventory_customers
11:50:21.259640 [info ] [Thread-1  ]: 5 of 8 START view model public.stg_inventory_customers.......................... [RUN]
11:50:21.263720 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_inventory_customers"
11:50:21.266333 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_inventory_customers
11:50:21.268372 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_inventory_customers
11:50:21.287083 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_inventory_customers"
11:50:21.296325 [debug] [Thread-1  ]: finished collecting timing info
11:50:21.299282 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_inventory_customers
11:50:21.321513 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_inventory_customers"
11:50:21.324639 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_inventory_customers"} */
drop view if exists "materialize"."public"."stg_inventory_customers" cascade
11:50:21.327223 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:50:21.333180 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:50:21.343507 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_inventory_customers"
11:50:21.352129 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_inventory_customers"
11:50:21.354217 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_inventory_customers"} */
create view "materialize"."public"."stg_inventory_customers"
  as (
    /*

The purpose of this model is to create an inventory_customers staging model.

 */





WITH source AS (

    SELECT * FROM "materialize"."public"."inventory_customers"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'id')::numeric as id,
       (data->>'first_name')::string as first_name,
       (data->>'last_name')::string as last_name,
       (data->>'email')::string as email

    FROM casted

)

SELECT * FROM renamed
  );
11:50:21.358316 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "data" does not exist

11:50:21.361196 [debug] [Thread-1  ]: finished collecting timing info
11:50:21.363211 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: Close
11:50:21.366179 [debug] [Thread-1  ]: Database Error in model stg_inventory_customers (models/examples/staging/inventory/stg_inventory_customers.sql)
  column "data" does not exist
  compiled SQL at target/run/mz_hack_day/models/examples/staging/inventory/stg_inventory_customers.sql
11:50:21.368891 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da75f871-68ca-4f9c-9fcb-873feea984d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f6c2b0>]}
11:50:21.372010 [error] [Thread-1  ]: 5 of 8 ERROR creating view model public.stg_inventory_customers................. [[31mERROR[0m in 0.11s]
11:50:21.375631 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_inventory_customers
11:50:21.377819 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_flight_information
11:50:21.381174 [info ] [Thread-1  ]: 6 of 8 START view model public.stg_flight_information........................... [RUN]
11:50:21.385052 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_flight_information"
11:50:21.387250 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_flight_information
11:50:21.389530 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_flight_information
11:50:21.411226 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_flight_information"
11:50:21.417206 [debug] [Thread-1  ]: finished collecting timing info
11:50:21.419187 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_flight_information
11:50:21.437139 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:50:21.440244 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
drop view if exists "materialize"."public"."stg_flight_information" cascade
11:50:21.442439 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:50:21.448522 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:50:21.460026 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_flight_information"
11:50:21.466281 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:50:21.468598 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
create view "materialize"."public"."stg_flight_information"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_flight_information"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'icao24')::string as icao24,
       (data->>'callsign')::string as callsign,
       (data->>'origin_country')::string as origin_country,
       (data->>'time_position')::numeric as time_position,
       (data->>'last_contact')::numeric as last_contact,
       (data->>'longitude')::double as longitude,
       (data->>'latitude')::double as latitude,
       (data->>'baro_altitude')::double as baro_altitude,
       (data->>'on_ground')::boolean as on_ground,
       (data->>'velocity')::double as velocity,
       (data->>'true_track')::double as true_track,
       (data->>'vertical_rate')::string as vertical_rate,
       (data->>'sensors')::string as sensors,
       (data->>'geo_altitude')::string as geo_altitude,
       (data->>'squawk')::string as squawk,
       (data->>'spi')::string as spi,
       (data->>'position_source')::string as position_source

    FROM casted

)

SELECT * FROM renamed
  );
11:50:21.477528 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:50:21.487239 [debug] [Thread-1  ]: finished collecting timing info
11:50:21.489507 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: Close
11:50:21.493850 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da75f871-68ca-4f9c-9fcb-873feea984d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f35e80>]}
11:50:21.497760 [info ] [Thread-1  ]: 6 of 8 OK created view model public.stg_flight_information...................... [[32mCREATE VIEW[0m in 0.11s]
11:50:21.501045 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_flight_information
11:50:21.504337 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_inventory
11:50:21.511206 [info ] [Thread-1  ]: 7 of 8 SKIP relation public.fct_inventory....................................... [[33mSKIP[0m]
11:50:21.532485 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_inventory
11:50:21.549973 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_flight
11:50:21.578123 [info ] [Thread-1  ]: 8 of 8 START materializedview model public.fct_flight........................... [RUN]
11:50:21.584225 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_flight"
11:50:21.588426 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_flight
11:50:21.594165 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_flight
11:50:21.633819 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_flight"
11:50:21.676948 [debug] [Thread-1  ]: finished collecting timing info
11:50:21.681482 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_flight
11:50:21.745024 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:50:21.749664 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
drop view if exists "materialize"."public"."fct_flight" cascade
11:50:21.751974 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:50:21.758008 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:50:21.775305 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_flight"
11:50:21.784503 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:50:21.786586 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
create materialized view "materialize"."public"."fct_flight"
  as (
    


SELECT fi.icao24,
       manufacturername,
       model,
       operator,
       origin_country,
       time_position,
       longitude,
       latitude
FROM "materialize"."public"."stg_flight_information" fi
JOIN "materialize"."public"."stg_icao_mapping" icao ON fi.icao24 = icao.icao24
  );
11:50:21.797949 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:50:21.810505 [debug] [Thread-1  ]: finished collecting timing info
11:50:21.813495 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: Close
11:50:21.817913 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da75f871-68ca-4f9c-9fcb-873feea984d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073e7b20>]}
11:50:21.821400 [info ] [Thread-1  ]: 8 of 8 OK created materializedview model public.fct_flight...................... [[32mCREATE VIEW[0m in 0.23s]
11:50:21.825142 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_flight
11:50:21.832719 [debug] [MainThread]: Acquiring new materialize connection "master"
11:50:21.836192 [debug] [MainThread]: Using materialize connection "master"
11:50:21.839089 [debug] [MainThread]: On master: BEGIN
11:50:21.841344 [debug] [MainThread]: Opening a new connection, currently in state closed
11:50:21.846572 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:50:21.849485 [debug] [MainThread]: Using materialize connection "master"
11:50:21.851679 [debug] [MainThread]: On master: COMMIT
11:50:21.854268 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:50:21.856378 [debug] [MainThread]: On master: Close
11:50:21.860333 [info ] [MainThread]: 
11:50:21.863405 [info ] [MainThread]: Finished running 3 source models, 3 view models, 2 materializedview models in 1.62s.
11:50:21.866430 [debug] [MainThread]: Connection 'master' was properly closed.
11:50:21.868261 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_flight' was properly closed.
11:50:21.909368 [info ] [MainThread]: 
11:50:21.912790 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
11:50:21.915807 [info ] [MainThread]: 
11:50:21.918362 [error] [MainThread]: [33mDatabase Error in model stg_inventory_customers (models/examples/staging/inventory/stg_inventory_customers.sql)[0m
11:50:21.920705 [error] [MainThread]:   column "data" does not exist
11:50:21.923448 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/examples/staging/inventory/stg_inventory_customers.sql
11:50:21.926310 [info ] [MainThread]: 
11:50:21.928685 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=1 TOTAL=8
11:50:21.931574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f2fc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027dac9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027db31c0>]}


============================== 2022-02-19 11:54:39.818968 | 4f7c8d9e-fdec-4d74-9ca4-a54c83fdd73a ==============================
11:54:39.818968 [info ] [MainThread]: Running with dbt=1.0.1
11:54:39.825652 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
11:54:39.829352 [debug] [MainThread]: Tracking: tracking
11:54:39.865317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abdf0>]}
11:54:40.244179 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
11:54:40.251259 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/examples/staging/inventory/stg_inventory_customers.sql
11:54:40.366917 [debug] [MainThread]: 1699: static parser successfully parsed examples/staging/inventory/stg_inventory_customers.sql
11:54:40.565306 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.templates
- models.examples

11:54:40.609332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f7c8d9e-fdec-4d74-9ca4-a54c83fdd73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2df40>]}
11:54:40.668002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f7c8d9e-fdec-4d74-9ca4-a54c83fdd73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400733cbb0>]}
11:54:40.671461 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
11:54:40.685644 [info ] [MainThread]: 
11:54:40.691455 [debug] [MainThread]: Acquiring new materialize connection "master"
11:54:40.706843 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
11:54:40.783028 [debug] [ThreadPool]: Using materialize connection "list_materialize"
11:54:40.786294 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
11:54:40.788928 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:54:40.822679 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
11:54:40.833653 [debug] [ThreadPool]: On list_materialize: Close
11:54:40.846465 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
11:54:40.870956 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
11:54:40.873480 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
11:54:40.876018 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:54:40.883558 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
11:54:40.893240 [debug] [ThreadPool]: On list_materialize_public: Close
11:54:40.901440 [debug] [MainThread]: Using materialize connection "master"
11:54:40.903835 [debug] [MainThread]: On master: BEGIN
11:54:40.905946 [debug] [MainThread]: Opening a new connection, currently in state init
11:54:40.912033 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:54:40.915266 [debug] [MainThread]: Using materialize connection "master"
11:54:40.917171 [debug] [MainThread]: On master: COMMIT
11:54:40.919910 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:54:40.922166 [debug] [MainThread]: On master: Close
11:54:40.925520 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
11:54:40.928583 [info ] [MainThread]: 
11:54:40.948027 [debug] [Thread-1  ]: Began running node model.mz_hack_day.icao_mapping
11:54:40.953744 [info ] [Thread-1  ]: 1 of 8 START source model public.icao_mapping................................... [RUN]
11:54:40.960698 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.icao_mapping"
11:54:40.963021 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.icao_mapping
11:54:40.965145 [debug] [Thread-1  ]: Compiling model.mz_hack_day.icao_mapping
11:54:41.003928 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.icao_mapping"
11:54:41.011396 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.014164 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.icao_mapping
11:54:41.076459 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:54:41.079792 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */
drop source if exists 
      materialize.public.icao_mapping
   cascade
11:54:41.082155 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:54:41.091794 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:54:41.135396 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.icao_mapping"
11:54:41.142174 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:54:41.144404 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */




CREATE SOURCE 
    materialize.public.icao_mapping

FROM FILE '/tmp/icao24_mapping_airbus.json.gz' COMPRESSION GZIP
FORMAT BYTES;
11:54:41.153518 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:54:41.207711 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.210631 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: Close
11:54:41.214400 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f7c8d9e-fdec-4d74-9ca4-a54c83fdd73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2d8b0>]}
11:54:41.217756 [info ] [Thread-1  ]: 1 of 8 OK created source model public.icao_mapping.............................. [[32mCREATE SOURCE[0m in 0.25s]
11:54:41.221410 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.icao_mapping
11:54:41.224159 [debug] [Thread-1  ]: Began running node model.mz_hack_day.inventory_customers
11:54:41.230532 [info ] [Thread-1  ]: 2 of 8 START source model public.inventory_customers............................ [RUN]
11:54:41.237289 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.inventory_customers"
11:54:41.240891 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.inventory_customers
11:54:41.245629 [debug] [Thread-1  ]: Compiling model.mz_hack_day.inventory_customers
11:54:41.272893 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.inventory_customers"
11:54:41.287676 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.293620 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.inventory_customers
11:54:41.304849 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:54:41.307250 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */
drop source if exists 
      materialize.public.inventory_customers
   cascade
11:54:41.309420 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:54:41.318691 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:54:41.327253 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.inventory_customers"
11:54:41.333481 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:54:41.336901 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */




CREATE SOURCE 
    materialize.public.inventory_customers

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'dbserver1.inventory.customers'
FORMAT AVRO USING CONFLUENT SCHEMA REGISTRY 'http://redpanda:8081'
ENVELOPE DEBEZIUM;
11:54:41.353832 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:54:41.364805 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.367525 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: Close
11:54:41.371487 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f7c8d9e-fdec-4d74-9ca4-a54c83fdd73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c52e50>]}
11:54:41.375233 [info ] [Thread-1  ]: 2 of 8 OK created source model public.inventory_customers....................... [[32mCREATE SOURCE[0m in 0.14s]
11:54:41.378481 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.inventory_customers
11:54:41.381624 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_flight_information
11:54:41.384858 [info ] [Thread-1  ]: 3 of 8 START source model public.rp_flight_information.......................... [RUN]
11:54:41.388529 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_flight_information"
11:54:41.391828 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_flight_information
11:54:41.394361 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_flight_information
11:54:41.416761 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_flight_information"
11:54:41.428457 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.431124 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_flight_information
11:54:41.442909 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:54:41.445724 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */
drop source if exists 
      materialize.public.rp_flight_information
   cascade
11:54:41.447732 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:54:41.456593 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:54:41.465179 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_flight_information"
11:54:41.470361 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:54:41.472505 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */




CREATE SOURCE 
    materialize.public.rp_flight_information

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'flight_information'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
11:54:41.482484 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:54:41.492769 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.495404 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: Close
11:54:41.499182 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f7c8d9e-fdec-4d74-9ca4-a54c83fdd73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f367c0>]}
11:54:41.502560 [info ] [Thread-1  ]: 3 of 8 OK created source model public.rp_flight_information..................... [[32mCREATE SOURCE[0m in 0.11s]
11:54:41.505596 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_flight_information
11:54:41.508519 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_icao_mapping
11:54:41.511769 [info ] [Thread-1  ]: 4 of 8 START view model public.stg_icao_mapping................................. [RUN]
11:54:41.515419 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_icao_mapping"
11:54:41.517527 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_icao_mapping
11:54:41.519756 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_icao_mapping
11:54:41.543657 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_icao_mapping"
11:54:41.551707 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.554585 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_icao_mapping
11:54:41.633639 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:54:41.636692 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
drop view if exists "materialize"."public"."stg_icao_mapping" cascade
11:54:41.638909 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:54:41.645202 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:54:41.672767 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_icao_mapping"
11:54:41.679708 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:54:41.682220 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
create view "materialize"."public"."stg_icao_mapping"
  as (
    /*

The purpose of this staging model is to create a icao_mapping staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."icao_mapping"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

    (data->>'icao24')::string AS icao24,
           (data->>'manufacturericao')::string AS manufacturericao,
           (data->>'manufacturername')::string AS manufacturername,
           (data->>'model')::string AS model,
           (data->>'typecode')::string AS typecode,
           (data->>'icaoaircrafttype')::string AS icaoaircrafttype,
           (data->>'operator')::string AS operator,
           (data->>'operatorcallsign')::string AS operatorcallsign,
           (data->>'operatoricao')::string AS operatoricao,
           (data->>'built')::string AS built,
           (data->>'categorydescription')::string AS categorydescription

    FROM casted

)

SELECT * FROM renamed
  );
11:54:41.691775 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:54:41.703495 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.706238 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: Close
11:54:41.709877 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f7c8d9e-fdec-4d74-9ca4-a54c83fdd73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f36c10>]}
11:54:41.713550 [info ] [Thread-1  ]: 4 of 8 OK created view model public.stg_icao_mapping............................ [[32mCREATE VIEW[0m in 0.20s]
11:54:41.717216 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_icao_mapping
11:54:41.719739 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_inventory_customers
11:54:41.722622 [info ] [Thread-1  ]: 5 of 8 START view model public.stg_inventory_customers.......................... [RUN]
11:54:41.725882 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_inventory_customers"
11:54:41.727947 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_inventory_customers
11:54:41.729939 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_inventory_customers
11:54:41.750181 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_inventory_customers"
11:54:41.758863 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.761438 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_inventory_customers
11:54:41.778750 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_inventory_customers"
11:54:41.781374 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_inventory_customers"} */
drop view if exists "materialize"."public"."stg_inventory_customers" cascade
11:54:41.783433 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:54:41.789314 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:54:41.799265 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_inventory_customers"
11:54:41.806601 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_inventory_customers"
11:54:41.808981 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_inventory_customers"} */
create view "materialize"."public"."stg_inventory_customers"
  as (
    /*

The purpose of this model is to create an inventory_customers staging model.

 */





WITH source AS (

    SELECT * FROM "materialize"."public"."inventory_customers"

),

-- converted AS (
--
--     SELECT convert_from(data, 'utf8') AS data FROM source
--
-- ),

casted AS (

    SELECT cast(source AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'id')::numeric as id,
       (data->>'first_name')::string as first_name,
       (data->>'last_name')::string as last_name,
       (data->>'email')::string as email

    FROM casted

)

SELECT * FROM renamed
  );
11:54:41.813106 [debug] [Thread-1  ]: Postgres adapter: Postgres error: unknown catalog item 'converted'

11:54:41.815734 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.817841 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: Close
11:54:41.820741 [debug] [Thread-1  ]: Database Error in model stg_inventory_customers (models/examples/staging/inventory/stg_inventory_customers.sql)
  unknown catalog item 'converted'
  compiled SQL at target/run/mz_hack_day/models/examples/staging/inventory/stg_inventory_customers.sql
11:54:41.823909 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f7c8d9e-fdec-4d74-9ca4-a54c83fdd73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f8af10>]}
11:54:41.826764 [error] [Thread-1  ]: 5 of 8 ERROR creating view model public.stg_inventory_customers................. [[31mERROR[0m in 0.10s]
11:54:41.829736 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_inventory_customers
11:54:41.832160 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_flight_information
11:54:41.835052 [info ] [Thread-1  ]: 6 of 8 START view model public.stg_flight_information........................... [RUN]
11:54:41.839287 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_flight_information"
11:54:41.841626 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_flight_information
11:54:41.845915 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_flight_information
11:54:41.873508 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_flight_information"
11:54:41.879997 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.882695 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_flight_information
11:54:41.901149 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:54:41.903457 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
drop view if exists "materialize"."public"."stg_flight_information" cascade
11:54:41.906320 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:54:41.912065 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:54:41.921732 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_flight_information"
11:54:41.927575 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:54:41.930397 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
create view "materialize"."public"."stg_flight_information"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_flight_information"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'icao24')::string as icao24,
       (data->>'callsign')::string as callsign,
       (data->>'origin_country')::string as origin_country,
       (data->>'time_position')::numeric as time_position,
       (data->>'last_contact')::numeric as last_contact,
       (data->>'longitude')::double as longitude,
       (data->>'latitude')::double as latitude,
       (data->>'baro_altitude')::double as baro_altitude,
       (data->>'on_ground')::boolean as on_ground,
       (data->>'velocity')::double as velocity,
       (data->>'true_track')::double as true_track,
       (data->>'vertical_rate')::string as vertical_rate,
       (data->>'sensors')::string as sensors,
       (data->>'geo_altitude')::string as geo_altitude,
       (data->>'squawk')::string as squawk,
       (data->>'spi')::string as spi,
       (data->>'position_source')::string as position_source

    FROM casted

)

SELECT * FROM renamed
  );
11:54:41.940260 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:54:41.950275 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.952381 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: Close
11:54:41.955765 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f7c8d9e-fdec-4d74-9ca4-a54c83fdd73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f6e250>]}
11:54:41.958832 [info ] [Thread-1  ]: 6 of 8 OK created view model public.stg_flight_information...................... [[32mCREATE VIEW[0m in 0.12s]
11:54:41.961604 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_flight_information
11:54:41.963594 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_inventory
11:54:41.965915 [info ] [Thread-1  ]: 7 of 8 SKIP relation public.fct_inventory....................................... [[33mSKIP[0m]
11:54:41.968540 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_inventory
11:54:41.970611 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_flight
11:54:41.973663 [info ] [Thread-1  ]: 8 of 8 START materializedview model public.fct_flight........................... [RUN]
11:54:41.978519 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_flight"
11:54:41.983191 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_flight
11:54:41.986706 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_flight
11:54:42.008330 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_flight"
11:54:42.014993 [debug] [Thread-1  ]: finished collecting timing info
11:54:42.017327 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_flight
11:54:42.072497 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:54:42.076156 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
drop view if exists "materialize"."public"."fct_flight" cascade
11:54:42.078818 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:54:42.085244 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:54:42.102594 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_flight"
11:54:42.109494 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:54:42.111676 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
create materialized view "materialize"."public"."fct_flight"
  as (
    


SELECT fi.icao24,
       manufacturername,
       model,
       operator,
       origin_country,
       time_position,
       longitude,
       latitude
FROM "materialize"."public"."stg_flight_information" fi
JOIN "materialize"."public"."stg_icao_mapping" icao ON fi.icao24 = icao.icao24
  );
11:54:42.123730 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:54:42.136736 [debug] [Thread-1  ]: finished collecting timing info
11:54:42.140542 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: Close
11:54:42.144663 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f7c8d9e-fdec-4d74-9ca4-a54c83fdd73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027dc6c70>]}
11:54:42.148844 [info ] [Thread-1  ]: 8 of 8 OK created materializedview model public.fct_flight...................... [[32mCREATE VIEW[0m in 0.17s]
11:54:42.152563 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_flight
11:54:42.159842 [debug] [MainThread]: Acquiring new materialize connection "master"
11:54:42.162549 [debug] [MainThread]: Using materialize connection "master"
11:54:42.165060 [debug] [MainThread]: On master: BEGIN
11:54:42.167363 [debug] [MainThread]: Opening a new connection, currently in state closed
11:54:42.173302 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:54:42.176184 [debug] [MainThread]: Using materialize connection "master"
11:54:42.179157 [debug] [MainThread]: On master: COMMIT
11:54:42.183367 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:54:42.186110 [debug] [MainThread]: On master: Close
11:54:42.189755 [info ] [MainThread]: 
11:54:42.193102 [info ] [MainThread]: Finished running 3 source models, 3 view models, 2 materializedview models in 1.50s.
11:54:42.197492 [debug] [MainThread]: Connection 'master' was properly closed.
11:54:42.199901 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_flight' was properly closed.
11:54:42.242568 [info ] [MainThread]: 
11:54:42.245689 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
11:54:42.248641 [info ] [MainThread]: 
11:54:42.251154 [error] [MainThread]: [33mDatabase Error in model stg_inventory_customers (models/examples/staging/inventory/stg_inventory_customers.sql)[0m
11:54:42.253671 [error] [MainThread]:   unknown catalog item 'converted'
11:54:42.256031 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/examples/staging/inventory/stg_inventory_customers.sql
11:54:42.260528 [info ] [MainThread]: 
11:54:42.264634 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=1 TOTAL=8
11:54:42.268030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f90100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f90160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027dae520>]}


============================== 2022-02-19 11:55:40.517281 | a34945c3-90e7-4533-bd87-76e80692f33a ==============================
11:55:40.517281 [info ] [MainThread]: Running with dbt=1.0.1
11:55:40.526221 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
11:55:40.529211 [debug] [MainThread]: Tracking: tracking
11:55:40.557085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abdf0>]}
11:55:40.927338 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
11:55:40.932192 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/examples/staging/inventory/stg_inventory_customers.sql
11:55:41.045211 [debug] [MainThread]: 1699: static parser successfully parsed examples/staging/inventory/stg_inventory_customers.sql
11:55:41.246377 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.templates
- models.examples

11:55:41.290052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a34945c3-90e7-4533-bd87-76e80692f33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2df40>]}
11:55:41.358441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a34945c3-90e7-4533-bd87-76e80692f33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400733cbb0>]}
11:55:41.362197 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
11:55:41.374039 [info ] [MainThread]: 
11:55:41.378620 [debug] [MainThread]: Acquiring new materialize connection "master"
11:55:41.389973 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
11:55:41.469092 [debug] [ThreadPool]: Using materialize connection "list_materialize"
11:55:41.472188 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
11:55:41.474110 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:55:41.507003 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
11:55:41.518564 [debug] [ThreadPool]: On list_materialize: Close
11:55:41.529823 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
11:55:41.555602 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
11:55:41.558906 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
11:55:41.561063 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:55:41.568558 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
11:55:41.579057 [debug] [ThreadPool]: On list_materialize_public: Close
11:55:41.587811 [debug] [MainThread]: Using materialize connection "master"
11:55:41.590312 [debug] [MainThread]: On master: BEGIN
11:55:41.593113 [debug] [MainThread]: Opening a new connection, currently in state init
11:55:41.598670 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:55:41.601504 [debug] [MainThread]: Using materialize connection "master"
11:55:41.603623 [debug] [MainThread]: On master: COMMIT
11:55:41.606664 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:55:41.609050 [debug] [MainThread]: On master: Close
11:55:41.613426 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
11:55:41.617318 [info ] [MainThread]: 
11:55:41.637315 [debug] [Thread-1  ]: Began running node model.mz_hack_day.icao_mapping
11:55:41.641423 [info ] [Thread-1  ]: 1 of 8 START source model public.icao_mapping................................... [RUN]
11:55:41.647438 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.icao_mapping"
11:55:41.662769 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.icao_mapping
11:55:41.682317 [debug] [Thread-1  ]: Compiling model.mz_hack_day.icao_mapping
11:55:41.735032 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.icao_mapping"
11:55:41.742189 [debug] [Thread-1  ]: finished collecting timing info
11:55:41.744403 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.icao_mapping
11:55:41.806199 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:55:41.809401 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */
drop source if exists 
      materialize.public.icao_mapping
   cascade
11:55:41.811790 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:55:41.822111 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:55:41.865281 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.icao_mapping"
11:55:41.872462 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:55:41.875122 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */




CREATE SOURCE 
    materialize.public.icao_mapping

FROM FILE '/tmp/icao24_mapping_airbus.json.gz' COMPRESSION GZIP
FORMAT BYTES;
11:55:41.886571 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:55:41.939753 [debug] [Thread-1  ]: finished collecting timing info
11:55:41.943066 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: Close
11:55:41.947107 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a34945c3-90e7-4533-bd87-76e80692f33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2de20>]}
11:55:41.950782 [info ] [Thread-1  ]: 1 of 8 OK created source model public.icao_mapping.............................. [[32mCREATE SOURCE[0m in 0.30s]
11:55:41.954162 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.icao_mapping
11:55:41.956274 [debug] [Thread-1  ]: Began running node model.mz_hack_day.inventory_customers
11:55:41.959155 [info ] [Thread-1  ]: 2 of 8 START source model public.inventory_customers............................ [RUN]
11:55:41.963146 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.inventory_customers"
11:55:41.965345 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.inventory_customers
11:55:41.967550 [debug] [Thread-1  ]: Compiling model.mz_hack_day.inventory_customers
11:55:41.989542 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.inventory_customers"
11:55:41.999016 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.003328 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.inventory_customers
11:55:42.021790 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:55:42.024883 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */
drop source if exists 
      materialize.public.inventory_customers
   cascade
11:55:42.031059 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:55:42.041517 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:55:42.050305 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.inventory_customers"
11:55:42.056779 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:55:42.058541 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */




CREATE SOURCE 
    materialize.public.inventory_customers

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'dbserver1.inventory.customers'
FORMAT AVRO USING CONFLUENT SCHEMA REGISTRY 'http://redpanda:8081'
ENVELOPE DEBEZIUM;
11:55:42.076793 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.02 seconds
11:55:42.087338 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.089936 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: Close
11:55:42.093364 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a34945c3-90e7-4533-bd87-76e80692f33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c52e50>]}
11:55:42.096774 [info ] [Thread-1  ]: 2 of 8 OK created source model public.inventory_customers....................... [[32mCREATE SOURCE[0m in 0.13s]
11:55:42.099592 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.inventory_customers
11:55:42.101805 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_flight_information
11:55:42.108366 [info ] [Thread-1  ]: 3 of 8 START source model public.rp_flight_information.......................... [RUN]
11:55:42.112498 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_flight_information"
11:55:42.115119 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_flight_information
11:55:42.117737 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_flight_information
11:55:42.139166 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_flight_information"
11:55:42.147951 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.150022 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_flight_information
11:55:42.161389 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:55:42.164005 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */
drop source if exists 
      materialize.public.rp_flight_information
   cascade
11:55:42.166228 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:55:42.180009 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:55:42.188903 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_flight_information"
11:55:42.194117 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:55:42.196347 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */




CREATE SOURCE 
    materialize.public.rp_flight_information

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'flight_information'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
11:55:42.206024 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:55:42.216318 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.219215 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: Close
11:55:42.222704 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a34945c3-90e7-4533-bd87-76e80692f33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f33e20>]}
11:55:42.225960 [info ] [Thread-1  ]: 3 of 8 OK created source model public.rp_flight_information..................... [[32mCREATE SOURCE[0m in 0.11s]
11:55:42.228824 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_flight_information
11:55:42.231515 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_icao_mapping
11:55:42.234520 [info ] [Thread-1  ]: 4 of 8 START view model public.stg_icao_mapping................................. [RUN]
11:55:42.238266 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_icao_mapping"
11:55:42.240512 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_icao_mapping
11:55:42.244787 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_icao_mapping
11:55:42.265611 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_icao_mapping"
11:55:42.272309 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.276141 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_icao_mapping
11:55:42.363779 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:55:42.366841 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
drop view if exists "materialize"."public"."stg_icao_mapping" cascade
11:55:42.368989 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:55:42.374192 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:55:42.401996 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_icao_mapping"
11:55:42.410497 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:55:42.412630 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
create view "materialize"."public"."stg_icao_mapping"
  as (
    /*

The purpose of this staging model is to create a icao_mapping staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."icao_mapping"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

    (data->>'icao24')::string AS icao24,
           (data->>'manufacturericao')::string AS manufacturericao,
           (data->>'manufacturername')::string AS manufacturername,
           (data->>'model')::string AS model,
           (data->>'typecode')::string AS typecode,
           (data->>'icaoaircrafttype')::string AS icaoaircrafttype,
           (data->>'operator')::string AS operator,
           (data->>'operatorcallsign')::string AS operatorcallsign,
           (data->>'operatoricao')::string AS operatoricao,
           (data->>'built')::string AS built,
           (data->>'categorydescription')::string AS categorydescription

    FROM casted

)

SELECT * FROM renamed
  );
11:55:42.429451 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:55:42.439763 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.442124 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: Close
11:55:42.445462 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a34945c3-90e7-4533-bd87-76e80692f33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f33c10>]}
11:55:42.448694 [info ] [Thread-1  ]: 4 of 8 OK created view model public.stg_icao_mapping............................ [[32mCREATE VIEW[0m in 0.21s]
11:55:42.452072 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_icao_mapping
11:55:42.454310 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_inventory_customers
11:55:42.457058 [info ] [Thread-1  ]: 5 of 8 START view model public.stg_inventory_customers.......................... [RUN]
11:55:42.460621 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_inventory_customers"
11:55:42.462909 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_inventory_customers
11:55:42.464802 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_inventory_customers
11:55:42.483435 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_inventory_customers"
11:55:42.489840 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.492472 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_inventory_customers
11:55:42.510343 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_inventory_customers"
11:55:42.512958 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_inventory_customers"} */
drop view if exists "materialize"."public"."stg_inventory_customers" cascade
11:55:42.515198 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:55:42.521597 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:55:42.531331 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_inventory_customers"
11:55:42.538075 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_inventory_customers"
11:55:42.540369 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_inventory_customers"} */
create view "materialize"."public"."stg_inventory_customers"
  as (
    /*

The purpose of this model is to create an inventory_customers staging model.

 */





WITH source AS (

    SELECT * FROM "materialize"."public"."inventory_customers"

),

converted AS (

    SELECT convert_from(value, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'id')::numeric as id,
       (data->>'first_name')::string as first_name,
       (data->>'last_name')::string as last_name,
       (data->>'email')::string as email

    FROM casted

)

SELECT * FROM renamed
  );
11:55:42.544394 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "value" does not exist

11:55:42.546935 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.549286 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: Close
11:55:42.552938 [debug] [Thread-1  ]: Database Error in model stg_inventory_customers (models/examples/staging/inventory/stg_inventory_customers.sql)
  column "value" does not exist
  compiled SQL at target/run/mz_hack_day/models/examples/staging/inventory/stg_inventory_customers.sql
11:55:42.556217 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a34945c3-90e7-4533-bd87-76e80692f33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f8af10>]}
11:55:42.559161 [error] [Thread-1  ]: 5 of 8 ERROR creating view model public.stg_inventory_customers................. [[31mERROR[0m in 0.10s]
11:55:42.562418 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_inventory_customers
11:55:42.564614 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_flight_information
11:55:42.567369 [info ] [Thread-1  ]: 6 of 8 START view model public.stg_flight_information........................... [RUN]
11:55:42.571065 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_flight_information"
11:55:42.573003 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_flight_information
11:55:42.575537 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_flight_information
11:55:42.600223 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_flight_information"
11:55:42.607173 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.609777 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_flight_information
11:55:42.627465 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:55:42.630220 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
drop view if exists "materialize"."public"."stg_flight_information" cascade
11:55:42.632320 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:55:42.638089 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:55:42.648138 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_flight_information"
11:55:42.653805 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:55:42.656176 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
create view "materialize"."public"."stg_flight_information"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_flight_information"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'icao24')::string as icao24,
       (data->>'callsign')::string as callsign,
       (data->>'origin_country')::string as origin_country,
       (data->>'time_position')::numeric as time_position,
       (data->>'last_contact')::numeric as last_contact,
       (data->>'longitude')::double as longitude,
       (data->>'latitude')::double as latitude,
       (data->>'baro_altitude')::double as baro_altitude,
       (data->>'on_ground')::boolean as on_ground,
       (data->>'velocity')::double as velocity,
       (data->>'true_track')::double as true_track,
       (data->>'vertical_rate')::string as vertical_rate,
       (data->>'sensors')::string as sensors,
       (data->>'geo_altitude')::string as geo_altitude,
       (data->>'squawk')::string as squawk,
       (data->>'spi')::string as spi,
       (data->>'position_source')::string as position_source

    FROM casted

)

SELECT * FROM renamed
  );
11:55:42.665862 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:55:42.675419 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.677777 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: Close
11:55:42.681562 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a34945c3-90e7-4533-bd87-76e80692f33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f6e310>]}
11:55:42.684819 [info ] [Thread-1  ]: 6 of 8 OK created view model public.stg_flight_information...................... [[32mCREATE VIEW[0m in 0.11s]
11:55:42.687538 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_flight_information
11:55:42.690163 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_inventory
11:55:42.692294 [info ] [Thread-1  ]: 7 of 8 SKIP relation public.fct_inventory....................................... [[33mSKIP[0m]
11:55:42.695609 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_inventory
11:55:42.698016 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_flight
11:55:42.700507 [info ] [Thread-1  ]: 8 of 8 START materializedview model public.fct_flight........................... [RUN]
11:55:42.705341 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_flight"
11:55:42.708004 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_flight
11:55:42.709959 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_flight
11:55:42.730406 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_flight"
11:55:42.739244 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.742246 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_flight
11:55:42.796542 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:55:42.799985 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
drop view if exists "materialize"."public"."fct_flight" cascade
11:55:42.802413 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:55:42.808275 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:55:42.825557 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_flight"
11:55:42.832219 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:55:42.834470 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
create materialized view "materialize"."public"."fct_flight"
  as (
    


SELECT fi.icao24,
       manufacturername,
       model,
       operator,
       origin_country,
       time_position,
       longitude,
       latitude
FROM "materialize"."public"."stg_flight_information" fi
JOIN "materialize"."public"."stg_icao_mapping" icao ON fi.icao24 = icao.icao24
  );
11:55:42.847005 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:55:42.860804 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.864222 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: Close
11:55:42.868777 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a34945c3-90e7-4533-bd87-76e80692f33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027dc6c70>]}
11:55:42.872999 [info ] [Thread-1  ]: 8 of 8 OK created materializedview model public.fct_flight...................... [[32mCREATE VIEW[0m in 0.16s]
11:55:42.877160 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_flight
11:55:42.884635 [debug] [MainThread]: Acquiring new materialize connection "master"
11:55:42.887446 [debug] [MainThread]: Using materialize connection "master"
11:55:42.890133 [debug] [MainThread]: On master: BEGIN
11:55:42.892557 [debug] [MainThread]: Opening a new connection, currently in state closed
11:55:42.898502 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:55:42.901435 [debug] [MainThread]: Using materialize connection "master"
11:55:42.903359 [debug] [MainThread]: On master: COMMIT
11:55:42.906410 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:55:42.909028 [debug] [MainThread]: On master: Close
11:55:42.912499 [info ] [MainThread]: 
11:55:42.915441 [info ] [MainThread]: Finished running 3 source models, 3 view models, 2 materializedview models in 1.53s.
11:55:42.917963 [debug] [MainThread]: Connection 'master' was properly closed.
11:55:42.919767 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_flight' was properly closed.
11:55:42.962476 [info ] [MainThread]: 
11:55:42.965907 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
11:55:42.969127 [info ] [MainThread]: 
11:55:42.971917 [error] [MainThread]: [33mDatabase Error in model stg_inventory_customers (models/examples/staging/inventory/stg_inventory_customers.sql)[0m
11:55:42.974505 [error] [MainThread]:   column "value" does not exist
11:55:42.976808 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/examples/staging/inventory/stg_inventory_customers.sql
11:55:42.981641 [info ] [MainThread]: 
11:55:42.985348 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=1 TOTAL=8
11:55:42.991018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f90100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f901f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2d3a0>]}


============================== 2022-02-19 11:58:06.757368 | 99e1ef94-ad08-444e-a8c6-219ba27e33bc ==============================
11:58:06.757368 [info ] [MainThread]: Running with dbt=1.0.1
11:58:06.764171 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
11:58:06.767686 [debug] [MainThread]: Tracking: tracking
11:58:06.800170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abdf0>]}
11:58:07.161076 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
11:58:07.165736 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/examples/staging/inventory/stg_inventory_customers.sql
11:58:07.282214 [debug] [MainThread]: 1699: static parser successfully parsed examples/staging/inventory/stg_inventory_customers.sql
11:58:07.479623 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.examples
- models.templates

11:58:07.521835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99e1ef94-ad08-444e-a8c6-219ba27e33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2df40>]}
11:58:07.581943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99e1ef94-ad08-444e-a8c6-219ba27e33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007339bb0>]}
11:58:07.585306 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
11:58:07.596416 [info ] [MainThread]: 
11:58:07.600922 [debug] [MainThread]: Acquiring new materialize connection "master"
11:58:07.613617 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
11:58:07.691095 [debug] [ThreadPool]: Using materialize connection "list_materialize"
11:58:07.694051 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
11:58:07.696678 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:58:07.725483 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
11:58:07.738175 [debug] [ThreadPool]: On list_materialize: Close
11:58:07.768456 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
11:58:07.798791 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
11:58:07.802444 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
11:58:07.804201 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:58:07.810973 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
11:58:07.820882 [debug] [ThreadPool]: On list_materialize_public: Close
11:58:07.829384 [debug] [MainThread]: Using materialize connection "master"
11:58:07.832078 [debug] [MainThread]: On master: BEGIN
11:58:07.834578 [debug] [MainThread]: Opening a new connection, currently in state init
11:58:07.840125 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:58:07.842678 [debug] [MainThread]: Using materialize connection "master"
11:58:07.844979 [debug] [MainThread]: On master: COMMIT
11:58:07.848360 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:58:07.850492 [debug] [MainThread]: On master: Close
11:58:07.853414 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
11:58:07.856075 [info ] [MainThread]: 
11:58:07.873632 [debug] [Thread-1  ]: Began running node model.mz_hack_day.icao_mapping
11:58:07.877659 [info ] [Thread-1  ]: 1 of 8 START source model public.icao_mapping................................... [RUN]
11:58:07.881360 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.icao_mapping"
11:58:07.884503 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.icao_mapping
11:58:07.888192 [debug] [Thread-1  ]: Compiling model.mz_hack_day.icao_mapping
11:58:07.923373 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.icao_mapping"
11:58:07.931698 [debug] [Thread-1  ]: finished collecting timing info
11:58:07.934124 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.icao_mapping
11:58:07.995101 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:58:07.998351 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */
drop source if exists 
      materialize.public.icao_mapping
   cascade
11:58:08.000363 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:58:08.015295 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:58:08.057881 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.icao_mapping"
11:58:08.065577 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:58:08.068266 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */




CREATE SOURCE 
    materialize.public.icao_mapping

FROM FILE '/tmp/icao24_mapping_airbus.json.gz' COMPRESSION GZIP
FORMAT BYTES;
11:58:08.079623 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:58:08.132486 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.135690 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: Close
11:58:08.139148 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99e1ef94-ad08-444e-a8c6-219ba27e33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2d190>]}
11:58:08.142978 [info ] [Thread-1  ]: 1 of 8 OK created source model public.icao_mapping.............................. [[32mCREATE SOURCE[0m in 0.26s]
11:58:08.146846 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.icao_mapping
11:58:08.149199 [debug] [Thread-1  ]: Began running node model.mz_hack_day.inventory_customers
11:58:08.152592 [info ] [Thread-1  ]: 2 of 8 START source model public.inventory_customers............................ [RUN]
11:58:08.156421 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.inventory_customers"
11:58:08.159965 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.inventory_customers
11:58:08.162186 [debug] [Thread-1  ]: Compiling model.mz_hack_day.inventory_customers
11:58:08.188013 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.inventory_customers"
11:58:08.196218 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.198823 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.inventory_customers
11:58:08.210131 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:58:08.212766 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */
drop source if exists 
      materialize.public.inventory_customers
   cascade
11:58:08.214723 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:58:08.223671 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:58:08.232470 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.inventory_customers"
11:58:08.238782 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:58:08.240912 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */




CREATE SOURCE 
    materialize.public.inventory_customers

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'dbserver1.inventory.customers'
FORMAT AVRO USING CONFLUENT SCHEMA REGISTRY 'http://redpanda:8081'
ENVELOPE DEBEZIUM;
11:58:08.258355 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.02 seconds
11:58:08.268833 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.271548 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: Close
11:58:08.274970 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99e1ef94-ad08-444e-a8c6-219ba27e33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c52e50>]}
11:58:08.278318 [info ] [Thread-1  ]: 2 of 8 OK created source model public.inventory_customers....................... [[32mCREATE SOURCE[0m in 0.12s]
11:58:08.281437 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.inventory_customers
11:58:08.284059 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_flight_information
11:58:08.286994 [info ] [Thread-1  ]: 3 of 8 START source model public.rp_flight_information.......................... [RUN]
11:58:08.291094 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_flight_information"
11:58:08.293138 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_flight_information
11:58:08.296194 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_flight_information
11:58:08.319978 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_flight_information"
11:58:08.326177 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.328460 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_flight_information
11:58:08.340199 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:58:08.342697 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */
drop source if exists 
      materialize.public.rp_flight_information
   cascade
11:58:08.344751 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:58:08.354779 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:58:08.363432 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_flight_information"
11:58:08.368593 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:58:08.371618 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */




CREATE SOURCE 
    materialize.public.rp_flight_information

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'flight_information'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
11:58:08.381204 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:58:08.391027 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.393879 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: Close
11:58:08.397770 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99e1ef94-ad08-444e-a8c6-219ba27e33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f376a0>]}
11:58:08.401484 [info ] [Thread-1  ]: 3 of 8 OK created source model public.rp_flight_information..................... [[32mCREATE SOURCE[0m in 0.11s]
11:58:08.404463 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_flight_information
11:58:08.407024 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_icao_mapping
11:58:08.409836 [info ] [Thread-1  ]: 4 of 8 START view model public.stg_icao_mapping................................. [RUN]
11:58:08.413936 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_icao_mapping"
11:58:08.416039 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_icao_mapping
11:58:08.417920 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_icao_mapping
11:58:08.438727 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_icao_mapping"
11:58:08.445940 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.448436 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_icao_mapping
11:58:08.523868 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:58:08.527352 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
drop view if exists "materialize"."public"."stg_icao_mapping" cascade
11:58:08.529564 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:58:08.535671 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:58:08.563342 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_icao_mapping"
11:58:08.570462 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:58:08.572529 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
create view "materialize"."public"."stg_icao_mapping"
  as (
    /*

The purpose of this staging model is to create a icao_mapping staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."icao_mapping"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

    (data->>'icao24')::string AS icao24,
           (data->>'manufacturericao')::string AS manufacturericao,
           (data->>'manufacturername')::string AS manufacturername,
           (data->>'model')::string AS model,
           (data->>'typecode')::string AS typecode,
           (data->>'icaoaircrafttype')::string AS icaoaircrafttype,
           (data->>'operator')::string AS operator,
           (data->>'operatorcallsign')::string AS operatorcallsign,
           (data->>'operatoricao')::string AS operatoricao,
           (data->>'built')::string AS built,
           (data->>'categorydescription')::string AS categorydescription

    FROM casted

)

SELECT * FROM renamed
  );
11:58:08.582982 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:58:08.592984 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.596122 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: Close
11:58:08.600081 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99e1ef94-ad08-444e-a8c6-219ba27e33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f37bb0>]}
11:58:08.603573 [info ] [Thread-1  ]: 4 of 8 OK created view model public.stg_icao_mapping............................ [[32mCREATE VIEW[0m in 0.19s]
11:58:08.606638 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_icao_mapping
11:58:08.609595 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_inventory_customers
11:58:08.612048 [info ] [Thread-1  ]: 5 of 8 START view model public.stg_inventory_customers.......................... [RUN]
11:58:08.615695 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_inventory_customers"
11:58:08.618045 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_inventory_customers
11:58:08.620354 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_inventory_customers
11:58:08.640051 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_inventory_customers"
11:58:08.646965 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.649565 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_inventory_customers
11:58:08.668077 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_inventory_customers"
11:58:08.670683 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_inventory_customers"} */
drop view if exists "materialize"."public"."stg_inventory_customers" cascade
11:58:08.672938 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:58:08.678728 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:58:08.688542 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_inventory_customers"
11:58:08.693715 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_inventory_customers"
11:58:08.695824 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_inventory_customers"} */
create view "materialize"."public"."stg_inventory_customers"
  as (
    /*

The purpose of this model is to create an inventory_customers staging model.

 */





WITH source AS (

    SELECT * FROM "materialize"."public"."inventory_customers"

),

renamed AS (

    SELECT

       (data->>'id')::numeric as id,
       (data->>'first_name')::string as first_name,
       (data->>'last_name')::string as last_name,
       (data->>'email')::string as email

    FROM source

)

SELECT * FROM renamed
  );
11:58:08.699912 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "data" does not exist

11:58:08.702782 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.704879 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: Close
11:58:08.708696 [debug] [Thread-1  ]: Database Error in model stg_inventory_customers (models/examples/staging/inventory/stg_inventory_customers.sql)
  column "data" does not exist
  compiled SQL at target/run/mz_hack_day/models/examples/staging/inventory/stg_inventory_customers.sql
11:58:08.711376 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99e1ef94-ad08-444e-a8c6-219ba27e33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f8af10>]}
11:58:08.714359 [error] [Thread-1  ]: 5 of 8 ERROR creating view model public.stg_inventory_customers................. [[31mERROR[0m in 0.10s]
11:58:08.717156 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_inventory_customers
11:58:08.720057 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_flight_information
11:58:08.723291 [info ] [Thread-1  ]: 6 of 8 START view model public.stg_flight_information........................... [RUN]
11:58:08.726649 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_flight_information"
11:58:08.728963 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_flight_information
11:58:08.730880 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_flight_information
11:58:08.759441 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_flight_information"
11:58:08.765958 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.768523 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_flight_information
11:58:08.787001 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:58:08.791414 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
drop view if exists "materialize"."public"."stg_flight_information" cascade
11:58:08.793696 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:58:08.800933 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:58:08.811508 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_flight_information"
11:58:08.818438 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:58:08.820908 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
create view "materialize"."public"."stg_flight_information"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_flight_information"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'icao24')::string as icao24,
       (data->>'callsign')::string as callsign,
       (data->>'origin_country')::string as origin_country,
       (data->>'time_position')::numeric as time_position,
       (data->>'last_contact')::numeric as last_contact,
       (data->>'longitude')::double as longitude,
       (data->>'latitude')::double as latitude,
       (data->>'baro_altitude')::double as baro_altitude,
       (data->>'on_ground')::boolean as on_ground,
       (data->>'velocity')::double as velocity,
       (data->>'true_track')::double as true_track,
       (data->>'vertical_rate')::string as vertical_rate,
       (data->>'sensors')::string as sensors,
       (data->>'geo_altitude')::string as geo_altitude,
       (data->>'squawk')::string as squawk,
       (data->>'spi')::string as spi,
       (data->>'position_source')::string as position_source

    FROM casted

)

SELECT * FROM renamed
  );
11:58:08.834325 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:58:08.847576 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.850818 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: Close
11:58:08.854766 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99e1ef94-ad08-444e-a8c6-219ba27e33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f6e430>]}
11:58:08.858420 [info ] [Thread-1  ]: 6 of 8 OK created view model public.stg_flight_information...................... [[32mCREATE VIEW[0m in 0.13s]
11:58:08.861454 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_flight_information
11:58:08.863659 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_inventory
11:58:08.867064 [info ] [Thread-1  ]: 7 of 8 SKIP relation public.fct_inventory....................................... [[33mSKIP[0m]
11:58:08.870057 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_inventory
11:58:08.872283 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_flight
11:58:08.874718 [info ] [Thread-1  ]: 8 of 8 START materializedview model public.fct_flight........................... [RUN]
11:58:08.878411 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_flight"
11:58:08.880511 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_flight
11:58:08.882947 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_flight
11:58:08.906221 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_flight"
11:58:08.913297 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.915276 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_flight
11:58:08.969852 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:58:08.972751 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
drop view if exists "materialize"."public"."fct_flight" cascade
11:58:08.974881 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:58:08.980709 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:58:08.997893 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_flight"
11:58:09.004953 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:58:09.007025 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
create materialized view "materialize"."public"."fct_flight"
  as (
    


SELECT fi.icao24,
       manufacturername,
       model,
       operator,
       origin_country,
       time_position,
       longitude,
       latitude
FROM "materialize"."public"."stg_flight_information" fi
JOIN "materialize"."public"."stg_icao_mapping" icao ON fi.icao24 = icao.icao24
  );
11:58:09.019483 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:58:09.031449 [debug] [Thread-1  ]: finished collecting timing info
11:58:09.034818 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: Close
11:58:09.038825 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99e1ef94-ad08-444e-a8c6-219ba27e33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027dc6c70>]}
11:58:09.042663 [info ] [Thread-1  ]: 8 of 8 OK created materializedview model public.fct_flight...................... [[32mCREATE VIEW[0m in 0.16s]
11:58:09.045787 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_flight
11:58:09.052690 [debug] [MainThread]: Acquiring new materialize connection "master"
11:58:09.055749 [debug] [MainThread]: Using materialize connection "master"
11:58:09.057968 [debug] [MainThread]: On master: BEGIN
11:58:09.060995 [debug] [MainThread]: Opening a new connection, currently in state closed
11:58:09.068327 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:58:09.072752 [debug] [MainThread]: Using materialize connection "master"
11:58:09.075595 [debug] [MainThread]: On master: COMMIT
11:58:09.078560 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:58:09.080630 [debug] [MainThread]: On master: Close
11:58:09.084145 [info ] [MainThread]: 
11:58:09.087203 [info ] [MainThread]: Finished running 3 source models, 3 view models, 2 materializedview models in 1.48s.
11:58:09.090317 [debug] [MainThread]: Connection 'master' was properly closed.
11:58:09.093566 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_flight' was properly closed.
11:58:09.138069 [info ] [MainThread]: 
11:58:09.141754 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
11:58:09.144569 [info ] [MainThread]: 
11:58:09.147152 [error] [MainThread]: [33mDatabase Error in model stg_inventory_customers (models/examples/staging/inventory/stg_inventory_customers.sql)[0m
11:58:09.149818 [error] [MainThread]:   column "data" does not exist
11:58:09.152169 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/examples/staging/inventory/stg_inventory_customers.sql
11:58:09.155594 [info ] [MainThread]: 
11:58:09.158110 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=1 TOTAL=8
11:58:09.162109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f90100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f90160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2d610>]}


============================== 2022-02-19 11:58:59.208660 | abe62d1c-7830-40d7-9151-1669e98e224d ==============================
11:58:59.208660 [info ] [MainThread]: Running with dbt=1.0.1
11:58:59.216677 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
11:58:59.220167 [debug] [MainThread]: Tracking: tracking
11:58:59.250409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abdf0>]}
11:58:59.632767 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
11:58:59.636796 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/examples/staging/inventory/stg_inventory_customers.sql
11:58:59.750054 [debug] [MainThread]: 1699: static parser successfully parsed examples/staging/inventory/stg_inventory_customers.sql
11:58:59.948507 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.templates
- models.examples

11:58:59.990585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abe62d1c-7830-40d7-9151-1669e98e224d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2df40>]}
11:59:00.062415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abe62d1c-7830-40d7-9151-1669e98e224d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007339bb0>]}
11:59:00.065917 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
11:59:00.077101 [info ] [MainThread]: 
11:59:00.081624 [debug] [MainThread]: Acquiring new materialize connection "master"
11:59:00.092675 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
11:59:00.168762 [debug] [ThreadPool]: Using materialize connection "list_materialize"
11:59:00.171823 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
11:59:00.174660 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:59:00.205709 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
11:59:00.216184 [debug] [ThreadPool]: On list_materialize: Close
11:59:00.228261 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
11:59:00.253203 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
11:59:00.256060 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
11:59:00.258251 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:59:00.267711 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
11:59:00.277320 [debug] [ThreadPool]: On list_materialize_public: Close
11:59:00.285461 [debug] [MainThread]: Using materialize connection "master"
11:59:00.288066 [debug] [MainThread]: On master: BEGIN
11:59:00.290229 [debug] [MainThread]: Opening a new connection, currently in state init
11:59:00.296143 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:59:00.299206 [debug] [MainThread]: Using materialize connection "master"
11:59:00.301348 [debug] [MainThread]: On master: COMMIT
11:59:00.304126 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:59:00.306411 [debug] [MainThread]: On master: Close
11:59:00.309561 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
11:59:00.312760 [info ] [MainThread]: 
11:59:00.331216 [debug] [Thread-1  ]: Began running node model.mz_hack_day.icao_mapping
11:59:00.334638 [info ] [Thread-1  ]: 1 of 8 START source model public.icao_mapping................................... [RUN]
11:59:00.338473 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.icao_mapping"
11:59:00.340669 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.icao_mapping
11:59:00.342699 [debug] [Thread-1  ]: Compiling model.mz_hack_day.icao_mapping
11:59:00.385077 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.icao_mapping"
11:59:00.395212 [debug] [Thread-1  ]: finished collecting timing info
11:59:00.397878 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.icao_mapping
11:59:00.460173 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:59:00.463278 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */
drop source if exists 
      materialize.public.icao_mapping
   cascade
11:59:00.465216 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:59:00.476243 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:59:00.519129 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.icao_mapping"
11:59:00.526278 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:59:00.528747 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */




CREATE SOURCE 
    materialize.public.icao_mapping

FROM FILE '/tmp/icao24_mapping_airbus.json.gz' COMPRESSION GZIP
FORMAT BYTES;
11:59:00.538475 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:59:00.591625 [debug] [Thread-1  ]: finished collecting timing info
11:59:00.594719 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: Close
11:59:00.598946 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abe62d1c-7830-40d7-9151-1669e98e224d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2df10>]}
11:59:00.602272 [info ] [Thread-1  ]: 1 of 8 OK created source model public.icao_mapping.............................. [[32mCREATE SOURCE[0m in 0.26s]
11:59:00.606238 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.icao_mapping
11:59:00.608592 [debug] [Thread-1  ]: Began running node model.mz_hack_day.inventory_customers
11:59:00.611558 [info ] [Thread-1  ]: 2 of 8 START source model public.inventory_customers............................ [RUN]
11:59:00.615278 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.inventory_customers"
11:59:00.617360 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.inventory_customers
11:59:00.619522 [debug] [Thread-1  ]: Compiling model.mz_hack_day.inventory_customers
11:59:00.640732 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.inventory_customers"
11:59:00.647629 [debug] [Thread-1  ]: finished collecting timing info
11:59:00.650111 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.inventory_customers
11:59:00.660436 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:59:00.662635 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */
drop source if exists 
      materialize.public.inventory_customers
   cascade
11:59:00.664611 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:59:00.674284 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:59:00.682518 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.inventory_customers"
11:59:00.688464 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:59:00.690224 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */




CREATE SOURCE 
    materialize.public.inventory_customers

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'dbserver1.inventory.customers'
FORMAT AVRO USING CONFLUENT SCHEMA REGISTRY 'http://redpanda:8081'
ENVELOPE DEBEZIUM;
11:59:00.706580 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:59:00.717267 [debug] [Thread-1  ]: finished collecting timing info
11:59:00.719877 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: Close
11:59:00.723943 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abe62d1c-7830-40d7-9151-1669e98e224d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d95e50>]}
11:59:00.727769 [info ] [Thread-1  ]: 2 of 8 OK created source model public.inventory_customers....................... [[32mCREATE SOURCE[0m in 0.11s]
11:59:00.730932 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.inventory_customers
11:59:00.733494 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_flight_information
11:59:00.736679 [info ] [Thread-1  ]: 3 of 8 START source model public.rp_flight_information.......................... [RUN]
11:59:00.740206 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_flight_information"
11:59:00.742310 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_flight_information
11:59:00.744417 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_flight_information
11:59:00.765341 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_flight_information"
11:59:00.771712 [debug] [Thread-1  ]: finished collecting timing info
11:59:00.773991 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_flight_information
11:59:00.785628 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:59:00.788147 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */
drop source if exists 
      materialize.public.rp_flight_information
   cascade
11:59:00.791683 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:59:00.800066 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:59:00.808187 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_flight_information"
11:59:00.814305 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:59:00.816193 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */




CREATE SOURCE 
    materialize.public.rp_flight_information

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'flight_information'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
11:59:00.825566 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:59:00.835537 [debug] [Thread-1  ]: finished collecting timing info
11:59:00.837910 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: Close
11:59:00.841397 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abe62d1c-7830-40d7-9151-1669e98e224d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f35d00>]}
11:59:00.844735 [info ] [Thread-1  ]: 3 of 8 OK created source model public.rp_flight_information..................... [[32mCREATE SOURCE[0m in 0.10s]
11:59:00.847918 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_flight_information
11:59:00.850111 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_icao_mapping
11:59:00.852620 [info ] [Thread-1  ]: 4 of 8 START view model public.stg_icao_mapping................................. [RUN]
11:59:00.856302 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_icao_mapping"
11:59:00.858458 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_icao_mapping
11:59:00.860656 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_icao_mapping
11:59:00.881787 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_icao_mapping"
11:59:00.889394 [debug] [Thread-1  ]: finished collecting timing info
11:59:00.894533 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_icao_mapping
11:59:00.970454 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:59:00.973919 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
drop view if exists "materialize"."public"."stg_icao_mapping" cascade
11:59:00.976498 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:59:00.982225 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:59:01.009835 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_icao_mapping"
11:59:01.016490 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:59:01.018931 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
create view "materialize"."public"."stg_icao_mapping"
  as (
    /*

The purpose of this staging model is to create a icao_mapping staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."icao_mapping"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

    (data->>'icao24')::string AS icao24,
           (data->>'manufacturericao')::string AS manufacturericao,
           (data->>'manufacturername')::string AS manufacturername,
           (data->>'model')::string AS model,
           (data->>'typecode')::string AS typecode,
           (data->>'icaoaircrafttype')::string AS icaoaircrafttype,
           (data->>'operator')::string AS operator,
           (data->>'operatorcallsign')::string AS operatorcallsign,
           (data->>'operatoricao')::string AS operatoricao,
           (data->>'built')::string AS built,
           (data->>'categorydescription')::string AS categorydescription

    FROM casted

)

SELECT * FROM renamed
  );
11:59:01.028496 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:59:01.038460 [debug] [Thread-1  ]: finished collecting timing info
11:59:01.040792 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: Close
11:59:01.044146 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abe62d1c-7830-40d7-9151-1669e98e224d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f35c10>]}
11:59:01.047374 [info ] [Thread-1  ]: 4 of 8 OK created view model public.stg_icao_mapping............................ [[32mCREATE VIEW[0m in 0.19s]
11:59:01.050453 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_icao_mapping
11:59:01.052668 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_inventory_customers
11:59:01.055415 [info ] [Thread-1  ]: 5 of 8 START view model public.stg_inventory_customers.......................... [RUN]
11:59:01.059426 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_inventory_customers"
11:59:01.061829 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_inventory_customers
11:59:01.064091 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_inventory_customers
11:59:01.083364 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_inventory_customers"
11:59:01.090307 [debug] [Thread-1  ]: finished collecting timing info
11:59:01.092300 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_inventory_customers
11:59:01.110216 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_inventory_customers"
11:59:01.113081 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_inventory_customers"} */
drop view if exists "materialize"."public"."stg_inventory_customers" cascade
11:59:01.115383 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:59:01.121015 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:59:01.130801 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_inventory_customers"
11:59:01.136744 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_inventory_customers"
11:59:01.138760 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_inventory_customers"} */
create view "materialize"."public"."stg_inventory_customers"
  as (
    /*

The purpose of this model is to create an inventory_customers staging model.

 */





WITH source AS (

    SELECT * FROM "materialize"."public"."inventory_customers"

),

renamed AS (

    SELECT

       id::numeric as id,
       first_name::string as first_name,
       last_name::string as last_name,
       email::string as email

    FROM source

)

SELECT * FROM renamed
  );
11:59:01.147483 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:59:01.157413 [debug] [Thread-1  ]: finished collecting timing info
11:59:01.159772 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: Close
11:59:01.163513 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abe62d1c-7830-40d7-9151-1669e98e224d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027dc7b80>]}
11:59:01.166768 [info ] [Thread-1  ]: 5 of 8 OK created view model public.stg_inventory_customers..................... [[32mCREATE VIEW[0m in 0.10s]
11:59:01.170694 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_inventory_customers
11:59:01.172920 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_flight_information
11:59:01.175737 [info ] [Thread-1  ]: 6 of 8 START view model public.stg_flight_information........................... [RUN]
11:59:01.179621 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_flight_information"
11:59:01.181918 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_flight_information
11:59:01.184309 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_flight_information
11:59:01.208836 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_flight_information"
11:59:01.214810 [debug] [Thread-1  ]: finished collecting timing info
11:59:01.217105 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_flight_information
11:59:01.234326 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:59:01.236893 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
drop view if exists "materialize"."public"."stg_flight_information" cascade
11:59:01.239118 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:59:01.245297 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:59:01.255448 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_flight_information"
11:59:01.261444 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:59:01.263687 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
create view "materialize"."public"."stg_flight_information"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_flight_information"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'icao24')::string as icao24,
       (data->>'callsign')::string as callsign,
       (data->>'origin_country')::string as origin_country,
       (data->>'time_position')::numeric as time_position,
       (data->>'last_contact')::numeric as last_contact,
       (data->>'longitude')::double as longitude,
       (data->>'latitude')::double as latitude,
       (data->>'baro_altitude')::double as baro_altitude,
       (data->>'on_ground')::boolean as on_ground,
       (data->>'velocity')::double as velocity,
       (data->>'true_track')::double as true_track,
       (data->>'vertical_rate')::string as vertical_rate,
       (data->>'sensors')::string as sensors,
       (data->>'geo_altitude')::string as geo_altitude,
       (data->>'squawk')::string as squawk,
       (data->>'spi')::string as spi,
       (data->>'position_source')::string as position_source

    FROM casted

)

SELECT * FROM renamed
  );
11:59:01.272951 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:59:01.282747 [debug] [Thread-1  ]: finished collecting timing info
11:59:01.285259 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: Close
11:59:01.290850 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abe62d1c-7830-40d7-9151-1669e98e224d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f85bb0>]}
11:59:01.294275 [info ] [Thread-1  ]: 6 of 8 OK created view model public.stg_flight_information...................... [[32mCREATE VIEW[0m in 0.11s]
11:59:01.297413 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_flight_information
11:59:01.300093 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_inventory
11:59:01.302869 [info ] [Thread-1  ]: 7 of 8 START materializedview model public.fct_inventory........................ [RUN]
11:59:01.306466 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_inventory"
11:59:01.308915 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_inventory
11:59:01.311128 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_inventory
11:59:01.328693 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_inventory"
11:59:01.335064 [debug] [Thread-1  ]: finished collecting timing info
11:59:01.337048 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_inventory
11:59:01.391478 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_inventory"
11:59:01.402154 [debug] [Thread-1  ]: On model.mz_hack_day.fct_inventory: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_inventory"} */
drop view if exists "materialize"."public"."fct_inventory" cascade
11:59:01.405138 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:59:01.412520 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:59:01.436284 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_inventory"
11:59:01.442930 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_inventory"
11:59:01.445179 [debug] [Thread-1  ]: On model.mz_hack_day.fct_inventory: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_inventory"} */
create materialized view "materialize"."public"."fct_inventory"
  as (
    


select *
from "materialize"."public"."stg_inventory_customers"
  );
11:59:01.455644 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:59:01.467106 [debug] [Thread-1  ]: finished collecting timing info
11:59:01.469986 [debug] [Thread-1  ]: On model.mz_hack_day.fct_inventory: Close
11:59:01.473589 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abe62d1c-7830-40d7-9151-1669e98e224d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073bbfa0>]}
11:59:01.477551 [info ] [Thread-1  ]: 7 of 8 OK created materializedview model public.fct_inventory................... [[32mCREATE VIEW[0m in 0.17s]
11:59:01.480643 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_inventory
11:59:01.483113 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_flight
11:59:01.485768 [info ] [Thread-1  ]: 8 of 8 START materializedview model public.fct_flight........................... [RUN]
11:59:01.489699 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_flight"
11:59:01.491882 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_flight
11:59:01.494245 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_flight
11:59:01.516642 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_flight"
11:59:01.522870 [debug] [Thread-1  ]: finished collecting timing info
11:59:01.525522 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_flight
11:59:01.542509 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:59:01.545133 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
drop view if exists "materialize"."public"."fct_flight" cascade
11:59:01.547364 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:59:01.552754 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:59:01.561384 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_flight"
11:59:01.567073 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:59:01.570018 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
create materialized view "materialize"."public"."fct_flight"
  as (
    


SELECT fi.icao24,
       manufacturername,
       model,
       operator,
       origin_country,
       time_position,
       longitude,
       latitude
FROM "materialize"."public"."stg_flight_information" fi
JOIN "materialize"."public"."stg_icao_mapping" icao ON fi.icao24 = icao.icao24
  );
11:59:01.580449 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:59:01.591874 [debug] [Thread-1  ]: finished collecting timing info
11:59:01.594629 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: Close
11:59:01.598908 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abe62d1c-7830-40d7-9151-1669e98e224d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f6a6a0>]}
11:59:01.602518 [info ] [Thread-1  ]: 8 of 8 OK created materializedview model public.fct_flight...................... [[32mCREATE VIEW[0m in 0.11s]
11:59:01.606478 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_flight
11:59:01.613742 [debug] [MainThread]: Acquiring new materialize connection "master"
11:59:01.616783 [debug] [MainThread]: Using materialize connection "master"
11:59:01.619157 [debug] [MainThread]: On master: BEGIN
11:59:01.621614 [debug] [MainThread]: Opening a new connection, currently in state closed
11:59:01.626953 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:59:01.629410 [debug] [MainThread]: Using materialize connection "master"
11:59:01.631301 [debug] [MainThread]: On master: COMMIT
11:59:01.633844 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:59:01.636444 [debug] [MainThread]: On master: Close
11:59:01.640063 [info ] [MainThread]: 
11:59:01.643011 [info ] [MainThread]: Finished running 3 source models, 3 view models, 2 materializedview models in 1.56s.
11:59:01.646139 [debug] [MainThread]: Connection 'master' was properly closed.
11:59:01.648497 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_flight' was properly closed.
11:59:01.689113 [info ] [MainThread]: 
11:59:01.691745 [info ] [MainThread]: [32mCompleted successfully[0m
11:59:01.695158 [info ] [MainThread]: 
11:59:01.697884 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
11:59:01.702301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f45910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027db47c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027daf4c0>]}
