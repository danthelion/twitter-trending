

============================== 2022-02-17 17:58:52.387803 | 0e48aee3-06ac-427f-9d03-215fef6e9e2d ==============================
17:58:52.387803 [info ] [MainThread]: Running with dbt=1.0.1
17:58:52.392967 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
17:58:52.395598 [debug] [MainThread]: Tracking: tracking
17:58:52.421643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4005a47f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4005a62220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4005a620d0>]}
17:58:53.136679 [debug] [MainThread]: Executing "git --help"
17:58:53.177460 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
17:58:53.181467 [debug] [MainThread]: STDERR: "b''"
17:58:53.213696 [debug] [MainThread]: Acquiring new materialize connection "debug"
17:58:53.220982 [debug] [MainThread]: Using materialize connection "debug"
17:58:53.225016 [debug] [MainThread]: On debug: select 1 as id
17:58:53.230491 [debug] [MainThread]: Opening a new connection, currently in state init
17:58:53.290402 [debug] [MainThread]: SQL status: SELECT 1 in 0.06 seconds
17:58:53.303459 [debug] [MainThread]: On debug: Close
17:58:53.309281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072b6f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072d7b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072d7190>]}
17:58:53.988487 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-02-17 18:00:42.937306 | 4353ffc9-652e-450f-adeb-58960b914a26 ==============================
18:00:42.937306 [info ] [MainThread]: Running with dbt=1.0.1
18:00:42.944023 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
18:00:42.946955 [debug] [MainThread]: Tracking: tracking
18:00:42.979619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abdf0>]}
18:00:42.988357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe20>]}


============================== 2022-02-17 18:30:56.659168 | 90794e57-a429-48a3-8b4e-4c5a275d364a ==============================
18:30:56.659168 [info ] [MainThread]: Running with dbt=1.0.1
18:30:56.665401 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, defer=None, state=None, cls=<class 'dbt.task.deps.DepsTask'>, which='deps', rpc_method='deps')
18:30:56.668358 [debug] [MainThread]: Tracking: tracking
18:30:56.697795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728c8e0>]}
18:30:56.709660 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-u2hmn_0i'
18:30:56.713204 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
18:30:57.028544 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
18:30:57.032663 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils.json
18:30:57.326539 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils.json 200
18:30:57.343683 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils/0.1.0.json
18:30:57.627973 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils/0.1.0.json 200
18:30:57.635815 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils.json
18:30:57.836245 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils.json 200
18:30:57.845486 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils/0.1.0.json
18:30:58.065487 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils/0.1.0.json 200
18:30:58.085362 [info ] [MainThread]: Installing MaterializeInc/materialize_dbt_utils
18:30:58.710067 [info ] [MainThread]:   Installed from version 0.1.0
18:30:58.714330 [info ] [MainThread]:   Up to date!
18:30:58.717700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '90794e57-a429-48a3-8b4e-4c5a275d364a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072c6700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072c6940>]}
18:30:58.725715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728c220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728cfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728c850>]}


============================== 2022-02-17 18:31:53.560450 | acc72c13-ece7-41af-92aa-39921711d9d8 ==============================
18:31:53.560450 [info ] [MainThread]: Running with dbt=1.0.1
18:31:53.567562 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
18:31:53.572311 [debug] [MainThread]: Tracking: tracking
18:31:53.601748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072a9dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072a9eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072a9e50>]}
18:31:53.730138 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
18:31:53.733114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'acc72c13-ece7-41af-92aa-39921711d9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072cf910>]}
18:31:54.067582 [debug] [MainThread]: Parsing macros/adapters.sql
18:31:54.170046 [debug] [MainThread]: Parsing macros/catalog.sql
18:31:54.191000 [debug] [MainThread]: Parsing macros/mz_generate_name.sql
18:31:54.199459 [debug] [MainThread]: Parsing macros/relations.sql
18:31:54.237234 [debug] [MainThread]: Parsing macros/materializations/source.sql
18:31:54.263472 [debug] [MainThread]: Parsing macros/materializations/view.sql
18:31:54.284325 [debug] [MainThread]: Parsing macros/materializations/seed.sql
18:31:54.345663 [debug] [MainThread]: Parsing macros/materializations/index.sql
18:31:54.371403 [debug] [MainThread]: Parsing macros/materializations/table.sql
18:31:54.392677 [debug] [MainThread]: Parsing macros/materializations/materialized_view.sql
18:31:54.414122 [debug] [MainThread]: Parsing macros/materializations/sink.sql
18:31:54.435115 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
18:31:54.442031 [debug] [MainThread]: Parsing macros/materializations/helpers.sql
18:31:54.456604 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:31:54.470984 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:31:54.492656 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:31:54.506005 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:31:54.579592 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:31:54.597538 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:31:54.673321 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:31:54.709732 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:31:54.764661 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:31:54.789947 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:31:54.812562 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:31:54.844591 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:31:54.864030 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:31:54.915281 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:31:55.068805 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:31:55.222634 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:31:55.311146 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:31:55.325365 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:31:55.409010 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:31:55.464821 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:31:55.487318 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:31:55.572992 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:31:55.607450 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:31:55.620725 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:31:55.739876 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:31:55.823105 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:31:55.881539 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:31:55.901651 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:31:55.925643 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:31:55.938339 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:31:55.975567 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:31:55.991155 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:31:56.006230 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:31:56.014583 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:31:56.020826 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:31:56.030363 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:31:56.044737 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:31:56.081678 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:31:56.159831 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:31:56.194568 [debug] [MainThread]: Parsing macros/dbt_utils/date_trunc.sql
18:31:56.208013 [debug] [MainThread]: Parsing macros/dbt_utils/dateadd.sql
18:31:56.227320 [debug] [MainThread]: Parsing macros/dbt_utils/datediff.sql
18:31:56.246102 [debug] [MainThread]: Parsing macros/dbt_utils/get_tables_by_pattern_sql.sql
18:31:56.265362 [debug] [MainThread]: Parsing macros/dbt_utils/last_day.sql
18:31:57.857393 [debug] [MainThread]: 1699: static parser successfully parsed examples/marts/flight/fct_twitter_trending.sql
18:31:57.948777 [debug] [MainThread]: 1603: static parser failed on examples/sources/flight/icao_mapping.sql
18:31:57.984715 [debug] [MainThread]: 1602: parser fallback to jinja rendering on examples/sources/flight/icao_mapping.sql
18:31:57.994553 [debug] [MainThread]: 1603: static parser failed on examples/sources/flight/rp_twitter_trending.sql
18:31:58.020532 [debug] [MainThread]: 1602: parser fallback to jinja rendering on examples/sources/flight/rp_twitter_trending.sql
18:31:58.031291 [debug] [MainThread]: 1699: static parser successfully parsed examples/staging/flight/stg_twitter_trending.sql
18:31:58.047503 [debug] [MainThread]: 1699: static parser successfully parsed examples/staging/flight/stg_icao_mapping.sql
18:31:58.065036 [debug] [MainThread]: 1603: static parser failed on templates/marts/core/fct_example.sql
18:31:58.089127 [debug] [MainThread]: 1602: parser fallback to jinja rendering on templates/marts/core/fct_example.sql
18:31:58.098456 [debug] [MainThread]: 1603: static parser failed on templates/sources/new_source/source_example.sql
18:31:58.129218 [debug] [MainThread]: 1602: parser fallback to jinja rendering on templates/sources/new_source/source_example.sql
18:31:58.153872 [debug] [MainThread]: 1603: static parser failed on templates/staging/new_staging_source/stg_inventory_customers.sql
18:31:58.186041 [debug] [MainThread]: 1602: parser fallback to jinja rendering on templates/staging/new_staging_source/stg_inventory_customers.sql
18:31:58.560645 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.templates
- models.examples

18:31:58.598286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'acc72c13-ece7-41af-92aa-39921711d9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027bd2100>]}
18:31:58.669607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'acc72c13-ece7-41af-92aa-39921711d9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027bd2760>]}
18:31:58.673301 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:31:58.682803 [info ] [MainThread]: 
18:31:58.686771 [debug] [MainThread]: Acquiring new materialize connection "master"
18:31:58.698460 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
18:31:58.765639 [debug] [ThreadPool]: Using materialize connection "list_materialize"
18:31:58.769052 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
18:31:58.772414 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:31:58.807334 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
18:31:58.818024 [debug] [ThreadPool]: On list_materialize: Close
18:31:58.828412 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
18:31:58.851733 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
18:31:58.854362 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
18:31:58.856439 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:31:58.863308 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
18:31:58.872501 [debug] [ThreadPool]: On list_materialize_public: Close
18:31:58.879360 [debug] [MainThread]: Using materialize connection "master"
18:31:58.882311 [debug] [MainThread]: On master: BEGIN
18:31:58.885148 [debug] [MainThread]: Opening a new connection, currently in state init
18:31:58.890879 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:31:58.893784 [debug] [MainThread]: Using materialize connection "master"
18:31:58.896183 [debug] [MainThread]: On master: COMMIT
18:31:58.899157 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:31:58.901337 [debug] [MainThread]: On master: Close
18:31:58.904849 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:31:58.908120 [info ] [MainThread]: 
18:31:59.028306 [debug] [Thread-1  ]: Began running node model.mz_hack_day.icao_mapping
18:31:59.032081 [info ] [Thread-1  ]: 1 of 5 START source model public.icao_mapping................................... [RUN]
18:31:59.039263 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.icao_mapping"
18:31:59.043456 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.icao_mapping
18:31:59.048695 [debug] [Thread-1  ]: Compiling model.mz_hack_day.icao_mapping
18:31:59.073431 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.icao_mapping"
18:31:59.111537 [debug] [Thread-1  ]: finished collecting timing info
18:31:59.114965 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.icao_mapping
18:31:59.196850 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
18:31:59.209568 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */
drop source if exists 
      materialize.public.icao_mapping
   cascade
18:31:59.219103 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:31:59.241656 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.02 seconds
18:31:59.312625 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.icao_mapping"
18:31:59.378126 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
18:31:59.381859 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */




CREATE SOURCE 
    materialize.public.icao_mapping

FROM FILE '/tmp/icao24_mapping_airbus.json.gz' COMPRESSION GZIP
FORMAT BYTES;
18:31:59.402510 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.02 seconds
18:31:59.457889 [debug] [Thread-1  ]: finished collecting timing info
18:31:59.462573 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: Close
18:31:59.467654 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acc72c13-ece7-41af-92aa-39921711d9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027ea9e80>]}
18:31:59.471478 [info ] [Thread-1  ]: 1 of 5 OK created source model public.icao_mapping.............................. [[32mCREATE SOURCE[0m in 0.43s]
18:31:59.475333 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.icao_mapping
18:31:59.478215 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_flight_information
18:31:59.482950 [info ] [Thread-1  ]: 2 of 5 START source model public.rp_flight_information.......................... [RUN]
18:31:59.486898 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_flight_information"
18:31:59.489452 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_flight_information
18:31:59.491898 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_flight_information
18:31:59.513050 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_flight_information"
18:31:59.520493 [debug] [Thread-1  ]: finished collecting timing info
18:31:59.523139 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_flight_information
18:31:59.533680 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
18:31:59.536385 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */
drop source if exists 
      materialize.public.rp_flight_information
   cascade
18:31:59.539372 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:31:59.546390 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
18:31:59.555204 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_flight_information"
18:31:59.562807 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
18:31:59.565324 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */




CREATE SOURCE 
    materialize.public.rp_flight_information

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'flight_information'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
18:31:59.592669 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.03 seconds
18:31:59.602949 [debug] [Thread-1  ]: finished collecting timing info
18:31:59.605386 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: Close
18:31:59.609410 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acc72c13-ece7-41af-92aa-39921711d9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027ebbfa0>]}
18:31:59.613201 [info ] [Thread-1  ]: 2 of 5 OK created source model public.rp_flight_information..................... [[32mCREATE SOURCE[0m in 0.12s]
18:31:59.616445 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_flight_information
18:31:59.619523 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_icao_mapping
18:31:59.622548 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_icao_mapping................................. [RUN]
18:31:59.626877 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_icao_mapping"
18:31:59.629389 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_icao_mapping
18:31:59.631642 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_icao_mapping
18:31:59.651645 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_icao_mapping"
18:31:59.667004 [debug] [Thread-1  ]: finished collecting timing info
18:31:59.669340 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_icao_mapping
18:31:59.744821 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
18:31:59.749870 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
drop view if exists "materialize"."public"."stg_icao_mapping" cascade
18:31:59.767409 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:31:59.790373 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.02 seconds
18:31:59.827841 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_icao_mapping"
18:31:59.854229 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
18:31:59.856522 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
create view "materialize"."public"."stg_icao_mapping"
  as (
    /*

The purpose of this staging model is to create a icao_mapping staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."icao_mapping"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

    (data->>'icao24')::string AS icao24,
           (data->>'manufacturericao')::string AS manufacturericao,
           (data->>'manufacturername')::string AS manufacturername,
           (data->>'model')::string AS model,
           (data->>'typecode')::string AS typecode,
           (data->>'icaoaircrafttype')::string AS icaoaircrafttype,
           (data->>'operator')::string AS operator,
           (data->>'operatorcallsign')::string AS operatorcallsign,
           (data->>'operatoricao')::string AS operatoricao,
           (data->>'built')::string AS built,
           (data->>'categorydescription')::string AS categorydescription

    FROM casted

)

SELECT * FROM renamed
  );
18:31:59.866660 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
18:31:59.876741 [debug] [Thread-1  ]: finished collecting timing info
18:31:59.880526 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: Close
18:31:59.884875 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acc72c13-ece7-41af-92aa-39921711d9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4030706580>]}
18:31:59.889152 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_icao_mapping............................ [[32mCREATE VIEW[0m in 0.26s]
18:31:59.895226 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_icao_mapping
18:31:59.897655 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_flight_information
18:31:59.900490 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_flight_information........................... [RUN]
18:31:59.904237 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_flight_information"
18:31:59.906825 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_flight_information
18:31:59.911166 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_flight_information
18:31:59.932974 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_flight_information"
18:31:59.940806 [debug] [Thread-1  ]: finished collecting timing info
18:31:59.944195 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_flight_information
18:31:59.963249 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
18:31:59.965894 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
drop view if exists "materialize"."public"."stg_flight_information" cascade
18:31:59.968071 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:31:59.974334 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
18:31:59.986503 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_flight_information"
18:31:59.995213 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
18:31:59.998058 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
create view "materialize"."public"."stg_flight_information"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_flight_information"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'icao24')::string as icao24,
       (data->>'callsign')::string as callsign,
       (data->>'origin_country')::string as origin_country,
       (data->>'time_position')::numeric as time_position,
       (data->>'last_contact')::numeric as last_contact,
       (data->>'longitude')::double as longitude,
       (data->>'latitude')::double as latitude,
       (data->>'baro_altitude')::double as baro_altitude,
       (data->>'on_ground')::boolean as on_ground,
       (data->>'velocity')::double as velocity,
       (data->>'true_track')::double as true_track,
       (data->>'vertical_rate')::string as vertical_rate,
       (data->>'sensors')::string as sensors,
       (data->>'geo_altitude')::string as geo_altitude,
       (data->>'squawk')::string as squawk,
       (data->>'spi')::string as spi,
       (data->>'position_source')::string as position_source

    FROM casted

)

SELECT * FROM renamed
  );
18:32:00.012894 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
18:32:00.024189 [debug] [Thread-1  ]: finished collecting timing info
18:32:00.031393 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: Close
18:32:00.038411 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acc72c13-ece7-41af-92aa-39921711d9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c11700>]}
18:32:00.044593 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_flight_information...................... [[32mCREATE VIEW[0m in 0.13s]
18:32:00.049211 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_flight_information
18:32:00.055659 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_flight
18:32:00.059811 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_flight........................... [RUN]
18:32:00.064411 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_flight"
18:32:00.067148 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_flight
18:32:00.071063 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_flight
18:32:00.098595 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_flight"
18:32:00.116367 [debug] [Thread-1  ]: finished collecting timing info
18:32:00.118858 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_flight
18:32:00.169856 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
18:32:00.173109 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
drop view if exists "materialize"."public"."fct_flight" cascade
18:32:00.175499 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:32:00.181863 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
18:32:00.197947 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_flight"
18:32:00.211675 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
18:32:00.213971 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
create materialized view "materialize"."public"."fct_flight"
  as (
    


SELECT fi.icao24,
       manufacturername,
       model,
       operator,
       origin_country,
       time_position,
       longitude,
       latitude
FROM "materialize"."public"."stg_flight_information" fi
JOIN "materialize"."public"."stg_icao_mapping" icao ON fi.icao24 = icao.icao24
  );
18:32:00.227558 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
18:32:00.246201 [debug] [Thread-1  ]: finished collecting timing info
18:32:00.249198 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: Close
18:32:00.252946 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acc72c13-ece7-41af-92aa-39921711d9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4030719f40>]}
18:32:00.256658 [info ] [Thread-1  ]: 5 of 5 OK created materializedview model public.fct_flight...................... [[32mCREATE VIEW[0m in 0.19s]
18:32:00.259841 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_flight
18:32:00.266471 [debug] [MainThread]: Acquiring new materialize connection "master"
18:32:00.269398 [debug] [MainThread]: Using materialize connection "master"
18:32:00.271439 [debug] [MainThread]: On master: BEGIN
18:32:00.273586 [debug] [MainThread]: Opening a new connection, currently in state closed
18:32:00.280576 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:32:00.286402 [debug] [MainThread]: Using materialize connection "master"
18:32:00.288749 [debug] [MainThread]: On master: COMMIT
18:32:00.292041 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:32:00.295090 [debug] [MainThread]: On master: Close
18:32:00.299161 [info ] [MainThread]: 
18:32:00.303668 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.61s.
18:32:00.306862 [debug] [MainThread]: Connection 'master' was properly closed.
18:32:00.309181 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_flight' was properly closed.
18:32:00.358724 [info ] [MainThread]: 
18:32:00.362212 [info ] [MainThread]: [32mCompleted successfully[0m
18:32:00.366323 [info ] [MainThread]: 
18:32:00.370617 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
18:32:00.378270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073ac820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073acdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073acac0>]}


============================== 2022-02-17 18:32:31.082990 | 6e4506e0-d357-4c03-8637-b2209330bc15 ==============================
18:32:31.082990 [info ] [MainThread]: Running with dbt=1.0.1
18:32:31.092997 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, compile=True, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.generate.GenerateTask'>, which='generate', rpc_method='docs.generate')
18:32:31.098247 [debug] [MainThread]: Tracking: tracking
18:32:31.134354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aad00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aadf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aad90>]}
18:32:31.574062 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:32:31.577441 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:32:31.582796 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.templates
- models.examples

18:32:31.631759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e4506e0-d357-4c03-8637-b2209330bc15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073d40d0>]}
18:32:31.716840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e4506e0-d357-4c03-8637-b2209330bc15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007316910>]}
18:32:31.723616 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:32:31.739007 [info ] [MainThread]: 
18:32:31.749676 [debug] [MainThread]: Acquiring new materialize connection "master"
18:32:31.779250 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
18:32:31.854566 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
18:32:31.858251 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
18:32:31.861412 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:32:31.896108 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.03 seconds
18:32:31.907395 [debug] [ThreadPool]: On list_materialize_public: Close
18:32:31.921338 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:32:31.925070 [info ] [MainThread]: 
18:32:31.981327 [debug] [Thread-1  ]: Began running node model.mz_hack_day.icao_mapping
18:32:31.989851 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.icao_mapping"
18:32:31.996767 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.icao_mapping
18:32:32.001741 [debug] [Thread-1  ]: Compiling model.mz_hack_day.icao_mapping
18:32:32.038095 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.icao_mapping"
18:32:32.046211 [debug] [Thread-1  ]: finished collecting timing info
18:32:32.048976 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.icao_mapping
18:32:32.052215 [debug] [Thread-1  ]: finished collecting timing info
18:32:32.055882 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.icao_mapping
18:32:32.059107 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_flight_information
18:32:32.062369 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_flight_information"
18:32:32.064799 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_flight_information
18:32:32.067051 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_flight_information
18:32:32.087706 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_flight_information"
18:32:32.095554 [debug] [Thread-1  ]: finished collecting timing info
18:32:32.098452 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_flight_information
18:32:32.101015 [debug] [Thread-1  ]: finished collecting timing info
18:32:32.104378 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_flight_information
18:32:32.106521 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_icao_mapping
18:32:32.109831 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_icao_mapping"
18:32:32.112541 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_icao_mapping
18:32:32.115405 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_icao_mapping
18:32:32.136009 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_icao_mapping"
18:32:32.144856 [debug] [Thread-1  ]: finished collecting timing info
18:32:32.147103 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_icao_mapping
18:32:32.149368 [debug] [Thread-1  ]: finished collecting timing info
18:32:32.153266 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_icao_mapping
18:32:32.157030 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_flight_information
18:32:32.160251 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_flight_information"
18:32:32.162357 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_flight_information
18:32:32.165231 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_flight_information
18:32:32.185988 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_flight_information"
18:32:32.192416 [debug] [Thread-1  ]: finished collecting timing info
18:32:32.195063 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_flight_information
18:32:32.197705 [debug] [Thread-1  ]: finished collecting timing info
18:32:32.201170 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_flight_information
18:32:32.207685 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_flight
18:32:32.211330 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_flight"
18:32:32.214280 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_flight
18:32:32.216450 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_flight
18:32:32.237156 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_flight"
18:32:32.244564 [debug] [Thread-1  ]: finished collecting timing info
18:32:32.247108 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_flight
18:32:32.249281 [debug] [Thread-1  ]: finished collecting timing info
18:32:32.253391 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_flight
18:32:32.258737 [debug] [MainThread]: Connection 'master' was properly closed.
18:32:32.261075 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_flight' was properly closed.
18:32:32.301387 [info ] [MainThread]: Done.
18:32:32.361150 [debug] [MainThread]: Acquiring new materialize connection "generate_catalog"
18:32:32.363555 [info ] [MainThread]: Building catalog
18:32:32.375288 [debug] [ThreadPool]: Acquiring new materialize connection "materialize.information_schema"
18:32:32.431359 [debug] [ThreadPool]: Using materialize connection "materialize.information_schema"
18:32:32.434761 [debug] [ThreadPool]: On materialize.information_schema: BEGIN
18:32:32.438576 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:32:32.445670 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:32:32.448424 [debug] [ThreadPool]: Using materialize connection "materialize.information_schema"
18:32:32.450852 [debug] [ThreadPool]: On materialize.information_schema: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "materialize.information_schema"} */

    
    

    select
        'materialize' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        col.type as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join (select mz_columns.name as attname, position as attnum, mz_relations.oid as attrelid, FALSE as attisdropped, mz_columns.type as type
          from mz_columns join mz_relations on mz_columns.id = mz_relations.id)
          as col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
18:32:32.507532 [debug] [ThreadPool]: SQL status: SELECT 41 in 0.02 seconds
18:32:32.601647 [debug] [ThreadPool]: On materialize.information_schema: ROLLBACK
18:32:32.604640 [debug] [ThreadPool]: On materialize.information_schema: Close
18:32:32.672584 [info ] [MainThread]: Catalog written to /usr/app/dbt/target/catalog.json
18:32:32.677269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aad00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40294e71f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40294e77c0>]}
18:32:33.362630 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
18:32:33.366263 [debug] [MainThread]: Connection 'materialize.information_schema' was properly closed.


============================== 2022-02-17 18:33:06.455752 | 03ef597f-b0a8-4c98-8b48-ecf48d863c3b ==============================
18:33:06.455752 [info ] [MainThread]: Running with dbt=1.0.1
18:33:06.463102 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8080, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
18:33:06.466069 [debug] [MainThread]: Tracking: tracking
18:33:06.498289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728cdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728cee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728ce80>]}
18:33:06.579534 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
18:33:06.583492 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
18:33:06.587009 [info ] [MainThread]: 
18:33:06.591817 [info ] [MainThread]: 
18:33:06.596247 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-02-19 11:38:01.522083 | ed3dd23d-a44a-498d-ad79-fb5d8506908a ==============================
11:38:01.522083 [info ] [MainThread]: Running with dbt=1.0.1
11:38:01.527535 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
11:38:01.530372 [debug] [MainThread]: Tracking: tracking
11:38:01.562722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4005bbaf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4005bbad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4005bbae80>]}
11:38:02.538277 [debug] [MainThread]: Executing "git --help"
11:38:02.586001 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
11:38:02.591290 [debug] [MainThread]: STDERR: "b''"
11:38:02.616900 [debug] [MainThread]: Acquiring new materialize connection "debug"
11:38:02.620903 [debug] [MainThread]: Using materialize connection "debug"
11:38:02.625026 [debug] [MainThread]: On debug: select 1 as id
11:38:02.629924 [debug] [MainThread]: Opening a new connection, currently in state init
11:38:02.686098 [debug] [MainThread]: SQL status: SELECT 1 in 0.06 seconds
11:38:02.699619 [debug] [MainThread]: On debug: Close
11:38:02.706325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073d8100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073d8460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073d8ee0>]}
11:38:03.381741 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-02-19 11:38:39.900540 | cf6f859b-ab73-4fe9-9d5a-902d696f5a6d ==============================
11:38:39.900540 [info ] [MainThread]: Running with dbt=1.0.1
11:38:39.910777 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
11:38:39.920436 [debug] [MainThread]: Tracking: tracking
11:38:39.949864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abdc0>]}
11:38:40.423848 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
11:38:40.427243 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/examples/marts/inventory/fct_inventory.sql
11:38:40.430195 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/examples/sources/inventory/inventory_customers.sql
11:38:40.433573 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/examples/sources/inventory/src_inventory.yml
11:38:40.544818 [debug] [MainThread]: 1699: static parser successfully parsed examples/marts/inventory/fct_inventory.sql
11:38:40.657600 [debug] [MainThread]: 1603: static parser failed on examples/sources/inventory/inventory_customers.sql
11:38:40.700452 [debug] [MainThread]: 1602: parser fallback to jinja rendering on examples/sources/inventory/inventory_customers.sql
11:38:40.763887 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'inventory_customer' in the 'models' section of file 'models/examples/sources/inventory/src_inventory.yml'
11:38:40.808813 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.templates
- models.examples

11:38:40.852028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf6f859b-ab73-4fe9-9d5a-902d696f5a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c6a0d0>]}
11:38:40.910315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf6f859b-ab73-4fe9-9d5a-902d696f5a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007329c70>]}
11:38:40.913552 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
11:38:40.925977 [info ] [MainThread]: 
11:38:40.930806 [debug] [MainThread]: Acquiring new materialize connection "master"
11:38:40.958038 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
11:38:41.049515 [debug] [ThreadPool]: Using materialize connection "list_materialize"
11:38:41.052828 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
11:38:41.055568 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:38:41.088339 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
11:38:41.099450 [debug] [ThreadPool]: On list_materialize: Close
11:38:41.111127 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
11:38:41.137324 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
11:38:41.140320 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
11:38:41.142881 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:38:41.149765 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
11:38:41.159999 [debug] [ThreadPool]: On list_materialize_public: Close
11:38:41.167868 [debug] [MainThread]: Using materialize connection "master"
11:38:41.172698 [debug] [MainThread]: On master: BEGIN
11:38:41.174886 [debug] [MainThread]: Opening a new connection, currently in state init
11:38:41.180643 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:38:41.183077 [debug] [MainThread]: Using materialize connection "master"
11:38:41.185525 [debug] [MainThread]: On master: COMMIT
11:38:41.188505 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:38:41.190802 [debug] [MainThread]: On master: Close
11:38:41.194315 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
11:38:41.197164 [info ] [MainThread]: 
11:38:41.334303 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_inventory
11:38:41.338392 [info ] [Thread-1  ]: 1 of 7 START view model public.fct_inventory.................................... [RUN]
11:38:41.346352 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_inventory"
11:38:41.350548 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_inventory
11:38:41.352907 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_inventory
11:38:41.362834 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_inventory"
11:38:41.376273 [debug] [Thread-1  ]: finished collecting timing info
11:38:41.378749 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_inventory
11:38:41.459830 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_inventory"
11:38:41.463865 [debug] [Thread-1  ]: On model.mz_hack_day.fct_inventory: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_inventory"} */
drop view if exists "materialize"."public"."fct_inventory" cascade
11:38:41.467011 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:38:41.478552 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:38:41.537909 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_inventory"
11:38:41.551262 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_inventory"
11:38:41.553589 [debug] [Thread-1  ]: On model.mz_hack_day.fct_inventory: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_inventory"} */
create view "materialize"."public"."fct_inventory"
  as (
    CREATE MATERIALIZED VIEW inventory_customers_view AS
SELECT * FROM inventory_customers;
  );
11:38:41.557605 [debug] [Thread-1  ]: Postgres adapter: Postgres error: Expected SELECT, VALUES, or a subquery in the query body, found CREATE
LINE 4:     CREATE MATERIALIZED VIEW inventory_customers_view AS
            ^

11:38:41.560501 [debug] [Thread-1  ]: finished collecting timing info
11:38:41.562827 [debug] [Thread-1  ]: On model.mz_hack_day.fct_inventory: Close
11:38:41.566325 [debug] [Thread-1  ]: Database Error in model fct_inventory (models/examples/marts/inventory/fct_inventory.sql)
  Expected SELECT, VALUES, or a subquery in the query body, found CREATE
  LINE 4:     CREATE MATERIALIZED VIEW inventory_customers_view AS
              ^
  compiled SQL at target/run/mz_hack_day/models/examples/marts/inventory/fct_inventory.sql
11:38:41.569569 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf6f859b-ab73-4fe9-9d5a-902d696f5a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4030784e20>]}
11:38:41.572843 [error] [Thread-1  ]: 1 of 7 ERROR creating view model public.fct_inventory........................... [[31mERROR[0m in 0.22s]
11:38:41.576120 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_inventory
11:38:41.578639 [debug] [Thread-1  ]: Began running node model.mz_hack_day.icao_mapping
11:38:41.581420 [info ] [Thread-1  ]: 2 of 7 START source model public.icao_mapping................................... [RUN]
11:38:41.585402 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.icao_mapping"
11:38:41.587943 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.icao_mapping
11:38:41.590150 [debug] [Thread-1  ]: Compiling model.mz_hack_day.icao_mapping
11:38:41.612994 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.icao_mapping"
11:38:41.622873 [debug] [Thread-1  ]: finished collecting timing info
11:38:41.625728 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.icao_mapping
11:38:41.690049 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:38:41.692783 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */
drop source if exists 
      materialize.public.icao_mapping
   cascade
11:38:41.695652 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:38:41.702081 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:38:41.717239 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.icao_mapping"
11:38:41.727317 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:38:41.729815 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */




CREATE SOURCE 
    materialize.public.icao_mapping

FROM FILE '/tmp/icao24_mapping_airbus.json.gz' COMPRESSION GZIP
FORMAT BYTES;
11:38:41.741813 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:38:41.796676 [debug] [Thread-1  ]: finished collecting timing info
11:38:41.799939 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: Close
11:38:41.804837 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf6f859b-ab73-4fe9-9d5a-902d696f5a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40307708b0>]}
11:38:41.808374 [info ] [Thread-1  ]: 2 of 7 OK created source model public.icao_mapping.............................. [[32mCREATE SOURCE[0m in 0.22s]
11:38:41.812687 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.icao_mapping
11:38:41.815788 [debug] [Thread-1  ]: Began running node model.mz_hack_day.inventory_customers
11:38:41.818869 [info ] [Thread-1  ]: 3 of 7 START source model public.inventory_customers............................ [RUN]
11:38:41.822748 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.inventory_customers"
11:38:41.825373 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.inventory_customers
11:38:41.827467 [debug] [Thread-1  ]: Compiling model.mz_hack_day.inventory_customers
11:38:41.848917 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.inventory_customers"
11:38:41.858098 [debug] [Thread-1  ]: finished collecting timing info
11:38:41.860604 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.inventory_customers
11:38:41.872048 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:38:41.874736 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */
drop source if exists 
      materialize.public.inventory_customers
   cascade
11:38:41.877410 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:38:41.883365 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:38:41.892853 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.inventory_customers"
11:38:41.902057 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:38:41.904407 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */




CREATE SOURCE 
    materialize.public.inventory_customers

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'dbserver1.inventory.customers'
FORMAT AVRO USING CONFLUENT SCHEMA REGISTRY 'http://redpanda:8081'
ENVELOPE DEBEZIUM;
11:38:42.429435 [debug] [Thread-1  ]: Postgres adapter: Postgres error: fetching latest schema for subject 'dbserver1.inventory.customers-value' from registry: subject not found

11:38:42.432944 [debug] [Thread-1  ]: finished collecting timing info
11:38:42.434979 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: Close
11:38:42.438103 [debug] [Thread-1  ]: Database Error in model inventory_customers (models/examples/sources/inventory/inventory_customers.sql)
  fetching latest schema for subject 'dbserver1.inventory.customers-value' from registry: subject not found
  compiled SQL at target/run/mz_hack_day/models/examples/sources/inventory/inventory_customers.sql
11:38:42.441070 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf6f859b-ab73-4fe9-9d5a-902d696f5a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x403075a7f0>]}
11:38:42.445150 [error] [Thread-1  ]: 3 of 7 ERROR creating source model public.inventory_customers................... [[31mERROR[0m in 0.62s]
11:38:42.448504 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.inventory_customers
11:38:42.450751 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_flight_information
11:38:42.453116 [info ] [Thread-1  ]: 4 of 7 START source model public.rp_flight_information.......................... [RUN]
11:38:42.456885 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_flight_information"
11:38:42.459257 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_flight_information
11:38:42.461685 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_flight_information
11:38:42.483097 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_flight_information"
11:38:42.490692 [debug] [Thread-1  ]: finished collecting timing info
11:38:42.493434 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_flight_information
11:38:42.504535 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:38:42.507286 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */
drop source if exists 
      materialize.public.rp_flight_information
   cascade
11:38:42.509247 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:38:42.515396 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:38:42.524639 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_flight_information"
11:38:42.531354 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:38:42.533453 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */




CREATE SOURCE 
    materialize.public.rp_flight_information

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'flight_information'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
11:38:42.545275 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:38:42.554878 [debug] [Thread-1  ]: finished collecting timing info
11:38:42.557828 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: Close
11:38:42.561687 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf6f859b-ab73-4fe9-9d5a-902d696f5a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40307706a0>]}
11:38:42.564985 [info ] [Thread-1  ]: 4 of 7 OK created source model public.rp_flight_information..................... [[32mCREATE SOURCE[0m in 0.11s]
11:38:42.567898 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_flight_information
11:38:42.570290 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_icao_mapping
11:38:42.573024 [info ] [Thread-1  ]: 5 of 7 START view model public.stg_icao_mapping................................. [RUN]
11:38:42.577052 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_icao_mapping"
11:38:42.579275 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_icao_mapping
11:38:42.581160 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_icao_mapping
11:38:42.602595 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_icao_mapping"
11:38:42.610107 [debug] [Thread-1  ]: finished collecting timing info
11:38:42.612346 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_icao_mapping
11:38:42.634009 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:38:42.637701 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
drop view if exists "materialize"."public"."stg_icao_mapping" cascade
11:38:42.640061 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:38:42.645870 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:38:42.655915 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_icao_mapping"
11:38:42.664601 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:38:42.666584 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
create view "materialize"."public"."stg_icao_mapping"
  as (
    /*

The purpose of this staging model is to create a icao_mapping staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."icao_mapping"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

    (data->>'icao24')::string AS icao24,
           (data->>'manufacturericao')::string AS manufacturericao,
           (data->>'manufacturername')::string AS manufacturername,
           (data->>'model')::string AS model,
           (data->>'typecode')::string AS typecode,
           (data->>'icaoaircrafttype')::string AS icaoaircrafttype,
           (data->>'operator')::string AS operator,
           (data->>'operatorcallsign')::string AS operatorcallsign,
           (data->>'operatoricao')::string AS operatoricao,
           (data->>'built')::string AS built,
           (data->>'categorydescription')::string AS categorydescription

    FROM casted

)

SELECT * FROM renamed
  );
11:38:42.678667 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:38:42.689050 [debug] [Thread-1  ]: finished collecting timing info
11:38:42.691292 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: Close
11:38:42.694619 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf6f859b-ab73-4fe9-9d5a-902d696f5a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x403079ee50>]}
11:38:42.698106 [info ] [Thread-1  ]: 5 of 7 OK created view model public.stg_icao_mapping............................ [[32mCREATE VIEW[0m in 0.12s]
11:38:42.701178 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_icao_mapping
11:38:42.703896 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_flight_information
11:38:42.706473 [info ] [Thread-1  ]: 6 of 7 START view model public.stg_flight_information........................... [RUN]
11:38:42.710083 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_flight_information"
11:38:42.712173 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_flight_information
11:38:42.714732 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_flight_information
11:38:42.737100 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_flight_information"
11:38:42.744775 [debug] [Thread-1  ]: finished collecting timing info
11:38:42.746850 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_flight_information
11:38:42.764927 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:38:42.768010 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
drop view if exists "materialize"."public"."stg_flight_information" cascade
11:38:42.770457 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:38:42.779064 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:38:42.789512 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_flight_information"
11:38:42.796840 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:38:42.799351 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
create view "materialize"."public"."stg_flight_information"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_flight_information"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'icao24')::string as icao24,
       (data->>'callsign')::string as callsign,
       (data->>'origin_country')::string as origin_country,
       (data->>'time_position')::numeric as time_position,
       (data->>'last_contact')::numeric as last_contact,
       (data->>'longitude')::double as longitude,
       (data->>'latitude')::double as latitude,
       (data->>'baro_altitude')::double as baro_altitude,
       (data->>'on_ground')::boolean as on_ground,
       (data->>'velocity')::double as velocity,
       (data->>'true_track')::double as true_track,
       (data->>'vertical_rate')::string as vertical_rate,
       (data->>'sensors')::string as sensors,
       (data->>'geo_altitude')::string as geo_altitude,
       (data->>'squawk')::string as squawk,
       (data->>'spi')::string as spi,
       (data->>'position_source')::string as position_source

    FROM casted

)

SELECT * FROM renamed
  );
11:38:42.808627 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:38:42.819077 [debug] [Thread-1  ]: finished collecting timing info
11:38:42.821668 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: Close
11:38:42.825653 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf6f859b-ab73-4fe9-9d5a-902d696f5a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c17670>]}
11:38:42.828967 [info ] [Thread-1  ]: 6 of 7 OK created view model public.stg_flight_information...................... [[32mCREATE VIEW[0m in 0.12s]
11:38:42.831967 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_flight_information
11:38:42.837344 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_flight
11:38:42.839939 [info ] [Thread-1  ]: 7 of 7 START materializedview model public.fct_flight........................... [RUN]
11:38:42.843357 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_flight"
11:38:42.845376 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_flight
11:38:42.847326 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_flight
11:38:42.868568 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_flight"
11:38:42.878280 [debug] [Thread-1  ]: finished collecting timing info
11:38:42.880493 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_flight
11:38:42.936139 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:38:42.939417 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
drop view if exists "materialize"."public"."fct_flight" cascade
11:38:42.941920 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:38:42.947609 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:38:42.965547 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_flight"
11:38:42.974841 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:38:42.977686 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
create materialized view "materialize"."public"."fct_flight"
  as (
    


SELECT fi.icao24,
       manufacturername,
       model,
       operator,
       origin_country,
       time_position,
       longitude,
       latitude
FROM "materialize"."public"."stg_flight_information" fi
JOIN "materialize"."public"."stg_icao_mapping" icao ON fi.icao24 = icao.icao24
  );
11:38:42.990354 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:38:43.002886 [debug] [Thread-1  ]: finished collecting timing info
11:38:43.006467 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: Close
11:38:43.010313 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf6f859b-ab73-4fe9-9d5a-902d696f5a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x403076f340>]}
11:38:43.013811 [info ] [Thread-1  ]: 7 of 7 OK created materializedview model public.fct_flight...................... [[32mCREATE VIEW[0m in 0.17s]
11:38:43.017382 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_flight
11:38:43.024134 [debug] [MainThread]: Acquiring new materialize connection "master"
11:38:43.029691 [debug] [MainThread]: Using materialize connection "master"
11:38:43.033886 [debug] [MainThread]: On master: BEGIN
11:38:43.037026 [debug] [MainThread]: Opening a new connection, currently in state closed
11:38:43.045333 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:38:43.051589 [debug] [MainThread]: Using materialize connection "master"
11:38:43.055408 [debug] [MainThread]: On master: COMMIT
11:38:43.058800 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:38:43.062958 [debug] [MainThread]: On master: Close
11:38:43.067829 [info ] [MainThread]: 
11:38:43.071977 [info ] [MainThread]: Finished running 3 view models, 3 source models, 1 materializedview model in 2.14s.
11:38:43.076028 [debug] [MainThread]: Connection 'master' was properly closed.
11:38:43.079909 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_flight' was properly closed.
11:38:43.129452 [info ] [MainThread]: 
11:38:43.131934 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
11:38:43.135024 [info ] [MainThread]: 
11:38:43.138415 [error] [MainThread]: [33mDatabase Error in model fct_inventory (models/examples/marts/inventory/fct_inventory.sql)[0m
11:38:43.142135 [error] [MainThread]:   Expected SELECT, VALUES, or a subquery in the query body, found CREATE
11:38:43.145955 [error] [MainThread]:   LINE 4:     CREATE MATERIALIZED VIEW inventory_customers_view AS
11:38:43.151312 [error] [MainThread]:               ^
11:38:43.154596 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/examples/marts/inventory/fct_inventory.sql
11:38:43.158975 [info ] [MainThread]: 
11:38:43.162766 [error] [MainThread]: [33mDatabase Error in model inventory_customers (models/examples/sources/inventory/inventory_customers.sql)[0m
11:38:43.166435 [error] [MainThread]:   fetching latest schema for subject 'dbserver1.inventory.customers-value' from registry: subject not found
11:38:43.169977 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/examples/sources/inventory/inventory_customers.sql
11:38:43.173515 [info ] [MainThread]: 
11:38:43.176685 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
11:38:43.180956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4030770c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4030770f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x404a0ccf70>]}


============================== 2022-02-19 11:41:47.588925 | b2725de8-4272-4dda-804c-f845307591e1 ==============================
11:41:47.588925 [info ] [MainThread]: Running with dbt=1.0.1
11:41:47.598349 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
11:41:47.601215 [debug] [MainThread]: Tracking: tracking
11:41:47.632769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abdc0>]}
11:41:48.027032 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
11:41:48.029781 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
11:41:48.034568 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.examples
- models.templates

11:41:48.082099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2725de8-4272-4dda-804c-f845307591e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073d70d0>]}
11:41:48.147109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2725de8-4272-4dda-804c-f845307591e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007324190>]}
11:41:48.154296 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
11:41:48.166218 [info ] [MainThread]: 
11:41:48.173331 [debug] [MainThread]: Acquiring new materialize connection "master"
11:41:48.196254 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
11:41:48.283100 [debug] [ThreadPool]: Using materialize connection "list_materialize"
11:41:48.286412 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
11:41:48.288378 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:41:48.321402 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
11:41:48.332818 [debug] [ThreadPool]: On list_materialize: Close
11:41:48.344126 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
11:41:48.368773 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
11:41:48.371873 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
11:41:48.374325 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:41:48.381234 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
11:41:48.390823 [debug] [ThreadPool]: On list_materialize_public: Close
11:41:48.399177 [debug] [MainThread]: Using materialize connection "master"
11:41:48.401448 [debug] [MainThread]: On master: BEGIN
11:41:48.403396 [debug] [MainThread]: Opening a new connection, currently in state init
11:41:48.408925 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:41:48.412404 [debug] [MainThread]: Using materialize connection "master"
11:41:48.414569 [debug] [MainThread]: On master: COMMIT
11:41:48.417276 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:41:48.419391 [debug] [MainThread]: On master: Close
11:41:48.422219 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
11:41:48.424845 [info ] [MainThread]: 
11:41:48.443656 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_inventory
11:41:48.448763 [info ] [Thread-1  ]: 1 of 7 START view model public.fct_inventory.................................... [RUN]
11:41:48.453878 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_inventory"
11:41:48.456525 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_inventory
11:41:48.458902 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_inventory
11:41:48.469109 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_inventory"
11:41:48.480699 [debug] [Thread-1  ]: finished collecting timing info
11:41:48.483413 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_inventory
11:41:48.569169 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_inventory"
11:41:48.576170 [debug] [Thread-1  ]: On model.mz_hack_day.fct_inventory: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_inventory"} */
drop view if exists "materialize"."public"."fct_inventory" cascade
11:41:48.578555 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:41:48.584872 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:41:48.646711 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_inventory"
11:41:48.655131 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_inventory"
11:41:48.657448 [debug] [Thread-1  ]: On model.mz_hack_day.fct_inventory: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_inventory"} */
create view "materialize"."public"."fct_inventory"
  as (
    CREATE MATERIALIZED VIEW inventory_customers_view AS
SELECT * FROM inventory_customers;
  );
11:41:48.661341 [debug] [Thread-1  ]: Postgres adapter: Postgres error: Expected SELECT, VALUES, or a subquery in the query body, found CREATE
LINE 4:     CREATE MATERIALIZED VIEW inventory_customers_view AS
            ^

11:41:48.664276 [debug] [Thread-1  ]: finished collecting timing info
11:41:48.666354 [debug] [Thread-1  ]: On model.mz_hack_day.fct_inventory: Close
11:41:48.670125 [debug] [Thread-1  ]: Database Error in model fct_inventory (models/examples/marts/inventory/fct_inventory.sql)
  Expected SELECT, VALUES, or a subquery in the query body, found CREATE
  LINE 4:     CREATE MATERIALIZED VIEW inventory_customers_view AS
              ^
  compiled SQL at target/run/mz_hack_day/models/examples/marts/inventory/fct_inventory.sql
11:41:48.674118 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2725de8-4272-4dda-804c-f845307591e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40295f0bb0>]}
11:41:48.677831 [error] [Thread-1  ]: 1 of 7 ERROR creating view model public.fct_inventory........................... [[31mERROR[0m in 0.22s]
11:41:48.682192 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_inventory
11:41:48.685165 [debug] [Thread-1  ]: Began running node model.mz_hack_day.icao_mapping
11:41:48.688889 [info ] [Thread-1  ]: 2 of 7 START source model public.icao_mapping................................... [RUN]
11:41:48.692623 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.icao_mapping"
11:41:48.694865 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.icao_mapping
11:41:48.697474 [debug] [Thread-1  ]: Compiling model.mz_hack_day.icao_mapping
11:41:48.735250 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.icao_mapping"
11:41:48.743785 [debug] [Thread-1  ]: finished collecting timing info
11:41:48.745964 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.icao_mapping
11:41:48.808503 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:41:48.811553 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */
drop source if exists 
      materialize.public.icao_mapping
   cascade
11:41:48.814101 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:41:48.824835 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:41:48.840709 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.icao_mapping"
11:41:48.846536 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:41:48.849171 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */




CREATE SOURCE 
    materialize.public.icao_mapping

FROM FILE '/tmp/icao24_mapping_airbus.json.gz' COMPRESSION GZIP
FORMAT BYTES;
11:41:48.858772 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:41:48.916597 [debug] [Thread-1  ]: finished collecting timing info
11:41:48.919627 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: Close
11:41:48.923336 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2725de8-4272-4dda-804c-f845307591e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400747c3d0>]}
11:41:48.926503 [info ] [Thread-1  ]: 2 of 7 OK created source model public.icao_mapping.............................. [[32mCREATE SOURCE[0m in 0.23s]
11:41:48.929470 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.icao_mapping
11:41:48.931723 [debug] [Thread-1  ]: Began running node model.mz_hack_day.inventory_customers
11:41:48.934683 [info ] [Thread-1  ]: 3 of 7 START source model public.inventory_customers............................ [RUN]
11:41:48.938621 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.inventory_customers"
11:41:48.941026 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.inventory_customers
11:41:48.942937 [debug] [Thread-1  ]: Compiling model.mz_hack_day.inventory_customers
11:41:48.965126 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.inventory_customers"
11:41:48.972305 [debug] [Thread-1  ]: finished collecting timing info
11:41:48.974976 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.inventory_customers
11:41:48.986361 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:41:48.988436 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */
drop source if exists 
      materialize.public.inventory_customers
   cascade
11:41:48.990241 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:41:48.996831 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:41:49.006264 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.inventory_customers"
11:41:49.014428 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:41:49.016591 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */




CREATE SOURCE 
    materialize.public.inventory_customers

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'dbserver1.inventory.customers'
FORMAT AVRO USING CONFLUENT SCHEMA REGISTRY 'http://redpanda:8081'
ENVELOPE DEBEZIUM;
11:41:49.039507 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.02 seconds
11:41:49.049792 [debug] [Thread-1  ]: finished collecting timing info
11:41:49.052732 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: Close
11:41:49.056536 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2725de8-4272-4dda-804c-f845307591e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4029630a00>]}
11:41:49.060243 [info ] [Thread-1  ]: 3 of 7 OK created source model public.inventory_customers....................... [[32mCREATE SOURCE[0m in 0.12s]
11:41:49.063438 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.inventory_customers
11:41:49.066231 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_flight_information
11:41:49.069153 [info ] [Thread-1  ]: 4 of 7 START source model public.rp_flight_information.......................... [RUN]
11:41:49.073533 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_flight_information"
11:41:49.077157 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_flight_information
11:41:49.079208 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_flight_information
11:41:49.102059 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_flight_information"
11:41:49.108606 [debug] [Thread-1  ]: finished collecting timing info
11:41:49.111386 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_flight_information
11:41:49.122133 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:41:49.124417 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */
drop source if exists 
      materialize.public.rp_flight_information
   cascade
11:41:49.126341 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:41:49.136813 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:41:49.150637 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_flight_information"
11:41:49.157148 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:41:49.160789 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */




CREATE SOURCE 
    materialize.public.rp_flight_information

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'flight_information'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
11:41:49.170839 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:41:49.182822 [debug] [Thread-1  ]: finished collecting timing info
11:41:49.185735 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: Close
11:41:49.189634 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2725de8-4272-4dda-804c-f845307591e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x402964a670>]}
11:41:49.193431 [info ] [Thread-1  ]: 4 of 7 OK created source model public.rp_flight_information..................... [[32mCREATE SOURCE[0m in 0.12s]
11:41:49.196586 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_flight_information
11:41:49.198947 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_icao_mapping
11:41:49.202226 [info ] [Thread-1  ]: 5 of 7 START view model public.stg_icao_mapping................................. [RUN]
11:41:49.206065 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_icao_mapping"
11:41:49.209871 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_icao_mapping
11:41:49.212509 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_icao_mapping
11:41:49.234487 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_icao_mapping"
11:41:49.242487 [debug] [Thread-1  ]: finished collecting timing info
11:41:49.245292 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_icao_mapping
11:41:49.263723 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:41:49.266681 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
drop view if exists "materialize"."public"."stg_icao_mapping" cascade
11:41:49.268853 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:41:49.274274 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:41:49.284718 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_icao_mapping"
11:41:49.292546 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:41:49.294685 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
create view "materialize"."public"."stg_icao_mapping"
  as (
    /*

The purpose of this staging model is to create a icao_mapping staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."icao_mapping"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

    (data->>'icao24')::string AS icao24,
           (data->>'manufacturericao')::string AS manufacturericao,
           (data->>'manufacturername')::string AS manufacturername,
           (data->>'model')::string AS model,
           (data->>'typecode')::string AS typecode,
           (data->>'icaoaircrafttype')::string AS icaoaircrafttype,
           (data->>'operator')::string AS operator,
           (data->>'operatorcallsign')::string AS operatorcallsign,
           (data->>'operatoricao')::string AS operatoricao,
           (data->>'built')::string AS built,
           (data->>'categorydescription')::string AS categorydescription

    FROM casted

)

SELECT * FROM renamed
  );
11:41:49.302851 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:41:49.313271 [debug] [Thread-1  ]: finished collecting timing info
11:41:49.316133 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: Close
11:41:49.320287 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2725de8-4272-4dda-804c-f845307591e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4029604790>]}
11:41:49.323605 [info ] [Thread-1  ]: 5 of 7 OK created view model public.stg_icao_mapping............................ [[32mCREATE VIEW[0m in 0.11s]
11:41:49.326557 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_icao_mapping
11:41:49.329382 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_flight_information
11:41:49.331928 [info ] [Thread-1  ]: 6 of 7 START view model public.stg_flight_information........................... [RUN]
11:41:49.335818 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_flight_information"
11:41:49.338423 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_flight_information
11:41:49.342623 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_flight_information
11:41:49.367824 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_flight_information"
11:41:49.375247 [debug] [Thread-1  ]: finished collecting timing info
11:41:49.378136 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_flight_information
11:41:49.396625 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:41:49.399690 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
drop view if exists "materialize"."public"."stg_flight_information" cascade
11:41:49.403133 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:41:49.409417 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:41:49.419752 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_flight_information"
11:41:49.426292 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:41:49.428607 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
create view "materialize"."public"."stg_flight_information"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_flight_information"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'icao24')::string as icao24,
       (data->>'callsign')::string as callsign,
       (data->>'origin_country')::string as origin_country,
       (data->>'time_position')::numeric as time_position,
       (data->>'last_contact')::numeric as last_contact,
       (data->>'longitude')::double as longitude,
       (data->>'latitude')::double as latitude,
       (data->>'baro_altitude')::double as baro_altitude,
       (data->>'on_ground')::boolean as on_ground,
       (data->>'velocity')::double as velocity,
       (data->>'true_track')::double as true_track,
       (data->>'vertical_rate')::string as vertical_rate,
       (data->>'sensors')::string as sensors,
       (data->>'geo_altitude')::string as geo_altitude,
       (data->>'squawk')::string as squawk,
       (data->>'spi')::string as spi,
       (data->>'position_source')::string as position_source

    FROM casted

)

SELECT * FROM renamed
  );
11:41:49.438125 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:41:49.447877 [debug] [Thread-1  ]: finished collecting timing info
11:41:49.450472 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: Close
11:41:49.454163 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2725de8-4272-4dda-804c-f845307591e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400747cbe0>]}
11:41:49.457581 [info ] [Thread-1  ]: 6 of 7 OK created view model public.stg_flight_information...................... [[32mCREATE VIEW[0m in 0.12s]
11:41:49.460760 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_flight_information
11:41:49.466322 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_flight
11:41:49.469247 [info ] [Thread-1  ]: 7 of 7 START materializedview model public.fct_flight........................... [RUN]
11:41:49.473047 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_flight"
11:41:49.476896 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_flight
11:41:49.479521 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_flight
11:41:49.502353 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_flight"
11:41:49.510472 [debug] [Thread-1  ]: finished collecting timing info
11:41:49.512800 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_flight
11:41:49.569591 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:41:49.572605 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
drop view if exists "materialize"."public"."fct_flight" cascade
11:41:49.575971 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:41:49.582132 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:41:49.601388 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_flight"
11:41:49.610372 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:41:49.613171 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
create materialized view "materialize"."public"."fct_flight"
  as (
    


SELECT fi.icao24,
       manufacturername,
       model,
       operator,
       origin_country,
       time_position,
       longitude,
       latitude
FROM "materialize"."public"."stg_flight_information" fi
JOIN "materialize"."public"."stg_icao_mapping" icao ON fi.icao24 = icao.icao24
  );
11:41:49.628965 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:41:49.649516 [debug] [Thread-1  ]: finished collecting timing info
11:41:49.652466 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: Close
11:41:49.656841 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2725de8-4272-4dda-804c-f845307591e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4029656eb0>]}
11:41:49.661332 [info ] [Thread-1  ]: 7 of 7 OK created materializedview model public.fct_flight...................... [[32mCREATE VIEW[0m in 0.18s]
11:41:49.664937 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_flight
11:41:49.671351 [debug] [MainThread]: Acquiring new materialize connection "master"
11:41:49.674271 [debug] [MainThread]: Using materialize connection "master"
11:41:49.678894 [debug] [MainThread]: On master: BEGIN
11:41:49.681253 [debug] [MainThread]: Opening a new connection, currently in state closed
11:41:49.686862 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:41:49.689429 [debug] [MainThread]: Using materialize connection "master"
11:41:49.693093 [debug] [MainThread]: On master: COMMIT
11:41:49.696305 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:41:49.699337 [debug] [MainThread]: On master: Close
11:41:49.703453 [info ] [MainThread]: 
11:41:49.706398 [info ] [MainThread]: Finished running 3 view models, 3 source models, 1 materializedview model in 1.53s.
11:41:49.709437 [debug] [MainThread]: Connection 'master' was properly closed.
11:41:49.711676 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_flight' was properly closed.
11:41:49.752285 [info ] [MainThread]: 
11:41:49.755289 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
11:41:49.758167 [info ] [MainThread]: 
11:41:49.760672 [error] [MainThread]: [33mDatabase Error in model fct_inventory (models/examples/marts/inventory/fct_inventory.sql)[0m
11:41:49.763329 [error] [MainThread]:   Expected SELECT, VALUES, or a subquery in the query body, found CREATE
11:41:49.765887 [error] [MainThread]:   LINE 4:     CREATE MATERIALIZED VIEW inventory_customers_view AS
11:41:49.769323 [error] [MainThread]:               ^
11:41:49.772741 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/examples/marts/inventory/fct_inventory.sql
11:41:49.776672 [info ] [MainThread]: 
11:41:49.779843 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
11:41:49.783770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x402961c130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4029643670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40296600d0>]}


============================== 2022-02-19 11:49:34.943407 | 7cff2cd1-a53b-4abc-bff3-2f5b2626e8c1 ==============================
11:49:34.943407 [info ] [MainThread]: Running with dbt=1.0.1
11:49:34.951439 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
11:49:34.954102 [debug] [MainThread]: Tracking: tracking
11:49:34.989442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe20>]}
11:49:35.369920 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
11:49:35.373478 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/examples/staging/inventory/stg_inventory_customers.sql
11:49:35.376426 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/examples/staging/inventory/stg_inventory.yml
11:49:35.379411 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/examples/marts/inventory/fct_inventory.yml
11:49:35.382545 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/examples/marts/inventory/fct_inventory.sql
11:49:35.506591 [debug] [MainThread]: 1699: static parser successfully parsed examples/staging/inventory/stg_inventory_customers.sql
11:49:35.601465 [debug] [MainThread]: 1699: static parser successfully parsed examples/marts/inventory/fct_inventory.sql
11:49:35.699384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073ba130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073bfac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073bf9a0>]}


============================== 2022-02-19 11:50:19.314172 | da75f871-68ca-4f9c-9fcb-873feea984d0 ==============================
11:50:19.314172 [info ] [MainThread]: Running with dbt=1.0.1
11:50:19.327714 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
11:50:19.330842 [debug] [MainThread]: Tracking: tracking
11:50:19.360014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abdf0>]}
11:50:19.751002 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
11:50:19.754643 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/examples/marts/inventory/fct_inventory.yml
11:50:19.757444 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/examples/staging/inventory/stg_inventory_customers.sql
11:50:19.760552 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/examples/staging/inventory/stg_inventory.yml
11:50:19.764361 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/examples/marts/inventory/fct_inventory.sql
11:50:19.880497 [debug] [MainThread]: 1699: static parser successfully parsed examples/staging/inventory/stg_inventory_customers.sql
11:50:19.982255 [debug] [MainThread]: 1699: static parser successfully parsed examples/marts/inventory/fct_inventory.sql
11:50:20.126121 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.templates
- models.examples

11:50:20.168257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da75f871-68ca-4f9c-9fcb-873feea984d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c300d0>]}
11:50:20.227208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da75f871-68ca-4f9c-9fcb-873feea984d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400739ce50>]}
11:50:20.230380 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
11:50:20.241166 [info ] [MainThread]: 
11:50:20.245428 [debug] [MainThread]: Acquiring new materialize connection "master"
11:50:20.256330 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
11:50:20.335734 [debug] [ThreadPool]: Using materialize connection "list_materialize"
11:50:20.339292 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
11:50:20.342539 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:50:20.373123 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
11:50:20.384565 [debug] [ThreadPool]: On list_materialize: Close
11:50:20.400573 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
11:50:20.426220 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
11:50:20.429758 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
11:50:20.432177 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:50:20.439017 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
11:50:20.448770 [debug] [ThreadPool]: On list_materialize_public: Close
11:50:20.457342 [debug] [MainThread]: Using materialize connection "master"
11:50:20.459701 [debug] [MainThread]: On master: BEGIN
11:50:20.461751 [debug] [MainThread]: Opening a new connection, currently in state init
11:50:20.467473 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:50:20.470345 [debug] [MainThread]: Using materialize connection "master"
11:50:20.472851 [debug] [MainThread]: On master: COMMIT
11:50:20.475724 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:50:20.477605 [debug] [MainThread]: On master: Close
11:50:20.480677 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
11:50:20.483558 [info ] [MainThread]: 
11:50:20.509830 [debug] [Thread-1  ]: Began running node model.mz_hack_day.icao_mapping
11:50:20.513623 [info ] [Thread-1  ]: 1 of 8 START source model public.icao_mapping................................... [RUN]
11:50:20.518177 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.icao_mapping"
11:50:20.520345 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.icao_mapping
11:50:20.522458 [debug] [Thread-1  ]: Compiling model.mz_hack_day.icao_mapping
11:50:20.556738 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.icao_mapping"
11:50:20.562846 [debug] [Thread-1  ]: finished collecting timing info
11:50:20.565814 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.icao_mapping
11:50:20.632677 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:50:20.636379 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */
drop source if exists 
      materialize.public.icao_mapping
   cascade
11:50:20.639514 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:50:20.652324 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:50:20.703563 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.icao_mapping"
11:50:20.711204 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:50:20.713425 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */




CREATE SOURCE 
    materialize.public.icao_mapping

FROM FILE '/tmp/icao24_mapping_airbus.json.gz' COMPRESSION GZIP
FORMAT BYTES;
11:50:20.723700 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:50:20.778131 [debug] [Thread-1  ]: finished collecting timing info
11:50:20.781372 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: Close
11:50:20.785201 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da75f871-68ca-4f9c-9fcb-873feea984d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073b3af0>]}
11:50:20.789235 [info ] [Thread-1  ]: 1 of 8 OK created source model public.icao_mapping.............................. [[32mCREATE SOURCE[0m in 0.27s]
11:50:20.793027 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.icao_mapping
11:50:20.795675 [debug] [Thread-1  ]: Began running node model.mz_hack_day.inventory_customers
11:50:20.798320 [info ] [Thread-1  ]: 2 of 8 START source model public.inventory_customers............................ [RUN]
11:50:20.802633 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.inventory_customers"
11:50:20.807233 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.inventory_customers
11:50:20.813970 [debug] [Thread-1  ]: Compiling model.mz_hack_day.inventory_customers
11:50:20.838159 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.inventory_customers"
11:50:20.846138 [debug] [Thread-1  ]: finished collecting timing info
11:50:20.848448 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.inventory_customers
11:50:20.859568 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:50:20.862295 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */
drop source if exists 
      materialize.public.inventory_customers
   cascade
11:50:20.864425 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:50:20.874550 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:50:20.883690 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.inventory_customers"
11:50:20.888947 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:50:20.891201 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */




CREATE SOURCE 
    materialize.public.inventory_customers

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'dbserver1.inventory.customers'
FORMAT AVRO USING CONFLUENT SCHEMA REGISTRY 'http://redpanda:8081'
ENVELOPE DEBEZIUM;
11:50:20.908379 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.02 seconds
11:50:20.920085 [debug] [Thread-1  ]: finished collecting timing info
11:50:20.922523 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: Close
11:50:20.926326 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da75f871-68ca-4f9c-9fcb-873feea984d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f2aa30>]}
11:50:20.929624 [info ] [Thread-1  ]: 2 of 8 OK created source model public.inventory_customers....................... [[32mCREATE SOURCE[0m in 0.12s]
11:50:20.932483 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.inventory_customers
11:50:20.935249 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_flight_information
11:50:20.938714 [info ] [Thread-1  ]: 3 of 8 START source model public.rp_flight_information.......................... [RUN]
11:50:20.942492 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_flight_information"
11:50:20.944833 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_flight_information
11:50:20.947024 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_flight_information
11:50:20.967995 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_flight_information"
11:50:20.975504 [debug] [Thread-1  ]: finished collecting timing info
11:50:20.978072 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_flight_information
11:50:20.989414 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:50:20.991928 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */
drop source if exists 
      materialize.public.rp_flight_information
   cascade
11:50:20.994043 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:50:21.002738 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:50:21.010992 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_flight_information"
11:50:21.016118 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:50:21.018043 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */




CREATE SOURCE 
    materialize.public.rp_flight_information

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'flight_information'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
11:50:21.027440 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:50:21.038304 [debug] [Thread-1  ]: finished collecting timing info
11:50:21.040973 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: Close
11:50:21.044595 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da75f871-68ca-4f9c-9fcb-873feea984d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f361c0>]}
11:50:21.048128 [info ] [Thread-1  ]: 3 of 8 OK created source model public.rp_flight_information..................... [[32mCREATE SOURCE[0m in 0.10s]
11:50:21.051202 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_flight_information
11:50:21.053575 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_icao_mapping
11:50:21.056567 [info ] [Thread-1  ]: 4 of 8 START view model public.stg_icao_mapping................................. [RUN]
11:50:21.060377 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_icao_mapping"
11:50:21.062698 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_icao_mapping
11:50:21.064844 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_icao_mapping
11:50:21.085941 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_icao_mapping"
11:50:21.093493 [debug] [Thread-1  ]: finished collecting timing info
11:50:21.095827 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_icao_mapping
11:50:21.173019 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:50:21.175857 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
drop view if exists "materialize"."public"."stg_icao_mapping" cascade
11:50:21.178150 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:50:21.185271 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:50:21.213299 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_icao_mapping"
11:50:21.220522 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:50:21.223108 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
create view "materialize"."public"."stg_icao_mapping"
  as (
    /*

The purpose of this staging model is to create a icao_mapping staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."icao_mapping"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

    (data->>'icao24')::string AS icao24,
           (data->>'manufacturericao')::string AS manufacturericao,
           (data->>'manufacturername')::string AS manufacturername,
           (data->>'model')::string AS model,
           (data->>'typecode')::string AS typecode,
           (data->>'icaoaircrafttype')::string AS icaoaircrafttype,
           (data->>'operator')::string AS operator,
           (data->>'operatorcallsign')::string AS operatorcallsign,
           (data->>'operatoricao')::string AS operatoricao,
           (data->>'built')::string AS built,
           (data->>'categorydescription')::string AS categorydescription

    FROM casted

)

SELECT * FROM renamed
  );
11:50:21.232470 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:50:21.242787 [debug] [Thread-1  ]: finished collecting timing info
11:50:21.245060 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: Close
11:50:21.248423 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da75f871-68ca-4f9c-9fcb-873feea984d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f45130>]}
11:50:21.251937 [info ] [Thread-1  ]: 4 of 8 OK created view model public.stg_icao_mapping............................ [[32mCREATE VIEW[0m in 0.19s]
11:50:21.254853 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_icao_mapping
11:50:21.257186 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_inventory_customers
11:50:21.259640 [info ] [Thread-1  ]: 5 of 8 START view model public.stg_inventory_customers.......................... [RUN]
11:50:21.263720 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_inventory_customers"
11:50:21.266333 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_inventory_customers
11:50:21.268372 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_inventory_customers
11:50:21.287083 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_inventory_customers"
11:50:21.296325 [debug] [Thread-1  ]: finished collecting timing info
11:50:21.299282 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_inventory_customers
11:50:21.321513 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_inventory_customers"
11:50:21.324639 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_inventory_customers"} */
drop view if exists "materialize"."public"."stg_inventory_customers" cascade
11:50:21.327223 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:50:21.333180 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:50:21.343507 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_inventory_customers"
11:50:21.352129 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_inventory_customers"
11:50:21.354217 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_inventory_customers"} */
create view "materialize"."public"."stg_inventory_customers"
  as (
    /*

The purpose of this model is to create an inventory_customers staging model.

 */





WITH source AS (

    SELECT * FROM "materialize"."public"."inventory_customers"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'id')::numeric as id,
       (data->>'first_name')::string as first_name,
       (data->>'last_name')::string as last_name,
       (data->>'email')::string as email

    FROM casted

)

SELECT * FROM renamed
  );
11:50:21.358316 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "data" does not exist

11:50:21.361196 [debug] [Thread-1  ]: finished collecting timing info
11:50:21.363211 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: Close
11:50:21.366179 [debug] [Thread-1  ]: Database Error in model stg_inventory_customers (models/examples/staging/inventory/stg_inventory_customers.sql)
  column "data" does not exist
  compiled SQL at target/run/mz_hack_day/models/examples/staging/inventory/stg_inventory_customers.sql
11:50:21.368891 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da75f871-68ca-4f9c-9fcb-873feea984d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f6c2b0>]}
11:50:21.372010 [error] [Thread-1  ]: 5 of 8 ERROR creating view model public.stg_inventory_customers................. [[31mERROR[0m in 0.11s]
11:50:21.375631 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_inventory_customers
11:50:21.377819 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_flight_information
11:50:21.381174 [info ] [Thread-1  ]: 6 of 8 START view model public.stg_flight_information........................... [RUN]
11:50:21.385052 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_flight_information"
11:50:21.387250 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_flight_information
11:50:21.389530 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_flight_information
11:50:21.411226 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_flight_information"
11:50:21.417206 [debug] [Thread-1  ]: finished collecting timing info
11:50:21.419187 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_flight_information
11:50:21.437139 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:50:21.440244 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
drop view if exists "materialize"."public"."stg_flight_information" cascade
11:50:21.442439 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:50:21.448522 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:50:21.460026 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_flight_information"
11:50:21.466281 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:50:21.468598 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
create view "materialize"."public"."stg_flight_information"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_flight_information"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'icao24')::string as icao24,
       (data->>'callsign')::string as callsign,
       (data->>'origin_country')::string as origin_country,
       (data->>'time_position')::numeric as time_position,
       (data->>'last_contact')::numeric as last_contact,
       (data->>'longitude')::double as longitude,
       (data->>'latitude')::double as latitude,
       (data->>'baro_altitude')::double as baro_altitude,
       (data->>'on_ground')::boolean as on_ground,
       (data->>'velocity')::double as velocity,
       (data->>'true_track')::double as true_track,
       (data->>'vertical_rate')::string as vertical_rate,
       (data->>'sensors')::string as sensors,
       (data->>'geo_altitude')::string as geo_altitude,
       (data->>'squawk')::string as squawk,
       (data->>'spi')::string as spi,
       (data->>'position_source')::string as position_source

    FROM casted

)

SELECT * FROM renamed
  );
11:50:21.477528 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:50:21.487239 [debug] [Thread-1  ]: finished collecting timing info
11:50:21.489507 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: Close
11:50:21.493850 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da75f871-68ca-4f9c-9fcb-873feea984d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f35e80>]}
11:50:21.497760 [info ] [Thread-1  ]: 6 of 8 OK created view model public.stg_flight_information...................... [[32mCREATE VIEW[0m in 0.11s]
11:50:21.501045 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_flight_information
11:50:21.504337 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_inventory
11:50:21.511206 [info ] [Thread-1  ]: 7 of 8 SKIP relation public.fct_inventory....................................... [[33mSKIP[0m]
11:50:21.532485 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_inventory
11:50:21.549973 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_flight
11:50:21.578123 [info ] [Thread-1  ]: 8 of 8 START materializedview model public.fct_flight........................... [RUN]
11:50:21.584225 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_flight"
11:50:21.588426 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_flight
11:50:21.594165 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_flight
11:50:21.633819 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_flight"
11:50:21.676948 [debug] [Thread-1  ]: finished collecting timing info
11:50:21.681482 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_flight
11:50:21.745024 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:50:21.749664 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
drop view if exists "materialize"."public"."fct_flight" cascade
11:50:21.751974 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:50:21.758008 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:50:21.775305 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_flight"
11:50:21.784503 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:50:21.786586 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
create materialized view "materialize"."public"."fct_flight"
  as (
    


SELECT fi.icao24,
       manufacturername,
       model,
       operator,
       origin_country,
       time_position,
       longitude,
       latitude
FROM "materialize"."public"."stg_flight_information" fi
JOIN "materialize"."public"."stg_icao_mapping" icao ON fi.icao24 = icao.icao24
  );
11:50:21.797949 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:50:21.810505 [debug] [Thread-1  ]: finished collecting timing info
11:50:21.813495 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: Close
11:50:21.817913 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da75f871-68ca-4f9c-9fcb-873feea984d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073e7b20>]}
11:50:21.821400 [info ] [Thread-1  ]: 8 of 8 OK created materializedview model public.fct_flight...................... [[32mCREATE VIEW[0m in 0.23s]
11:50:21.825142 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_flight
11:50:21.832719 [debug] [MainThread]: Acquiring new materialize connection "master"
11:50:21.836192 [debug] [MainThread]: Using materialize connection "master"
11:50:21.839089 [debug] [MainThread]: On master: BEGIN
11:50:21.841344 [debug] [MainThread]: Opening a new connection, currently in state closed
11:50:21.846572 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:50:21.849485 [debug] [MainThread]: Using materialize connection "master"
11:50:21.851679 [debug] [MainThread]: On master: COMMIT
11:50:21.854268 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:50:21.856378 [debug] [MainThread]: On master: Close
11:50:21.860333 [info ] [MainThread]: 
11:50:21.863405 [info ] [MainThread]: Finished running 3 source models, 3 view models, 2 materializedview models in 1.62s.
11:50:21.866430 [debug] [MainThread]: Connection 'master' was properly closed.
11:50:21.868261 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_flight' was properly closed.
11:50:21.909368 [info ] [MainThread]: 
11:50:21.912790 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
11:50:21.915807 [info ] [MainThread]: 
11:50:21.918362 [error] [MainThread]: [33mDatabase Error in model stg_inventory_customers (models/examples/staging/inventory/stg_inventory_customers.sql)[0m
11:50:21.920705 [error] [MainThread]:   column "data" does not exist
11:50:21.923448 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/examples/staging/inventory/stg_inventory_customers.sql
11:50:21.926310 [info ] [MainThread]: 
11:50:21.928685 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=1 TOTAL=8
11:50:21.931574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f2fc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027dac9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027db31c0>]}


============================== 2022-02-19 11:54:39.818968 | 4f7c8d9e-fdec-4d74-9ca4-a54c83fdd73a ==============================
11:54:39.818968 [info ] [MainThread]: Running with dbt=1.0.1
11:54:39.825652 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
11:54:39.829352 [debug] [MainThread]: Tracking: tracking
11:54:39.865317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abdf0>]}
11:54:40.244179 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
11:54:40.251259 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/examples/staging/inventory/stg_inventory_customers.sql
11:54:40.366917 [debug] [MainThread]: 1699: static parser successfully parsed examples/staging/inventory/stg_inventory_customers.sql
11:54:40.565306 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.templates
- models.examples

11:54:40.609332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f7c8d9e-fdec-4d74-9ca4-a54c83fdd73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2df40>]}
11:54:40.668002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f7c8d9e-fdec-4d74-9ca4-a54c83fdd73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400733cbb0>]}
11:54:40.671461 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
11:54:40.685644 [info ] [MainThread]: 
11:54:40.691455 [debug] [MainThread]: Acquiring new materialize connection "master"
11:54:40.706843 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
11:54:40.783028 [debug] [ThreadPool]: Using materialize connection "list_materialize"
11:54:40.786294 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
11:54:40.788928 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:54:40.822679 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
11:54:40.833653 [debug] [ThreadPool]: On list_materialize: Close
11:54:40.846465 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
11:54:40.870956 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
11:54:40.873480 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
11:54:40.876018 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:54:40.883558 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
11:54:40.893240 [debug] [ThreadPool]: On list_materialize_public: Close
11:54:40.901440 [debug] [MainThread]: Using materialize connection "master"
11:54:40.903835 [debug] [MainThread]: On master: BEGIN
11:54:40.905946 [debug] [MainThread]: Opening a new connection, currently in state init
11:54:40.912033 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:54:40.915266 [debug] [MainThread]: Using materialize connection "master"
11:54:40.917171 [debug] [MainThread]: On master: COMMIT
11:54:40.919910 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:54:40.922166 [debug] [MainThread]: On master: Close
11:54:40.925520 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
11:54:40.928583 [info ] [MainThread]: 
11:54:40.948027 [debug] [Thread-1  ]: Began running node model.mz_hack_day.icao_mapping
11:54:40.953744 [info ] [Thread-1  ]: 1 of 8 START source model public.icao_mapping................................... [RUN]
11:54:40.960698 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.icao_mapping"
11:54:40.963021 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.icao_mapping
11:54:40.965145 [debug] [Thread-1  ]: Compiling model.mz_hack_day.icao_mapping
11:54:41.003928 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.icao_mapping"
11:54:41.011396 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.014164 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.icao_mapping
11:54:41.076459 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:54:41.079792 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */
drop source if exists 
      materialize.public.icao_mapping
   cascade
11:54:41.082155 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:54:41.091794 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:54:41.135396 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.icao_mapping"
11:54:41.142174 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:54:41.144404 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */




CREATE SOURCE 
    materialize.public.icao_mapping

FROM FILE '/tmp/icao24_mapping_airbus.json.gz' COMPRESSION GZIP
FORMAT BYTES;
11:54:41.153518 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:54:41.207711 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.210631 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: Close
11:54:41.214400 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f7c8d9e-fdec-4d74-9ca4-a54c83fdd73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2d8b0>]}
11:54:41.217756 [info ] [Thread-1  ]: 1 of 8 OK created source model public.icao_mapping.............................. [[32mCREATE SOURCE[0m in 0.25s]
11:54:41.221410 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.icao_mapping
11:54:41.224159 [debug] [Thread-1  ]: Began running node model.mz_hack_day.inventory_customers
11:54:41.230532 [info ] [Thread-1  ]: 2 of 8 START source model public.inventory_customers............................ [RUN]
11:54:41.237289 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.inventory_customers"
11:54:41.240891 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.inventory_customers
11:54:41.245629 [debug] [Thread-1  ]: Compiling model.mz_hack_day.inventory_customers
11:54:41.272893 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.inventory_customers"
11:54:41.287676 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.293620 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.inventory_customers
11:54:41.304849 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:54:41.307250 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */
drop source if exists 
      materialize.public.inventory_customers
   cascade
11:54:41.309420 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:54:41.318691 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:54:41.327253 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.inventory_customers"
11:54:41.333481 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:54:41.336901 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */




CREATE SOURCE 
    materialize.public.inventory_customers

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'dbserver1.inventory.customers'
FORMAT AVRO USING CONFLUENT SCHEMA REGISTRY 'http://redpanda:8081'
ENVELOPE DEBEZIUM;
11:54:41.353832 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:54:41.364805 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.367525 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: Close
11:54:41.371487 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f7c8d9e-fdec-4d74-9ca4-a54c83fdd73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c52e50>]}
11:54:41.375233 [info ] [Thread-1  ]: 2 of 8 OK created source model public.inventory_customers....................... [[32mCREATE SOURCE[0m in 0.14s]
11:54:41.378481 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.inventory_customers
11:54:41.381624 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_flight_information
11:54:41.384858 [info ] [Thread-1  ]: 3 of 8 START source model public.rp_flight_information.......................... [RUN]
11:54:41.388529 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_flight_information"
11:54:41.391828 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_flight_information
11:54:41.394361 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_flight_information
11:54:41.416761 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_flight_information"
11:54:41.428457 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.431124 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_flight_information
11:54:41.442909 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:54:41.445724 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */
drop source if exists 
      materialize.public.rp_flight_information
   cascade
11:54:41.447732 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:54:41.456593 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:54:41.465179 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_flight_information"
11:54:41.470361 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:54:41.472505 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */




CREATE SOURCE 
    materialize.public.rp_flight_information

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'flight_information'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
11:54:41.482484 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:54:41.492769 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.495404 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: Close
11:54:41.499182 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f7c8d9e-fdec-4d74-9ca4-a54c83fdd73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f367c0>]}
11:54:41.502560 [info ] [Thread-1  ]: 3 of 8 OK created source model public.rp_flight_information..................... [[32mCREATE SOURCE[0m in 0.11s]
11:54:41.505596 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_flight_information
11:54:41.508519 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_icao_mapping
11:54:41.511769 [info ] [Thread-1  ]: 4 of 8 START view model public.stg_icao_mapping................................. [RUN]
11:54:41.515419 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_icao_mapping"
11:54:41.517527 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_icao_mapping
11:54:41.519756 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_icao_mapping
11:54:41.543657 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_icao_mapping"
11:54:41.551707 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.554585 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_icao_mapping
11:54:41.633639 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:54:41.636692 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
drop view if exists "materialize"."public"."stg_icao_mapping" cascade
11:54:41.638909 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:54:41.645202 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:54:41.672767 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_icao_mapping"
11:54:41.679708 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:54:41.682220 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
create view "materialize"."public"."stg_icao_mapping"
  as (
    /*

The purpose of this staging model is to create a icao_mapping staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."icao_mapping"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

    (data->>'icao24')::string AS icao24,
           (data->>'manufacturericao')::string AS manufacturericao,
           (data->>'manufacturername')::string AS manufacturername,
           (data->>'model')::string AS model,
           (data->>'typecode')::string AS typecode,
           (data->>'icaoaircrafttype')::string AS icaoaircrafttype,
           (data->>'operator')::string AS operator,
           (data->>'operatorcallsign')::string AS operatorcallsign,
           (data->>'operatoricao')::string AS operatoricao,
           (data->>'built')::string AS built,
           (data->>'categorydescription')::string AS categorydescription

    FROM casted

)

SELECT * FROM renamed
  );
11:54:41.691775 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:54:41.703495 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.706238 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: Close
11:54:41.709877 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f7c8d9e-fdec-4d74-9ca4-a54c83fdd73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f36c10>]}
11:54:41.713550 [info ] [Thread-1  ]: 4 of 8 OK created view model public.stg_icao_mapping............................ [[32mCREATE VIEW[0m in 0.20s]
11:54:41.717216 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_icao_mapping
11:54:41.719739 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_inventory_customers
11:54:41.722622 [info ] [Thread-1  ]: 5 of 8 START view model public.stg_inventory_customers.......................... [RUN]
11:54:41.725882 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_inventory_customers"
11:54:41.727947 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_inventory_customers
11:54:41.729939 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_inventory_customers
11:54:41.750181 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_inventory_customers"
11:54:41.758863 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.761438 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_inventory_customers
11:54:41.778750 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_inventory_customers"
11:54:41.781374 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_inventory_customers"} */
drop view if exists "materialize"."public"."stg_inventory_customers" cascade
11:54:41.783433 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:54:41.789314 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:54:41.799265 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_inventory_customers"
11:54:41.806601 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_inventory_customers"
11:54:41.808981 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_inventory_customers"} */
create view "materialize"."public"."stg_inventory_customers"
  as (
    /*

The purpose of this model is to create an inventory_customers staging model.

 */





WITH source AS (

    SELECT * FROM "materialize"."public"."inventory_customers"

),

-- converted AS (
--
--     SELECT convert_from(data, 'utf8') AS data FROM source
--
-- ),

casted AS (

    SELECT cast(source AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'id')::numeric as id,
       (data->>'first_name')::string as first_name,
       (data->>'last_name')::string as last_name,
       (data->>'email')::string as email

    FROM casted

)

SELECT * FROM renamed
  );
11:54:41.813106 [debug] [Thread-1  ]: Postgres adapter: Postgres error: unknown catalog item 'converted'

11:54:41.815734 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.817841 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: Close
11:54:41.820741 [debug] [Thread-1  ]: Database Error in model stg_inventory_customers (models/examples/staging/inventory/stg_inventory_customers.sql)
  unknown catalog item 'converted'
  compiled SQL at target/run/mz_hack_day/models/examples/staging/inventory/stg_inventory_customers.sql
11:54:41.823909 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f7c8d9e-fdec-4d74-9ca4-a54c83fdd73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f8af10>]}
11:54:41.826764 [error] [Thread-1  ]: 5 of 8 ERROR creating view model public.stg_inventory_customers................. [[31mERROR[0m in 0.10s]
11:54:41.829736 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_inventory_customers
11:54:41.832160 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_flight_information
11:54:41.835052 [info ] [Thread-1  ]: 6 of 8 START view model public.stg_flight_information........................... [RUN]
11:54:41.839287 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_flight_information"
11:54:41.841626 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_flight_information
11:54:41.845915 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_flight_information
11:54:41.873508 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_flight_information"
11:54:41.879997 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.882695 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_flight_information
11:54:41.901149 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:54:41.903457 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
drop view if exists "materialize"."public"."stg_flight_information" cascade
11:54:41.906320 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:54:41.912065 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:54:41.921732 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_flight_information"
11:54:41.927575 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:54:41.930397 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
create view "materialize"."public"."stg_flight_information"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_flight_information"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'icao24')::string as icao24,
       (data->>'callsign')::string as callsign,
       (data->>'origin_country')::string as origin_country,
       (data->>'time_position')::numeric as time_position,
       (data->>'last_contact')::numeric as last_contact,
       (data->>'longitude')::double as longitude,
       (data->>'latitude')::double as latitude,
       (data->>'baro_altitude')::double as baro_altitude,
       (data->>'on_ground')::boolean as on_ground,
       (data->>'velocity')::double as velocity,
       (data->>'true_track')::double as true_track,
       (data->>'vertical_rate')::string as vertical_rate,
       (data->>'sensors')::string as sensors,
       (data->>'geo_altitude')::string as geo_altitude,
       (data->>'squawk')::string as squawk,
       (data->>'spi')::string as spi,
       (data->>'position_source')::string as position_source

    FROM casted

)

SELECT * FROM renamed
  );
11:54:41.940260 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:54:41.950275 [debug] [Thread-1  ]: finished collecting timing info
11:54:41.952381 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: Close
11:54:41.955765 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f7c8d9e-fdec-4d74-9ca4-a54c83fdd73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f6e250>]}
11:54:41.958832 [info ] [Thread-1  ]: 6 of 8 OK created view model public.stg_flight_information...................... [[32mCREATE VIEW[0m in 0.12s]
11:54:41.961604 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_flight_information
11:54:41.963594 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_inventory
11:54:41.965915 [info ] [Thread-1  ]: 7 of 8 SKIP relation public.fct_inventory....................................... [[33mSKIP[0m]
11:54:41.968540 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_inventory
11:54:41.970611 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_flight
11:54:41.973663 [info ] [Thread-1  ]: 8 of 8 START materializedview model public.fct_flight........................... [RUN]
11:54:41.978519 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_flight"
11:54:41.983191 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_flight
11:54:41.986706 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_flight
11:54:42.008330 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_flight"
11:54:42.014993 [debug] [Thread-1  ]: finished collecting timing info
11:54:42.017327 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_flight
11:54:42.072497 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:54:42.076156 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
drop view if exists "materialize"."public"."fct_flight" cascade
11:54:42.078818 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:54:42.085244 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:54:42.102594 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_flight"
11:54:42.109494 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:54:42.111676 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
create materialized view "materialize"."public"."fct_flight"
  as (
    


SELECT fi.icao24,
       manufacturername,
       model,
       operator,
       origin_country,
       time_position,
       longitude,
       latitude
FROM "materialize"."public"."stg_flight_information" fi
JOIN "materialize"."public"."stg_icao_mapping" icao ON fi.icao24 = icao.icao24
  );
11:54:42.123730 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:54:42.136736 [debug] [Thread-1  ]: finished collecting timing info
11:54:42.140542 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: Close
11:54:42.144663 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f7c8d9e-fdec-4d74-9ca4-a54c83fdd73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027dc6c70>]}
11:54:42.148844 [info ] [Thread-1  ]: 8 of 8 OK created materializedview model public.fct_flight...................... [[32mCREATE VIEW[0m in 0.17s]
11:54:42.152563 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_flight
11:54:42.159842 [debug] [MainThread]: Acquiring new materialize connection "master"
11:54:42.162549 [debug] [MainThread]: Using materialize connection "master"
11:54:42.165060 [debug] [MainThread]: On master: BEGIN
11:54:42.167363 [debug] [MainThread]: Opening a new connection, currently in state closed
11:54:42.173302 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:54:42.176184 [debug] [MainThread]: Using materialize connection "master"
11:54:42.179157 [debug] [MainThread]: On master: COMMIT
11:54:42.183367 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:54:42.186110 [debug] [MainThread]: On master: Close
11:54:42.189755 [info ] [MainThread]: 
11:54:42.193102 [info ] [MainThread]: Finished running 3 source models, 3 view models, 2 materializedview models in 1.50s.
11:54:42.197492 [debug] [MainThread]: Connection 'master' was properly closed.
11:54:42.199901 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_flight' was properly closed.
11:54:42.242568 [info ] [MainThread]: 
11:54:42.245689 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
11:54:42.248641 [info ] [MainThread]: 
11:54:42.251154 [error] [MainThread]: [33mDatabase Error in model stg_inventory_customers (models/examples/staging/inventory/stg_inventory_customers.sql)[0m
11:54:42.253671 [error] [MainThread]:   unknown catalog item 'converted'
11:54:42.256031 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/examples/staging/inventory/stg_inventory_customers.sql
11:54:42.260528 [info ] [MainThread]: 
11:54:42.264634 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=1 TOTAL=8
11:54:42.268030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f90100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f90160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027dae520>]}


============================== 2022-02-19 11:55:40.517281 | a34945c3-90e7-4533-bd87-76e80692f33a ==============================
11:55:40.517281 [info ] [MainThread]: Running with dbt=1.0.1
11:55:40.526221 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
11:55:40.529211 [debug] [MainThread]: Tracking: tracking
11:55:40.557085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abdf0>]}
11:55:40.927338 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
11:55:40.932192 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/examples/staging/inventory/stg_inventory_customers.sql
11:55:41.045211 [debug] [MainThread]: 1699: static parser successfully parsed examples/staging/inventory/stg_inventory_customers.sql
11:55:41.246377 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.templates
- models.examples

11:55:41.290052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a34945c3-90e7-4533-bd87-76e80692f33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2df40>]}
11:55:41.358441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a34945c3-90e7-4533-bd87-76e80692f33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400733cbb0>]}
11:55:41.362197 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
11:55:41.374039 [info ] [MainThread]: 
11:55:41.378620 [debug] [MainThread]: Acquiring new materialize connection "master"
11:55:41.389973 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
11:55:41.469092 [debug] [ThreadPool]: Using materialize connection "list_materialize"
11:55:41.472188 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
11:55:41.474110 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:55:41.507003 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
11:55:41.518564 [debug] [ThreadPool]: On list_materialize: Close
11:55:41.529823 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
11:55:41.555602 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
11:55:41.558906 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
11:55:41.561063 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:55:41.568558 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
11:55:41.579057 [debug] [ThreadPool]: On list_materialize_public: Close
11:55:41.587811 [debug] [MainThread]: Using materialize connection "master"
11:55:41.590312 [debug] [MainThread]: On master: BEGIN
11:55:41.593113 [debug] [MainThread]: Opening a new connection, currently in state init
11:55:41.598670 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:55:41.601504 [debug] [MainThread]: Using materialize connection "master"
11:55:41.603623 [debug] [MainThread]: On master: COMMIT
11:55:41.606664 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:55:41.609050 [debug] [MainThread]: On master: Close
11:55:41.613426 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
11:55:41.617318 [info ] [MainThread]: 
11:55:41.637315 [debug] [Thread-1  ]: Began running node model.mz_hack_day.icao_mapping
11:55:41.641423 [info ] [Thread-1  ]: 1 of 8 START source model public.icao_mapping................................... [RUN]
11:55:41.647438 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.icao_mapping"
11:55:41.662769 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.icao_mapping
11:55:41.682317 [debug] [Thread-1  ]: Compiling model.mz_hack_day.icao_mapping
11:55:41.735032 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.icao_mapping"
11:55:41.742189 [debug] [Thread-1  ]: finished collecting timing info
11:55:41.744403 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.icao_mapping
11:55:41.806199 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:55:41.809401 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */
drop source if exists 
      materialize.public.icao_mapping
   cascade
11:55:41.811790 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:55:41.822111 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:55:41.865281 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.icao_mapping"
11:55:41.872462 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:55:41.875122 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */




CREATE SOURCE 
    materialize.public.icao_mapping

FROM FILE '/tmp/icao24_mapping_airbus.json.gz' COMPRESSION GZIP
FORMAT BYTES;
11:55:41.886571 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:55:41.939753 [debug] [Thread-1  ]: finished collecting timing info
11:55:41.943066 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: Close
11:55:41.947107 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a34945c3-90e7-4533-bd87-76e80692f33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2de20>]}
11:55:41.950782 [info ] [Thread-1  ]: 1 of 8 OK created source model public.icao_mapping.............................. [[32mCREATE SOURCE[0m in 0.30s]
11:55:41.954162 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.icao_mapping
11:55:41.956274 [debug] [Thread-1  ]: Began running node model.mz_hack_day.inventory_customers
11:55:41.959155 [info ] [Thread-1  ]: 2 of 8 START source model public.inventory_customers............................ [RUN]
11:55:41.963146 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.inventory_customers"
11:55:41.965345 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.inventory_customers
11:55:41.967550 [debug] [Thread-1  ]: Compiling model.mz_hack_day.inventory_customers
11:55:41.989542 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.inventory_customers"
11:55:41.999016 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.003328 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.inventory_customers
11:55:42.021790 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:55:42.024883 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */
drop source if exists 
      materialize.public.inventory_customers
   cascade
11:55:42.031059 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:55:42.041517 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:55:42.050305 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.inventory_customers"
11:55:42.056779 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:55:42.058541 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */




CREATE SOURCE 
    materialize.public.inventory_customers

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'dbserver1.inventory.customers'
FORMAT AVRO USING CONFLUENT SCHEMA REGISTRY 'http://redpanda:8081'
ENVELOPE DEBEZIUM;
11:55:42.076793 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.02 seconds
11:55:42.087338 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.089936 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: Close
11:55:42.093364 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a34945c3-90e7-4533-bd87-76e80692f33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c52e50>]}
11:55:42.096774 [info ] [Thread-1  ]: 2 of 8 OK created source model public.inventory_customers....................... [[32mCREATE SOURCE[0m in 0.13s]
11:55:42.099592 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.inventory_customers
11:55:42.101805 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_flight_information
11:55:42.108366 [info ] [Thread-1  ]: 3 of 8 START source model public.rp_flight_information.......................... [RUN]
11:55:42.112498 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_flight_information"
11:55:42.115119 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_flight_information
11:55:42.117737 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_flight_information
11:55:42.139166 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_flight_information"
11:55:42.147951 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.150022 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_flight_information
11:55:42.161389 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:55:42.164005 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */
drop source if exists 
      materialize.public.rp_flight_information
   cascade
11:55:42.166228 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:55:42.180009 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:55:42.188903 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_flight_information"
11:55:42.194117 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:55:42.196347 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */




CREATE SOURCE 
    materialize.public.rp_flight_information

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'flight_information'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
11:55:42.206024 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:55:42.216318 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.219215 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: Close
11:55:42.222704 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a34945c3-90e7-4533-bd87-76e80692f33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f33e20>]}
11:55:42.225960 [info ] [Thread-1  ]: 3 of 8 OK created source model public.rp_flight_information..................... [[32mCREATE SOURCE[0m in 0.11s]
11:55:42.228824 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_flight_information
11:55:42.231515 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_icao_mapping
11:55:42.234520 [info ] [Thread-1  ]: 4 of 8 START view model public.stg_icao_mapping................................. [RUN]
11:55:42.238266 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_icao_mapping"
11:55:42.240512 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_icao_mapping
11:55:42.244787 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_icao_mapping
11:55:42.265611 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_icao_mapping"
11:55:42.272309 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.276141 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_icao_mapping
11:55:42.363779 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:55:42.366841 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
drop view if exists "materialize"."public"."stg_icao_mapping" cascade
11:55:42.368989 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:55:42.374192 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:55:42.401996 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_icao_mapping"
11:55:42.410497 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:55:42.412630 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
create view "materialize"."public"."stg_icao_mapping"
  as (
    /*

The purpose of this staging model is to create a icao_mapping staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."icao_mapping"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

    (data->>'icao24')::string AS icao24,
           (data->>'manufacturericao')::string AS manufacturericao,
           (data->>'manufacturername')::string AS manufacturername,
           (data->>'model')::string AS model,
           (data->>'typecode')::string AS typecode,
           (data->>'icaoaircrafttype')::string AS icaoaircrafttype,
           (data->>'operator')::string AS operator,
           (data->>'operatorcallsign')::string AS operatorcallsign,
           (data->>'operatoricao')::string AS operatoricao,
           (data->>'built')::string AS built,
           (data->>'categorydescription')::string AS categorydescription

    FROM casted

)

SELECT * FROM renamed
  );
11:55:42.429451 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:55:42.439763 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.442124 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: Close
11:55:42.445462 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a34945c3-90e7-4533-bd87-76e80692f33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f33c10>]}
11:55:42.448694 [info ] [Thread-1  ]: 4 of 8 OK created view model public.stg_icao_mapping............................ [[32mCREATE VIEW[0m in 0.21s]
11:55:42.452072 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_icao_mapping
11:55:42.454310 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_inventory_customers
11:55:42.457058 [info ] [Thread-1  ]: 5 of 8 START view model public.stg_inventory_customers.......................... [RUN]
11:55:42.460621 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_inventory_customers"
11:55:42.462909 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_inventory_customers
11:55:42.464802 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_inventory_customers
11:55:42.483435 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_inventory_customers"
11:55:42.489840 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.492472 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_inventory_customers
11:55:42.510343 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_inventory_customers"
11:55:42.512958 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_inventory_customers"} */
drop view if exists "materialize"."public"."stg_inventory_customers" cascade
11:55:42.515198 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:55:42.521597 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:55:42.531331 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_inventory_customers"
11:55:42.538075 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_inventory_customers"
11:55:42.540369 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_inventory_customers"} */
create view "materialize"."public"."stg_inventory_customers"
  as (
    /*

The purpose of this model is to create an inventory_customers staging model.

 */





WITH source AS (

    SELECT * FROM "materialize"."public"."inventory_customers"

),

converted AS (

    SELECT convert_from(value, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'id')::numeric as id,
       (data->>'first_name')::string as first_name,
       (data->>'last_name')::string as last_name,
       (data->>'email')::string as email

    FROM casted

)

SELECT * FROM renamed
  );
11:55:42.544394 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "value" does not exist

11:55:42.546935 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.549286 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: Close
11:55:42.552938 [debug] [Thread-1  ]: Database Error in model stg_inventory_customers (models/examples/staging/inventory/stg_inventory_customers.sql)
  column "value" does not exist
  compiled SQL at target/run/mz_hack_day/models/examples/staging/inventory/stg_inventory_customers.sql
11:55:42.556217 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a34945c3-90e7-4533-bd87-76e80692f33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f8af10>]}
11:55:42.559161 [error] [Thread-1  ]: 5 of 8 ERROR creating view model public.stg_inventory_customers................. [[31mERROR[0m in 0.10s]
11:55:42.562418 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_inventory_customers
11:55:42.564614 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_flight_information
11:55:42.567369 [info ] [Thread-1  ]: 6 of 8 START view model public.stg_flight_information........................... [RUN]
11:55:42.571065 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_flight_information"
11:55:42.573003 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_flight_information
11:55:42.575537 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_flight_information
11:55:42.600223 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_flight_information"
11:55:42.607173 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.609777 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_flight_information
11:55:42.627465 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:55:42.630220 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
drop view if exists "materialize"."public"."stg_flight_information" cascade
11:55:42.632320 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:55:42.638089 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:55:42.648138 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_flight_information"
11:55:42.653805 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:55:42.656176 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
create view "materialize"."public"."stg_flight_information"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_flight_information"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'icao24')::string as icao24,
       (data->>'callsign')::string as callsign,
       (data->>'origin_country')::string as origin_country,
       (data->>'time_position')::numeric as time_position,
       (data->>'last_contact')::numeric as last_contact,
       (data->>'longitude')::double as longitude,
       (data->>'latitude')::double as latitude,
       (data->>'baro_altitude')::double as baro_altitude,
       (data->>'on_ground')::boolean as on_ground,
       (data->>'velocity')::double as velocity,
       (data->>'true_track')::double as true_track,
       (data->>'vertical_rate')::string as vertical_rate,
       (data->>'sensors')::string as sensors,
       (data->>'geo_altitude')::string as geo_altitude,
       (data->>'squawk')::string as squawk,
       (data->>'spi')::string as spi,
       (data->>'position_source')::string as position_source

    FROM casted

)

SELECT * FROM renamed
  );
11:55:42.665862 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:55:42.675419 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.677777 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: Close
11:55:42.681562 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a34945c3-90e7-4533-bd87-76e80692f33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f6e310>]}
11:55:42.684819 [info ] [Thread-1  ]: 6 of 8 OK created view model public.stg_flight_information...................... [[32mCREATE VIEW[0m in 0.11s]
11:55:42.687538 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_flight_information
11:55:42.690163 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_inventory
11:55:42.692294 [info ] [Thread-1  ]: 7 of 8 SKIP relation public.fct_inventory....................................... [[33mSKIP[0m]
11:55:42.695609 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_inventory
11:55:42.698016 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_flight
11:55:42.700507 [info ] [Thread-1  ]: 8 of 8 START materializedview model public.fct_flight........................... [RUN]
11:55:42.705341 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_flight"
11:55:42.708004 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_flight
11:55:42.709959 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_flight
11:55:42.730406 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_flight"
11:55:42.739244 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.742246 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_flight
11:55:42.796542 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:55:42.799985 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
drop view if exists "materialize"."public"."fct_flight" cascade
11:55:42.802413 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:55:42.808275 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:55:42.825557 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_flight"
11:55:42.832219 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:55:42.834470 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
create materialized view "materialize"."public"."fct_flight"
  as (
    


SELECT fi.icao24,
       manufacturername,
       model,
       operator,
       origin_country,
       time_position,
       longitude,
       latitude
FROM "materialize"."public"."stg_flight_information" fi
JOIN "materialize"."public"."stg_icao_mapping" icao ON fi.icao24 = icao.icao24
  );
11:55:42.847005 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:55:42.860804 [debug] [Thread-1  ]: finished collecting timing info
11:55:42.864222 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: Close
11:55:42.868777 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a34945c3-90e7-4533-bd87-76e80692f33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027dc6c70>]}
11:55:42.872999 [info ] [Thread-1  ]: 8 of 8 OK created materializedview model public.fct_flight...................... [[32mCREATE VIEW[0m in 0.16s]
11:55:42.877160 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_flight
11:55:42.884635 [debug] [MainThread]: Acquiring new materialize connection "master"
11:55:42.887446 [debug] [MainThread]: Using materialize connection "master"
11:55:42.890133 [debug] [MainThread]: On master: BEGIN
11:55:42.892557 [debug] [MainThread]: Opening a new connection, currently in state closed
11:55:42.898502 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:55:42.901435 [debug] [MainThread]: Using materialize connection "master"
11:55:42.903359 [debug] [MainThread]: On master: COMMIT
11:55:42.906410 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:55:42.909028 [debug] [MainThread]: On master: Close
11:55:42.912499 [info ] [MainThread]: 
11:55:42.915441 [info ] [MainThread]: Finished running 3 source models, 3 view models, 2 materializedview models in 1.53s.
11:55:42.917963 [debug] [MainThread]: Connection 'master' was properly closed.
11:55:42.919767 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_flight' was properly closed.
11:55:42.962476 [info ] [MainThread]: 
11:55:42.965907 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
11:55:42.969127 [info ] [MainThread]: 
11:55:42.971917 [error] [MainThread]: [33mDatabase Error in model stg_inventory_customers (models/examples/staging/inventory/stg_inventory_customers.sql)[0m
11:55:42.974505 [error] [MainThread]:   column "value" does not exist
11:55:42.976808 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/examples/staging/inventory/stg_inventory_customers.sql
11:55:42.981641 [info ] [MainThread]: 
11:55:42.985348 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=1 TOTAL=8
11:55:42.991018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f90100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f901f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2d3a0>]}


============================== 2022-02-19 11:58:06.757368 | 99e1ef94-ad08-444e-a8c6-219ba27e33bc ==============================
11:58:06.757368 [info ] [MainThread]: Running with dbt=1.0.1
11:58:06.764171 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
11:58:06.767686 [debug] [MainThread]: Tracking: tracking
11:58:06.800170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abdf0>]}
11:58:07.161076 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
11:58:07.165736 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/examples/staging/inventory/stg_inventory_customers.sql
11:58:07.282214 [debug] [MainThread]: 1699: static parser successfully parsed examples/staging/inventory/stg_inventory_customers.sql
11:58:07.479623 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.examples
- models.templates

11:58:07.521835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99e1ef94-ad08-444e-a8c6-219ba27e33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2df40>]}
11:58:07.581943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99e1ef94-ad08-444e-a8c6-219ba27e33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007339bb0>]}
11:58:07.585306 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
11:58:07.596416 [info ] [MainThread]: 
11:58:07.600922 [debug] [MainThread]: Acquiring new materialize connection "master"
11:58:07.613617 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
11:58:07.691095 [debug] [ThreadPool]: Using materialize connection "list_materialize"
11:58:07.694051 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
11:58:07.696678 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:58:07.725483 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
11:58:07.738175 [debug] [ThreadPool]: On list_materialize: Close
11:58:07.768456 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
11:58:07.798791 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
11:58:07.802444 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
11:58:07.804201 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:58:07.810973 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
11:58:07.820882 [debug] [ThreadPool]: On list_materialize_public: Close
11:58:07.829384 [debug] [MainThread]: Using materialize connection "master"
11:58:07.832078 [debug] [MainThread]: On master: BEGIN
11:58:07.834578 [debug] [MainThread]: Opening a new connection, currently in state init
11:58:07.840125 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:58:07.842678 [debug] [MainThread]: Using materialize connection "master"
11:58:07.844979 [debug] [MainThread]: On master: COMMIT
11:58:07.848360 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:58:07.850492 [debug] [MainThread]: On master: Close
11:58:07.853414 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
11:58:07.856075 [info ] [MainThread]: 
11:58:07.873632 [debug] [Thread-1  ]: Began running node model.mz_hack_day.icao_mapping
11:58:07.877659 [info ] [Thread-1  ]: 1 of 8 START source model public.icao_mapping................................... [RUN]
11:58:07.881360 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.icao_mapping"
11:58:07.884503 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.icao_mapping
11:58:07.888192 [debug] [Thread-1  ]: Compiling model.mz_hack_day.icao_mapping
11:58:07.923373 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.icao_mapping"
11:58:07.931698 [debug] [Thread-1  ]: finished collecting timing info
11:58:07.934124 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.icao_mapping
11:58:07.995101 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:58:07.998351 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */
drop source if exists 
      materialize.public.icao_mapping
   cascade
11:58:08.000363 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:58:08.015295 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:58:08.057881 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.icao_mapping"
11:58:08.065577 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:58:08.068266 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */




CREATE SOURCE 
    materialize.public.icao_mapping

FROM FILE '/tmp/icao24_mapping_airbus.json.gz' COMPRESSION GZIP
FORMAT BYTES;
11:58:08.079623 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:58:08.132486 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.135690 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: Close
11:58:08.139148 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99e1ef94-ad08-444e-a8c6-219ba27e33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2d190>]}
11:58:08.142978 [info ] [Thread-1  ]: 1 of 8 OK created source model public.icao_mapping.............................. [[32mCREATE SOURCE[0m in 0.26s]
11:58:08.146846 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.icao_mapping
11:58:08.149199 [debug] [Thread-1  ]: Began running node model.mz_hack_day.inventory_customers
11:58:08.152592 [info ] [Thread-1  ]: 2 of 8 START source model public.inventory_customers............................ [RUN]
11:58:08.156421 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.inventory_customers"
11:58:08.159965 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.inventory_customers
11:58:08.162186 [debug] [Thread-1  ]: Compiling model.mz_hack_day.inventory_customers
11:58:08.188013 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.inventory_customers"
11:58:08.196218 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.198823 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.inventory_customers
11:58:08.210131 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:58:08.212766 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */
drop source if exists 
      materialize.public.inventory_customers
   cascade
11:58:08.214723 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:58:08.223671 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:58:08.232470 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.inventory_customers"
11:58:08.238782 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:58:08.240912 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */




CREATE SOURCE 
    materialize.public.inventory_customers

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'dbserver1.inventory.customers'
FORMAT AVRO USING CONFLUENT SCHEMA REGISTRY 'http://redpanda:8081'
ENVELOPE DEBEZIUM;
11:58:08.258355 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.02 seconds
11:58:08.268833 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.271548 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: Close
11:58:08.274970 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99e1ef94-ad08-444e-a8c6-219ba27e33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c52e50>]}
11:58:08.278318 [info ] [Thread-1  ]: 2 of 8 OK created source model public.inventory_customers....................... [[32mCREATE SOURCE[0m in 0.12s]
11:58:08.281437 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.inventory_customers
11:58:08.284059 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_flight_information
11:58:08.286994 [info ] [Thread-1  ]: 3 of 8 START source model public.rp_flight_information.......................... [RUN]
11:58:08.291094 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_flight_information"
11:58:08.293138 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_flight_information
11:58:08.296194 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_flight_information
11:58:08.319978 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_flight_information"
11:58:08.326177 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.328460 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_flight_information
11:58:08.340199 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:58:08.342697 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */
drop source if exists 
      materialize.public.rp_flight_information
   cascade
11:58:08.344751 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:58:08.354779 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:58:08.363432 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_flight_information"
11:58:08.368593 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:58:08.371618 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */




CREATE SOURCE 
    materialize.public.rp_flight_information

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'flight_information'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
11:58:08.381204 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:58:08.391027 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.393879 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: Close
11:58:08.397770 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99e1ef94-ad08-444e-a8c6-219ba27e33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f376a0>]}
11:58:08.401484 [info ] [Thread-1  ]: 3 of 8 OK created source model public.rp_flight_information..................... [[32mCREATE SOURCE[0m in 0.11s]
11:58:08.404463 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_flight_information
11:58:08.407024 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_icao_mapping
11:58:08.409836 [info ] [Thread-1  ]: 4 of 8 START view model public.stg_icao_mapping................................. [RUN]
11:58:08.413936 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_icao_mapping"
11:58:08.416039 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_icao_mapping
11:58:08.417920 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_icao_mapping
11:58:08.438727 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_icao_mapping"
11:58:08.445940 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.448436 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_icao_mapping
11:58:08.523868 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:58:08.527352 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
drop view if exists "materialize"."public"."stg_icao_mapping" cascade
11:58:08.529564 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:58:08.535671 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:58:08.563342 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_icao_mapping"
11:58:08.570462 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:58:08.572529 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
create view "materialize"."public"."stg_icao_mapping"
  as (
    /*

The purpose of this staging model is to create a icao_mapping staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."icao_mapping"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

    (data->>'icao24')::string AS icao24,
           (data->>'manufacturericao')::string AS manufacturericao,
           (data->>'manufacturername')::string AS manufacturername,
           (data->>'model')::string AS model,
           (data->>'typecode')::string AS typecode,
           (data->>'icaoaircrafttype')::string AS icaoaircrafttype,
           (data->>'operator')::string AS operator,
           (data->>'operatorcallsign')::string AS operatorcallsign,
           (data->>'operatoricao')::string AS operatoricao,
           (data->>'built')::string AS built,
           (data->>'categorydescription')::string AS categorydescription

    FROM casted

)

SELECT * FROM renamed
  );
11:58:08.582982 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:58:08.592984 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.596122 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: Close
11:58:08.600081 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99e1ef94-ad08-444e-a8c6-219ba27e33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f37bb0>]}
11:58:08.603573 [info ] [Thread-1  ]: 4 of 8 OK created view model public.stg_icao_mapping............................ [[32mCREATE VIEW[0m in 0.19s]
11:58:08.606638 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_icao_mapping
11:58:08.609595 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_inventory_customers
11:58:08.612048 [info ] [Thread-1  ]: 5 of 8 START view model public.stg_inventory_customers.......................... [RUN]
11:58:08.615695 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_inventory_customers"
11:58:08.618045 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_inventory_customers
11:58:08.620354 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_inventory_customers
11:58:08.640051 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_inventory_customers"
11:58:08.646965 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.649565 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_inventory_customers
11:58:08.668077 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_inventory_customers"
11:58:08.670683 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_inventory_customers"} */
drop view if exists "materialize"."public"."stg_inventory_customers" cascade
11:58:08.672938 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:58:08.678728 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:58:08.688542 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_inventory_customers"
11:58:08.693715 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_inventory_customers"
11:58:08.695824 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_inventory_customers"} */
create view "materialize"."public"."stg_inventory_customers"
  as (
    /*

The purpose of this model is to create an inventory_customers staging model.

 */





WITH source AS (

    SELECT * FROM "materialize"."public"."inventory_customers"

),

renamed AS (

    SELECT

       (data->>'id')::numeric as id,
       (data->>'first_name')::string as first_name,
       (data->>'last_name')::string as last_name,
       (data->>'email')::string as email

    FROM source

)

SELECT * FROM renamed
  );
11:58:08.699912 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "data" does not exist

11:58:08.702782 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.704879 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: Close
11:58:08.708696 [debug] [Thread-1  ]: Database Error in model stg_inventory_customers (models/examples/staging/inventory/stg_inventory_customers.sql)
  column "data" does not exist
  compiled SQL at target/run/mz_hack_day/models/examples/staging/inventory/stg_inventory_customers.sql
11:58:08.711376 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99e1ef94-ad08-444e-a8c6-219ba27e33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f8af10>]}
11:58:08.714359 [error] [Thread-1  ]: 5 of 8 ERROR creating view model public.stg_inventory_customers................. [[31mERROR[0m in 0.10s]
11:58:08.717156 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_inventory_customers
11:58:08.720057 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_flight_information
11:58:08.723291 [info ] [Thread-1  ]: 6 of 8 START view model public.stg_flight_information........................... [RUN]
11:58:08.726649 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_flight_information"
11:58:08.728963 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_flight_information
11:58:08.730880 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_flight_information
11:58:08.759441 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_flight_information"
11:58:08.765958 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.768523 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_flight_information
11:58:08.787001 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:58:08.791414 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
drop view if exists "materialize"."public"."stg_flight_information" cascade
11:58:08.793696 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:58:08.800933 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:58:08.811508 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_flight_information"
11:58:08.818438 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:58:08.820908 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
create view "materialize"."public"."stg_flight_information"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_flight_information"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'icao24')::string as icao24,
       (data->>'callsign')::string as callsign,
       (data->>'origin_country')::string as origin_country,
       (data->>'time_position')::numeric as time_position,
       (data->>'last_contact')::numeric as last_contact,
       (data->>'longitude')::double as longitude,
       (data->>'latitude')::double as latitude,
       (data->>'baro_altitude')::double as baro_altitude,
       (data->>'on_ground')::boolean as on_ground,
       (data->>'velocity')::double as velocity,
       (data->>'true_track')::double as true_track,
       (data->>'vertical_rate')::string as vertical_rate,
       (data->>'sensors')::string as sensors,
       (data->>'geo_altitude')::string as geo_altitude,
       (data->>'squawk')::string as squawk,
       (data->>'spi')::string as spi,
       (data->>'position_source')::string as position_source

    FROM casted

)

SELECT * FROM renamed
  );
11:58:08.834325 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:58:08.847576 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.850818 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: Close
11:58:08.854766 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99e1ef94-ad08-444e-a8c6-219ba27e33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f6e430>]}
11:58:08.858420 [info ] [Thread-1  ]: 6 of 8 OK created view model public.stg_flight_information...................... [[32mCREATE VIEW[0m in 0.13s]
11:58:08.861454 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_flight_information
11:58:08.863659 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_inventory
11:58:08.867064 [info ] [Thread-1  ]: 7 of 8 SKIP relation public.fct_inventory....................................... [[33mSKIP[0m]
11:58:08.870057 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_inventory
11:58:08.872283 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_flight
11:58:08.874718 [info ] [Thread-1  ]: 8 of 8 START materializedview model public.fct_flight........................... [RUN]
11:58:08.878411 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_flight"
11:58:08.880511 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_flight
11:58:08.882947 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_flight
11:58:08.906221 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_flight"
11:58:08.913297 [debug] [Thread-1  ]: finished collecting timing info
11:58:08.915276 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_flight
11:58:08.969852 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:58:08.972751 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
drop view if exists "materialize"."public"."fct_flight" cascade
11:58:08.974881 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:58:08.980709 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:58:08.997893 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_flight"
11:58:09.004953 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:58:09.007025 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
create materialized view "materialize"."public"."fct_flight"
  as (
    


SELECT fi.icao24,
       manufacturername,
       model,
       operator,
       origin_country,
       time_position,
       longitude,
       latitude
FROM "materialize"."public"."stg_flight_information" fi
JOIN "materialize"."public"."stg_icao_mapping" icao ON fi.icao24 = icao.icao24
  );
11:58:09.019483 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:58:09.031449 [debug] [Thread-1  ]: finished collecting timing info
11:58:09.034818 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: Close
11:58:09.038825 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99e1ef94-ad08-444e-a8c6-219ba27e33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027dc6c70>]}
11:58:09.042663 [info ] [Thread-1  ]: 8 of 8 OK created materializedview model public.fct_flight...................... [[32mCREATE VIEW[0m in 0.16s]
11:58:09.045787 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_flight
11:58:09.052690 [debug] [MainThread]: Acquiring new materialize connection "master"
11:58:09.055749 [debug] [MainThread]: Using materialize connection "master"
11:58:09.057968 [debug] [MainThread]: On master: BEGIN
11:58:09.060995 [debug] [MainThread]: Opening a new connection, currently in state closed
11:58:09.068327 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:58:09.072752 [debug] [MainThread]: Using materialize connection "master"
11:58:09.075595 [debug] [MainThread]: On master: COMMIT
11:58:09.078560 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:58:09.080630 [debug] [MainThread]: On master: Close
11:58:09.084145 [info ] [MainThread]: 
11:58:09.087203 [info ] [MainThread]: Finished running 3 source models, 3 view models, 2 materializedview models in 1.48s.
11:58:09.090317 [debug] [MainThread]: Connection 'master' was properly closed.
11:58:09.093566 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_flight' was properly closed.
11:58:09.138069 [info ] [MainThread]: 
11:58:09.141754 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
11:58:09.144569 [info ] [MainThread]: 
11:58:09.147152 [error] [MainThread]: [33mDatabase Error in model stg_inventory_customers (models/examples/staging/inventory/stg_inventory_customers.sql)[0m
11:58:09.149818 [error] [MainThread]:   column "data" does not exist
11:58:09.152169 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/examples/staging/inventory/stg_inventory_customers.sql
11:58:09.155594 [info ] [MainThread]: 
11:58:09.158110 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=1 TOTAL=8
11:58:09.162109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f90100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f90160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2d610>]}


============================== 2022-02-19 11:58:59.208660 | abe62d1c-7830-40d7-9151-1669e98e224d ==============================
11:58:59.208660 [info ] [MainThread]: Running with dbt=1.0.1
11:58:59.216677 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
11:58:59.220167 [debug] [MainThread]: Tracking: tracking
11:58:59.250409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abdf0>]}
11:58:59.632767 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
11:58:59.636796 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/examples/staging/inventory/stg_inventory_customers.sql
11:58:59.750054 [debug] [MainThread]: 1699: static parser successfully parsed examples/staging/inventory/stg_inventory_customers.sql
11:58:59.948507 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.templates
- models.examples

11:58:59.990585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abe62d1c-7830-40d7-9151-1669e98e224d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2df40>]}
11:59:00.062415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abe62d1c-7830-40d7-9151-1669e98e224d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007339bb0>]}
11:59:00.065917 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
11:59:00.077101 [info ] [MainThread]: 
11:59:00.081624 [debug] [MainThread]: Acquiring new materialize connection "master"
11:59:00.092675 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
11:59:00.168762 [debug] [ThreadPool]: Using materialize connection "list_materialize"
11:59:00.171823 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
11:59:00.174660 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:59:00.205709 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
11:59:00.216184 [debug] [ThreadPool]: On list_materialize: Close
11:59:00.228261 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
11:59:00.253203 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
11:59:00.256060 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
11:59:00.258251 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:59:00.267711 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
11:59:00.277320 [debug] [ThreadPool]: On list_materialize_public: Close
11:59:00.285461 [debug] [MainThread]: Using materialize connection "master"
11:59:00.288066 [debug] [MainThread]: On master: BEGIN
11:59:00.290229 [debug] [MainThread]: Opening a new connection, currently in state init
11:59:00.296143 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:59:00.299206 [debug] [MainThread]: Using materialize connection "master"
11:59:00.301348 [debug] [MainThread]: On master: COMMIT
11:59:00.304126 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:59:00.306411 [debug] [MainThread]: On master: Close
11:59:00.309561 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
11:59:00.312760 [info ] [MainThread]: 
11:59:00.331216 [debug] [Thread-1  ]: Began running node model.mz_hack_day.icao_mapping
11:59:00.334638 [info ] [Thread-1  ]: 1 of 8 START source model public.icao_mapping................................... [RUN]
11:59:00.338473 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.icao_mapping"
11:59:00.340669 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.icao_mapping
11:59:00.342699 [debug] [Thread-1  ]: Compiling model.mz_hack_day.icao_mapping
11:59:00.385077 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.icao_mapping"
11:59:00.395212 [debug] [Thread-1  ]: finished collecting timing info
11:59:00.397878 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.icao_mapping
11:59:00.460173 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:59:00.463278 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */
drop source if exists 
      materialize.public.icao_mapping
   cascade
11:59:00.465216 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:59:00.476243 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:59:00.519129 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.icao_mapping"
11:59:00.526278 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.icao_mapping"
11:59:00.528747 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.icao_mapping"} */




CREATE SOURCE 
    materialize.public.icao_mapping

FROM FILE '/tmp/icao24_mapping_airbus.json.gz' COMPRESSION GZIP
FORMAT BYTES;
11:59:00.538475 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:59:00.591625 [debug] [Thread-1  ]: finished collecting timing info
11:59:00.594719 [debug] [Thread-1  ]: On model.mz_hack_day.icao_mapping: Close
11:59:00.598946 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abe62d1c-7830-40d7-9151-1669e98e224d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2df10>]}
11:59:00.602272 [info ] [Thread-1  ]: 1 of 8 OK created source model public.icao_mapping.............................. [[32mCREATE SOURCE[0m in 0.26s]
11:59:00.606238 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.icao_mapping
11:59:00.608592 [debug] [Thread-1  ]: Began running node model.mz_hack_day.inventory_customers
11:59:00.611558 [info ] [Thread-1  ]: 2 of 8 START source model public.inventory_customers............................ [RUN]
11:59:00.615278 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.inventory_customers"
11:59:00.617360 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.inventory_customers
11:59:00.619522 [debug] [Thread-1  ]: Compiling model.mz_hack_day.inventory_customers
11:59:00.640732 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.inventory_customers"
11:59:00.647629 [debug] [Thread-1  ]: finished collecting timing info
11:59:00.650111 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.inventory_customers
11:59:00.660436 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:59:00.662635 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */
drop source if exists 
      materialize.public.inventory_customers
   cascade
11:59:00.664611 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:59:00.674284 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:59:00.682518 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.inventory_customers"
11:59:00.688464 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.inventory_customers"
11:59:00.690224 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.inventory_customers"} */




CREATE SOURCE 
    materialize.public.inventory_customers

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'dbserver1.inventory.customers'
FORMAT AVRO USING CONFLUENT SCHEMA REGISTRY 'http://redpanda:8081'
ENVELOPE DEBEZIUM;
11:59:00.706580 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:59:00.717267 [debug] [Thread-1  ]: finished collecting timing info
11:59:00.719877 [debug] [Thread-1  ]: On model.mz_hack_day.inventory_customers: Close
11:59:00.723943 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abe62d1c-7830-40d7-9151-1669e98e224d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d95e50>]}
11:59:00.727769 [info ] [Thread-1  ]: 2 of 8 OK created source model public.inventory_customers....................... [[32mCREATE SOURCE[0m in 0.11s]
11:59:00.730932 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.inventory_customers
11:59:00.733494 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_flight_information
11:59:00.736679 [info ] [Thread-1  ]: 3 of 8 START source model public.rp_flight_information.......................... [RUN]
11:59:00.740206 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_flight_information"
11:59:00.742310 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_flight_information
11:59:00.744417 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_flight_information
11:59:00.765341 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_flight_information"
11:59:00.771712 [debug] [Thread-1  ]: finished collecting timing info
11:59:00.773991 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_flight_information
11:59:00.785628 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:59:00.788147 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */
drop source if exists 
      materialize.public.rp_flight_information
   cascade
11:59:00.791683 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:59:00.800066 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:59:00.808187 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_flight_information"
11:59:00.814305 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_flight_information"
11:59:00.816193 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.rp_flight_information"} */




CREATE SOURCE 
    materialize.public.rp_flight_information

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'flight_information'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
11:59:00.825566 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:59:00.835537 [debug] [Thread-1  ]: finished collecting timing info
11:59:00.837910 [debug] [Thread-1  ]: On model.mz_hack_day.rp_flight_information: Close
11:59:00.841397 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abe62d1c-7830-40d7-9151-1669e98e224d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f35d00>]}
11:59:00.844735 [info ] [Thread-1  ]: 3 of 8 OK created source model public.rp_flight_information..................... [[32mCREATE SOURCE[0m in 0.10s]
11:59:00.847918 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_flight_information
11:59:00.850111 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_icao_mapping
11:59:00.852620 [info ] [Thread-1  ]: 4 of 8 START view model public.stg_icao_mapping................................. [RUN]
11:59:00.856302 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_icao_mapping"
11:59:00.858458 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_icao_mapping
11:59:00.860656 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_icao_mapping
11:59:00.881787 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_icao_mapping"
11:59:00.889394 [debug] [Thread-1  ]: finished collecting timing info
11:59:00.894533 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_icao_mapping
11:59:00.970454 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:59:00.973919 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
drop view if exists "materialize"."public"."stg_icao_mapping" cascade
11:59:00.976498 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:59:00.982225 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:59:01.009835 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_icao_mapping"
11:59:01.016490 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_icao_mapping"
11:59:01.018931 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_icao_mapping"} */
create view "materialize"."public"."stg_icao_mapping"
  as (
    /*

The purpose of this staging model is to create a icao_mapping staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."icao_mapping"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

    (data->>'icao24')::string AS icao24,
           (data->>'manufacturericao')::string AS manufacturericao,
           (data->>'manufacturername')::string AS manufacturername,
           (data->>'model')::string AS model,
           (data->>'typecode')::string AS typecode,
           (data->>'icaoaircrafttype')::string AS icaoaircrafttype,
           (data->>'operator')::string AS operator,
           (data->>'operatorcallsign')::string AS operatorcallsign,
           (data->>'operatoricao')::string AS operatoricao,
           (data->>'built')::string AS built,
           (data->>'categorydescription')::string AS categorydescription

    FROM casted

)

SELECT * FROM renamed
  );
11:59:01.028496 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:59:01.038460 [debug] [Thread-1  ]: finished collecting timing info
11:59:01.040792 [debug] [Thread-1  ]: On model.mz_hack_day.stg_icao_mapping: Close
11:59:01.044146 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abe62d1c-7830-40d7-9151-1669e98e224d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f35c10>]}
11:59:01.047374 [info ] [Thread-1  ]: 4 of 8 OK created view model public.stg_icao_mapping............................ [[32mCREATE VIEW[0m in 0.19s]
11:59:01.050453 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_icao_mapping
11:59:01.052668 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_inventory_customers
11:59:01.055415 [info ] [Thread-1  ]: 5 of 8 START view model public.stg_inventory_customers.......................... [RUN]
11:59:01.059426 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_inventory_customers"
11:59:01.061829 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_inventory_customers
11:59:01.064091 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_inventory_customers
11:59:01.083364 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_inventory_customers"
11:59:01.090307 [debug] [Thread-1  ]: finished collecting timing info
11:59:01.092300 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_inventory_customers
11:59:01.110216 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_inventory_customers"
11:59:01.113081 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_inventory_customers"} */
drop view if exists "materialize"."public"."stg_inventory_customers" cascade
11:59:01.115383 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:59:01.121015 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:59:01.130801 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_inventory_customers"
11:59:01.136744 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_inventory_customers"
11:59:01.138760 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_inventory_customers"} */
create view "materialize"."public"."stg_inventory_customers"
  as (
    /*

The purpose of this model is to create an inventory_customers staging model.

 */





WITH source AS (

    SELECT * FROM "materialize"."public"."inventory_customers"

),

renamed AS (

    SELECT

       id::numeric as id,
       first_name::string as first_name,
       last_name::string as last_name,
       email::string as email

    FROM source

)

SELECT * FROM renamed
  );
11:59:01.147483 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:59:01.157413 [debug] [Thread-1  ]: finished collecting timing info
11:59:01.159772 [debug] [Thread-1  ]: On model.mz_hack_day.stg_inventory_customers: Close
11:59:01.163513 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abe62d1c-7830-40d7-9151-1669e98e224d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027dc7b80>]}
11:59:01.166768 [info ] [Thread-1  ]: 5 of 8 OK created view model public.stg_inventory_customers..................... [[32mCREATE VIEW[0m in 0.10s]
11:59:01.170694 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_inventory_customers
11:59:01.172920 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_flight_information
11:59:01.175737 [info ] [Thread-1  ]: 6 of 8 START view model public.stg_flight_information........................... [RUN]
11:59:01.179621 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_flight_information"
11:59:01.181918 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_flight_information
11:59:01.184309 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_flight_information
11:59:01.208836 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_flight_information"
11:59:01.214810 [debug] [Thread-1  ]: finished collecting timing info
11:59:01.217105 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_flight_information
11:59:01.234326 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:59:01.236893 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
drop view if exists "materialize"."public"."stg_flight_information" cascade
11:59:01.239118 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:59:01.245297 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:59:01.255448 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_flight_information"
11:59:01.261444 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_flight_information"
11:59:01.263687 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.stg_flight_information"} */
create view "materialize"."public"."stg_flight_information"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_flight_information"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'icao24')::string as icao24,
       (data->>'callsign')::string as callsign,
       (data->>'origin_country')::string as origin_country,
       (data->>'time_position')::numeric as time_position,
       (data->>'last_contact')::numeric as last_contact,
       (data->>'longitude')::double as longitude,
       (data->>'latitude')::double as latitude,
       (data->>'baro_altitude')::double as baro_altitude,
       (data->>'on_ground')::boolean as on_ground,
       (data->>'velocity')::double as velocity,
       (data->>'true_track')::double as true_track,
       (data->>'vertical_rate')::string as vertical_rate,
       (data->>'sensors')::string as sensors,
       (data->>'geo_altitude')::string as geo_altitude,
       (data->>'squawk')::string as squawk,
       (data->>'spi')::string as spi,
       (data->>'position_source')::string as position_source

    FROM casted

)

SELECT * FROM renamed
  );
11:59:01.272951 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:59:01.282747 [debug] [Thread-1  ]: finished collecting timing info
11:59:01.285259 [debug] [Thread-1  ]: On model.mz_hack_day.stg_flight_information: Close
11:59:01.290850 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abe62d1c-7830-40d7-9151-1669e98e224d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f85bb0>]}
11:59:01.294275 [info ] [Thread-1  ]: 6 of 8 OK created view model public.stg_flight_information...................... [[32mCREATE VIEW[0m in 0.11s]
11:59:01.297413 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_flight_information
11:59:01.300093 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_inventory
11:59:01.302869 [info ] [Thread-1  ]: 7 of 8 START materializedview model public.fct_inventory........................ [RUN]
11:59:01.306466 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_inventory"
11:59:01.308915 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_inventory
11:59:01.311128 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_inventory
11:59:01.328693 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_inventory"
11:59:01.335064 [debug] [Thread-1  ]: finished collecting timing info
11:59:01.337048 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_inventory
11:59:01.391478 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_inventory"
11:59:01.402154 [debug] [Thread-1  ]: On model.mz_hack_day.fct_inventory: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_inventory"} */
drop view if exists "materialize"."public"."fct_inventory" cascade
11:59:01.405138 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:59:01.412520 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:59:01.436284 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_inventory"
11:59:01.442930 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_inventory"
11:59:01.445179 [debug] [Thread-1  ]: On model.mz_hack_day.fct_inventory: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_inventory"} */
create materialized view "materialize"."public"."fct_inventory"
  as (
    


select *
from "materialize"."public"."stg_inventory_customers"
  );
11:59:01.455644 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:59:01.467106 [debug] [Thread-1  ]: finished collecting timing info
11:59:01.469986 [debug] [Thread-1  ]: On model.mz_hack_day.fct_inventory: Close
11:59:01.473589 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abe62d1c-7830-40d7-9151-1669e98e224d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073bbfa0>]}
11:59:01.477551 [info ] [Thread-1  ]: 7 of 8 OK created materializedview model public.fct_inventory................... [[32mCREATE VIEW[0m in 0.17s]
11:59:01.480643 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_inventory
11:59:01.483113 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_flight
11:59:01.485768 [info ] [Thread-1  ]: 8 of 8 START materializedview model public.fct_flight........................... [RUN]
11:59:01.489699 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_flight"
11:59:01.491882 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_flight
11:59:01.494245 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_flight
11:59:01.516642 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_flight"
11:59:01.522870 [debug] [Thread-1  ]: finished collecting timing info
11:59:01.525522 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_flight
11:59:01.542509 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:59:01.545133 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
drop view if exists "materialize"."public"."fct_flight" cascade
11:59:01.547364 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:59:01.552754 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:59:01.561384 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_flight"
11:59:01.567073 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_flight"
11:59:01.570018 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "materialize_hack_day_2022", "target_name": "dev", "node_id": "model.mz_hack_day.fct_flight"} */
create materialized view "materialize"."public"."fct_flight"
  as (
    


SELECT fi.icao24,
       manufacturername,
       model,
       operator,
       origin_country,
       time_position,
       longitude,
       latitude
FROM "materialize"."public"."stg_flight_information" fi
JOIN "materialize"."public"."stg_icao_mapping" icao ON fi.icao24 = icao.icao24
  );
11:59:01.580449 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:59:01.591874 [debug] [Thread-1  ]: finished collecting timing info
11:59:01.594629 [debug] [Thread-1  ]: On model.mz_hack_day.fct_flight: Close
11:59:01.598908 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abe62d1c-7830-40d7-9151-1669e98e224d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f6a6a0>]}
11:59:01.602518 [info ] [Thread-1  ]: 8 of 8 OK created materializedview model public.fct_flight...................... [[32mCREATE VIEW[0m in 0.11s]
11:59:01.606478 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_flight
11:59:01.613742 [debug] [MainThread]: Acquiring new materialize connection "master"
11:59:01.616783 [debug] [MainThread]: Using materialize connection "master"
11:59:01.619157 [debug] [MainThread]: On master: BEGIN
11:59:01.621614 [debug] [MainThread]: Opening a new connection, currently in state closed
11:59:01.626953 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:59:01.629410 [debug] [MainThread]: Using materialize connection "master"
11:59:01.631301 [debug] [MainThread]: On master: COMMIT
11:59:01.633844 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:59:01.636444 [debug] [MainThread]: On master: Close
11:59:01.640063 [info ] [MainThread]: 
11:59:01.643011 [info ] [MainThread]: Finished running 3 source models, 3 view models, 2 materializedview models in 1.56s.
11:59:01.646139 [debug] [MainThread]: Connection 'master' was properly closed.
11:59:01.648497 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_flight' was properly closed.
11:59:01.689113 [info ] [MainThread]: 
11:59:01.691745 [info ] [MainThread]: [32mCompleted successfully[0m
11:59:01.695158 [info ] [MainThread]: 
11:59:01.697884 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
11:59:01.702301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f45910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027db47c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027daf4c0>]}


============================== 2022-02-22 19:21:51.426887 | 1dedc050-6de1-4bdf-bf16-2dc0233de123 ==============================
19:21:51.426887 [info ] [MainThread]: Running with dbt=1.0.1
19:21:51.432100 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, defer=None, state=None, cls=<class 'dbt.task.deps.DepsTask'>, which='deps', rpc_method='deps')
19:21:51.434676 [debug] [MainThread]: Tracking: tracking
19:21:51.464873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007399250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007399160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073991c0>]}
19:21:51.478530 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-yl1r9ggk'
19:21:51.482366 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
19:21:51.831519 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
19:21:51.835895 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils.json
19:21:52.296521 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils.json 200
19:21:52.316991 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils/0.1.0.json
19:21:52.889276 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils/0.1.0.json 200
19:21:52.897396 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils.json
19:21:53.087288 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils.json 200
19:21:53.096298 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils/0.1.0.json
19:21:53.269517 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/MaterializeInc/materialize_dbt_utils/0.1.0.json 200
19:21:53.274117 [info ] [MainThread]: Installing MaterializeInc/materialize_dbt_utils
19:21:53.943417 [info ] [MainThread]:   Installed from version 0.1.0
19:21:53.946202 [info ] [MainThread]:   Up to date!
19:21:53.949067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1dedc050-6de1-4bdf-bf16-2dc0233de123', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073c7820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073c7a00>]}
19:21:53.951971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007399d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007399af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073991c0>]}


============================== 2022-02-22 19:39:19.173757 | 1c37cfd2-b071-4e7f-9365-f6105620c931 ==============================
19:39:19.173757 [info ] [MainThread]: Running with dbt=1.0.1
19:39:19.180426 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:39:19.183094 [debug] [MainThread]: Tracking: tracking
19:39:19.212565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072c5700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072c57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072c5790>]}
19:39:19.592732 [debug] [MainThread]: Partial parsing enabled: 19 files deleted, 6 files added, 0 files changed.
19:39:19.596963 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
19:39:19.600182 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:39:19.603855 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter.yml
19:39:19.606488 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/twitter_trending/sources/twitter/src_twitter.yml
19:39:19.609334 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter.yml
19:39:19.612026 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/twitter_trending/sources/twitter/rp_twitter_trending.sql
19:39:19.615736 [debug] [MainThread]: Partial parsing: model.mz_hack_day.stg_example not found in child_map
19:39:19.617698 [debug] [MainThread]: Partial parsing: deleted file: mz_hack_day://models/templates/staging/new_staging_source/stg_example.sql
19:39:19.619921 [debug] [MainThread]: Partial parsing: deleted file: mz_hack_day://models/examples/staging/inventory/stg_inventory_customers.sql
19:39:19.621921 [debug] [MainThread]: Partial parsing: model.mz_hack_day.source_example not found in child_map
19:39:19.623735 [debug] [MainThread]: Partial parsing: deleted file: mz_hack_day://models/templates/sources/new_source/source_example.sql
19:39:19.625622 [debug] [MainThread]: Partial parsing: deleted file: mz_hack_day://models/examples/sources/inventory/inventory_customers.sql
19:39:19.627753 [debug] [MainThread]: Partial parsing: deleted file: mz_hack_day://models/examples/marts/inventory/fct_inventory.sql
19:39:19.629715 [debug] [MainThread]: Partial parsing: deleted file: mz_hack_day://models/examples/sources/flight/rp_flight_information.sql
19:39:19.631628 [debug] [MainThread]: Partial parsing: deleted file: mz_hack_day://models/examples/staging/flight/stg_flight_information.sql
19:39:19.634190 [debug] [MainThread]: Partial parsing: deleted file: mz_hack_day://models/examples/staging/flight/stg_icao_mapping.sql
19:39:19.636244 [debug] [MainThread]: Partial parsing: deleted file: mz_hack_day://models/examples/sources/flight/icao_mapping.sql
19:39:19.638131 [debug] [MainThread]: Partial parsing: deleted file: mz_hack_day://models/examples/marts/flight/fct_flight.sql
19:39:19.640300 [debug] [MainThread]: Partial parsing: model.mz_hack_day.fct_example not found in child_map
19:39:19.642180 [debug] [MainThread]: Partial parsing: deleted file: mz_hack_day://models/templates/marts/core/fct_example.sql
19:39:19.744003 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
19:39:19.835074 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
19:39:19.854119 [debug] [MainThread]: 1603: static parser failed on twitter_trending/sources/twitter/rp_twitter_trending.sql
19:39:19.892912 [debug] [MainThread]: 1602: parser fallback to jinja rendering on twitter_trending/sources/twitter/rp_twitter_trending.sql
19:39:19.959911 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'fct_twitter_trending' in the 'models' section of file 'models/twitter_trending/marts/twitter/fct_twitter.yml'
19:39:19.967905 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'rp_trending_data' in the 'models' section of file 'models/twitter_trending/sources/twitter/src_twitter.yml'
19:39:19.986330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073be8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c1ac70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073c91c0>]}


============================== 2022-02-22 19:40:29.688792 | e968da6f-bdd9-4ed7-a61c-661452c71694 ==============================
19:40:29.688792 [info ] [MainThread]: Running with dbt=1.0.1
19:40:29.696036 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:40:29.699912 [debug] [MainThread]: Tracking: tracking
19:40:29.726694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acdf0>]}
19:40:29.900639 [info ] [MainThread]: Unable to do partial parsing because profile has changed
19:40:29.904931 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
19:40:29.908006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e968da6f-bdd9-4ed7-a61c-661452c71694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072a4e50>]}
19:40:30.052198 [debug] [MainThread]: Parsing macros/adapters.sql
19:40:30.144170 [debug] [MainThread]: Parsing macros/catalog.sql
19:40:30.165179 [debug] [MainThread]: Parsing macros/mz_generate_name.sql
19:40:30.172365 [debug] [MainThread]: Parsing macros/relations.sql
19:40:30.207190 [debug] [MainThread]: Parsing macros/materializations/source.sql
19:40:30.228713 [debug] [MainThread]: Parsing macros/materializations/view.sql
19:40:30.247398 [debug] [MainThread]: Parsing macros/materializations/seed.sql
19:40:30.306079 [debug] [MainThread]: Parsing macros/materializations/index.sql
19:40:30.326417 [debug] [MainThread]: Parsing macros/materializations/table.sql
19:40:30.346368 [debug] [MainThread]: Parsing macros/materializations/materialized_view.sql
19:40:30.365190 [debug] [MainThread]: Parsing macros/materializations/sink.sql
19:40:30.385115 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
19:40:30.391533 [debug] [MainThread]: Parsing macros/materializations/helpers.sql
19:40:30.406424 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
19:40:30.420214 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
19:40:30.439670 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
19:40:30.453110 [debug] [MainThread]: Parsing macros/adapters/relation.sql
19:40:30.528172 [debug] [MainThread]: Parsing macros/adapters/schema.sql
19:40:30.546299 [debug] [MainThread]: Parsing macros/adapters/columns.sql
19:40:30.621918 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
19:40:30.656394 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
19:40:30.709644 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
19:40:30.733863 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
19:40:30.754654 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
19:40:30.783967 [debug] [MainThread]: Parsing macros/materializations/configs.sql
19:40:30.802231 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
19:40:30.850211 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
19:40:30.969997 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
19:40:31.096634 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
19:40:31.193167 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
19:40:31.208194 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
19:40:31.292143 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
19:40:31.348405 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
19:40:31.372328 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
19:40:31.457016 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
19:40:31.490603 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
19:40:31.503322 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
19:40:31.619806 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
19:40:31.696760 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
19:40:31.750456 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
19:40:31.768646 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
19:40:31.790686 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
19:40:31.801914 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
19:40:31.837202 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
19:40:31.851465 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
19:40:31.865635 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
19:40:31.872355 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
19:40:31.877326 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
19:40:31.885072 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
19:40:31.896657 [debug] [MainThread]: Parsing macros/etc/statement.sql
19:40:31.930416 [debug] [MainThread]: Parsing macros/etc/datetime.sql
19:40:31.993824 [debug] [MainThread]: Parsing tests/generic/builtin.sql
19:40:32.017892 [debug] [MainThread]: Parsing macros/dbt_utils/date_trunc.sql
19:40:32.023430 [debug] [MainThread]: Parsing macros/dbt_utils/dateadd.sql
19:40:32.029270 [debug] [MainThread]: Parsing macros/dbt_utils/datediff.sql
19:40:32.035171 [debug] [MainThread]: Parsing macros/dbt_utils/get_tables_by_pattern_sql.sql
19:40:32.043543 [debug] [MainThread]: Parsing macros/dbt_utils/last_day.sql
19:40:33.416179 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
19:40:33.500035 [debug] [MainThread]: 1603: static parser failed on twitter_trending/sources/twitter/rp_twitter_trending.sql
19:40:33.536408 [debug] [MainThread]: 1602: parser fallback to jinja rendering on twitter_trending/sources/twitter/rp_twitter_trending.sql
19:40:33.546371 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
19:40:33.685063 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'fct_twitter_trending' in the 'models' section of file 'models/twitter_trending/marts/twitter/fct_twitter.yml'
19:40:33.693477 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'rp_trending_data' in the 'models' section of file 'models/twitter_trending/sources/twitter/src_twitter.yml'
19:40:33.716256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c35280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c1da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c1d910>]}


============================== 2022-02-22 19:41:54.741630 | 82058250-4248-4162-a827-b1749b4b7428 ==============================
19:41:54.741630 [info ] [MainThread]: Running with dbt=1.0.1
19:41:54.749996 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:41:54.754128 [debug] [MainThread]: Tracking: tracking
19:41:54.789826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace20>]}
19:41:54.959941 [info ] [MainThread]: Unable to do partial parsing because profile has changed
19:41:54.963646 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
19:41:54.966767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '82058250-4248-4162-a827-b1749b4b7428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728d7c0>]}
19:41:55.141044 [debug] [MainThread]: Parsing macros/adapters.sql
19:41:55.229364 [debug] [MainThread]: Parsing macros/catalog.sql
19:41:55.248775 [debug] [MainThread]: Parsing macros/mz_generate_name.sql
19:41:55.255681 [debug] [MainThread]: Parsing macros/relations.sql
19:41:55.287622 [debug] [MainThread]: Parsing macros/materializations/source.sql
19:41:55.308654 [debug] [MainThread]: Parsing macros/materializations/view.sql
19:41:55.328532 [debug] [MainThread]: Parsing macros/materializations/seed.sql
19:41:55.391633 [debug] [MainThread]: Parsing macros/materializations/index.sql
19:41:55.413478 [debug] [MainThread]: Parsing macros/materializations/table.sql
19:41:55.433276 [debug] [MainThread]: Parsing macros/materializations/materialized_view.sql
19:41:55.451935 [debug] [MainThread]: Parsing macros/materializations/sink.sql
19:41:55.472875 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
19:41:55.478909 [debug] [MainThread]: Parsing macros/materializations/helpers.sql
19:41:55.492733 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
19:41:55.507835 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
19:41:55.528536 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
19:41:55.542049 [debug] [MainThread]: Parsing macros/adapters/relation.sql
19:41:55.616419 [debug] [MainThread]: Parsing macros/adapters/schema.sql
19:41:55.633918 [debug] [MainThread]: Parsing macros/adapters/columns.sql
19:41:55.708162 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
19:41:55.744660 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
19:41:55.799051 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
19:41:55.823481 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
19:41:55.845057 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
19:41:55.875063 [debug] [MainThread]: Parsing macros/materializations/configs.sql
19:41:55.893786 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
19:41:55.942235 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
19:41:56.064454 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
19:41:56.196158 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
19:41:56.295552 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
19:41:56.309668 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
19:41:56.396464 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
19:41:56.456117 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
19:41:56.483127 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
19:41:56.582249 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
19:41:56.624533 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
19:41:56.639809 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
19:41:56.768894 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
19:41:56.852875 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
19:41:56.916350 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
19:41:56.947541 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
19:41:56.974146 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
19:41:56.989464 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
19:41:57.034443 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
19:41:57.054293 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
19:41:57.073830 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
19:41:57.083945 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
19:41:57.093175 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
19:41:57.104985 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
19:41:57.119939 [debug] [MainThread]: Parsing macros/etc/statement.sql
19:41:57.239975 [debug] [MainThread]: Parsing macros/etc/datetime.sql
19:41:57.331472 [debug] [MainThread]: Parsing tests/generic/builtin.sql
19:41:57.359993 [debug] [MainThread]: Parsing macros/dbt_utils/date_trunc.sql
19:41:57.369976 [debug] [MainThread]: Parsing macros/dbt_utils/dateadd.sql
19:41:57.378875 [debug] [MainThread]: Parsing macros/dbt_utils/datediff.sql
19:41:57.388120 [debug] [MainThread]: Parsing macros/dbt_utils/get_tables_by_pattern_sql.sql
19:41:57.398167 [debug] [MainThread]: Parsing macros/dbt_utils/last_day.sql
19:41:58.798441 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
19:41:58.899619 [debug] [MainThread]: 1603: static parser failed on twitter_trending/sources/twitter/rp_twitter_trending.sql
19:41:58.942331 [debug] [MainThread]: 1602: parser fallback to jinja rendering on twitter_trending/sources/twitter/rp_twitter_trending.sql
19:41:58.953827 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
19:41:59.235786 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

19:41:59.279143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82058250-4248-4162-a827-b1749b4b7428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073a3c40>]}
19:41:59.332264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82058250-4248-4162-a827-b1749b4b7428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073a3e80>]}
19:41:59.336406 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:41:59.349099 [info ] [MainThread]: 
19:41:59.355652 [debug] [MainThread]: Acquiring new materialize connection "master"
19:41:59.365757 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
19:41:59.458609 [debug] [ThreadPool]: Using materialize connection "list_materialize"
19:41:59.461716 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
19:41:59.464514 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:41:59.502113 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.04 seconds
19:41:59.513133 [debug] [ThreadPool]: On list_materialize: Close
19:41:59.523910 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
19:41:59.547138 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
19:41:59.549893 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
19:41:59.552321 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:41:59.560080 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
19:41:59.569724 [debug] [ThreadPool]: On list_materialize_public: Close
19:41:59.576820 [debug] [MainThread]: Using materialize connection "master"
19:41:59.579411 [debug] [MainThread]: On master: BEGIN
19:41:59.581617 [debug] [MainThread]: Opening a new connection, currently in state init
19:41:59.587704 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:41:59.591003 [debug] [MainThread]: Using materialize connection "master"
19:41:59.593675 [debug] [MainThread]: On master: COMMIT
19:41:59.596816 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:41:59.598947 [debug] [MainThread]: On master: Close
19:41:59.602145 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:41:59.605198 [info ] [MainThread]: 
19:41:59.720502 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
19:41:59.724337 [info ] [Thread-1  ]: 1 of 3 START source model public.rp_twitter_trending............................ [RUN]
19:41:59.728817 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
19:41:59.731363 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
19:41:59.733962 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
19:41:59.755919 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
19:41:59.774349 [debug] [Thread-1  ]: finished collecting timing info
19:41:59.776691 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
19:41:59.831501 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:41:59.834495 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
19:41:59.837272 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:41:59.845188 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
19:41:59.894790 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
19:41:59.920406 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:41:59.923165 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_trending_data

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
19:41:59.938765 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
19:41:59.987793 [debug] [Thread-1  ]: finished collecting timing info
19:41:59.990737 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
19:41:59.994609 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82058250-4248-4162-a827-b1749b4b7428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c91490>]}
19:41:59.998110 [info ] [Thread-1  ]: 1 of 3 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.27s]
19:42:00.001794 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
19:42:00.007329 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
19:42:00.011416 [info ] [Thread-1  ]: 2 of 3 START view model public.stg_twitter_trending............................. [RUN]
19:42:00.015100 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
19:42:00.017616 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
19:42:00.020115 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
19:42:00.038842 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
19:42:00.052200 [debug] [Thread-1  ]: finished collecting timing info
19:42:00.054573 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
19:42:00.121397 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:42:00.124619 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
19:42:00.127365 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:42:00.133703 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
19:42:00.159261 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
19:42:00.173811 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:42:00.176063 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_twitter_trending"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'location'->>'name')::string as location_name,
       (data->>'location'->>'country')::string as location_country,
       (data->>'trends'->>'name')::string as trend_name,
       (data->>'trends'->>'tweet_volume')::numeric as tweet_volume

    FROM casted

)

SELECT * FROM renamed
  );
19:42:00.180361 [debug] [Thread-1  ]: Postgres adapter: Postgres error: unknown catalog item 'materialize.public.rp_twitter_trending'

19:42:00.183514 [debug] [Thread-1  ]: finished collecting timing info
19:42:00.185939 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
19:42:00.189846 [debug] [Thread-1  ]: Database Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)
  unknown catalog item 'materialize.public.rp_twitter_trending'
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:42:00.192796 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82058250-4248-4162-a827-b1749b4b7428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4030814f40>]}
19:42:00.195826 [error] [Thread-1  ]: 2 of 3 ERROR creating view model public.stg_twitter_trending.................... [[31mERROR[0m in 0.18s]
19:42:00.199014 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
19:42:00.203326 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
19:42:00.205732 [info ] [Thread-1  ]: 3 of 3 SKIP relation public.fct_twitter_trending................................ [[33mSKIP[0m]
19:42:00.209294 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
19:42:00.218674 [debug] [MainThread]: Acquiring new materialize connection "master"
19:42:00.225742 [debug] [MainThread]: Using materialize connection "master"
19:42:00.228104 [debug] [MainThread]: On master: BEGIN
19:42:00.230725 [debug] [MainThread]: Opening a new connection, currently in state closed
19:42:00.236823 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:42:00.239265 [debug] [MainThread]: Using materialize connection "master"
19:42:00.241365 [debug] [MainThread]: On master: COMMIT
19:42:00.244043 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:42:00.245975 [debug] [MainThread]: On master: Close
19:42:00.249376 [info ] [MainThread]: 
19:42:00.252357 [info ] [MainThread]: Finished running 1 source model, 1 view model, 1 materializedview model in 0.89s.
19:42:00.255308 [debug] [MainThread]: Connection 'master' was properly closed.
19:42:00.257306 [debug] [MainThread]: Connection 'model.mz_hack_day.stg_twitter_trending' was properly closed.
19:42:00.292845 [info ] [MainThread]: 
19:42:00.295896 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:42:00.298664 [info ] [MainThread]: 
19:42:00.301208 [error] [MainThread]: [33mDatabase Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)[0m
19:42:00.304039 [error] [MainThread]:   unknown catalog item 'materialize.public.rp_twitter_trending'
19:42:00.307354 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:42:00.310410 [info ] [MainThread]: 
19:42:00.313776 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
19:42:00.317355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027bfe7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027bfe640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4030814c40>]}


============================== 2022-02-22 19:43:04.947868 | 204f6846-3deb-4382-b8b5-46559aa64705 ==============================
19:43:04.947868 [info ] [MainThread]: Running with dbt=1.0.1
19:43:04.954313 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:43:04.956745 [debug] [MainThread]: Tracking: tracking
19:43:04.989486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace20>]}
19:43:05.293071 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:43:05.297702 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/sources/twitter/rp_twitter_trending.sql
19:43:05.384562 [debug] [MainThread]: 1603: static parser failed on twitter_trending/sources/twitter/rp_twitter_trending.sql
19:43:05.483619 [debug] [MainThread]: 1602: parser fallback to jinja rendering on twitter_trending/sources/twitter/rp_twitter_trending.sql
19:43:05.569164 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

19:43:05.606206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '204f6846-3deb-4382-b8b5-46559aa64705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073fb0d0>]}
19:43:05.654461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '204f6846-3deb-4382-b8b5-46559aa64705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007295d30>]}
19:43:05.657770 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:43:05.665102 [info ] [MainThread]: 
19:43:05.669156 [debug] [MainThread]: Acquiring new materialize connection "master"
19:43:05.678714 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
19:43:05.746762 [debug] [ThreadPool]: Using materialize connection "list_materialize"
19:43:05.749596 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
19:43:05.752031 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:43:05.778824 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
19:43:05.789187 [debug] [ThreadPool]: On list_materialize: Close
19:43:05.797953 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
19:43:05.820608 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
19:43:05.823141 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
19:43:05.825393 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:43:05.832803 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
19:43:05.842549 [debug] [ThreadPool]: On list_materialize_public: Close
19:43:05.848036 [debug] [MainThread]: Using materialize connection "master"
19:43:05.850397 [debug] [MainThread]: On master: BEGIN
19:43:05.852495 [debug] [MainThread]: Opening a new connection, currently in state init
19:43:05.858771 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:43:05.861693 [debug] [MainThread]: Using materialize connection "master"
19:43:05.864873 [debug] [MainThread]: On master: COMMIT
19:43:05.867439 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:43:05.869767 [debug] [MainThread]: On master: Close
19:43:05.872817 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:43:05.875421 [info ] [MainThread]: 
19:43:05.892132 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
19:43:05.895454 [info ] [Thread-1  ]: 1 of 3 START source model public.rp_twitter_trending............................ [RUN]
19:43:05.899991 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
19:43:05.903752 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
19:43:05.905848 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
19:43:05.926647 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
19:43:05.934297 [debug] [Thread-1  ]: finished collecting timing info
19:43:05.936976 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
19:43:05.992318 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:43:05.995387 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
19:43:05.998017 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:43:06.004561 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
19:43:06.050380 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
19:43:06.058765 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:43:06.060941 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
19:43:06.071804 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
19:43:06.119879 [debug] [Thread-1  ]: finished collecting timing info
19:43:06.123343 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
19:43:06.127433 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '204f6846-3deb-4382-b8b5-46559aa64705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007585490>]}
19:43:06.131319 [info ] [Thread-1  ]: 1 of 3 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.23s]
19:43:06.134928 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
19:43:06.140435 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
19:43:06.143138 [info ] [Thread-1  ]: 2 of 3 START view model public.stg_twitter_trending............................. [RUN]
19:43:06.146783 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
19:43:06.148847 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
19:43:06.150818 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
19:43:06.171487 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
19:43:06.180169 [debug] [Thread-1  ]: finished collecting timing info
19:43:06.182500 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
19:43:06.248950 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:43:06.251688 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
19:43:06.253768 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:43:06.259425 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
19:43:06.284784 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
19:43:06.292773 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:43:06.294889 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_twitter_trending"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->>'location'->>'name')::string as location_name,
       (data->>'location'->>'country')::string as location_country,
       (data->>'trends'->>'name')::string as trend_name,
       (data->>'trends'->>'tweet_volume')::numeric as tweet_volume

    FROM casted

)

SELECT * FROM renamed
  );
19:43:06.298914 [debug] [Thread-1  ]: Postgres adapter: Postgres error: no overload for text ->> unknown: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts

19:43:06.302464 [debug] [Thread-1  ]: finished collecting timing info
19:43:06.304958 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
19:43:06.307981 [debug] [Thread-1  ]: Database Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)
  no overload for text ->> unknown: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:43:06.310876 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '204f6846-3deb-4382-b8b5-46559aa64705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073a6df0>]}
19:43:06.313855 [error] [Thread-1  ]: 2 of 3 ERROR creating view model public.stg_twitter_trending.................... [[31mERROR[0m in 0.16s]
19:43:06.316878 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
19:43:06.320717 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
19:43:06.324043 [info ] [Thread-1  ]: 3 of 3 SKIP relation public.fct_twitter_trending................................ [[33mSKIP[0m]
19:43:06.326825 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
19:43:06.332786 [debug] [MainThread]: Acquiring new materialize connection "master"
19:43:06.335700 [debug] [MainThread]: Using materialize connection "master"
19:43:06.337733 [debug] [MainThread]: On master: BEGIN
19:43:06.339799 [debug] [MainThread]: Opening a new connection, currently in state closed
19:43:06.346768 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:43:06.349339 [debug] [MainThread]: Using materialize connection "master"
19:43:06.351546 [debug] [MainThread]: On master: COMMIT
19:43:06.354301 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:43:06.356682 [debug] [MainThread]: On master: Close
19:43:06.359910 [info ] [MainThread]: 
19:43:06.362983 [info ] [MainThread]: Finished running 1 source model, 1 view model, 1 materializedview model in 0.69s.
19:43:06.365478 [debug] [MainThread]: Connection 'master' was properly closed.
19:43:06.367742 [debug] [MainThread]: Connection 'model.mz_hack_day.stg_twitter_trending' was properly closed.
19:43:06.401386 [info ] [MainThread]: 
19:43:06.404249 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:43:06.407048 [info ] [MainThread]: 
19:43:06.409430 [error] [MainThread]: [33mDatabase Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)[0m
19:43:06.412295 [error] [MainThread]:   no overload for text ->> unknown: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
19:43:06.415155 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:43:06.418832 [info ] [MainThread]: 
19:43:06.421939 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
19:43:06.425332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007338280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40075668e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ce8e0>]}


============================== 2022-02-22 19:44:19.750656 | 9589aa83-34cf-4071-b262-a78a3e856500 ==============================
19:44:19.750656 [info ] [MainThread]: Running with dbt=1.0.1
19:44:19.757588 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:44:19.761716 [debug] [MainThread]: Tracking: tracking
19:44:19.788486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace20>]}
19:44:20.102649 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:44:20.107167 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:44:20.210926 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
19:44:20.395372 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

19:44:20.431649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9589aa83-34cf-4071-b262-a78a3e856500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027bf90d0>]}
19:44:20.479530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9589aa83-34cf-4071-b262-a78a3e856500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728fd90>]}
19:44:20.482724 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:44:20.490622 [info ] [MainThread]: 
19:44:20.494447 [debug] [MainThread]: Acquiring new materialize connection "master"
19:44:20.501777 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
19:44:20.567895 [debug] [ThreadPool]: Using materialize connection "list_materialize"
19:44:20.570725 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
19:44:20.573615 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:44:20.602580 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
19:44:20.612389 [debug] [ThreadPool]: On list_materialize: Close
19:44:20.620862 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
19:44:20.643164 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
19:44:20.645688 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
19:44:20.647833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:44:20.655192 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
19:44:20.664493 [debug] [ThreadPool]: On list_materialize_public: Close
19:44:20.669962 [debug] [MainThread]: Using materialize connection "master"
19:44:20.672391 [debug] [MainThread]: On master: BEGIN
19:44:20.674338 [debug] [MainThread]: Opening a new connection, currently in state init
19:44:20.679852 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:44:20.682269 [debug] [MainThread]: Using materialize connection "master"
19:44:20.685125 [debug] [MainThread]: On master: COMMIT
19:44:20.688191 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:44:20.690669 [debug] [MainThread]: On master: Close
19:44:20.693891 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:44:20.696871 [info ] [MainThread]: 
19:44:20.714343 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
19:44:20.717514 [info ] [Thread-1  ]: 1 of 3 START source model public.rp_twitter_trending............................ [RUN]
19:44:20.722183 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
19:44:20.724494 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
19:44:20.726498 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
19:44:20.756349 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
19:44:20.763002 [debug] [Thread-1  ]: finished collecting timing info
19:44:20.765353 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
19:44:20.823933 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:44:20.827087 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
19:44:20.829392 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:44:20.838938 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
19:44:20.878428 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
19:44:20.885477 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:44:20.887921 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
19:44:20.898165 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
19:44:20.948719 [debug] [Thread-1  ]: finished collecting timing info
19:44:20.951479 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
19:44:20.954990 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9589aa83-34cf-4071-b262-a78a3e856500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d8afd0>]}
19:44:20.958610 [info ] [Thread-1  ]: 1 of 3 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.23s]
19:44:20.962410 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
19:44:20.967775 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
19:44:20.970422 [info ] [Thread-1  ]: 2 of 3 START view model public.stg_twitter_trending............................. [RUN]
19:44:20.973888 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
19:44:20.976285 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
19:44:20.978326 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
19:44:20.996116 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
19:44:21.002437 [debug] [Thread-1  ]: finished collecting timing info
19:44:21.004830 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
19:44:21.074824 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:44:21.078265 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
19:44:21.080788 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:44:21.086544 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
19:44:21.112710 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
19:44:21.120236 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:44:21.123154 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_twitter_trending"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->'location'->'name')::string as location_name,
       (data->'location'->'country')::string as location_country,
       (data->'trends'->'name')::string as trend_name,
       (data->'trends'->'tweet_volume')::numeric as tweet_volume

    FROM casted

)

SELECT * FROM renamed
  );
19:44:21.132422 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
19:44:21.141386 [debug] [Thread-1  ]: finished collecting timing info
19:44:21.143677 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
19:44:21.147176 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9589aa83-34cf-4071-b262-a78a3e856500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ecd670>]}
19:44:21.150733 [info ] [Thread-1  ]: 2 of 3 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.17s]
19:44:21.153420 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
19:44:21.157646 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
19:44:21.160124 [info ] [Thread-1  ]: 3 of 3 START materializedview model public.fct_twitter_trending................. [RUN]
19:44:21.163409 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
19:44:21.165385 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
19:44:21.167263 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
19:44:21.184856 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
19:44:21.199262 [debug] [Thread-1  ]: finished collecting timing info
19:44:21.201542 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
19:44:21.250925 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
19:44:21.253515 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
19:44:21.255789 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:44:21.261854 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
19:44:21.277807 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
19:44:21.292503 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
19:44:21.295312 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


SELECT tt.location_name, tt.location_country, tt.trend_name, tt.tweet_count
FROM "materialize"."public"."stg_twitter_trending" tt
  );
19:44:21.299753 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "tt.tweet_count" does not exist

19:44:21.304310 [debug] [Thread-1  ]: finished collecting timing info
19:44:21.306907 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
19:44:21.310685 [debug] [Thread-1  ]: Database Error in model fct_twitter_trending (models/twitter_trending/marts/twitter/fct_twitter_trending.sql)
  column "tt.tweet_count" does not exist
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/marts/twitter/fct_twitter_trending.sql
19:44:21.313733 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9589aa83-34cf-4071-b262-a78a3e856500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ef7850>]}
19:44:21.316881 [error] [Thread-1  ]: 3 of 3 ERROR creating materializedview model public.fct_twitter_trending........ [[31mERROR[0m in 0.15s]
19:44:21.321569 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
19:44:21.329364 [debug] [MainThread]: Acquiring new materialize connection "master"
19:44:21.331659 [debug] [MainThread]: Using materialize connection "master"
19:44:21.333774 [debug] [MainThread]: On master: BEGIN
19:44:21.335908 [debug] [MainThread]: Opening a new connection, currently in state closed
19:44:21.340982 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:44:21.343450 [debug] [MainThread]: Using materialize connection "master"
19:44:21.345375 [debug] [MainThread]: On master: COMMIT
19:44:21.348175 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:44:21.350662 [debug] [MainThread]: On master: Close
19:44:21.354229 [info ] [MainThread]: 
19:44:21.357478 [info ] [MainThread]: Finished running 1 source model, 1 view model, 1 materializedview model in 0.86s.
19:44:21.359923 [debug] [MainThread]: Connection 'master' was properly closed.
19:44:21.362156 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
19:44:21.397503 [info ] [MainThread]: 
19:44:21.400251 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:44:21.402859 [info ] [MainThread]: 
19:44:21.405294 [error] [MainThread]: [33mDatabase Error in model fct_twitter_trending (models/twitter_trending/marts/twitter/fct_twitter_trending.sql)[0m
19:44:21.407819 [error] [MainThread]:   column "tt.tweet_count" does not exist
19:44:21.410478 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/marts/twitter/fct_twitter_trending.sql
19:44:21.412916 [info ] [MainThread]: 
19:44:21.415547 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
19:44:21.418478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400733a220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d672e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049eef670>]}


============================== 2022-02-22 19:46:25.091077 | ba5a79a8-a36f-4610-9eb1-a3594e6c5193 ==============================
19:46:25.091077 [info ] [MainThread]: Running with dbt=1.0.1
19:46:25.097434 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:46:25.100157 [debug] [MainThread]: Tracking: tracking
19:46:25.125760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd90>]}
19:46:25.432111 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:46:25.436226 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
19:46:25.542110 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
19:46:25.713919 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

19:46:25.749884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba5a79a8-a36f-4610-9eb1-a3594e6c5193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027bfb0d0>]}
19:46:25.794299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba5a79a8-a36f-4610-9eb1-a3594e6c5193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072d0640>]}
19:46:25.797428 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:46:25.805203 [info ] [MainThread]: 
19:46:25.808679 [debug] [MainThread]: Acquiring new materialize connection "master"
19:46:25.817156 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
19:46:25.882875 [debug] [ThreadPool]: Using materialize connection "list_materialize"
19:46:25.886308 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
19:46:25.889245 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:46:25.916203 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
19:46:25.926212 [debug] [ThreadPool]: On list_materialize: Close
19:46:25.935288 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
19:46:25.958523 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
19:46:25.961397 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
19:46:25.964272 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:46:25.971220 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
19:46:25.980265 [debug] [ThreadPool]: On list_materialize_public: Close
19:46:25.985391 [debug] [MainThread]: Using materialize connection "master"
19:46:25.987811 [debug] [MainThread]: On master: BEGIN
19:46:25.990077 [debug] [MainThread]: Opening a new connection, currently in state init
19:46:25.996283 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:46:25.999060 [debug] [MainThread]: Using materialize connection "master"
19:46:26.000969 [debug] [MainThread]: On master: COMMIT
19:46:26.003807 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:46:26.006135 [debug] [MainThread]: On master: Close
19:46:26.010129 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:46:26.013073 [info ] [MainThread]: 
19:46:26.030288 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
19:46:26.033666 [info ] [Thread-1  ]: 1 of 3 START source model public.rp_twitter_trending............................ [RUN]
19:46:26.038847 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
19:46:26.041485 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
19:46:26.043820 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
19:46:26.072441 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
19:46:26.080547 [debug] [Thread-1  ]: finished collecting timing info
19:46:26.084075 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
19:46:26.138680 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:46:26.141421 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
19:46:26.143987 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:46:26.153369 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
19:46:26.192483 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
19:46:26.201600 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:46:26.203983 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
19:46:26.233594 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
19:46:26.281064 [debug] [Thread-1  ]: finished collecting timing info
19:46:26.284410 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
19:46:26.288343 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a79a8-a36f-4610-9eb1-a3594e6c5193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d8bf10>]}
19:46:26.291601 [info ] [Thread-1  ]: 1 of 3 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.25s]
19:46:26.294766 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
19:46:26.300359 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
19:46:26.303257 [info ] [Thread-1  ]: 2 of 3 START view model public.stg_twitter_trending............................. [RUN]
19:46:26.306472 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
19:46:26.308619 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
19:46:26.310754 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
19:46:26.328760 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
19:46:26.335313 [debug] [Thread-1  ]: finished collecting timing info
19:46:26.337744 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
19:46:26.406275 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:46:26.409259 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
19:46:26.411744 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:46:26.418217 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
19:46:26.443144 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
19:46:26.448993 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:46:26.451122 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_twitter_trending"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),

renamed AS (

    SELECT

       (data->'location'->'name')::string as location_name,
       (data->'location'->'country')::string as location_country,
       (data->'trends'->'name')::string as trend_name,
       (data->'trends'->'tweet_volume')::numeric as tweet_volume

    FROM casted

)

SELECT * FROM renamed
  );
19:46:26.460748 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
19:46:26.470386 [debug] [Thread-1  ]: finished collecting timing info
19:46:26.472735 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
19:46:26.476089 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a79a8-a36f-4610-9eb1-a3594e6c5193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049dcfeb0>]}
19:46:26.479739 [info ] [Thread-1  ]: 2 of 3 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.17s]
19:46:26.482716 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
19:46:26.486729 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
19:46:26.489829 [info ] [Thread-1  ]: 3 of 3 START materializedview model public.fct_twitter_trending................. [RUN]
19:46:26.493441 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
19:46:26.495433 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
19:46:26.497472 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
19:46:26.515083 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
19:46:26.521332 [debug] [Thread-1  ]: finished collecting timing info
19:46:26.523624 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
19:46:26.581853 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
19:46:26.585230 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
19:46:26.587817 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:46:26.594960 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
19:46:26.611611 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
19:46:26.618575 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
19:46:26.620740 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


SELECT location_name, location_country, trend_name, tweet_volume
FROM "materialize"."public"."stg_twitter_trending"
  );
19:46:26.630820 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
19:46:26.641547 [debug] [Thread-1  ]: finished collecting timing info
19:46:26.644095 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
19:46:26.647653 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a79a8-a36f-4610-9eb1-a3594e6c5193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d73220>]}
19:46:26.651726 [info ] [Thread-1  ]: 3 of 3 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.15s]
19:46:26.655063 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
19:46:26.660966 [debug] [MainThread]: Acquiring new materialize connection "master"
19:46:26.663359 [debug] [MainThread]: Using materialize connection "master"
19:46:26.665263 [debug] [MainThread]: On master: BEGIN
19:46:26.667066 [debug] [MainThread]: Opening a new connection, currently in state closed
19:46:26.672311 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:46:26.674786 [debug] [MainThread]: Using materialize connection "master"
19:46:26.676988 [debug] [MainThread]: On master: COMMIT
19:46:26.679599 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:46:26.681802 [debug] [MainThread]: On master: Close
19:46:26.684981 [info ] [MainThread]: 
19:46:26.687611 [info ] [MainThread]: Finished running 1 source model, 1 view model, 1 materializedview model in 0.88s.
19:46:26.690678 [debug] [MainThread]: Connection 'master' was properly closed.
19:46:26.693059 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
19:46:26.726464 [info ] [MainThread]: 
19:46:26.729267 [info ] [MainThread]: [32mCompleted successfully[0m
19:46:26.732288 [info ] [MainThread]: 
19:46:26.734844 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
19:46:26.737817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c40b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c495b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5ae80>]}


============================== 2022-02-22 19:53:40.568844 | 703fd9be-8b6f-4d6f-a513-de73311dc596 ==============================
19:53:40.568844 [info ] [MainThread]: Running with dbt=1.0.1
19:53:40.576493 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:53:40.579502 [debug] [MainThread]: Tracking: tracking
19:53:40.605543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072adc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072add60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072add00>]}
19:53:40.949307 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
19:53:40.954380 [debug] [MainThread]: Partial parsing: update schema file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter.yml
19:53:40.956897 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
19:53:40.960382 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:53:41.063563 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
19:53:41.149363 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
19:53:41.267014 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

19:53:41.303666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '703fd9be-8b6f-4d6f-a513-de73311dc596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027bfc0d0>]}
19:53:41.353417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '703fd9be-8b6f-4d6f-a513-de73311dc596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728feb0>]}
19:53:41.357317 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:53:41.365484 [info ] [MainThread]: 
19:53:41.370219 [debug] [MainThread]: Acquiring new materialize connection "master"
19:53:41.378526 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
19:53:41.450337 [debug] [ThreadPool]: Using materialize connection "list_materialize"
19:53:41.453456 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
19:53:41.455671 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:53:41.485314 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
19:53:41.496125 [debug] [ThreadPool]: On list_materialize: Close
19:53:41.505347 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
19:53:41.528440 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
19:53:41.531244 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
19:53:41.533314 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:53:41.540617 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
19:53:41.550428 [debug] [ThreadPool]: On list_materialize_public: Close
19:53:41.555782 [debug] [MainThread]: Using materialize connection "master"
19:53:41.558577 [debug] [MainThread]: On master: BEGIN
19:53:41.560582 [debug] [MainThread]: Opening a new connection, currently in state init
19:53:41.566138 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:53:41.568521 [debug] [MainThread]: Using materialize connection "master"
19:53:41.570726 [debug] [MainThread]: On master: COMMIT
19:53:41.574010 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:53:41.576162 [debug] [MainThread]: On master: Close
19:53:41.579174 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:53:41.581750 [info ] [MainThread]: 
19:53:41.598222 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
19:53:41.601701 [info ] [Thread-1  ]: 1 of 3 START source model public.rp_twitter_trending............................ [RUN]
19:53:41.606864 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
19:53:41.609476 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
19:53:41.612126 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
19:53:41.643861 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
19:53:41.649493 [debug] [Thread-1  ]: finished collecting timing info
19:53:41.651673 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
19:53:41.708402 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:53:41.711402 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
19:53:41.713807 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:53:41.724440 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
19:53:41.765750 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
19:53:41.773281 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:53:41.775373 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
19:53:41.786503 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
19:53:41.836027 [debug] [Thread-1  ]: finished collecting timing info
19:53:41.838783 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
19:53:41.842746 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '703fd9be-8b6f-4d6f-a513-de73311dc596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d92d00>]}
19:53:41.846402 [info ] [Thread-1  ]: 1 of 3 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.24s]
19:53:41.850177 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
19:53:41.854999 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
19:53:41.857840 [info ] [Thread-1  ]: 2 of 3 START view model public.stg_twitter_trending............................. [RUN]
19:53:41.861855 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
19:53:41.864152 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
19:53:41.866276 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
19:53:41.887392 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
19:53:41.897645 [debug] [Thread-1  ]: finished collecting timing info
19:53:41.900543 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
19:53:41.981907 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:53:41.984856 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
19:53:41.987386 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:53:41.994613 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
19:53:42.020951 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
19:53:42.027781 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:53:42.030322 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_twitter_trending"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),


renamed AS (

    SELECT

       (data->'location'->'name')::string as location_name,
       (data->'location'->'country')::string as location_country,
       (data->'trends')::array as trends,

    FROM casted

)

final AS (

    SELECT
        location_name,
        location_country,
        trends,
    FROM renamed

)

SELECT * FROM renamed
  );
19:53:42.034229 [debug] [Thread-1  ]: Postgres adapter: Postgres error: expected expression, but found reserved keyword
LINE 41:     FROM casted
             ^

19:53:42.037839 [debug] [Thread-1  ]: finished collecting timing info
19:53:42.040134 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
19:53:42.043188 [debug] [Thread-1  ]: Database Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)
  expected expression, but found reserved keyword
  LINE 41:     FROM casted
               ^
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:53:42.045893 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '703fd9be-8b6f-4d6f-a513-de73311dc596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2fac0>]}
19:53:42.049308 [error] [Thread-1  ]: 2 of 3 ERROR creating view model public.stg_twitter_trending.................... [[31mERROR[0m in 0.18s]
19:53:42.052648 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
19:53:42.057740 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
19:53:42.060559 [info ] [Thread-1  ]: 3 of 3 SKIP relation public.fct_twitter_trending................................ [[33mSKIP[0m]
19:53:42.063480 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
19:53:42.069327 [debug] [MainThread]: Acquiring new materialize connection "master"
19:53:42.072109 [debug] [MainThread]: Using materialize connection "master"
19:53:42.074630 [debug] [MainThread]: On master: BEGIN
19:53:42.076699 [debug] [MainThread]: Opening a new connection, currently in state closed
19:53:42.082243 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:53:42.084853 [debug] [MainThread]: Using materialize connection "master"
19:53:42.087130 [debug] [MainThread]: On master: COMMIT
19:53:42.089929 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:53:42.092116 [debug] [MainThread]: On master: Close
19:53:42.095251 [info ] [MainThread]: 
19:53:42.098240 [info ] [MainThread]: Finished running 1 source model, 1 view model, 1 materializedview model in 0.73s.
19:53:42.100905 [debug] [MainThread]: Connection 'master' was properly closed.
19:53:42.103031 [debug] [MainThread]: Connection 'model.mz_hack_day.stg_twitter_trending' was properly closed.
19:53:42.136611 [info ] [MainThread]: 
19:53:42.139360 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:53:42.142207 [info ] [MainThread]: 
19:53:42.144627 [error] [MainThread]: [33mDatabase Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)[0m
19:53:42.147490 [error] [MainThread]:   expected expression, but found reserved keyword
19:53:42.150269 [error] [MainThread]:   LINE 41:     FROM casted
19:53:42.152884 [error] [MainThread]:                ^
19:53:42.155668 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:53:42.158602 [info ] [MainThread]: 
19:53:42.160906 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
19:53:42.165477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072adf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d67100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2f730>]}


============================== 2022-02-22 19:54:06.093716 | 28f109f8-c590-4dc4-8f71-5ecd6299a8ec ==============================
19:54:06.093716 [info ] [MainThread]: Running with dbt=1.0.1
19:54:06.101057 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:54:06.104577 [debug] [MainThread]: Tracking: tracking
19:54:06.130413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aadc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aaeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aae50>]}
19:54:06.450304 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:54:06.454700 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:54:06.583271 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
19:54:06.776391 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

19:54:06.817072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28f109f8-c590-4dc4-8f71-5ecd6299a8ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027bfc0d0>]}
19:54:06.882140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28f109f8-c590-4dc4-8f71-5ecd6299a8ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007293d00>]}
19:54:06.885349 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:54:06.893895 [info ] [MainThread]: 
19:54:06.898325 [debug] [MainThread]: Acquiring new materialize connection "master"
19:54:06.906338 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
19:54:06.980045 [debug] [ThreadPool]: Using materialize connection "list_materialize"
19:54:06.983362 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
19:54:06.986877 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:54:07.015153 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
19:54:07.025839 [debug] [ThreadPool]: On list_materialize: Close
19:54:07.034296 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
19:54:07.057041 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
19:54:07.059987 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
19:54:07.062288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:54:07.069096 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
19:54:07.078970 [debug] [ThreadPool]: On list_materialize_public: Close
19:54:07.084351 [debug] [MainThread]: Using materialize connection "master"
19:54:07.086836 [debug] [MainThread]: On master: BEGIN
19:54:07.088567 [debug] [MainThread]: Opening a new connection, currently in state init
19:54:07.094234 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:54:07.097058 [debug] [MainThread]: Using materialize connection "master"
19:54:07.099293 [debug] [MainThread]: On master: COMMIT
19:54:07.101907 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:54:07.104539 [debug] [MainThread]: On master: Close
19:54:07.107723 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:54:07.111086 [info ] [MainThread]: 
19:54:07.128127 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
19:54:07.132160 [info ] [Thread-1  ]: 1 of 3 START source model public.rp_twitter_trending............................ [RUN]
19:54:07.136910 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
19:54:07.139319 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
19:54:07.141640 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
19:54:07.171569 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
19:54:07.179223 [debug] [Thread-1  ]: finished collecting timing info
19:54:07.181832 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
19:54:07.241105 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:54:07.244254 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
19:54:07.246814 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:54:07.256067 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
19:54:07.297852 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
19:54:07.309779 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:54:07.315688 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
19:54:07.331008 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
19:54:07.386954 [debug] [Thread-1  ]: finished collecting timing info
19:54:07.392266 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
19:54:07.400934 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28f109f8-c590-4dc4-8f71-5ecd6299a8ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d8bfd0>]}
19:54:07.406204 [info ] [Thread-1  ]: 1 of 3 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.26s]
19:54:07.414676 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
19:54:07.422102 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
19:54:07.428252 [info ] [Thread-1  ]: 2 of 3 START view model public.stg_twitter_trending............................. [RUN]
19:54:07.434693 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
19:54:07.437124 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
19:54:07.439400 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
19:54:07.459875 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
19:54:07.469867 [debug] [Thread-1  ]: finished collecting timing info
19:54:07.474645 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
19:54:07.557145 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:54:07.560592 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
19:54:07.564009 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:54:07.572136 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
19:54:07.602585 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
19:54:07.610917 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:54:07.614380 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_twitter_trending"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),


renamed AS (

    SELECT

       (data->'location'->'name')::string as location_name,
       (data->'location'->'country')::string as location_country,
       (data->'trends')::array as trends

    FROM casted

)

final AS (

    SELECT
        location_name,
        location_country,
        trends,
    FROM renamed

)

SELECT * FROM renamed
  );
19:54:07.619514 [debug] [Thread-1  ]: Postgres adapter: Postgres error: Expected SELECT, VALUES, or a subquery in the query body, found identifier "final"
LINE 45: final AS (
         ^

19:54:07.622474 [debug] [Thread-1  ]: finished collecting timing info
19:54:07.625104 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
19:54:07.628434 [debug] [Thread-1  ]: Database Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)
  Expected SELECT, VALUES, or a subquery in the query body, found identifier "final"
  LINE 45: final AS (
           ^
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:54:07.631556 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28f109f8-c590-4dc4-8f71-5ecd6299a8ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d68e20>]}
19:54:07.635236 [error] [Thread-1  ]: 2 of 3 ERROR creating view model public.stg_twitter_trending.................... [[31mERROR[0m in 0.20s]
19:54:07.638557 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
19:54:07.642210 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
19:54:07.644386 [info ] [Thread-1  ]: 3 of 3 SKIP relation public.fct_twitter_trending................................ [[33mSKIP[0m]
19:54:07.648375 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
19:54:07.654519 [debug] [MainThread]: Acquiring new materialize connection "master"
19:54:07.657083 [debug] [MainThread]: Using materialize connection "master"
19:54:07.659257 [debug] [MainThread]: On master: BEGIN
19:54:07.661452 [debug] [MainThread]: Opening a new connection, currently in state closed
19:54:07.666852 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:54:07.669749 [debug] [MainThread]: Using materialize connection "master"
19:54:07.672272 [debug] [MainThread]: On master: COMMIT
19:54:07.675581 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:54:07.678046 [debug] [MainThread]: On master: Close
19:54:07.681130 [info ] [MainThread]: 
19:54:07.683919 [info ] [MainThread]: Finished running 1 source model, 1 view model, 1 materializedview model in 0.78s.
19:54:07.686412 [debug] [MainThread]: Connection 'master' was properly closed.
19:54:07.688744 [debug] [MainThread]: Connection 'model.mz_hack_day.stg_twitter_trending' was properly closed.
19:54:07.727853 [info ] [MainThread]: 
19:54:07.730921 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:54:07.736115 [info ] [MainThread]: 
19:54:07.739840 [error] [MainThread]: [33mDatabase Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)[0m
19:54:07.743212 [error] [MainThread]:   Expected SELECT, VALUES, or a subquery in the query body, found identifier "final"
19:54:07.748737 [error] [MainThread]:   LINE 45: final AS (
19:54:07.751941 [error] [MainThread]:            ^
19:54:07.754877 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:54:07.757263 [info ] [MainThread]: 
19:54:07.761967 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
19:54:07.767700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5ce20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5cdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ee3910>]}


============================== 2022-02-22 19:54:46.931310 | 0f04e46a-7684-4b7e-8581-993197ad208d ==============================
19:54:46.931310 [info ] [MainThread]: Running with dbt=1.0.1
19:54:46.944856 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:54:46.947974 [debug] [MainThread]: Tracking: tracking
19:54:46.978771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abdf0>]}
19:54:47.322938 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:54:47.327340 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:54:47.435457 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
19:54:47.618833 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

19:54:47.658818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f04e46a-7684-4b7e-8581-993197ad208d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027bfd0d0>]}
19:54:47.709534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f04e46a-7684-4b7e-8581-993197ad208d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072a4d90>]}
19:54:47.712754 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:54:47.720910 [info ] [MainThread]: 
19:54:47.725625 [debug] [MainThread]: Acquiring new materialize connection "master"
19:54:47.734349 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
19:54:47.812757 [debug] [ThreadPool]: Using materialize connection "list_materialize"
19:54:47.816177 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
19:54:47.818232 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:54:47.846868 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
19:54:47.857712 [debug] [ThreadPool]: On list_materialize: Close
19:54:47.867177 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
19:54:47.899067 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
19:54:47.904424 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
19:54:47.908622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:54:47.920658 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
19:54:47.933674 [debug] [ThreadPool]: On list_materialize_public: Close
19:54:47.939991 [debug] [MainThread]: Using materialize connection "master"
19:54:47.943781 [debug] [MainThread]: On master: BEGIN
19:54:47.947805 [debug] [MainThread]: Opening a new connection, currently in state init
19:54:47.956561 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:54:47.961015 [debug] [MainThread]: Using materialize connection "master"
19:54:47.963955 [debug] [MainThread]: On master: COMMIT
19:54:47.969381 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:54:47.972707 [debug] [MainThread]: On master: Close
19:54:47.976846 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:54:47.980241 [info ] [MainThread]: 
19:54:48.003654 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
19:54:48.007936 [info ] [Thread-1  ]: 1 of 3 START source model public.rp_twitter_trending............................ [RUN]
19:54:48.014735 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
19:54:48.017514 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
19:54:48.019437 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
19:54:48.051661 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
19:54:48.058783 [debug] [Thread-1  ]: finished collecting timing info
19:54:48.060968 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
19:54:48.120386 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:54:48.123050 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
19:54:48.125552 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:54:48.134876 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
19:54:48.176910 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
19:54:48.183880 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:54:48.186187 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
19:54:48.198683 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
19:54:48.252214 [debug] [Thread-1  ]: finished collecting timing info
19:54:48.255926 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
19:54:48.261985 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f04e46a-7684-4b7e-8581-993197ad208d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d8af40>]}
19:54:48.266031 [info ] [Thread-1  ]: 1 of 3 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.25s]
19:54:48.269891 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
19:54:48.275945 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
19:54:48.278539 [info ] [Thread-1  ]: 2 of 3 START view model public.stg_twitter_trending............................. [RUN]
19:54:48.281908 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
19:54:48.284385 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
19:54:48.287057 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
19:54:48.306746 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
19:54:48.313261 [debug] [Thread-1  ]: finished collecting timing info
19:54:48.315772 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
19:54:48.391571 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:54:48.394413 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
19:54:48.396858 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:54:48.403282 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
19:54:48.429331 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
19:54:48.435792 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:54:48.437880 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (

    SELECT * FROM "materialize"."public"."rp_twitter_trending"

),

converted AS (

    SELECT convert_from(data, 'utf8') AS data FROM source

),

casted AS (

    SELECT cast(data AS jsonb) AS data FROM converted

),


renamed AS (

    SELECT

       (data->'location'->'name')::string as location_name,
       (data->'location'->'country')::string as location_country,
       (data->'trends')::array as trends

    FROM casted

),

final AS (

    SELECT
        location_name,
        location_country,
        trends,
    FROM renamed

)

SELECT * FROM final
  );
19:54:48.441774 [debug] [Thread-1  ]: Postgres adapter: Postgres error: expected expression, but found reserved keyword
LINE 51:     FROM renamed
             ^

19:54:48.444311 [debug] [Thread-1  ]: finished collecting timing info
19:54:48.446742 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
19:54:48.450149 [debug] [Thread-1  ]: Database Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)
  expected expression, but found reserved keyword
  LINE 51:     FROM renamed
               ^
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:54:48.453491 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f04e46a-7684-4b7e-8581-993197ad208d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d67d90>]}
19:54:48.457293 [error] [Thread-1  ]: 2 of 3 ERROR creating view model public.stg_twitter_trending.................... [[31mERROR[0m in 0.17s]
19:54:48.460417 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
19:54:48.464837 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
19:54:48.467357 [info ] [Thread-1  ]: 3 of 3 SKIP relation public.fct_twitter_trending................................ [[33mSKIP[0m]
19:54:48.470056 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
19:54:48.477126 [debug] [MainThread]: Acquiring new materialize connection "master"
19:54:48.479747 [debug] [MainThread]: Using materialize connection "master"
19:54:48.481823 [debug] [MainThread]: On master: BEGIN
19:54:48.484748 [debug] [MainThread]: Opening a new connection, currently in state closed
19:54:48.490956 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:54:48.493688 [debug] [MainThread]: Using materialize connection "master"
19:54:48.496182 [debug] [MainThread]: On master: COMMIT
19:54:48.499511 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:54:48.501863 [debug] [MainThread]: On master: Close
19:54:48.505408 [info ] [MainThread]: 
19:54:48.508051 [info ] [MainThread]: Finished running 1 source model, 1 view model, 1 materializedview model in 0.78s.
19:54:48.511875 [debug] [MainThread]: Connection 'master' was properly closed.
19:54:48.514844 [debug] [MainThread]: Connection 'model.mz_hack_day.stg_twitter_trending' was properly closed.
19:54:48.550477 [info ] [MainThread]: 
19:54:48.553288 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:54:48.556001 [info ] [MainThread]: 
19:54:48.558724 [error] [MainThread]: [33mDatabase Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)[0m
19:54:48.561317 [error] [MainThread]:   expected expression, but found reserved keyword
19:54:48.564046 [error] [MainThread]:   LINE 51:     FROM renamed
19:54:48.567002 [error] [MainThread]:                ^
19:54:48.569951 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:54:48.574267 [info ] [MainThread]: 
19:54:48.577336 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
19:54:48.580499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5cd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ee18b0>]}


============================== 2022-02-22 19:55:20.601514 | 7d3a3045-4d6e-4678-b327-d7c02d93d536 ==============================
19:55:20.601514 [info ] [MainThread]: Running with dbt=1.0.1
19:55:20.608130 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:55:20.611119 [debug] [MainThread]: Tracking: tracking
19:55:20.637074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728adc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728aeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728ae50>]}
19:55:21.057163 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:55:21.061598 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:55:21.170327 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
19:55:21.344730 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

19:55:21.385356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d3a3045-4d6e-4678-b327-d7c02d93d536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027bfd0d0>]}
19:55:21.436966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d3a3045-4d6e-4678-b327-d7c02d93d536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072a2d00>]}
19:55:21.442016 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:55:21.451975 [info ] [MainThread]: 
19:55:21.457133 [debug] [MainThread]: Acquiring new materialize connection "master"
19:55:21.469230 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
19:55:21.542895 [debug] [ThreadPool]: Using materialize connection "list_materialize"
19:55:21.545878 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
19:55:21.549976 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:55:21.583090 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
19:55:21.601737 [debug] [ThreadPool]: On list_materialize: Close
19:55:21.612084 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
19:55:21.637377 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
19:55:21.640322 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
19:55:21.642511 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:55:21.650276 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
19:55:21.659755 [debug] [ThreadPool]: On list_materialize_public: Close
19:55:21.665131 [debug] [MainThread]: Using materialize connection "master"
19:55:21.667583 [debug] [MainThread]: On master: BEGIN
19:55:21.669468 [debug] [MainThread]: Opening a new connection, currently in state init
19:55:21.675140 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:55:21.678196 [debug] [MainThread]: Using materialize connection "master"
19:55:21.680172 [debug] [MainThread]: On master: COMMIT
19:55:21.683195 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:55:21.685654 [debug] [MainThread]: On master: Close
19:55:21.688758 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:55:21.691715 [info ] [MainThread]: 
19:55:21.708727 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
19:55:21.712588 [info ] [Thread-1  ]: 1 of 3 START source model public.rp_twitter_trending............................ [RUN]
19:55:21.717640 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
19:55:21.720197 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
19:55:21.723005 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
19:55:21.755954 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
19:55:21.762983 [debug] [Thread-1  ]: finished collecting timing info
19:55:21.765192 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
19:55:21.821500 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:55:21.824211 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
19:55:21.826800 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:55:21.839512 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
19:55:21.882611 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
19:55:21.892330 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:55:21.894747 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
19:55:21.904857 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
19:55:21.954012 [debug] [Thread-1  ]: finished collecting timing info
19:55:21.957170 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
19:55:21.960503 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d3a3045-4d6e-4678-b327-d7c02d93d536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d8bfd0>]}
19:55:21.963771 [info ] [Thread-1  ]: 1 of 3 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.24s]
19:55:21.966978 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
19:55:21.972155 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
19:55:21.974703 [info ] [Thread-1  ]: 2 of 3 START view model public.stg_twitter_trending............................. [RUN]
19:55:21.978431 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
19:55:21.980383 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
19:55:21.983175 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
19:55:22.002387 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
19:55:22.009389 [debug] [Thread-1  ]: finished collecting timing info
19:55:22.011739 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
19:55:22.084307 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:55:22.087067 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
19:55:22.089327 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:55:22.095537 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
19:55:22.120986 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
19:55:22.127475 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:55:22.129575 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT

       (data->'location'->'name')::string as location_name,
       (data->'location'->'country')::string as location_country,
       (data->'trends')::array as trends
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        trends
    FROM renamed
)

SELECT * FROM final
  );
19:55:22.133306 [debug] [Thread-1  ]: Postgres adapter: Postgres error: unknown catalog item 'array'

19:55:22.137139 [debug] [Thread-1  ]: finished collecting timing info
19:55:22.139624 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
19:55:22.143214 [debug] [Thread-1  ]: Database Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)
  unknown catalog item 'array'
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:55:22.146331 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d3a3045-4d6e-4678-b327-d7c02d93d536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d69e80>]}
19:55:22.149326 [error] [Thread-1  ]: 2 of 3 ERROR creating view model public.stg_twitter_trending.................... [[31mERROR[0m in 0.17s]
19:55:22.152251 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
19:55:22.155777 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
19:55:22.157778 [info ] [Thread-1  ]: 3 of 3 SKIP relation public.fct_twitter_trending................................ [[33mSKIP[0m]
19:55:22.161258 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
19:55:22.167386 [debug] [MainThread]: Acquiring new materialize connection "master"
19:55:22.170787 [debug] [MainThread]: Using materialize connection "master"
19:55:22.173153 [debug] [MainThread]: On master: BEGIN
19:55:22.175706 [debug] [MainThread]: Opening a new connection, currently in state closed
19:55:22.181580 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:55:22.184483 [debug] [MainThread]: Using materialize connection "master"
19:55:22.186741 [debug] [MainThread]: On master: COMMIT
19:55:22.189727 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:55:22.192512 [debug] [MainThread]: On master: Close
19:55:22.196129 [info ] [MainThread]: 
19:55:22.199235 [info ] [MainThread]: Finished running 1 source model, 1 view model, 1 materializedview model in 0.74s.
19:55:22.202029 [debug] [MainThread]: Connection 'master' was properly closed.
19:55:22.204748 [debug] [MainThread]: Connection 'model.mz_hack_day.stg_twitter_trending' was properly closed.
19:55:22.239783 [info ] [MainThread]: 
19:55:22.242543 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:55:22.245290 [info ] [MainThread]: 
19:55:22.247714 [error] [MainThread]: [33mDatabase Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)[0m
19:55:22.250244 [error] [MainThread]:   unknown catalog item 'array'
19:55:22.252461 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:55:22.254738 [info ] [MainThread]: 
19:55:22.257247 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
19:55:22.260086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5bdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d69b20>]}


============================== 2022-02-22 19:57:02.268783 | b76dd00a-8dd4-4e0d-99e2-a41c34911d27 ==============================
19:57:02.268783 [info ] [MainThread]: Running with dbt=1.0.1
19:57:02.275454 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:57:02.278731 [debug] [MainThread]: Tracking: tracking
19:57:02.304317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aed60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aedf0>]}
19:57:02.604556 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
19:57:02.607321 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
19:57:02.611395 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

19:57:02.652732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b76dd00a-8dd4-4e0d-99e2-a41c34911d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073b6af0>]}
19:57:02.699764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b76dd00a-8dd4-4e0d-99e2-a41c34911d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072a5b50>]}
19:57:02.703040 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:57:02.711118 [info ] [MainThread]: 
19:57:02.714847 [debug] [MainThread]: Acquiring new materialize connection "master"
19:57:02.724928 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
19:57:02.792560 [debug] [ThreadPool]: Using materialize connection "list_materialize"
19:57:02.795373 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
19:57:02.797889 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:57:02.827234 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
19:57:02.837652 [debug] [ThreadPool]: On list_materialize: Close
19:57:02.846515 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
19:57:02.872454 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
19:57:02.875874 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
19:57:02.878923 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:57:02.886859 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
19:57:02.897259 [debug] [ThreadPool]: On list_materialize_public: Close
19:57:02.904957 [debug] [MainThread]: Using materialize connection "master"
19:57:02.909020 [debug] [MainThread]: On master: BEGIN
19:57:02.912375 [debug] [MainThread]: Opening a new connection, currently in state init
19:57:02.919557 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:57:02.922469 [debug] [MainThread]: Using materialize connection "master"
19:57:02.924366 [debug] [MainThread]: On master: COMMIT
19:57:02.927318 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:57:02.929440 [debug] [MainThread]: On master: Close
19:57:02.932468 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:57:02.935477 [info ] [MainThread]: 
19:57:02.951485 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
19:57:02.957262 [info ] [Thread-1  ]: 1 of 3 START source model public.rp_twitter_trending............................ [RUN]
19:57:02.960896 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
19:57:02.963669 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
19:57:02.966709 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
19:57:02.996167 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
19:57:03.003411 [debug] [Thread-1  ]: finished collecting timing info
19:57:03.005890 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
19:57:03.064489 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:57:03.067345 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
19:57:03.069595 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:57:03.079369 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
19:57:03.118158 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
19:57:03.125438 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:57:03.127344 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
19:57:03.137774 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
19:57:03.186202 [debug] [Thread-1  ]: finished collecting timing info
19:57:03.189072 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
19:57:03.192912 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b76dd00a-8dd4-4e0d-99e2-a41c34911d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400743cb80>]}
19:57:03.197431 [info ] [Thread-1  ]: 1 of 3 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.23s]
19:57:03.201320 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
19:57:03.206265 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
19:57:03.208755 [info ] [Thread-1  ]: 2 of 3 START view model public.stg_twitter_trending............................. [RUN]
19:57:03.212143 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
19:57:03.214016 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
19:57:03.216371 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
19:57:03.233756 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
19:57:03.239719 [debug] [Thread-1  ]: finished collecting timing info
19:57:03.241660 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
19:57:03.307769 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:57:03.310793 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
19:57:03.313008 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:57:03.319282 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
19:57:03.344308 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
19:57:03.352570 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:57:03.355113 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT

       (data->'location'->'name')::string as location_name,
       (data->'location'->'country')::string as location_country,
       (data->'trends')::array as trends
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        trends
    FROM renamed
)

SELECT * FROM final
  );
19:57:03.359781 [debug] [Thread-1  ]: Postgres adapter: Postgres error: unknown catalog item 'array'

19:57:03.362889 [debug] [Thread-1  ]: finished collecting timing info
19:57:03.365034 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
19:57:03.368016 [debug] [Thread-1  ]: Database Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)
  unknown catalog item 'array'
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:57:03.370862 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b76dd00a-8dd4-4e0d-99e2-a41c34911d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40294e9a30>]}
19:57:03.373947 [error] [Thread-1  ]: 2 of 3 ERROR creating view model public.stg_twitter_trending.................... [[31mERROR[0m in 0.16s]
19:57:03.377081 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
19:57:03.381363 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
19:57:03.383805 [info ] [Thread-1  ]: 3 of 3 SKIP relation public.fct_twitter_trending................................ [[33mSKIP[0m]
19:57:03.386699 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
19:57:03.392250 [debug] [MainThread]: Acquiring new materialize connection "master"
19:57:03.394599 [debug] [MainThread]: Using materialize connection "master"
19:57:03.396578 [debug] [MainThread]: On master: BEGIN
19:57:03.398426 [debug] [MainThread]: Opening a new connection, currently in state closed
19:57:03.403709 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:57:03.406528 [debug] [MainThread]: Using materialize connection "master"
19:57:03.408557 [debug] [MainThread]: On master: COMMIT
19:57:03.411357 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:57:03.413523 [debug] [MainThread]: On master: Close
19:57:03.418139 [info ] [MainThread]: 
19:57:03.421970 [info ] [MainThread]: Finished running 1 source model, 1 view model, 1 materializedview model in 0.70s.
19:57:03.425357 [debug] [MainThread]: Connection 'master' was properly closed.
19:57:03.427591 [debug] [MainThread]: Connection 'model.mz_hack_day.stg_twitter_trending' was properly closed.
19:57:03.460360 [info ] [MainThread]: 
19:57:03.463003 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:57:03.465578 [info ] [MainThread]: 
19:57:03.467971 [error] [MainThread]: [33mDatabase Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)[0m
19:57:03.470733 [error] [MainThread]:   unknown catalog item 'array'
19:57:03.473339 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:57:03.475760 [info ] [MainThread]: 
19:57:03.478289 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
19:57:03.481016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400fc7e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400fc7e100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40294e9730>]}


============================== 2022-02-22 19:57:59.065391 | 32f74228-3f2e-4c4c-bfe1-116135192a7b ==============================
19:57:59.065391 [info ] [MainThread]: Running with dbt=1.0.1
19:57:59.072245 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:57:59.074904 [debug] [MainThread]: Tracking: tracking
19:57:59.102733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acdf0>]}
19:57:59.418907 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:57:59.423361 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:57:59.526958 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
19:57:59.698053 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

19:57:59.735730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32f74228-3f2e-4c4c-bfe1-116135192a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027bfc0d0>]}
19:57:59.782400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32f74228-3f2e-4c4c-bfe1-116135192a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728f670>]}
19:57:59.785292 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:57:59.793210 [info ] [MainThread]: 
19:57:59.797113 [debug] [MainThread]: Acquiring new materialize connection "master"
19:57:59.806184 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
19:57:59.876914 [debug] [ThreadPool]: Using materialize connection "list_materialize"
19:57:59.879791 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
19:57:59.882920 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:57:59.909964 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
19:57:59.920256 [debug] [ThreadPool]: On list_materialize: Close
19:57:59.928798 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
19:57:59.951437 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
19:57:59.954177 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
19:57:59.956407 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:57:59.963755 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
19:57:59.973518 [debug] [ThreadPool]: On list_materialize_public: Close
19:57:59.980137 [debug] [MainThread]: Using materialize connection "master"
19:57:59.982557 [debug] [MainThread]: On master: BEGIN
19:57:59.984598 [debug] [MainThread]: Opening a new connection, currently in state init
19:57:59.990356 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:57:59.992850 [debug] [MainThread]: Using materialize connection "master"
19:57:59.994912 [debug] [MainThread]: On master: COMMIT
19:57:59.998015 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:58:00.000653 [debug] [MainThread]: On master: Close
19:58:00.004028 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:58:00.007205 [info ] [MainThread]: 
19:58:00.024297 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
19:58:00.028662 [info ] [Thread-1  ]: 1 of 3 START source model public.rp_twitter_trending............................ [RUN]
19:58:00.036582 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
19:58:00.039557 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
19:58:00.042164 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
19:58:00.072309 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
19:58:00.080196 [debug] [Thread-1  ]: finished collecting timing info
19:58:00.083158 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
19:58:00.140848 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:58:00.143793 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
19:58:00.146477 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:58:00.157994 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
19:58:00.196561 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
19:58:00.203008 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:58:00.205412 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
19:58:00.216145 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
19:58:00.263805 [debug] [Thread-1  ]: finished collecting timing info
19:58:00.266567 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
19:58:00.270990 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32f74228-3f2e-4c4c-bfe1-116135192a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d8bf40>]}
19:58:00.274594 [info ] [Thread-1  ]: 1 of 3 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.24s]
19:58:00.278236 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
19:58:00.282987 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
19:58:00.286333 [info ] [Thread-1  ]: 2 of 3 START view model public.stg_twitter_trending............................. [RUN]
19:58:00.289943 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
19:58:00.292394 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
19:58:00.295033 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
19:58:00.314232 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
19:58:00.321162 [debug] [Thread-1  ]: finished collecting timing info
19:58:00.324356 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
19:58:00.401261 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:58:00.404016 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
19:58:00.406108 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:58:00.412909 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
19:58:00.442617 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
19:58:00.449581 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:58:00.451896 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT

       (data->'location'->'name')::string as location_name,
       (data->'location'->'country')::string as location_country,
       (data->'trends')::json[] as trends
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        trends
    FROM renamed
)

SELECT * FROM final
  );
19:58:00.455817 [debug] [Thread-1  ]: Postgres adapter: Postgres error: CAST does not support casting from jsonb to jsonb[]

19:58:00.458466 [debug] [Thread-1  ]: finished collecting timing info
19:58:00.460814 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
19:58:00.464208 [debug] [Thread-1  ]: Database Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)
  CAST does not support casting from jsonb to jsonb[]
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:58:00.467316 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32f74228-3f2e-4c4c-bfe1-116135192a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d68ca0>]}
19:58:00.470444 [error] [Thread-1  ]: 2 of 3 ERROR creating view model public.stg_twitter_trending.................... [[31mERROR[0m in 0.18s]
19:58:00.473387 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
19:58:00.477112 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
19:58:00.479201 [info ] [Thread-1  ]: 3 of 3 SKIP relation public.fct_twitter_trending................................ [[33mSKIP[0m]
19:58:00.482391 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
19:58:00.488064 [debug] [MainThread]: Acquiring new materialize connection "master"
19:58:00.491095 [debug] [MainThread]: Using materialize connection "master"
19:58:00.493934 [debug] [MainThread]: On master: BEGIN
19:58:00.496381 [debug] [MainThread]: Opening a new connection, currently in state closed
19:58:00.501888 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:58:00.505209 [debug] [MainThread]: Using materialize connection "master"
19:58:00.507204 [debug] [MainThread]: On master: COMMIT
19:58:00.510181 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:58:00.512558 [debug] [MainThread]: On master: Close
19:58:00.515930 [info ] [MainThread]: 
19:58:00.518557 [info ] [MainThread]: Finished running 1 source model, 1 view model, 1 materializedview model in 0.72s.
19:58:00.522464 [debug] [MainThread]: Connection 'master' was properly closed.
19:58:00.524610 [debug] [MainThread]: Connection 'model.mz_hack_day.stg_twitter_trending' was properly closed.
19:58:00.561347 [info ] [MainThread]: 
19:58:00.564240 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:58:00.567104 [info ] [MainThread]: 
19:58:00.569644 [error] [MainThread]: [33mDatabase Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)[0m
19:58:00.573448 [error] [MainThread]:   CAST does not support casting from jsonb to jsonb[]
19:58:00.576932 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:58:00.580110 [info ] [MainThread]: 
19:58:00.582760 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
19:58:00.587139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d68a30>]}


============================== 2022-02-22 19:58:31.280277 | 9a0d3ba8-0f72-4b8c-a926-508493fdb2c9 ==============================
19:58:31.280277 [info ] [MainThread]: Running with dbt=1.0.1
19:58:31.286634 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:58:31.289314 [debug] [MainThread]: Tracking: tracking
19:58:31.317028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe20>]}
19:58:31.630653 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:58:31.635108 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
19:58:31.739322 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
19:58:31.909421 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

19:58:31.946730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a0d3ba8-0f72-4b8c-a926-508493fdb2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027bfc0d0>]}
19:58:31.996160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a0d3ba8-0f72-4b8c-a926-508493fdb2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007284e50>]}
19:58:31.999238 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:58:32.007447 [info ] [MainThread]: 
19:58:32.011180 [debug] [MainThread]: Acquiring new materialize connection "master"
19:58:32.019458 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
19:58:32.085719 [debug] [ThreadPool]: Using materialize connection "list_materialize"
19:58:32.089329 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
19:58:32.091413 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:58:32.120259 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
19:58:32.130716 [debug] [ThreadPool]: On list_materialize: Close
19:58:32.138920 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
19:58:32.161168 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
19:58:32.163848 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
19:58:32.165949 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:58:32.173521 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
19:58:32.182829 [debug] [ThreadPool]: On list_materialize_public: Close
19:58:32.188398 [debug] [MainThread]: Using materialize connection "master"
19:58:32.190891 [debug] [MainThread]: On master: BEGIN
19:58:32.192957 [debug] [MainThread]: Opening a new connection, currently in state init
19:58:32.198187 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:58:32.200814 [debug] [MainThread]: Using materialize connection "master"
19:58:32.202798 [debug] [MainThread]: On master: COMMIT
19:58:32.205614 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:58:32.207983 [debug] [MainThread]: On master: Close
19:58:32.211265 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:58:32.213936 [info ] [MainThread]: 
19:58:32.232349 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
19:58:32.235993 [info ] [Thread-1  ]: 1 of 3 START source model public.rp_twitter_trending............................ [RUN]
19:58:32.241496 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
19:58:32.244676 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
19:58:32.247724 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
19:58:32.284624 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
19:58:32.292080 [debug] [Thread-1  ]: finished collecting timing info
19:58:32.294282 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
19:58:32.349562 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:58:32.352494 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
19:58:32.354948 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:58:32.364265 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
19:58:32.402747 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
19:58:32.409703 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
19:58:32.411986 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
19:58:32.422354 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
19:58:32.470378 [debug] [Thread-1  ]: finished collecting timing info
19:58:32.473330 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
19:58:32.478530 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a0d3ba8-0f72-4b8c-a926-508493fdb2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d8bfa0>]}
19:58:32.482622 [info ] [Thread-1  ]: 1 of 3 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.24s]
19:58:32.486059 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
19:58:32.491493 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
19:58:32.494390 [info ] [Thread-1  ]: 2 of 3 START view model public.stg_twitter_trending............................. [RUN]
19:58:32.497874 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
19:58:32.499902 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
19:58:32.502080 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
19:58:32.520833 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
19:58:32.528490 [debug] [Thread-1  ]: finished collecting timing info
19:58:32.530757 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
19:58:32.599962 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:58:32.603119 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
19:58:32.605281 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:58:32.611543 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
19:58:32.636343 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
19:58:32.644339 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
19:58:32.646720 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT

       (data->'location'->'name')::string as location_name,
       (data->'location'->'country')::string as location_country,
       (data->'trends')::jsonb as trends
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        trends
    FROM renamed
)

SELECT * FROM final
  );
19:58:32.655756 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
19:58:32.665246 [debug] [Thread-1  ]: finished collecting timing info
19:58:32.667532 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
19:58:32.671181 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a0d3ba8-0f72-4b8c-a926-508493fdb2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049dbfdf0>]}
19:58:32.674839 [info ] [Thread-1  ]: 2 of 3 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.17s]
19:58:32.677730 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
19:58:32.681744 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
19:58:32.684614 [info ] [Thread-1  ]: 3 of 3 START materializedview model public.fct_twitter_trending................. [RUN]
19:58:32.688870 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
19:58:32.692961 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
19:58:32.694974 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
19:58:32.711752 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
19:58:32.719580 [debug] [Thread-1  ]: finished collecting timing info
19:58:32.721596 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
19:58:32.771601 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
19:58:32.774140 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
19:58:32.776404 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:58:32.781956 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
19:58:32.798044 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
19:58:32.804701 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
19:58:32.806802 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


SELECT location_name, location_country, trends
FROM "materialize"."public"."stg_twitter_trending"
  );
19:58:32.816733 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
19:58:32.827338 [debug] [Thread-1  ]: finished collecting timing info
19:58:32.830205 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
19:58:32.833934 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a0d3ba8-0f72-4b8c-a926-508493fdb2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d74250>]}
19:58:32.837931 [info ] [Thread-1  ]: 3 of 3 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.15s]
19:58:32.840699 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
19:58:32.847372 [debug] [MainThread]: Acquiring new materialize connection "master"
19:58:32.849966 [debug] [MainThread]: Using materialize connection "master"
19:58:32.852211 [debug] [MainThread]: On master: BEGIN
19:58:32.854503 [debug] [MainThread]: Opening a new connection, currently in state closed
19:58:32.860319 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:58:32.863132 [debug] [MainThread]: Using materialize connection "master"
19:58:32.865358 [debug] [MainThread]: On master: COMMIT
19:58:32.868068 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:58:32.870956 [debug] [MainThread]: On master: Close
19:58:32.874496 [info ] [MainThread]: 
19:58:32.877303 [info ] [MainThread]: Finished running 1 source model, 1 view model, 1 materializedview model in 0.86s.
19:58:32.880851 [debug] [MainThread]: Connection 'master' was properly closed.
19:58:32.883766 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
19:58:32.922381 [info ] [MainThread]: 
19:58:32.925520 [info ] [MainThread]: [32mCompleted successfully[0m
19:58:32.930101 [info ] [MainThread]: 
19:58:32.934065 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
19:58:32.938560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049de37c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049de37f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5beb0>]}


============================== 2022-02-22 20:00:59.730629 | 3b7584ff-c25a-4862-a323-ff7605c57106 ==============================
20:00:59.730629 [info ] [MainThread]: Running with dbt=1.0.1
20:00:59.737851 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
20:00:59.740492 [debug] [MainThread]: Tracking: tracking
20:00:59.766546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acdf0>]}
20:01:00.091385 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
20:01:00.096042 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
20:01:00.205211 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
20:01:00.380738 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

20:01:00.417951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b7584ff-c25a-4862-a323-ff7605c57106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027bfd0d0>]}
20:01:00.463328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b7584ff-c25a-4862-a323-ff7605c57106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072a4d00>]}
20:01:00.466359 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
20:01:00.474304 [info ] [MainThread]: 
20:01:00.478010 [debug] [MainThread]: Acquiring new materialize connection "master"
20:01:00.486992 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
20:01:00.555509 [debug] [ThreadPool]: Using materialize connection "list_materialize"
20:01:00.558567 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
20:01:00.560842 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:01:00.590891 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
20:01:00.601377 [debug] [ThreadPool]: On list_materialize: Close
20:01:00.611944 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
20:01:00.636317 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
20:01:00.639500 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
20:01:00.641513 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:01:00.649352 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
20:01:00.659070 [debug] [ThreadPool]: On list_materialize_public: Close
20:01:00.664584 [debug] [MainThread]: Using materialize connection "master"
20:01:00.667262 [debug] [MainThread]: On master: BEGIN
20:01:00.670023 [debug] [MainThread]: Opening a new connection, currently in state init
20:01:00.675865 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:01:00.678528 [debug] [MainThread]: Using materialize connection "master"
20:01:00.680481 [debug] [MainThread]: On master: COMMIT
20:01:00.683811 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:01:00.685902 [debug] [MainThread]: On master: Close
20:01:00.688921 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
20:01:00.691950 [info ] [MainThread]: 
20:01:00.708234 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
20:01:00.711674 [info ] [Thread-1  ]: 1 of 3 START source model public.rp_twitter_trending............................ [RUN]
20:01:00.716665 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
20:01:00.719013 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
20:01:00.721052 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
20:01:00.751856 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
20:01:00.758367 [debug] [Thread-1  ]: finished collecting timing info
20:01:00.761843 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
20:01:00.820070 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
20:01:00.822736 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
20:01:00.824790 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:01:00.835093 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
20:01:00.874291 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
20:01:00.880685 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
20:01:00.883141 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
20:01:00.892946 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
20:01:00.943013 [debug] [Thread-1  ]: finished collecting timing info
20:01:00.945784 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
20:01:00.949780 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b7584ff-c25a-4862-a323-ff7605c57106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d8af40>]}
20:01:00.953086 [info ] [Thread-1  ]: 1 of 3 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.23s]
20:01:00.956531 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
20:01:00.962633 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
20:01:00.965284 [info ] [Thread-1  ]: 2 of 3 START view model public.stg_twitter_trending............................. [RUN]
20:01:00.968674 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
20:01:00.970640 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
20:01:00.972533 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
20:01:00.990541 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
20:01:00.997301 [debug] [Thread-1  ]: finished collecting timing info
20:01:00.999465 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
20:01:01.078006 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
20:01:01.082030 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
20:01:01.084589 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:01:01.091370 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
20:01:01.120190 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
20:01:01.127606 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
20:01:01.130183 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT

       (data->'location'->'name')::string as location_name,
       (data->'location'->'country')::string as location_country,
       (data->'trends'->'trends')::jsonb as trends
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        trends
    FROM renamed
)

SELECT * FROM final
  );
20:01:01.138816 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
20:01:01.148576 [debug] [Thread-1  ]: finished collecting timing info
20:01:01.150678 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
20:01:01.154191 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b7584ff-c25a-4862-a323-ff7605c57106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ed71f0>]}
20:01:01.157555 [info ] [Thread-1  ]: 2 of 3 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.19s]
20:01:01.160550 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
20:01:01.164719 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
20:01:01.167439 [info ] [Thread-1  ]: 3 of 3 START materializedview model public.fct_twitter_trending................. [RUN]
20:01:01.171357 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
20:01:01.173422 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
20:01:01.176607 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
20:01:01.193942 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
20:01:01.200470 [debug] [Thread-1  ]: finished collecting timing info
20:01:01.203757 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
20:01:01.256224 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
20:01:01.259494 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
20:01:01.262251 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:01:01.269390 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
20:01:01.285722 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
20:01:01.292505 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
20:01:01.295600 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


SELECT location_name, location_country, trends
FROM "materialize"."public"."stg_twitter_trending"
  );
20:01:01.304997 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
20:01:01.315188 [debug] [Thread-1  ]: finished collecting timing info
20:01:01.317399 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
20:01:01.320795 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b7584ff-c25a-4862-a323-ff7605c57106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d6f220>]}
20:01:01.324086 [info ] [Thread-1  ]: 3 of 3 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.15s]
20:01:01.327110 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
20:01:01.332606 [debug] [MainThread]: Acquiring new materialize connection "master"
20:01:01.334961 [debug] [MainThread]: Using materialize connection "master"
20:01:01.337171 [debug] [MainThread]: On master: BEGIN
20:01:01.339350 [debug] [MainThread]: Opening a new connection, currently in state closed
20:01:01.345511 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:01:01.348039 [debug] [MainThread]: Using materialize connection "master"
20:01:01.350391 [debug] [MainThread]: On master: COMMIT
20:01:01.353633 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:01:01.355714 [debug] [MainThread]: On master: Close
20:01:01.358742 [info ] [MainThread]: 
20:01:01.361314 [info ] [MainThread]: Finished running 1 source model, 1 view model, 1 materializedview model in 0.88s.
20:01:01.364083 [debug] [MainThread]: Connection 'master' was properly closed.
20:01:01.366408 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
20:01:01.399943 [info ] [MainThread]: 
20:01:01.402840 [info ] [MainThread]: [32mCompleted successfully[0m
20:01:01.406032 [info ] [MainThread]: 
20:01:01.408947 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
20:01:01.411880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d8c520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072cf250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5de80>]}


============================== 2022-02-22 20:02:14.608556 | cde53d8a-5211-472a-957e-7690059d3668 ==============================
20:02:14.608556 [info ] [MainThread]: Running with dbt=1.0.1
20:02:14.615106 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
20:02:14.617766 [debug] [MainThread]: Tracking: tracking
20:02:14.646236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acdf0>]}
20:02:14.967946 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
20:02:14.972675 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
20:02:15.078795 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
20:02:15.256573 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

20:02:15.296699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cde53d8a-5211-472a-957e-7690059d3668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027bfd0d0>]}
20:02:15.343679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cde53d8a-5211-472a-957e-7690059d3668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007292dc0>]}
20:02:15.346892 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
20:02:15.354973 [info ] [MainThread]: 
20:02:15.359038 [debug] [MainThread]: Acquiring new materialize connection "master"
20:02:15.368049 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
20:02:15.445449 [debug] [ThreadPool]: Using materialize connection "list_materialize"
20:02:15.448765 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
20:02:15.452970 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:02:15.482263 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
20:02:15.492352 [debug] [ThreadPool]: On list_materialize: Close
20:02:15.500537 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
20:02:15.524130 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
20:02:15.526726 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
20:02:15.528850 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:02:15.535993 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
20:02:15.545551 [debug] [ThreadPool]: On list_materialize_public: Close
20:02:15.551260 [debug] [MainThread]: Using materialize connection "master"
20:02:15.554260 [debug] [MainThread]: On master: BEGIN
20:02:15.556993 [debug] [MainThread]: Opening a new connection, currently in state init
20:02:15.562723 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:02:15.565495 [debug] [MainThread]: Using materialize connection "master"
20:02:15.567622 [debug] [MainThread]: On master: COMMIT
20:02:15.571025 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:02:15.573425 [debug] [MainThread]: On master: Close
20:02:15.576683 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
20:02:15.579488 [info ] [MainThread]: 
20:02:15.595552 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
20:02:15.598948 [info ] [Thread-1  ]: 1 of 3 START source model public.rp_twitter_trending............................ [RUN]
20:02:15.604226 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
20:02:15.607218 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
20:02:15.609798 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
20:02:15.641281 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
20:02:15.647472 [debug] [Thread-1  ]: finished collecting timing info
20:02:15.650462 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
20:02:15.709032 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
20:02:15.712254 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
20:02:15.715093 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:02:15.728854 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
20:02:15.769890 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
20:02:15.776288 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
20:02:15.778658 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
20:02:15.788252 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
20:02:15.836460 [debug] [Thread-1  ]: finished collecting timing info
20:02:15.840119 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
20:02:15.843847 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cde53d8a-5211-472a-957e-7690059d3668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d8bf40>]}
20:02:15.846997 [info ] [Thread-1  ]: 1 of 3 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.24s]
20:02:15.850272 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
20:02:15.855531 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
20:02:15.858576 [info ] [Thread-1  ]: 2 of 3 START view model public.stg_twitter_trending............................. [RUN]
20:02:15.862268 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
20:02:15.864780 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
20:02:15.867274 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
20:02:15.886157 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
20:02:15.893205 [debug] [Thread-1  ]: finished collecting timing info
20:02:15.895400 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
20:02:15.967626 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
20:02:15.970364 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
20:02:15.972480 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:02:15.978687 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
20:02:16.005338 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
20:02:16.012591 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
20:02:16.015278 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT

       (data->'location'->'name')::string as location_name,
       (data->'location'->'country')::string as location_country,
       (data->'trends'->0->'trends')::jsonb as trends
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        trends
    FROM renamed
)

SELECT * FROM final
  );
20:02:16.025040 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
20:02:16.034826 [debug] [Thread-1  ]: finished collecting timing info
20:02:16.036884 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
20:02:16.040198 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cde53d8a-5211-472a-957e-7690059d3668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ed71f0>]}
20:02:16.043519 [info ] [Thread-1  ]: 2 of 3 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.18s]
20:02:16.046573 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
20:02:16.050713 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
20:02:16.053562 [info ] [Thread-1  ]: 3 of 3 START materializedview model public.fct_twitter_trending................. [RUN]
20:02:16.057354 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
20:02:16.059374 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
20:02:16.061374 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
20:02:16.080799 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
20:02:16.088420 [debug] [Thread-1  ]: finished collecting timing info
20:02:16.091033 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
20:02:16.141125 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
20:02:16.143963 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
20:02:16.146268 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:02:16.152082 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
20:02:16.167224 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
20:02:16.173611 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
20:02:16.175903 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


SELECT location_name, location_country, trends
FROM "materialize"."public"."stg_twitter_trending"
  );
20:02:16.187172 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
20:02:16.197061 [debug] [Thread-1  ]: finished collecting timing info
20:02:16.199302 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
20:02:16.202519 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cde53d8a-5211-472a-957e-7690059d3668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ee6220>]}
20:02:16.206191 [info ] [Thread-1  ]: 3 of 3 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.15s]
20:02:16.209086 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
20:02:16.215071 [debug] [MainThread]: Acquiring new materialize connection "master"
20:02:16.217473 [debug] [MainThread]: Using materialize connection "master"
20:02:16.220186 [debug] [MainThread]: On master: BEGIN
20:02:16.222268 [debug] [MainThread]: Opening a new connection, currently in state closed
20:02:16.228078 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:02:16.231846 [debug] [MainThread]: Using materialize connection "master"
20:02:16.234405 [debug] [MainThread]: On master: COMMIT
20:02:16.237752 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:02:16.240412 [debug] [MainThread]: On master: Close
20:02:16.243538 [info ] [MainThread]: 
20:02:16.246697 [info ] [MainThread]: Finished running 1 source model, 1 view model, 1 materializedview model in 0.89s.
20:02:16.249602 [debug] [MainThread]: Connection 'master' was properly closed.
20:02:16.251634 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
20:02:16.287369 [info ] [MainThread]: 
20:02:16.290248 [info ] [MainThread]: [32mCompleted successfully[0m
20:02:16.293418 [info ] [MainThread]: 
20:02:16.296460 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
20:02:16.299526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ee2820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c4c910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5df40>]}


============================== 2022-02-23 11:50:20.025405 | 29484269-a94d-4de9-bdaf-9b6c9a731637 ==============================
11:50:20.025405 [info ] [MainThread]: Running with dbt=1.0.1
11:50:20.031340 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
11:50:20.034809 [debug] [MainThread]: Tracking: tracking
11:50:20.066228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4005bbae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4005bbadf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4005bbad90>]}
11:50:20.768153 [debug] [MainThread]: Executing "git --help"
11:50:20.807688 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
11:50:20.811798 [debug] [MainThread]: STDERR: "b''"
11:50:20.831295 [debug] [MainThread]: Acquiring new materialize connection "debug"
11:50:20.835087 [debug] [MainThread]: Using materialize connection "debug"
11:50:20.837969 [debug] [MainThread]: On debug: select 1 as id
11:50:20.840752 [debug] [MainThread]: Opening a new connection, currently in state init
11:50:20.869034 [debug] [MainThread]: SQL status: SELECT 1 in 0.03 seconds
11:50:20.877943 [debug] [MainThread]: On debug: Close
11:50:20.881670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073d6100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073d6490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073d6f40>]}
11:50:21.852964 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-02-23 11:50:42.315862 | 45812468-fb99-48b7-836f-aac029b54f06 ==============================
11:50:42.315862 [info ] [MainThread]: Running with dbt=1.0.1
11:50:42.322776 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
11:50:42.325367 [debug] [MainThread]: Tracking: tracking
11:50:42.351515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728de50>]}
11:50:42.715961 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
11:50:42.718474 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
11:50:42.722289 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

11:50:42.766288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45812468-fb99-48b7-836f-aac029b54f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073b8fa0>]}
11:50:42.816346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45812468-fb99-48b7-836f-aac029b54f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400729d520>]}
11:50:42.820235 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
11:50:42.828080 [info ] [MainThread]: 
11:50:42.831776 [debug] [MainThread]: Acquiring new materialize connection "master"
11:50:42.841820 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
11:50:42.909284 [debug] [ThreadPool]: Using materialize connection "list_materialize"
11:50:42.912062 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
11:50:42.914847 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:50:42.943006 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
11:50:42.952942 [debug] [ThreadPool]: On list_materialize: Close
11:50:42.962391 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
11:50:42.989326 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
11:50:42.993187 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
11:50:42.995871 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:50:43.006017 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
11:50:43.015608 [debug] [ThreadPool]: On list_materialize_public: Close
11:50:43.021594 [debug] [MainThread]: Using materialize connection "master"
11:50:43.024155 [debug] [MainThread]: On master: BEGIN
11:50:43.026189 [debug] [MainThread]: Opening a new connection, currently in state init
11:50:43.032459 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:50:43.035250 [debug] [MainThread]: Using materialize connection "master"
11:50:43.037267 [debug] [MainThread]: On master: COMMIT
11:50:43.040558 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:50:43.042943 [debug] [MainThread]: On master: Close
11:50:43.046032 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
11:50:43.048921 [info ] [MainThread]: 
11:50:43.168981 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
11:50:43.176319 [info ] [Thread-1  ]: 1 of 3 START source model public.rp_twitter_trending............................ [RUN]
11:50:43.181563 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
11:50:43.184145 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
11:50:43.187266 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
11:50:43.220513 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
11:50:43.235007 [debug] [Thread-1  ]: finished collecting timing info
11:50:43.239114 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
11:50:43.304383 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
11:50:43.308143 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
11:50:43.311392 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:50:43.318762 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:50:43.366938 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
11:50:43.391319 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
11:50:43.405954 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
11:50:43.427367 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:50:43.481300 [debug] [Thread-1  ]: finished collecting timing info
11:50:43.484156 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
11:50:43.487813 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45812468-fb99-48b7-836f-aac029b54f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400fc81af0>]}
11:50:43.491285 [info ] [Thread-1  ]: 1 of 3 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.31s]
11:50:43.494839 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
11:50:43.499923 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
11:50:43.502694 [info ] [Thread-1  ]: 2 of 3 START view model public.stg_twitter_trending............................. [RUN]
11:50:43.506387 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
11:50:43.508635 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
11:50:43.510733 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
11:50:43.529146 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
11:50:43.537844 [debug] [Thread-1  ]: finished collecting timing info
11:50:43.540032 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
11:50:43.607601 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
11:50:43.610293 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
11:50:43.613252 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:50:43.619311 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:50:43.643980 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
11:50:43.653981 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
11:50:43.656527 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT

       (data->'location'->'name')::string as location_name,
       (data->'location'->'country')::string as location_country,
       (data->'trends'->0->'trends')::jsonb as trends
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        trends
    FROM renamed
)

SELECT * FROM final
  );
11:50:43.665620 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:50:43.675410 [debug] [Thread-1  ]: finished collecting timing info
11:50:43.677867 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
11:50:43.681293 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45812468-fb99-48b7-836f-aac029b54f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007440070>]}
11:50:43.685364 [info ] [Thread-1  ]: 2 of 3 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.18s]
11:50:43.688694 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
11:50:43.692697 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
11:50:43.695385 [info ] [Thread-1  ]: 3 of 3 START materializedview model public.fct_twitter_trending................. [RUN]
11:50:43.698949 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
11:50:43.701119 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
11:50:43.703631 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
11:50:43.719861 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
11:50:43.728855 [debug] [Thread-1  ]: finished collecting timing info
11:50:43.731089 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
11:50:43.779652 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
11:50:43.782289 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
11:50:43.784628 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:50:43.790949 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:50:43.808597 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
11:50:43.816233 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
11:50:43.818302 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


SELECT location_name, location_country, trends
FROM "materialize"."public"."stg_twitter_trending"
  );
11:50:43.828662 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:50:43.839187 [debug] [Thread-1  ]: finished collecting timing info
11:50:43.841656 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
11:50:43.845120 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45812468-fb99-48b7-836f-aac029b54f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4029600be0>]}
11:50:43.848673 [info ] [Thread-1  ]: 3 of 3 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.15s]
11:50:43.851684 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
11:50:43.857088 [debug] [MainThread]: Acquiring new materialize connection "master"
11:50:43.859947 [debug] [MainThread]: Using materialize connection "master"
11:50:43.862982 [debug] [MainThread]: On master: BEGIN
11:50:43.865244 [debug] [MainThread]: Opening a new connection, currently in state closed
11:50:43.870621 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:50:43.873251 [debug] [MainThread]: Using materialize connection "master"
11:50:43.875409 [debug] [MainThread]: On master: COMMIT
11:50:43.878004 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:50:43.879790 [debug] [MainThread]: On master: Close
11:50:43.882986 [info ] [MainThread]: 
11:50:43.885653 [info ] [MainThread]: Finished running 1 source model, 1 view model, 1 materializedview model in 1.05s.
11:50:43.888256 [debug] [MainThread]: Connection 'master' was properly closed.
11:50:43.890324 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
11:50:43.924769 [info ] [MainThread]: 
11:50:43.927894 [info ] [MainThread]: [32mCompleted successfully[0m
11:50:43.931718 [info ] [MainThread]: 
11:50:43.934336 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
11:50:43.937597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400fc7dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4029600fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4029619b80>]}


============================== 2022-02-23 11:54:17.760509 | b34ef9c0-6297-4de8-8598-ef50be8ddb8d ==============================
11:54:17.760509 [info ] [MainThread]: Running with dbt=1.0.1
11:54:17.767938 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
11:54:17.771193 [debug] [MainThread]: Tracking: tracking
11:54:17.801928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073dd790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400418b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400418bb50>]}
11:54:18.179849 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
11:54:18.182618 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
11:54:18.186434 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

11:54:18.230667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b34ef9c0-6297-4de8-8598-ef50be8ddb8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40074bd0d0>]}
11:54:18.289689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b34ef9c0-6297-4de8-8598-ef50be8ddb8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073cdfd0>]}
11:54:18.292990 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
11:54:18.301612 [info ] [MainThread]: 
11:54:18.305855 [debug] [MainThread]: Acquiring new materialize connection "master"
11:54:18.317301 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
11:54:18.387920 [debug] [ThreadPool]: Using materialize connection "list_materialize"
11:54:18.391533 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
11:54:18.394136 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:54:18.428165 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
11:54:18.438788 [debug] [ThreadPool]: On list_materialize: Close
11:54:18.448244 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
11:54:18.471917 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
11:54:18.474768 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
11:54:18.478185 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:54:18.485619 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
11:54:18.495597 [debug] [ThreadPool]: On list_materialize_public: Close
11:54:18.502109 [debug] [MainThread]: Using materialize connection "master"
11:54:18.504993 [debug] [MainThread]: On master: BEGIN
11:54:18.508363 [debug] [MainThread]: Opening a new connection, currently in state init
11:54:18.515212 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:54:18.518593 [debug] [MainThread]: Using materialize connection "master"
11:54:18.521313 [debug] [MainThread]: On master: COMMIT
11:54:18.524284 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:54:18.526764 [debug] [MainThread]: On master: Close
11:54:18.530273 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
11:54:18.533072 [info ] [MainThread]: 
11:54:18.643198 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
11:54:18.646661 [info ] [Thread-1  ]: 1 of 3 START source model public.rp_twitter_trending............................ [RUN]
11:54:18.650672 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
11:54:18.653011 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
11:54:18.654986 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
11:54:18.685033 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
11:54:18.693401 [debug] [Thread-1  ]: finished collecting timing info
11:54:18.695674 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
11:54:18.752106 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
11:54:18.755249 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
11:54:18.757444 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:54:18.764171 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
11:54:18.803723 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
11:54:18.811993 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
11:54:18.814073 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
11:54:18.827845 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
11:54:18.878581 [debug] [Thread-1  ]: finished collecting timing info
11:54:18.881693 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
11:54:18.885373 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b34ef9c0-6297-4de8-8598-ef50be8ddb8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40075445e0>]}
11:54:18.889049 [info ] [Thread-1  ]: 1 of 3 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.24s]
11:54:18.892327 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
11:54:18.897954 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
11:54:18.901205 [info ] [Thread-1  ]: 2 of 3 START view model public.stg_twitter_trending............................. [RUN]
11:54:18.905229 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
11:54:18.907926 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
11:54:18.911294 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
11:54:18.930569 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
11:54:18.940424 [debug] [Thread-1  ]: finished collecting timing info
11:54:18.943267 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
11:54:19.012389 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
11:54:19.015359 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
11:54:19.018082 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:54:19.024851 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:54:19.050808 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
11:54:19.059484 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
11:54:19.061984 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT

       (data->'location'->'name')::string as location_name,
       (data->'location'->'country')::string as location_country,
       (data->'trends'->0->'trends')::jsonb as trends
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        trends
    FROM renamed
)

SELECT * FROM final
  );
11:54:19.070768 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:54:19.083043 [debug] [Thread-1  ]: finished collecting timing info
11:54:19.085692 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
11:54:19.089795 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b34ef9c0-6297-4de8-8598-ef50be8ddb8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400fdbed60>]}
11:54:19.093430 [info ] [Thread-1  ]: 2 of 3 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.19s]
11:54:19.096536 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
11:54:19.100468 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
11:54:19.103445 [info ] [Thread-1  ]: 3 of 3 START materializedview model public.fct_twitter_trending................. [RUN]
11:54:19.107028 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
11:54:19.109182 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
11:54:19.112348 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
11:54:19.132997 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
11:54:19.141987 [debug] [Thread-1  ]: finished collecting timing info
11:54:19.144758 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
11:54:19.199088 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
11:54:19.201762 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
11:54:19.204989 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:54:19.210744 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
11:54:19.227438 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
11:54:19.234848 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
11:54:19.237163 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


SELECT location_name, location_country, trends
FROM "materialize"."public"."stg_twitter_trending"
  );
11:54:19.247906 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
11:54:19.258558 [debug] [Thread-1  ]: finished collecting timing info
11:54:19.261064 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
11:54:19.264404 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b34ef9c0-6297-4de8-8598-ef50be8ddb8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4029705c10>]}
11:54:19.268214 [info ] [Thread-1  ]: 3 of 3 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.16s]
11:54:19.271283 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
11:54:19.278059 [debug] [MainThread]: Acquiring new materialize connection "master"
11:54:19.281403 [debug] [MainThread]: Using materialize connection "master"
11:54:19.285565 [debug] [MainThread]: On master: BEGIN
11:54:19.288001 [debug] [MainThread]: Opening a new connection, currently in state closed
11:54:19.293713 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:54:19.296949 [debug] [MainThread]: Using materialize connection "master"
11:54:19.299932 [debug] [MainThread]: On master: COMMIT
11:54:19.302767 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:54:19.304931 [debug] [MainThread]: On master: Close
11:54:19.307981 [info ] [MainThread]: 
11:54:19.311054 [info ] [MainThread]: Finished running 1 source model, 1 view model, 1 materializedview model in 1.00s.
11:54:19.314382 [debug] [MainThread]: Connection 'master' was properly closed.
11:54:19.316359 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
11:54:19.352218 [info ] [MainThread]: 
11:54:19.355325 [info ] [MainThread]: [32mCompleted successfully[0m
11:54:19.358785 [info ] [MainThread]: 
11:54:19.361386 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
11:54:19.364831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400fdb37f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400fdb5a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x402971d700>]}


============================== 2022-02-23 12:28:22.475303 | f4fa9d36-ddd6-4f68-9180-410799f00367 ==============================
12:28:22.475303 [info ] [MainThread]: Running with dbt=1.0.1
12:28:22.485238 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:28:22.488515 [debug] [MainThread]: Tracking: tracking
12:28:22.519642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acdf0>]}
12:28:22.856470 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
12:28:22.861430 [debug] [MainThread]: Partial parsing: update schema file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter.yml
12:28:22.865593 [debug] [MainThread]: Partial parsing: update schema file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter.yml
12:28:22.870438 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
12:28:22.877400 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
12:28:22.998343 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
12:28:23.093314 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
12:28:23.234072 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

12:28:23.273040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4fa9d36-ddd6-4f68-9180-410799f00367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027bfd0a0>]}
12:28:23.323066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4fa9d36-ddd6-4f68-9180-410799f00367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400729fd90>]}
12:28:23.325945 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
12:28:23.333872 [info ] [MainThread]: 
12:28:23.337743 [debug] [MainThread]: Acquiring new materialize connection "master"
12:28:23.346287 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
12:28:23.417937 [debug] [ThreadPool]: Using materialize connection "list_materialize"
12:28:23.421165 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
12:28:23.423666 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:28:23.456303 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
12:28:23.467823 [debug] [ThreadPool]: On list_materialize: Close
12:28:23.478223 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
12:28:23.503198 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
12:28:23.506219 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
12:28:23.508498 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:28:23.516897 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
12:28:23.527185 [debug] [ThreadPool]: On list_materialize_public: Close
12:28:23.534255 [debug] [MainThread]: Using materialize connection "master"
12:28:23.536802 [debug] [MainThread]: On master: BEGIN
12:28:23.538916 [debug] [MainThread]: Opening a new connection, currently in state init
12:28:23.545025 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
12:28:23.547662 [debug] [MainThread]: Using materialize connection "master"
12:28:23.550053 [debug] [MainThread]: On master: COMMIT
12:28:23.553123 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
12:28:23.555973 [debug] [MainThread]: On master: Close
12:28:23.559551 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:28:23.562560 [info ] [MainThread]: 
12:28:23.579162 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
12:28:23.582364 [info ] [Thread-1  ]: 1 of 3 START source model public.rp_twitter_trending............................ [RUN]
12:28:23.587209 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
12:28:23.589997 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
12:28:23.592125 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
12:28:23.624592 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
12:28:23.631831 [debug] [Thread-1  ]: finished collecting timing info
12:28:23.634096 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
12:28:23.691412 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
12:28:23.694339 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
12:28:23.696446 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:28:23.706640 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
12:28:23.745599 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
12:28:23.752431 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
12:28:23.754797 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
12:28:23.765238 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
12:28:23.833987 [debug] [Thread-1  ]: finished collecting timing info
12:28:23.838334 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
12:28:23.844994 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4fa9d36-ddd6-4f68-9180-410799f00367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d8e220>]}
12:28:23.854193 [info ] [Thread-1  ]: 1 of 3 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.26s]
12:28:23.858419 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
12:28:23.865756 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
12:28:23.869938 [info ] [Thread-1  ]: 2 of 3 START view model public.stg_twitter_trending............................. [RUN]
12:28:23.876115 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
12:28:23.880158 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
12:28:23.882897 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
12:28:23.906208 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
12:28:23.914517 [debug] [Thread-1  ]: finished collecting timing info
12:28:23.919066 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
12:28:23.988719 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
12:28:23.991838 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
12:28:23.994885 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:28:24.001141 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
12:28:24.027371 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
12:28:24.034448 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
12:28:24.036640 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT

       (data->'location'->'name')::string as location_name,
       (data->'location'->'country')::string as location_country,
       (data->'trends'->0->'trends')::jsonb as trends
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        jsonb_array_elements(trends)->>'name' as trend_name,
        jsonb_array_elements(trends)->>'volume' as trend_volume
    FROM renamed
)

SELECT * FROM final
  );
12:28:24.046618 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
12:28:24.056441 [debug] [Thread-1  ]: finished collecting timing info
12:28:24.058721 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
12:28:24.062160 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4fa9d36-ddd6-4f68-9180-410799f00367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ee7310>]}
12:28:24.065660 [info ] [Thread-1  ]: 2 of 3 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.19s]
12:28:24.068874 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
12:28:24.073465 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
12:28:24.076584 [info ] [Thread-1  ]: 3 of 3 START materializedview model public.fct_twitter_trending................. [RUN]
12:28:24.080131 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
12:28:24.082278 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
12:28:24.084632 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
12:28:24.102351 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
12:28:24.109016 [debug] [Thread-1  ]: finished collecting timing info
12:28:24.111944 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
12:28:24.171534 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
12:28:24.175230 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
12:28:24.177911 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:28:24.184625 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
12:28:24.204182 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
12:28:24.211149 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
12:28:24.213568 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


SELECT location_name, location_country, trend_name, trend_volume
FROM "materialize"."public"."stg_twitter_trending"
  );
12:28:24.226610 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
12:28:24.238292 [debug] [Thread-1  ]: finished collecting timing info
12:28:24.241201 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
12:28:24.245457 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4fa9d36-ddd6-4f68-9180-410799f00367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ef0cd0>]}
12:28:24.250056 [info ] [Thread-1  ]: 3 of 3 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.17s]
12:28:24.253949 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
12:28:24.261104 [debug] [MainThread]: Acquiring new materialize connection "master"
12:28:24.264904 [debug] [MainThread]: Using materialize connection "master"
12:28:24.267042 [debug] [MainThread]: On master: BEGIN
12:28:24.269228 [debug] [MainThread]: Opening a new connection, currently in state closed
12:28:24.277439 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
12:28:24.280753 [debug] [MainThread]: Using materialize connection "master"
12:28:24.282538 [debug] [MainThread]: On master: COMMIT
12:28:24.285538 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
12:28:24.287565 [debug] [MainThread]: On master: Close
12:28:24.291108 [info ] [MainThread]: 
12:28:24.295077 [info ] [MainThread]: Finished running 1 source model, 1 view model, 1 materializedview model in 0.95s.
12:28:24.297815 [debug] [MainThread]: Connection 'master' was properly closed.
12:28:24.300288 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
12:28:24.335129 [info ] [MainThread]: 
12:28:24.338175 [info ] [MainThread]: [32mCompleted successfully[0m
12:28:24.341077 [info ] [MainThread]: 
12:28:24.343654 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
12:28:24.346557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c452b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c454f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ef6490>]}


============================== 2022-02-23 12:30:22.131449 | f22fb3a2-f91f-49d4-81e2-93c6b10fc17d ==============================
12:30:22.131449 [info ] [MainThread]: Running with dbt=1.0.1
12:30:22.141237 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:30:22.146227 [debug] [MainThread]: Tracking: tracking
12:30:22.180361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace20>]}
12:30:22.541942 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:30:22.547963 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
12:30:22.673149 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
12:30:22.863268 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

12:30:22.902352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f22fb3a2-f91f-49d4-81e2-93c6b10fc17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027bfd0d0>]}
12:30:22.954378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f22fb3a2-f91f-49d4-81e2-93c6b10fc17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072a5340>]}
12:30:22.959043 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
12:30:22.967673 [info ] [MainThread]: 
12:30:22.973314 [debug] [MainThread]: Acquiring new materialize connection "master"
12:30:22.982499 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
12:30:23.055124 [debug] [ThreadPool]: Using materialize connection "list_materialize"
12:30:23.058023 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
12:30:23.060244 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:30:23.088395 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
12:30:23.098765 [debug] [ThreadPool]: On list_materialize: Close
12:30:23.107334 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
12:30:23.132155 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
12:30:23.135875 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
12:30:23.138482 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:30:23.149723 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
12:30:23.160952 [debug] [ThreadPool]: On list_materialize_public: Close
12:30:23.166942 [debug] [MainThread]: Using materialize connection "master"
12:30:23.169615 [debug] [MainThread]: On master: BEGIN
12:30:23.171945 [debug] [MainThread]: Opening a new connection, currently in state init
12:30:23.178129 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
12:30:23.181051 [debug] [MainThread]: Using materialize connection "master"
12:30:23.183025 [debug] [MainThread]: On master: COMMIT
12:30:23.185642 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
12:30:23.187645 [debug] [MainThread]: On master: Close
12:30:23.190689 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:30:23.193534 [info ] [MainThread]: 
12:30:23.212036 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
12:30:23.215651 [info ] [Thread-1  ]: 1 of 3 START source model public.rp_twitter_trending............................ [RUN]
12:30:23.220480 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
12:30:23.222894 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
12:30:23.225084 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
12:30:23.255624 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
12:30:23.264180 [debug] [Thread-1  ]: finished collecting timing info
12:30:23.266523 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
12:30:23.325139 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
12:30:23.327919 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
12:30:23.330948 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:30:23.341082 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
12:30:23.380828 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
12:30:23.387465 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
12:30:23.389567 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
12:30:23.401236 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
12:30:23.451634 [debug] [Thread-1  ]: finished collecting timing info
12:30:23.454686 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
12:30:23.458392 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f22fb3a2-f91f-49d4-81e2-93c6b10fc17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d8cfd0>]}
12:30:23.467590 [info ] [Thread-1  ]: 1 of 3 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.24s]
12:30:23.473508 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
12:30:23.480524 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
12:30:23.483337 [info ] [Thread-1  ]: 2 of 3 START view model public.stg_twitter_trending............................. [RUN]
12:30:23.486781 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
12:30:23.489294 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
12:30:23.491721 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
12:30:23.510336 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
12:30:23.517415 [debug] [Thread-1  ]: finished collecting timing info
12:30:23.519955 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
12:30:23.591362 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
12:30:23.594596 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
12:30:23.596840 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:30:23.603441 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
12:30:23.629811 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
12:30:23.635990 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
12:30:23.638160 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT

       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'trends'->0->'trends')::jsonb as trends
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        jsonb_array_elements(trends)->>'name' as trend_name,
        jsonb_array_elements(trends)->>'volume' as trend_volume
    FROM renamed
)

SELECT * FROM final
  );
12:30:23.650299 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
12:30:23.660283 [debug] [Thread-1  ]: finished collecting timing info
12:30:23.662697 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
12:30:23.666050 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f22fb3a2-f91f-49d4-81e2-93c6b10fc17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ed89a0>]}
12:30:23.669186 [info ] [Thread-1  ]: 2 of 3 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.18s]
12:30:23.673115 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
12:30:23.678939 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
12:30:23.682485 [info ] [Thread-1  ]: 3 of 3 START materializedview model public.fct_twitter_trending................. [RUN]
12:30:23.686425 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
12:30:23.691368 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
12:30:23.693249 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
12:30:23.713889 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
12:30:23.723311 [debug] [Thread-1  ]: finished collecting timing info
12:30:23.726185 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
12:30:23.778199 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
12:30:23.781151 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
12:30:23.783390 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:30:23.789688 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
12:30:23.805593 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
12:30:23.811883 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
12:30:23.814088 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


SELECT location_name, location_country, trend_name, trend_volume
FROM "materialize"."public"."stg_twitter_trending"
  );
12:30:23.825059 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
12:30:23.835873 [debug] [Thread-1  ]: finished collecting timing info
12:30:23.838299 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
12:30:23.841870 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f22fb3a2-f91f-49d4-81e2-93c6b10fc17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d6f2b0>]}
12:30:23.845106 [info ] [Thread-1  ]: 3 of 3 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.16s]
12:30:23.848077 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
12:30:23.854496 [debug] [MainThread]: Acquiring new materialize connection "master"
12:30:23.857102 [debug] [MainThread]: Using materialize connection "master"
12:30:23.859470 [debug] [MainThread]: On master: BEGIN
12:30:23.862522 [debug] [MainThread]: Opening a new connection, currently in state closed
12:30:23.867991 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
12:30:23.870472 [debug] [MainThread]: Using materialize connection "master"
12:30:23.872905 [debug] [MainThread]: On master: COMMIT
12:30:23.875793 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
12:30:23.878163 [debug] [MainThread]: On master: Close
12:30:23.881942 [info ] [MainThread]: 
12:30:23.884921 [info ] [MainThread]: Finished running 1 source model, 1 view model, 1 materializedview model in 0.91s.
12:30:23.887958 [debug] [MainThread]: Connection 'master' was properly closed.
12:30:23.890116 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
12:30:23.925027 [info ] [MainThread]: 
12:30:23.929359 [info ] [MainThread]: [32mCompleted successfully[0m
12:30:23.932654 [info ] [MainThread]: 
12:30:23.936664 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
12:30:23.940020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d8e250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d8e430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5cfa0>]}


============================== 2022-02-23 12:30:45.995625 | 7faf7ec6-4b17-4855-b28b-007eddcf6474 ==============================
12:30:45.995625 [info ] [MainThread]: Running with dbt=1.0.1
12:30:46.003641 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:30:46.006578 [debug] [MainThread]: Tracking: tracking
12:30:46.033692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aad60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aadf0>]}
12:30:46.360064 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:30:46.364411 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
12:30:46.468627 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
12:30:46.647509 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

12:30:46.691951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7faf7ec6-4b17-4855-b28b-007eddcf6474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027bfc0d0>]}
12:30:46.742257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7faf7ec6-4b17-4855-b28b-007eddcf6474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072a4d60>]}
12:30:46.745627 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
12:30:46.753650 [info ] [MainThread]: 
12:30:46.758093 [debug] [MainThread]: Acquiring new materialize connection "master"
12:30:46.768376 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
12:30:46.839490 [debug] [ThreadPool]: Using materialize connection "list_materialize"
12:30:46.842494 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
12:30:46.845572 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:30:46.874846 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
12:30:46.885497 [debug] [ThreadPool]: On list_materialize: Close
12:30:46.894614 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
12:30:46.917725 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
12:30:46.920340 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
12:30:46.922691 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:30:46.929454 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
12:30:46.938907 [debug] [ThreadPool]: On list_materialize_public: Close
12:30:46.944198 [debug] [MainThread]: Using materialize connection "master"
12:30:46.946530 [debug] [MainThread]: On master: BEGIN
12:30:46.948669 [debug] [MainThread]: Opening a new connection, currently in state init
12:30:46.954839 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
12:30:46.957293 [debug] [MainThread]: Using materialize connection "master"
12:30:46.959324 [debug] [MainThread]: On master: COMMIT
12:30:46.962640 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
12:30:46.965087 [debug] [MainThread]: On master: Close
12:30:46.968054 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:30:46.970912 [info ] [MainThread]: 
12:30:46.987586 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
12:30:46.991023 [info ] [Thread-1  ]: 1 of 3 START source model public.rp_twitter_trending............................ [RUN]
12:30:46.995605 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
12:30:46.998021 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
12:30:47.000502 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
12:30:47.031947 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
12:30:47.038953 [debug] [Thread-1  ]: finished collecting timing info
12:30:47.041227 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
12:30:47.097061 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
12:30:47.099894 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
12:30:47.102167 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:30:47.112518 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
12:30:47.152246 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
12:30:47.158882 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
12:30:47.160888 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
12:30:47.170636 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
12:30:47.219666 [debug] [Thread-1  ]: finished collecting timing info
12:30:47.225193 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
12:30:47.229863 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7faf7ec6-4b17-4855-b28b-007eddcf6474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d8cfa0>]}
12:30:47.233097 [info ] [Thread-1  ]: 1 of 3 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.23s]
12:30:47.236423 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
12:30:47.241955 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
12:30:47.244655 [info ] [Thread-1  ]: 2 of 3 START view model public.stg_twitter_trending............................. [RUN]
12:30:47.248261 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
12:30:47.250445 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
12:30:47.252440 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
12:30:47.271464 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
12:30:47.279735 [debug] [Thread-1  ]: finished collecting timing info
12:30:47.283159 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
12:30:47.354615 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
12:30:47.357458 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
12:30:47.360106 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:30:47.366868 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
12:30:47.392176 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
12:30:47.400809 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
12:30:47.403146 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT

       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'trends'->0->'trends')::jsonb as trends
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        jsonb_array_elements(trends)->>'name' as trend_name,
        jsonb_array_elements(trends)->>'tweet_volume' as trend_volume
    FROM renamed
)

SELECT * FROM final
  );
12:30:47.412233 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
12:30:47.421935 [debug] [Thread-1  ]: finished collecting timing info
12:30:47.424420 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
12:30:47.427671 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7faf7ec6-4b17-4855-b28b-007eddcf6474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ec9df0>]}
12:30:47.431122 [info ] [Thread-1  ]: 2 of 3 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.18s]
12:30:47.434134 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
12:30:47.438227 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
12:30:47.441544 [info ] [Thread-1  ]: 3 of 3 START materializedview model public.fct_twitter_trending................. [RUN]
12:30:47.445170 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
12:30:47.447485 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
12:30:47.450157 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
12:30:47.467813 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
12:30:47.473611 [debug] [Thread-1  ]: finished collecting timing info
12:30:47.476656 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
12:30:47.527221 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
12:30:47.530229 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
12:30:47.533600 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:30:47.540187 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
12:30:47.556243 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
12:30:47.562350 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
12:30:47.564427 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


SELECT location_name, location_country, trend_name, trend_volume
FROM "materialize"."public"."stg_twitter_trending"
  );
12:30:47.574989 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
12:30:47.585174 [debug] [Thread-1  ]: finished collecting timing info
12:30:47.587486 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
12:30:47.591017 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7faf7ec6-4b17-4855-b28b-007eddcf6474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d74280>]}
12:30:47.594342 [info ] [Thread-1  ]: 3 of 3 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.15s]
12:30:47.597462 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
12:30:47.603375 [debug] [MainThread]: Acquiring new materialize connection "master"
12:30:47.605959 [debug] [MainThread]: Using materialize connection "master"
12:30:47.609657 [debug] [MainThread]: On master: BEGIN
12:30:47.612239 [debug] [MainThread]: Opening a new connection, currently in state closed
12:30:47.618088 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
12:30:47.620707 [debug] [MainThread]: Using materialize connection "master"
12:30:47.622973 [debug] [MainThread]: On master: COMMIT
12:30:47.625814 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
12:30:47.628298 [debug] [MainThread]: On master: Close
12:30:47.631829 [info ] [MainThread]: 
12:30:47.635085 [info ] [MainThread]: Finished running 1 source model, 1 view model, 1 materializedview model in 0.87s.
12:30:47.638233 [debug] [MainThread]: Connection 'master' was properly closed.
12:30:47.640465 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
12:30:47.674785 [info ] [MainThread]: 
12:30:47.677423 [info ] [MainThread]: [32mCompleted successfully[0m
12:30:47.680133 [info ] [MainThread]: 
12:30:47.683257 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
12:30:47.687381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ee2820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c4d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5dd60>]}


============================== 2022-02-23 12:53:55.345617 | 17edf447-d5f5-4e7d-9080-a82ba95ec132 ==============================
12:53:55.345617 [info ] [MainThread]: Running with dbt=1.0.1
12:53:55.351849 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:53:55.356341 [debug] [MainThread]: Tracking: tracking
12:53:55.382636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073c8700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073c87f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073c8790>]}
12:53:55.794971 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
12:53:55.799722 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/twitter_trending/staging/twitter/stg_worldcities.sql
12:53:55.803034 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/twitter_trending/sources/twitter/worldcities.sql
12:53:55.810932 [debug] [MainThread]: Partial parsing: update schema file: mz_hack_day://models/twitter_trending/sources/twitter/src_twitter.yml
12:53:55.936918 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_worldcities.sql
12:53:56.026364 [debug] [MainThread]: 1603: static parser failed on twitter_trending/sources/twitter/worldcities.sql
12:53:56.065413 [debug] [MainThread]: 1602: parser fallback to jinja rendering on twitter_trending/sources/twitter/worldcities.sql
12:53:56.126148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40074af8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027cfe580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027cfe5b0>]}


============================== 2022-02-23 12:54:41.271099 | 98e26632-cf0f-4592-95c9-0909e7eadfd0 ==============================
12:54:41.271099 [info ] [MainThread]: Running with dbt=1.0.1
12:54:41.277862 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:54:41.280506 [debug] [MainThread]: Tracking: tracking
12:54:41.309002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aae80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aae20>]}
12:54:41.699616 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
12:54:41.702926 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/twitter_trending/sources/twitter/worldcities.sql
12:54:41.705440 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/twitter_trending/staging/twitter/stg_worldcities.sql
12:54:41.709014 [debug] [MainThread]: Partial parsing: update schema file: mz_hack_day://models/twitter_trending/sources/twitter/src_twitter.yml
12:54:41.794653 [debug] [MainThread]: 1603: static parser failed on twitter_trending/sources/twitter/worldcities.sql
12:54:41.899348 [debug] [MainThread]: 1602: parser fallback to jinja rendering on twitter_trending/sources/twitter/worldcities.sql
12:54:41.935510 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_worldcities.sql
12:54:42.003331 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'worldcities' in the 'models' section of file 'models/twitter_trending/sources/twitter/src_twitter.yml'
12:54:42.008046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073900a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073989a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007398b80>]}


============================== 2022-02-23 12:55:40.599538 | 9ec6dfbd-b8f7-4359-b352-3da648fe2083 ==============================
12:55:40.599538 [info ] [MainThread]: Running with dbt=1.0.1
12:55:40.605630 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:55:40.608229 [debug] [MainThread]: Tracking: tracking
12:55:40.634632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abdc0>]}
12:55:40.953688 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
12:55:40.957179 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/twitter_trending/staging/twitter/stg_worldcities.sql
12:55:40.960381 [debug] [MainThread]: Partial parsing: added file: mz_hack_day://models/twitter_trending/sources/twitter/worldcities.sql
12:55:40.963576 [debug] [MainThread]: Partial parsing: update schema file: mz_hack_day://models/twitter_trending/sources/twitter/src_twitter.yml
12:55:41.079184 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_worldcities.sql
12:55:41.167202 [debug] [MainThread]: 1603: static parser failed on twitter_trending/sources/twitter/worldcities.sql
12:55:41.202891 [debug] [MainThread]: 1602: parser fallback to jinja rendering on twitter_trending/sources/twitter/worldcities.sql
12:55:41.291414 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

12:55:41.328557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ec6dfbd-b8f7-4359-b352-3da648fe2083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027bfe0d0>]}
12:55:41.378151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ec6dfbd-b8f7-4359-b352-3da648fe2083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072a3d30>]}
12:55:41.382222 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
12:55:41.391477 [info ] [MainThread]: 
12:55:41.395130 [debug] [MainThread]: Acquiring new materialize connection "master"
12:55:41.403954 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
12:55:41.471623 [debug] [ThreadPool]: Using materialize connection "list_materialize"
12:55:41.474495 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
12:55:41.477096 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:55:41.507436 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
12:55:41.517970 [debug] [ThreadPool]: On list_materialize: Close
12:55:41.527688 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
12:55:41.550700 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
12:55:41.553692 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
12:55:41.556313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:55:41.563316 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
12:55:41.572921 [debug] [ThreadPool]: On list_materialize_public: Close
12:55:41.579660 [debug] [MainThread]: Using materialize connection "master"
12:55:41.582100 [debug] [MainThread]: On master: BEGIN
12:55:41.584082 [debug] [MainThread]: Opening a new connection, currently in state init
12:55:41.589807 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
12:55:41.592872 [debug] [MainThread]: Using materialize connection "master"
12:55:41.595295 [debug] [MainThread]: On master: COMMIT
12:55:41.598387 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
12:55:41.600373 [debug] [MainThread]: On master: Close
12:55:41.603387 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:55:41.606152 [info ] [MainThread]: 
12:55:41.716374 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
12:55:41.720166 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
12:55:41.724103 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
12:55:41.726621 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
12:55:41.729158 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
12:55:41.749242 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
12:55:41.760562 [debug] [Thread-1  ]: finished collecting timing info
12:55:41.763058 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
12:55:41.820959 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
12:55:41.823815 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
12:55:41.826217 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:55:41.832751 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
12:55:41.871159 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
12:55:41.882385 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
12:55:41.884896 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
12:55:41.897075 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
12:55:41.945135 [debug] [Thread-1  ]: finished collecting timing info
12:55:41.948322 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
12:55:41.952477 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ec6dfbd-b8f7-4359-b352-3da648fe2083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5c790>]}
12:55:41.956209 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.23s]
12:55:41.959481 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
12:55:41.962166 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
12:55:41.964684 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
12:55:41.968238 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
12:55:41.970445 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
12:55:41.972430 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
12:55:41.991713 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
12:55:41.998578 [debug] [Thread-1  ]: finished collecting timing info
12:55:42.000759 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
12:55:42.011396 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
12:55:42.013869 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
12:55:42.015765 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:55:42.021900 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
12:55:42.031979 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
12:55:42.037699 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
12:55:42.039598 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv.gz' COMPRESSION GZIP
FORMAT CSV;
12:55:42.043036 [debug] [Thread-1  ]: Postgres adapter: Postgres error: Expected WITH, found semicolon
LINE 10: FORMAT CSV;
                   ^

12:55:42.045585 [debug] [Thread-1  ]: finished collecting timing info
12:55:42.047665 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
12:55:42.051443 [debug] [Thread-1  ]: Database Error in model worldcities (models/twitter_trending/sources/twitter/worldcities.sql)
  Expected WITH, found semicolon
  LINE 10: FORMAT CSV;
                     ^
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/sources/twitter/worldcities.sql
12:55:42.055266 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ec6dfbd-b8f7-4359-b352-3da648fe2083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073c51c0>]}
12:55:42.059722 [error] [Thread-1  ]: 2 of 5 ERROR creating source model public.worldcities........................... [[31mERROR[0m in 0.09s]
12:55:42.063076 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
12:55:42.067093 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
12:55:42.070799 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
12:55:42.075904 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
12:55:42.078529 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
12:55:42.082798 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
12:55:42.103738 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
12:55:42.112543 [debug] [Thread-1  ]: finished collecting timing info
12:55:42.114762 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
12:55:42.184459 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
12:55:42.187663 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
12:55:42.190175 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:55:42.196160 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
12:55:42.221400 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
12:55:42.231653 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
12:55:42.234260 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT

       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'trends'->0->'trends')::jsonb as trends
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        jsonb_array_elements(trends)->>'name' as trend_name,
        jsonb_array_elements(trends)->>'tweet_volume' as trend_volume
    FROM renamed
)

SELECT * FROM final
  );
12:55:42.242585 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
12:55:42.252376 [debug] [Thread-1  ]: finished collecting timing info
12:55:42.254730 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
12:55:42.258663 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ec6dfbd-b8f7-4359-b352-3da648fe2083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073987f0>]}
12:55:42.261960 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.18s]
12:55:42.264664 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
12:55:42.267104 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
12:55:42.269517 [info ] [Thread-1  ]: 4 of 5 SKIP relation public.stg_worldcities..................................... [[33mSKIP[0m]
12:55:42.272202 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
12:55:42.274504 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
12:55:42.277079 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
12:55:42.280797 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
12:55:42.283958 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
12:55:42.285838 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
12:55:42.303012 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
12:55:42.310588 [debug] [Thread-1  ]: finished collecting timing info
12:55:42.313100 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
12:55:42.364110 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
12:55:42.366724 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
12:55:42.368838 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:55:42.375238 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
12:55:42.392105 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
12:55:42.401550 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
12:55:42.403566 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


SELECT location_name, location_country, trend_name, trend_volume
FROM "materialize"."public"."stg_twitter_trending"
  );
12:55:42.414850 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
12:55:42.425797 [debug] [Thread-1  ]: finished collecting timing info
12:55:42.428160 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
12:55:42.431898 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ec6dfbd-b8f7-4359-b352-3da648fe2083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d565b0>]}
12:55:42.435393 [info ] [Thread-1  ]: 5 of 5 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.15s]
12:55:42.438405 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
12:55:42.445344 [debug] [MainThread]: Acquiring new materialize connection "master"
12:55:42.448139 [debug] [MainThread]: Using materialize connection "master"
12:55:42.450746 [debug] [MainThread]: On master: BEGIN
12:55:42.454005 [debug] [MainThread]: Opening a new connection, currently in state closed
12:55:42.459976 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
12:55:42.462665 [debug] [MainThread]: Using materialize connection "master"
12:55:42.464771 [debug] [MainThread]: On master: COMMIT
12:55:42.467528 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
12:55:42.469726 [debug] [MainThread]: On master: Close
12:55:42.473974 [info ] [MainThread]: 
12:55:42.476899 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.08s.
12:55:42.480337 [debug] [MainThread]: Connection 'master' was properly closed.
12:55:42.482926 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
12:55:42.518795 [info ] [MainThread]: 
12:55:42.521845 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
12:55:42.524370 [info ] [MainThread]: 
12:55:42.526879 [error] [MainThread]: [33mDatabase Error in model worldcities (models/twitter_trending/sources/twitter/worldcities.sql)[0m
12:55:42.529798 [error] [MainThread]:   Expected WITH, found semicolon
12:55:42.532555 [error] [MainThread]:   LINE 10: FORMAT CSV;
12:55:42.534789 [error] [MainThread]:                      ^
12:55:42.537140 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/sources/twitter/worldcities.sql
12:55:42.540680 [info ] [MainThread]: 
12:55:42.543118 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
12:55:42.547816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073c5a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40306bf7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x403071dbb0>]}


============================== 2022-02-23 12:56:43.607305 | 30eeb971-1cb0-42fa-8d45-46acbbe8c7de ==============================
12:56:43.607305 [info ] [MainThread]: Running with dbt=1.0.1
12:56:43.614157 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:56:43.617241 [debug] [MainThread]: Tracking: tracking
12:56:43.645849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728ad60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728ae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728adf0>]}
12:56:44.009588 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:56:44.013770 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/sources/twitter/worldcities.sql
12:56:44.103020 [debug] [MainThread]: 1603: static parser failed on twitter_trending/sources/twitter/worldcities.sql
12:56:44.207452 [debug] [MainThread]: 1602: parser fallback to jinja rendering on twitter_trending/sources/twitter/worldcities.sql
12:56:44.299659 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

12:56:44.338171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30eeb971-1cb0-42fa-8d45-46acbbe8c7de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40074010d0>]}
12:56:44.395787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30eeb971-1cb0-42fa-8d45-46acbbe8c7de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400732c790>]}
12:56:44.399224 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
12:56:44.408950 [info ] [MainThread]: 
12:56:44.413714 [debug] [MainThread]: Acquiring new materialize connection "master"
12:56:44.426310 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
12:56:44.498362 [debug] [ThreadPool]: Using materialize connection "list_materialize"
12:56:44.502304 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
12:56:44.504862 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:56:44.533734 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
12:56:44.544150 [debug] [ThreadPool]: On list_materialize: Close
12:56:44.554331 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
12:56:44.577884 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
12:56:44.581585 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
12:56:44.583526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:56:44.590461 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
12:56:44.600014 [debug] [ThreadPool]: On list_materialize_public: Close
12:56:44.606946 [debug] [MainThread]: Using materialize connection "master"
12:56:44.609498 [debug] [MainThread]: On master: BEGIN
12:56:44.611328 [debug] [MainThread]: Opening a new connection, currently in state init
12:56:44.617764 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
12:56:44.620483 [debug] [MainThread]: Using materialize connection "master"
12:56:44.622804 [debug] [MainThread]: On master: COMMIT
12:56:44.625801 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
12:56:44.628525 [debug] [MainThread]: On master: Close
12:56:44.632448 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:56:44.635397 [info ] [MainThread]: 
12:56:44.652687 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
12:56:44.657115 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
12:56:44.661175 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
12:56:44.663558 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
12:56:44.665596 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
12:56:44.688784 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
12:56:44.695932 [debug] [Thread-1  ]: finished collecting timing info
12:56:44.698583 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
12:56:44.756293 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
12:56:44.758978 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
12:56:44.761347 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:56:44.770907 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
12:56:44.811421 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
12:56:44.818515 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
12:56:44.820830 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
12:56:44.833574 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
12:56:44.883937 [debug] [Thread-1  ]: finished collecting timing info
12:56:44.886878 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
12:56:44.890782 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30eeb971-1cb0-42fa-8d45-46acbbe8c7de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40295bbee0>]}
12:56:44.894072 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.23s]
12:56:44.897707 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
12:56:44.900515 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
12:56:44.903845 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
12:56:44.909536 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
12:56:44.911942 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
12:56:44.914408 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
12:56:44.938390 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
12:56:44.945594 [debug] [Thread-1  ]: finished collecting timing info
12:56:44.948629 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
12:56:44.960204 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
12:56:44.962799 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
12:56:44.964723 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:56:44.970777 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
12:56:44.979479 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
12:56:44.985426 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
12:56:44.987332 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv.gz' COMPRESSION GZIP
FORMAT CSV WITH HEADER;
12:56:44.993173 [debug] [Thread-1  ]: Postgres adapter: Postgres error: Cannot determine header by reading CSV file: stream did not contain valid UTF-8

12:56:44.996046 [debug] [Thread-1  ]: finished collecting timing info
12:56:44.999145 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
12:56:45.003080 [debug] [Thread-1  ]: Database Error in model worldcities (models/twitter_trending/sources/twitter/worldcities.sql)
  Cannot determine header by reading CSV file: stream did not contain valid UTF-8
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/sources/twitter/worldcities.sql
12:56:45.006540 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30eeb971-1cb0-42fa-8d45-46acbbe8c7de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400744ac70>]}
12:56:45.009864 [error] [Thread-1  ]: 2 of 5 ERROR creating source model public.worldcities........................... [[31mERROR[0m in 0.10s]
12:56:45.014038 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
12:56:45.016949 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
12:56:45.020139 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
12:56:45.024188 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
12:56:45.026830 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
12:56:45.029125 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
12:56:45.051344 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
12:56:45.058033 [debug] [Thread-1  ]: finished collecting timing info
12:56:45.060928 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
12:56:45.135509 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
12:56:45.139031 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
12:56:45.141262 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:56:45.147481 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
12:56:45.174035 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
12:56:45.185387 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
12:56:45.187776 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT

       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'trends'->0->'trends')::jsonb as trends
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        jsonb_array_elements(trends)->>'name' as trend_name,
        jsonb_array_elements(trends)->>'tweet_volume' as trend_volume
    FROM renamed
)

SELECT * FROM final
  );
12:56:45.197675 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
12:56:45.207510 [debug] [Thread-1  ]: finished collecting timing info
12:56:45.210089 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
12:56:45.214350 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30eeb971-1cb0-42fa-8d45-46acbbe8c7de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40295d2fa0>]}
12:56:45.217704 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.19s]
12:56:45.221255 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
12:56:45.224132 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
12:56:45.226973 [info ] [Thread-1  ]: 4 of 5 SKIP relation public.stg_worldcities..................................... [[33mSKIP[0m]
12:56:45.229982 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
12:56:45.232193 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
12:56:45.234825 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
12:56:45.239208 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
12:56:45.241704 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
12:56:45.244643 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
12:56:45.270245 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
12:56:45.280600 [debug] [Thread-1  ]: finished collecting timing info
12:56:45.284783 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
12:56:45.339302 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
12:56:45.342421 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
12:56:45.344840 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:56:45.351902 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
12:56:45.369745 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
12:56:45.383918 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
12:56:45.387452 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


SELECT location_name, location_country, trend_name, trend_volume
FROM "materialize"."public"."stg_twitter_trending"
  );
12:56:45.402802 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
12:56:45.415436 [debug] [Thread-1  ]: finished collecting timing info
12:56:45.418214 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
12:56:45.421903 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30eeb971-1cb0-42fa-8d45-46acbbe8c7de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400756cee0>]}
12:56:45.425448 [info ] [Thread-1  ]: 5 of 5 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.18s]
12:56:45.429718 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
12:56:45.439410 [debug] [MainThread]: Acquiring new materialize connection "master"
12:56:45.442339 [debug] [MainThread]: Using materialize connection "master"
12:56:45.444628 [debug] [MainThread]: On master: BEGIN
12:56:45.446706 [debug] [MainThread]: Opening a new connection, currently in state closed
12:56:45.455481 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
12:56:45.458525 [debug] [MainThread]: Using materialize connection "master"
12:56:45.460580 [debug] [MainThread]: On master: COMMIT
12:56:45.464203 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
12:56:45.468619 [debug] [MainThread]: On master: Close
12:56:45.474581 [info ] [MainThread]: 
12:56:45.478017 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.06s.
12:56:45.481560 [debug] [MainThread]: Connection 'master' was properly closed.
12:56:45.484076 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
12:56:45.524680 [info ] [MainThread]: 
12:56:45.527656 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
12:56:45.531005 [info ] [MainThread]: 
12:56:45.535066 [error] [MainThread]: [33mDatabase Error in model worldcities (models/twitter_trending/sources/twitter/worldcities.sql)[0m
12:56:45.539417 [error] [MainThread]:   Cannot determine header by reading CSV file: stream did not contain valid UTF-8
12:56:45.542482 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/sources/twitter/worldcities.sql
12:56:45.545464 [info ] [MainThread]: 
12:56:45.548401 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
12:56:45.552804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400756cfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400756ce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400744a610>]}


============================== 2022-02-23 13:04:35.678533 | 7d505e46-127b-40d1-b595-5394853716b9 ==============================
13:04:35.678533 [info ] [MainThread]: Running with dbt=1.0.1
13:04:35.685791 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:04:35.688579 [debug] [MainThread]: Tracking: tracking
13:04:35.718467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aadc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aaeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aae50>]}
13:04:36.093303 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
13:04:36.096773 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
13:04:36.101734 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

13:04:36.150861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d505e46-127b-40d1-b595-5394853716b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073bc0d0>]}
13:04:36.203111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d505e46-127b-40d1-b595-5394853716b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073307f0>]}
13:04:36.206308 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
13:04:36.216195 [info ] [MainThread]: 
13:04:36.220353 [debug] [MainThread]: Acquiring new materialize connection "master"
13:04:36.231371 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
13:04:36.311117 [debug] [ThreadPool]: Using materialize connection "list_materialize"
13:04:36.314240 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
13:04:36.316468 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:04:36.347190 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
13:04:36.358391 [debug] [ThreadPool]: On list_materialize: Close
13:04:36.368713 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
13:04:36.392681 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
13:04:36.395859 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
13:04:36.398357 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:04:36.405623 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
13:04:36.414855 [debug] [ThreadPool]: On list_materialize_public: Close
13:04:36.421705 [debug] [MainThread]: Using materialize connection "master"
13:04:36.424157 [debug] [MainThread]: On master: BEGIN
13:04:36.443382 [debug] [MainThread]: Opening a new connection, currently in state init
13:04:36.449424 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:04:36.452163 [debug] [MainThread]: Using materialize connection "master"
13:04:36.454458 [debug] [MainThread]: On master: COMMIT
13:04:36.457657 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:04:36.460077 [debug] [MainThread]: On master: Close
13:04:36.463319 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:04:36.466313 [info ] [MainThread]: 
13:04:36.488498 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
13:04:36.492446 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
13:04:36.496681 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
13:04:36.499142 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
13:04:36.501468 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
13:04:36.533294 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
13:04:36.541534 [debug] [Thread-1  ]: finished collecting timing info
13:04:36.544007 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
13:04:36.602301 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
13:04:36.605396 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
13:04:36.607496 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:04:36.617965 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
13:04:36.658379 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
13:04:36.668709 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
13:04:36.671251 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
13:04:36.682909 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
13:04:36.733240 [debug] [Thread-1  ]: finished collecting timing info
13:04:36.735781 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
13:04:36.740496 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d505e46-127b-40d1-b595-5394853716b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400fc82d60>]}
13:04:36.744134 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.24s]
13:04:36.747698 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
13:04:36.750295 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
13:04:36.754213 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
13:04:36.757716 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
13:04:36.760064 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
13:04:36.762222 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
13:04:36.782440 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
13:04:36.789253 [debug] [Thread-1  ]: finished collecting timing info
13:04:36.791529 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
13:04:36.801775 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
13:04:36.804259 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
13:04:36.806204 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:04:36.812238 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
13:04:36.820774 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
13:04:36.826660 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
13:04:36.828686 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv.gz' COMPRESSION GZIP
FORMAT CSV WITH HEADER;
13:04:36.835100 [debug] [Thread-1  ]: Postgres adapter: Postgres error: Cannot determine header by reading CSV file: stream did not contain valid UTF-8

13:04:36.839298 [debug] [Thread-1  ]: finished collecting timing info
13:04:36.841620 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
13:04:36.845172 [debug] [Thread-1  ]: Database Error in model worldcities (models/twitter_trending/sources/twitter/worldcities.sql)
  Cannot determine header by reading CSV file: stream did not contain valid UTF-8
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/sources/twitter/worldcities.sql
13:04:36.848234 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d505e46-127b-40d1-b595-5394853716b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40294cda30>]}
13:04:36.851275 [error] [Thread-1  ]: 2 of 5 ERROR creating source model public.worldcities........................... [[31mERROR[0m in 0.09s]
13:04:36.854231 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
13:04:36.856877 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
13:04:36.860099 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
13:04:36.863583 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
13:04:36.865497 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
13:04:36.867697 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
13:04:36.887254 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
13:04:36.894136 [debug] [Thread-1  ]: finished collecting timing info
13:04:36.896744 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
13:04:36.966386 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
13:04:36.969335 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
13:04:36.971377 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:04:36.977853 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:04:37.002899 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
13:04:37.009474 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
13:04:37.012100 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT

       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'trends'->0->'trends')::jsonb as trends
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        jsonb_array_elements(trends)->>'name' as trend_name,
        jsonb_array_elements(trends)->>'tweet_volume' as trend_volume
    FROM renamed
)

SELECT * FROM final
  );
13:04:37.020777 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:04:37.030508 [debug] [Thread-1  ]: finished collecting timing info
13:04:37.033092 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
13:04:37.036530 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d505e46-127b-40d1-b595-5394853716b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40294ebf40>]}
13:04:37.041135 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.17s]
13:04:37.044099 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
13:04:37.046537 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
13:04:37.049242 [info ] [Thread-1  ]: 4 of 5 SKIP relation public.stg_worldcities..................................... [[33mSKIP[0m]
13:04:37.051875 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
13:04:37.054590 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
13:04:37.057132 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
13:04:37.060651 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
13:04:37.063016 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
13:04:37.065183 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
13:04:37.082400 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
13:04:37.089243 [debug] [Thread-1  ]: finished collecting timing info
13:04:37.091531 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
13:04:37.143871 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
13:04:37.147262 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
13:04:37.150104 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:04:37.158219 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:04:37.178936 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
13:04:37.186037 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
13:04:37.188349 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


SELECT location_name, location_country, trend_name, trend_volume
FROM "materialize"."public"."stg_twitter_trending"
  );
13:04:37.199403 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:04:37.210467 [debug] [Thread-1  ]: finished collecting timing info
13:04:37.213127 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
13:04:37.216956 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d505e46-127b-40d1-b595-5394853716b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400743d0a0>]}
13:04:37.220394 [info ] [Thread-1  ]: 5 of 5 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.16s]
13:04:37.223635 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
13:04:37.232295 [debug] [MainThread]: Acquiring new materialize connection "master"
13:04:37.235018 [debug] [MainThread]: Using materialize connection "master"
13:04:37.236998 [debug] [MainThread]: On master: BEGIN
13:04:37.238992 [debug] [MainThread]: Opening a new connection, currently in state closed
13:04:37.244756 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:04:37.247536 [debug] [MainThread]: Using materialize connection "master"
13:04:37.249721 [debug] [MainThread]: On master: COMMIT
13:04:37.252823 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:04:37.255348 [debug] [MainThread]: On master: Close
13:04:37.259738 [info ] [MainThread]: 
13:04:37.262760 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.04s.
13:04:37.265988 [debug] [MainThread]: Connection 'master' was properly closed.
13:04:37.268262 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
13:04:37.306430 [info ] [MainThread]: 
13:04:37.309198 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
13:04:37.312146 [info ] [MainThread]: 
13:04:37.314629 [error] [MainThread]: [33mDatabase Error in model worldcities (models/twitter_trending/sources/twitter/worldcities.sql)[0m
13:04:37.317340 [error] [MainThread]:   Cannot determine header by reading CSV file: stream did not contain valid UTF-8
13:04:37.320051 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/sources/twitter/worldcities.sql
13:04:37.322732 [info ] [MainThread]: 
13:04:37.325532 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
13:04:37.328588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400743d970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400743dbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40295315e0>]}


============================== 2022-02-23 13:11:02.557940 | 4665103f-3e5d-4920-b74b-f0e05daa0e6a ==============================
13:11:02.557940 [info ] [MainThread]: Running with dbt=1.0.1
13:11:02.565355 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:11:02.568412 [debug] [MainThread]: Tracking: tracking
13:11:02.598660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acdf0>]}
13:11:02.934321 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:11:02.938300 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/sources/twitter/worldcities.sql
13:11:03.026876 [debug] [MainThread]: 1603: static parser failed on twitter_trending/sources/twitter/worldcities.sql
13:11:03.134076 [debug] [MainThread]: 1602: parser fallback to jinja rendering on twitter_trending/sources/twitter/worldcities.sql
13:11:03.224144 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

13:11:03.262634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4665103f-3e5d-4920-b74b-f0e05daa0e6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073fe0d0>]}
13:11:03.310084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4665103f-3e5d-4920-b74b-f0e05daa0e6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400732c790>]}
13:11:03.313304 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
13:11:03.323186 [info ] [MainThread]: 
13:11:03.327491 [debug] [MainThread]: Acquiring new materialize connection "master"
13:11:03.341731 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
13:11:03.410791 [debug] [ThreadPool]: Using materialize connection "list_materialize"
13:11:03.414425 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
13:11:03.416776 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:11:03.446946 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
13:11:03.457860 [debug] [ThreadPool]: On list_materialize: Close
13:11:03.468004 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
13:11:03.491716 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
13:11:03.494294 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
13:11:03.496614 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:11:03.503531 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
13:11:03.513091 [debug] [ThreadPool]: On list_materialize_public: Close
13:11:03.519739 [debug] [MainThread]: Using materialize connection "master"
13:11:03.522475 [debug] [MainThread]: On master: BEGIN
13:11:03.525040 [debug] [MainThread]: Opening a new connection, currently in state init
13:11:03.530892 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:11:03.533509 [debug] [MainThread]: Using materialize connection "master"
13:11:03.535905 [debug] [MainThread]: On master: COMMIT
13:11:03.539131 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:11:03.541603 [debug] [MainThread]: On master: Close
13:11:03.544627 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:11:03.547590 [info ] [MainThread]: 
13:11:03.565520 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
13:11:03.569958 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
13:11:03.574301 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
13:11:03.580961 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
13:11:03.583716 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
13:11:03.604870 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
13:11:03.612460 [debug] [Thread-1  ]: finished collecting timing info
13:11:03.615041 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
13:11:03.673489 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
13:11:03.676657 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
13:11:03.678998 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:11:03.688647 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
13:11:03.728629 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
13:11:03.736800 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
13:11:03.739446 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
13:11:03.755925 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
13:11:03.811663 [debug] [Thread-1  ]: finished collecting timing info
13:11:03.814315 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
13:11:03.818144 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4665103f-3e5d-4920-b74b-f0e05daa0e6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40296ba130>]}
13:11:03.822075 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.24s]
13:11:03.825516 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
13:11:03.827836 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
13:11:03.831111 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
13:11:03.834846 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
13:11:03.836903 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
13:11:03.839401 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
13:11:03.864011 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
13:11:03.870821 [debug] [Thread-1  ]: finished collecting timing info
13:11:03.873163 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
13:11:03.883824 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
13:11:03.886364 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
13:11:03.888474 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:11:03.894713 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
13:11:03.903019 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
13:11:03.909757 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
13:11:03.911810 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv.gz' COMPRESSION GZIP
FORMAT CSV WITH HEADER
DELIMITED BY '|';
13:11:03.918538 [debug] [Thread-1  ]: Postgres adapter: Postgres error: Cannot determine header by reading CSV file: stream did not contain valid UTF-8

13:11:03.921710 [debug] [Thread-1  ]: finished collecting timing info
13:11:03.923846 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
13:11:03.927169 [debug] [Thread-1  ]: Database Error in model worldcities (models/twitter_trending/sources/twitter/worldcities.sql)
  Cannot determine header by reading CSV file: stream did not contain valid UTF-8
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/sources/twitter/worldcities.sql
13:11:03.930144 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4665103f-3e5d-4920-b74b-f0e05daa0e6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400744ac70>]}
13:11:03.933205 [error] [Thread-1  ]: 2 of 5 ERROR creating source model public.worldcities........................... [[31mERROR[0m in 0.10s]
13:11:03.936330 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
13:11:03.938731 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
13:11:03.941293 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
13:11:03.944810 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
13:11:03.947293 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
13:11:03.950435 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
13:11:03.969466 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
13:11:03.976440 [debug] [Thread-1  ]: finished collecting timing info
13:11:03.979101 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
13:11:04.048286 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
13:11:04.051342 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
13:11:04.070417 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:11:04.076953 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:11:04.107461 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
13:11:04.114680 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
13:11:04.116748 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT

       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'trends'->0->'trends')::jsonb as trends
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        jsonb_array_elements(trends)->>'name' as trend_name,
        jsonb_array_elements(trends)->>'tweet_volume' as trend_volume
    FROM renamed
)

SELECT * FROM final
  );
13:11:04.126379 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:11:04.136105 [debug] [Thread-1  ]: finished collecting timing info
13:11:04.138884 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
13:11:04.142308 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4665103f-3e5d-4920-b74b-f0e05daa0e6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40296de070>]}
13:11:04.145838 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.20s]
13:11:04.148767 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
13:11:04.151297 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
13:11:04.154065 [info ] [Thread-1  ]: 4 of 5 SKIP relation public.stg_worldcities..................................... [[33mSKIP[0m]
13:11:04.157018 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
13:11:04.160041 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
13:11:04.163134 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
13:11:04.167271 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
13:11:04.170495 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
13:11:04.173066 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
13:11:04.191506 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
13:11:04.199436 [debug] [Thread-1  ]: finished collecting timing info
13:11:04.202659 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
13:11:04.255118 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
13:11:04.258199 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
13:11:04.260270 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:11:04.266376 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:11:04.282484 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
13:11:04.289356 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
13:11:04.291821 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


SELECT location_name, location_country, trend_name, trend_volume
FROM "materialize"."public"."stg_twitter_trending"
  );
13:11:04.301957 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:11:04.314252 [debug] [Thread-1  ]: finished collecting timing info
13:11:04.317142 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
13:11:04.320809 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4665103f-3e5d-4920-b74b-f0e05daa0e6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400756cee0>]}
13:11:04.324186 [info ] [Thread-1  ]: 5 of 5 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.15s]
13:11:04.327260 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
13:11:04.335110 [debug] [MainThread]: Acquiring new materialize connection "master"
13:11:04.337861 [debug] [MainThread]: Using materialize connection "master"
13:11:04.339906 [debug] [MainThread]: On master: BEGIN
13:11:04.341764 [debug] [MainThread]: Opening a new connection, currently in state closed
13:11:04.347990 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:11:04.351059 [debug] [MainThread]: Using materialize connection "master"
13:11:04.353510 [debug] [MainThread]: On master: COMMIT
13:11:04.356714 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:11:04.359073 [debug] [MainThread]: On master: Close
13:11:04.363494 [info ] [MainThread]: 
13:11:04.366426 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.04s.
13:11:04.369226 [debug] [MainThread]: Connection 'master' was properly closed.
13:11:04.371436 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
13:11:04.407654 [info ] [MainThread]: 
13:11:04.410315 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
13:11:04.413191 [info ] [MainThread]: 
13:11:04.415320 [error] [MainThread]: [33mDatabase Error in model worldcities (models/twitter_trending/sources/twitter/worldcities.sql)[0m
13:11:04.418311 [error] [MainThread]:   Cannot determine header by reading CSV file: stream did not contain valid UTF-8
13:11:04.421886 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/sources/twitter/worldcities.sql
13:11:04.425937 [info ] [MainThread]: 
13:11:04.429024 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
13:11:04.432450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400756cfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400756ce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400744ab50>]}


============================== 2022-02-23 13:12:22.795094 | e0f4868f-a4a5-4e34-8377-edaf2956d2a3 ==============================
13:12:22.795094 [info ] [MainThread]: Running with dbt=1.0.1
13:12:22.802210 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:12:22.805150 [debug] [MainThread]: Tracking: tracking
13:12:22.832710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd30>]}
13:12:23.171723 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:12:23.175554 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/sources/twitter/worldcities.sql
13:12:23.266083 [debug] [MainThread]: 1603: static parser failed on twitter_trending/sources/twitter/worldcities.sql
13:12:23.369988 [debug] [MainThread]: 1602: parser fallback to jinja rendering on twitter_trending/sources/twitter/worldcities.sql
13:12:23.466337 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

13:12:23.510703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0f4868f-a4a5-4e34-8377-edaf2956d2a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073fe0d0>]}
13:12:23.562621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0f4868f-a4a5-4e34-8377-edaf2956d2a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072a76d0>]}
13:12:23.566028 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
13:12:23.575300 [info ] [MainThread]: 
13:12:23.579449 [debug] [MainThread]: Acquiring new materialize connection "master"
13:12:23.589437 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
13:12:23.659072 [debug] [ThreadPool]: Using materialize connection "list_materialize"
13:12:23.663652 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
13:12:23.666010 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:12:23.697912 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
13:12:23.708441 [debug] [ThreadPool]: On list_materialize: Close
13:12:23.718149 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
13:12:23.741633 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
13:12:23.744299 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
13:12:23.746474 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:12:23.754648 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
13:12:23.764035 [debug] [ThreadPool]: On list_materialize_public: Close
13:12:23.771806 [debug] [MainThread]: Using materialize connection "master"
13:12:23.774324 [debug] [MainThread]: On master: BEGIN
13:12:23.776529 [debug] [MainThread]: Opening a new connection, currently in state init
13:12:23.783477 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:12:23.786082 [debug] [MainThread]: Using materialize connection "master"
13:12:23.788261 [debug] [MainThread]: On master: COMMIT
13:12:23.791952 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:12:23.793996 [debug] [MainThread]: On master: Close
13:12:23.797249 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:12:23.800786 [info ] [MainThread]: 
13:12:23.819450 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
13:12:23.825566 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
13:12:23.831106 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
13:12:23.834395 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
13:12:23.836757 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
13:12:23.857990 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
13:12:23.864408 [debug] [Thread-1  ]: finished collecting timing info
13:12:23.867166 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
13:12:23.923619 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
13:12:23.926341 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
13:12:23.928520 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:12:23.939012 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
13:12:23.980155 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
13:12:23.987086 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
13:12:23.989378 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
13:12:23.999718 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
13:12:24.049944 [debug] [Thread-1  ]: finished collecting timing info
13:12:24.053133 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
13:12:24.056438 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0f4868f-a4a5-4e34-8377-edaf2956d2a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400738ac10>]}
13:12:24.059936 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.23s]
13:12:24.063057 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
13:12:24.066102 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
13:12:24.069257 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
13:12:24.073262 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
13:12:24.075605 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
13:12:24.077944 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
13:12:24.100517 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
13:12:24.107525 [debug] [Thread-1  ]: finished collecting timing info
13:12:24.110311 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
13:12:24.121136 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
13:12:24.123464 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
13:12:24.125486 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:12:24.131525 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
13:12:24.139569 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
13:12:24.145375 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
13:12:24.147396 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv.gz' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
13:12:24.151936 [debug] [Thread-1  ]: Postgres adapter: Postgres error: No such file or directory (os error 2)

13:12:24.154899 [debug] [Thread-1  ]: finished collecting timing info
13:12:24.156908 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
13:12:24.159749 [debug] [Thread-1  ]: Database Error in model worldcities (models/twitter_trending/sources/twitter/worldcities.sql)
  No such file or directory (os error 2)
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/sources/twitter/worldcities.sql
13:12:24.162581 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0f4868f-a4a5-4e34-8377-edaf2956d2a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40074494f0>]}
13:12:24.165945 [error] [Thread-1  ]: 2 of 5 ERROR creating source model public.worldcities........................... [[31mERROR[0m in 0.09s]
13:12:24.169347 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
13:12:24.172429 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
13:12:24.175457 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
13:12:24.179267 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
13:12:24.181562 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
13:12:24.184796 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
13:12:24.206542 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
13:12:24.213848 [debug] [Thread-1  ]: finished collecting timing info
13:12:24.216727 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
13:12:24.289032 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
13:12:24.292219 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
13:12:24.294721 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:12:24.300996 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:12:24.327352 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
13:12:24.333772 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
13:12:24.335771 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT

       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'trends'->0->'trends')::jsonb as trends
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        jsonb_array_elements(trends)->>'name' as trend_name,
        jsonb_array_elements(trends)->>'tweet_volume' as trend_volume
    FROM renamed
)

SELECT * FROM final
  );
13:12:24.346087 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:12:24.355807 [debug] [Thread-1  ]: finished collecting timing info
13:12:24.358399 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
13:12:24.362626 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0f4868f-a4a5-4e34-8377-edaf2956d2a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40296db280>]}
13:12:24.365895 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.18s]
13:12:24.368937 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
13:12:24.371648 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
13:12:24.374189 [info ] [Thread-1  ]: 4 of 5 SKIP relation public.stg_worldcities..................................... [[33mSKIP[0m]
13:12:24.377547 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
13:12:24.380543 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
13:12:24.383182 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
13:12:24.387230 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
13:12:24.389212 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
13:12:24.391533 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
13:12:24.410148 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
13:12:24.417100 [debug] [Thread-1  ]: finished collecting timing info
13:12:24.419617 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
13:12:24.470012 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
13:12:24.473217 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
13:12:24.475576 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:12:24.481482 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:12:24.498277 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
13:12:24.509759 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
13:12:24.512727 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


SELECT location_name, location_country, trend_name, trend_volume
FROM "materialize"."public"."stg_twitter_trending"
  );
13:12:24.524542 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:12:24.534742 [debug] [Thread-1  ]: finished collecting timing info
13:12:24.538280 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
13:12:24.542628 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0f4868f-a4a5-4e34-8377-edaf2956d2a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007570e20>]}
13:12:24.549469 [info ] [Thread-1  ]: 5 of 5 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.16s]
13:12:24.554332 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
13:12:24.561341 [debug] [MainThread]: Acquiring new materialize connection "master"
13:12:24.563772 [debug] [MainThread]: Using materialize connection "master"
13:12:24.566127 [debug] [MainThread]: On master: BEGIN
13:12:24.568137 [debug] [MainThread]: Opening a new connection, currently in state closed
13:12:24.575138 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:12:24.578230 [debug] [MainThread]: Using materialize connection "master"
13:12:24.580325 [debug] [MainThread]: On master: COMMIT
13:12:24.583753 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:12:24.586236 [debug] [MainThread]: On master: Close
13:12:24.590118 [info ] [MainThread]: 
13:12:24.593236 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.01s.
13:12:24.596040 [debug] [MainThread]: Connection 'master' was properly closed.
13:12:24.598289 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
13:12:24.633999 [info ] [MainThread]: 
13:12:24.637039 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
13:12:24.640413 [info ] [MainThread]: 
13:12:24.643481 [error] [MainThread]: [33mDatabase Error in model worldcities (models/twitter_trending/sources/twitter/worldcities.sql)[0m
13:12:24.646160 [error] [MainThread]:   No such file or directory (os error 2)
13:12:24.648535 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/sources/twitter/worldcities.sql
13:12:24.652161 [info ] [MainThread]: 
13:12:24.655451 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
13:12:24.659302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007449790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007382a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40075709a0>]}


============================== 2022-02-23 13:13:51.988118 | 0649f13e-d53f-439f-aa87-2d356bfbde30 ==============================
13:13:51.988118 [info ] [MainThread]: Running with dbt=1.0.1
13:13:51.996447 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:13:52.001051 [debug] [MainThread]: Tracking: tracking
13:13:52.040055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073de790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40041624c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4004162b50>]}
13:13:52.532607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:13:52.536590 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/sources/twitter/worldcities.sql
13:13:52.627487 [debug] [MainThread]: 1603: static parser failed on twitter_trending/sources/twitter/worldcities.sql
13:13:52.733662 [debug] [MainThread]: 1602: parser fallback to jinja rendering on twitter_trending/sources/twitter/worldcities.sql
13:13:52.825534 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter

13:13:52.862346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0649f13e-d53f-439f-aa87-2d356bfbde30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40075220d0>]}
13:13:52.910493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0649f13e-d53f-439f-aa87-2d356bfbde30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400742ab80>]}
13:13:52.913505 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
13:13:52.922381 [info ] [MainThread]: 
13:13:52.926066 [debug] [MainThread]: Acquiring new materialize connection "master"
13:13:52.936500 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
13:13:53.005555 [debug] [ThreadPool]: Using materialize connection "list_materialize"
13:13:53.008127 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
13:13:53.010833 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:13:53.045470 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
13:13:53.055919 [debug] [ThreadPool]: On list_materialize: Close
13:13:53.066009 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
13:13:53.089135 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
13:13:53.092013 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
13:13:53.094451 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:13:53.101627 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
13:13:53.111619 [debug] [ThreadPool]: On list_materialize_public: Close
13:13:53.118596 [debug] [MainThread]: Using materialize connection "master"
13:13:53.121049 [debug] [MainThread]: On master: BEGIN
13:13:53.122916 [debug] [MainThread]: Opening a new connection, currently in state init
13:13:53.128785 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:13:53.131522 [debug] [MainThread]: Using materialize connection "master"
13:13:53.133458 [debug] [MainThread]: On master: COMMIT
13:13:53.136462 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:13:53.138562 [debug] [MainThread]: On master: Close
13:13:53.141653 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:13:53.144745 [info ] [MainThread]: 
13:13:53.250235 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
13:13:53.254054 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
13:13:53.258289 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
13:13:53.260501 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
13:13:53.262535 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
13:13:53.282797 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
13:13:53.290225 [debug] [Thread-1  ]: finished collecting timing info
13:13:53.292537 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
13:13:53.348892 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
13:13:53.352502 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
13:13:53.355505 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:13:53.363135 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
13:13:53.413223 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
13:13:53.421790 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
13:13:53.423860 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
13:13:53.435989 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
13:13:53.485213 [debug] [Thread-1  ]: finished collecting timing info
13:13:53.487726 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
13:13:53.491396 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0649f13e-d53f-439f-aa87-2d356bfbde30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400fed0e50>]}
13:13:53.496506 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.23s]
13:13:53.499926 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
13:13:53.502614 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
13:13:53.505762 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
13:13:53.509265 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
13:13:53.511510 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
13:13:53.514041 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
13:13:53.536238 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
13:13:53.543808 [debug] [Thread-1  ]: finished collecting timing info
13:13:53.545839 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
13:13:53.556440 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
13:13:53.558630 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
13:13:53.560745 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:13:53.566649 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
13:13:53.575029 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
13:13:53.581692 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
13:13:53.583914 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
13:13:53.594599 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
13:13:53.604738 [debug] [Thread-1  ]: finished collecting timing info
13:13:53.606872 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
13:13:53.610234 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0649f13e-d53f-439f-aa87-2d356bfbde30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007665700>]}
13:13:53.614529 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.10s]
13:13:53.617219 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
13:13:53.619834 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
13:13:53.622691 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
13:13:53.626569 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
13:13:53.628674 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
13:13:53.630646 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
13:13:53.648924 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
13:13:53.656674 [debug] [Thread-1  ]: finished collecting timing info
13:13:53.658943 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
13:13:53.727392 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
13:13:53.730414 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
13:13:53.732713 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:13:53.739197 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:13:53.764761 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
13:13:53.773129 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
13:13:53.775446 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT

       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'trends'->0->'trends')::jsonb as trends
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        jsonb_array_elements(trends)->>'name' as trend_name,
        jsonb_array_elements(trends)->>'tweet_volume' as trend_volume
    FROM renamed
)

SELECT * FROM final
  );
13:13:53.784824 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:13:53.794330 [debug] [Thread-1  ]: finished collecting timing info
13:13:53.796701 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
13:13:53.800163 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0649f13e-d53f-439f-aa87-2d356bfbde30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40074a5f40>]}
13:13:53.803961 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.17s]
13:13:53.806811 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
13:13:53.809651 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
13:13:53.812472 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
13:13:53.816318 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
13:13:53.819631 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
13:13:53.821623 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
13:13:53.838036 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
13:13:53.844303 [debug] [Thread-1  ]: finished collecting timing info
13:13:53.846529 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
13:13:53.862720 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
13:13:53.865299 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
13:13:53.867421 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:13:53.873785 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:13:53.883826 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
13:13:53.889576 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
13:13:53.891813 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
13:13:53.899558 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
13:13:53.909264 [debug] [Thread-1  ]: finished collecting timing info
13:13:53.911562 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
13:13:53.915050 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0649f13e-d53f-439f-aa87-2d356bfbde30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400fef65e0>]}
13:13:53.918780 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.10s]
13:13:53.922116 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
13:13:53.924635 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
13:13:53.927218 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
13:13:53.930784 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
13:13:53.933182 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
13:13:53.935854 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
13:13:53.952903 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
13:13:53.960676 [debug] [Thread-1  ]: finished collecting timing info
13:13:53.962969 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
13:13:54.012316 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
13:13:54.015161 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
13:13:54.017806 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:13:54.024357 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:13:54.040769 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
13:13:54.049888 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
13:13:54.052028 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


SELECT location_name, location_country, trend_name, trend_volume
FROM "materialize"."public"."stg_twitter_trending"
  );
13:13:54.064155 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:13:54.075386 [debug] [Thread-1  ]: finished collecting timing info
13:13:54.077880 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
13:13:54.081478 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0649f13e-d53f-439f-aa87-2d356bfbde30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400765bb20>]}
13:13:54.085267 [info ] [Thread-1  ]: 5 of 5 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.15s]
13:13:54.088132 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
13:13:54.095959 [debug] [MainThread]: Acquiring new materialize connection "master"
13:13:54.098693 [debug] [MainThread]: Using materialize connection "master"
13:13:54.100777 [debug] [MainThread]: On master: BEGIN
13:13:54.102784 [debug] [MainThread]: Opening a new connection, currently in state closed
13:13:54.109154 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:13:54.111916 [debug] [MainThread]: Using materialize connection "master"
13:13:54.114146 [debug] [MainThread]: On master: COMMIT
13:13:54.117064 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:13:54.119148 [debug] [MainThread]: On master: Close
13:13:54.122607 [info ] [MainThread]: 
13:13:54.125753 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.20s.
13:13:54.128321 [debug] [MainThread]: Connection 'master' was properly closed.
13:13:54.130849 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
13:13:54.167590 [info ] [MainThread]: 
13:13:54.205096 [info ] [MainThread]: [32mCompleted successfully[0m
13:13:54.217729 [info ] [MainThread]: 
13:13:54.221032 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
13:13:54.225185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400feb5220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400feee9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400fed18b0>]}


============================== 2022-02-23 13:19:26.841605 | 6d9f7720-ec00-4d6d-88e9-787d3950d4a0 ==============================
13:19:26.841605 [info ] [MainThread]: Running with dbt=1.0.1
13:19:26.848338 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:19:26.850853 [debug] [MainThread]: Tracking: tracking
13:19:26.878718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acdc0>]}
13:19:27.059398 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
13:19:27.063211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6d9f7720-ec00-4d6d-88e9-787d3950d4a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072a35b0>]}
13:19:27.232123 [debug] [MainThread]: Parsing macros/adapters.sql
13:19:27.315352 [debug] [MainThread]: Parsing macros/catalog.sql
13:19:27.335044 [debug] [MainThread]: Parsing macros/mz_generate_name.sql
13:19:27.341974 [debug] [MainThread]: Parsing macros/relations.sql
13:19:27.376301 [debug] [MainThread]: Parsing macros/materializations/source.sql
13:19:27.398201 [debug] [MainThread]: Parsing macros/materializations/view.sql
13:19:27.417499 [debug] [MainThread]: Parsing macros/materializations/seed.sql
13:19:27.479477 [debug] [MainThread]: Parsing macros/materializations/index.sql
13:19:27.501506 [debug] [MainThread]: Parsing macros/materializations/table.sql
13:19:27.521043 [debug] [MainThread]: Parsing macros/materializations/materialized_view.sql
13:19:27.540458 [debug] [MainThread]: Parsing macros/materializations/sink.sql
13:19:27.561125 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
13:19:27.567295 [debug] [MainThread]: Parsing macros/materializations/helpers.sql
13:19:27.580715 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
13:19:27.593873 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
13:19:27.613871 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
13:19:27.626731 [debug] [MainThread]: Parsing macros/adapters/relation.sql
13:19:27.709758 [debug] [MainThread]: Parsing macros/adapters/schema.sql
13:19:27.728552 [debug] [MainThread]: Parsing macros/adapters/columns.sql
13:19:27.805752 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
13:19:27.841293 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
13:19:27.895857 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
13:19:27.920266 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
13:19:27.942220 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
13:19:27.973894 [debug] [MainThread]: Parsing macros/materializations/configs.sql
13:19:27.993485 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
13:19:28.046228 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
13:19:28.171338 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
13:19:28.310704 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
13:19:28.401764 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
13:19:28.416441 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
13:19:28.505113 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
13:19:28.564152 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
13:19:28.587961 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
13:19:28.676680 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
13:19:28.718455 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
13:19:28.735267 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
13:19:28.860017 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
13:19:28.940582 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
13:19:28.996291 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
13:19:29.015347 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
13:19:29.038483 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
13:19:29.050117 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
13:19:29.087238 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
13:19:29.101659 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
13:19:29.116798 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
13:19:29.123532 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
13:19:29.128893 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
13:19:29.136573 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
13:19:29.148027 [debug] [MainThread]: Parsing macros/etc/statement.sql
13:19:29.184765 [debug] [MainThread]: Parsing macros/etc/datetime.sql
13:19:29.250484 [debug] [MainThread]: Parsing tests/generic/builtin.sql
13:19:29.275090 [debug] [MainThread]: Parsing macros/dbt_utils/date_trunc.sql
13:19:29.280703 [debug] [MainThread]: Parsing macros/dbt_utils/dateadd.sql
13:19:29.288015 [debug] [MainThread]: Parsing macros/dbt_utils/datediff.sql
13:19:29.294371 [debug] [MainThread]: Parsing macros/dbt_utils/get_tables_by_pattern_sql.sql
13:19:29.302147 [debug] [MainThread]: Parsing macros/dbt_utils/last_day.sql
13:19:30.752171 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
13:19:30.852600 [debug] [MainThread]: 1603: static parser failed on twitter_trending/sources/twitter/rp_twitter_trending.sql
13:19:30.889593 [debug] [MainThread]: 1602: parser fallback to jinja rendering on twitter_trending/sources/twitter/rp_twitter_trending.sql
13:19:30.898561 [debug] [MainThread]: 1603: static parser failed on twitter_trending/sources/twitter/worldcities.sql
13:19:30.925605 [debug] [MainThread]: 1602: parser fallback to jinja rendering on twitter_trending/sources/twitter/worldcities.sql
13:19:30.935285 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
13:19:30.951103 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_worldcities.sql
13:19:31.232525 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

13:19:31.274033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d9f7720-ec00-4d6d-88e9-787d3950d4a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c54040>]}
13:19:31.324442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d9f7720-ec00-4d6d-88e9-787d3950d4a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c54a00>]}
13:19:31.327660 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
13:19:31.336637 [info ] [MainThread]: 
13:19:31.341200 [debug] [MainThread]: Acquiring new materialize connection "master"
13:19:31.352160 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
13:19:31.420178 [debug] [ThreadPool]: Using materialize connection "list_materialize"
13:19:31.423062 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
13:19:31.425408 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:19:31.455851 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
13:19:31.467643 [debug] [ThreadPool]: On list_materialize: Close
13:19:31.477516 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
13:19:31.502028 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
13:19:31.504480 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
13:19:31.506636 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:19:31.513889 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
13:19:31.524268 [debug] [ThreadPool]: On list_materialize_public: Close
13:19:31.530844 [debug] [MainThread]: Using materialize connection "master"
13:19:31.533230 [debug] [MainThread]: On master: BEGIN
13:19:31.535222 [debug] [MainThread]: Opening a new connection, currently in state init
13:19:31.541283 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:19:31.543594 [debug] [MainThread]: Using materialize connection "master"
13:19:31.545592 [debug] [MainThread]: On master: COMMIT
13:19:31.548512 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:19:31.551095 [debug] [MainThread]: On master: Close
13:19:31.554318 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:19:31.557580 [info ] [MainThread]: 
13:19:31.574797 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
13:19:31.581046 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
13:19:31.586089 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
13:19:31.588688 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
13:19:31.596250 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
13:19:31.616990 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
13:19:31.624920 [debug] [Thread-1  ]: finished collecting timing info
13:19:31.627174 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
13:19:31.684375 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
13:19:31.687196 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
13:19:31.689447 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:19:31.699637 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
13:19:31.738997 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
13:19:31.745085 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
13:19:31.747085 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
13:19:31.757489 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
13:19:31.807412 [debug] [Thread-1  ]: finished collecting timing info
13:19:31.809896 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
13:19:31.814246 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d9f7720-ec00-4d6d-88e9-787d3950d4a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007381220>]}
13:19:31.818460 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.23s]
13:19:31.823407 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
13:19:31.843047 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
13:19:31.846653 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
13:19:31.851702 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
13:19:31.854839 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
13:19:31.859092 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
13:19:31.880837 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
13:19:31.887317 [debug] [Thread-1  ]: finished collecting timing info
13:19:31.890306 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
13:19:31.901039 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
13:19:31.903373 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
13:19:31.905432 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:19:31.918643 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
13:19:31.927397 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
13:19:31.932816 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
13:19:31.934868 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
13:19:31.945014 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
13:19:31.954189 [debug] [Thread-1  ]: finished collecting timing info
13:19:31.956402 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
13:19:31.959763 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d9f7720-ec00-4d6d-88e9-787d3950d4a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027ec7b20>]}
13:19:31.963314 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.11s]
13:19:31.966529 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
13:19:31.969347 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
13:19:31.972242 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
13:19:31.976005 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
13:19:31.978014 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
13:19:31.980260 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
13:19:31.999136 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
13:19:32.006334 [debug] [Thread-1  ]: finished collecting timing info
13:19:32.008633 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
13:19:32.079640 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
13:19:32.082527 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
13:19:32.084790 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:19:32.090904 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:19:32.118174 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
13:19:32.125164 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
13:19:32.127360 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'trends'->0->'trends')::jsonb as trends
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        jsonb_array_elements(trends)->>'name' as trend_name,
        jsonb_array_elements(trends)->>'tweet_volume' as trend_volume
    FROM renamed
)

SELECT * FROM final
  );
13:19:32.137205 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:19:32.146921 [debug] [Thread-1  ]: finished collecting timing info
13:19:32.149479 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
13:19:32.153283 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d9f7720-ec00-4d6d-88e9-787d3950d4a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f0a910>]}
13:19:32.156560 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.18s]
13:19:32.159479 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
13:19:32.161668 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
13:19:32.164153 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
13:19:32.167659 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
13:19:32.169758 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
13:19:32.172104 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
13:19:32.191579 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
13:19:32.199455 [debug] [Thread-1  ]: finished collecting timing info
13:19:32.202175 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
13:19:32.219295 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
13:19:32.221834 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
13:19:32.224000 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:19:32.229839 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:19:32.239361 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
13:19:32.245208 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
13:19:32.247526 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
13:19:32.255510 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:19:32.266059 [debug] [Thread-1  ]: finished collecting timing info
13:19:32.269801 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
13:19:32.273336 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d9f7720-ec00-4d6d-88e9-787d3950d4a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027ec9490>]}
13:19:32.276586 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.11s]
13:19:32.279486 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
13:19:32.285971 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
13:19:32.289430 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
13:19:32.294998 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
13:19:32.297638 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
13:19:32.301183 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
13:19:32.321045 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
13:19:32.328338 [debug] [Thread-1  ]: finished collecting timing info
13:19:32.331206 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
13:19:32.386528 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
13:19:32.389568 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
13:19:32.391764 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:19:32.398210 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:19:32.415074 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
13:19:32.421071 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
13:19:32.423154 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


SELECT location_name, location_country, trend_name, trend_volume
FROM "materialize"."public"."stg_twitter_trending" tt
JOIN "materialize"."public"."stg_worldcities" wc ON tt.location_name = wc.city
WHERE trend_volume > 0
  );
13:19:32.427022 [debug] [Thread-1  ]: Postgres adapter: Postgres error: WHERE clause error: no overload for text > integer: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts

13:19:32.429899 [debug] [Thread-1  ]: finished collecting timing info
13:19:32.432046 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
13:19:32.435291 [debug] [Thread-1  ]: Database Error in model fct_twitter_trending (models/twitter_trending/marts/twitter/fct_twitter_trending.sql)
  WHERE clause error: no overload for text > integer: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/marts/twitter/fct_twitter_trending.sql
13:19:32.438326 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d9f7720-ec00-4d6d-88e9-787d3950d4a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f0c310>]}
13:19:32.441546 [error] [Thread-1  ]: 5 of 5 ERROR creating materializedview model public.fct_twitter_trending........ [[31mERROR[0m in 0.14s]
13:19:32.444716 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
13:19:32.451582 [debug] [MainThread]: Acquiring new materialize connection "master"
13:19:32.454337 [debug] [MainThread]: Using materialize connection "master"
13:19:32.456325 [debug] [MainThread]: On master: BEGIN
13:19:32.458670 [debug] [MainThread]: Opening a new connection, currently in state closed
13:19:32.464088 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:19:32.466494 [debug] [MainThread]: Using materialize connection "master"
13:19:32.468374 [debug] [MainThread]: On master: COMMIT
13:19:32.470906 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:19:32.473070 [debug] [MainThread]: On master: Close
13:19:32.476381 [info ] [MainThread]: 
13:19:32.479455 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.14s.
13:19:32.483000 [debug] [MainThread]: Connection 'master' was properly closed.
13:19:32.486384 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
13:19:32.526394 [info ] [MainThread]: 
13:19:32.529274 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
13:19:32.532115 [info ] [MainThread]: 
13:19:32.536034 [error] [MainThread]: [33mDatabase Error in model fct_twitter_trending (models/twitter_trending/marts/twitter/fct_twitter_trending.sql)[0m
13:19:32.539354 [error] [MainThread]:   WHERE clause error: no overload for text > integer: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
13:19:32.542587 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/marts/twitter/fct_twitter_trending.sql
13:19:32.545722 [info ] [MainThread]: 
13:19:32.549334 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
13:19:32.553572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c8fbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c8f6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f0c8b0>]}


============================== 2022-02-23 13:21:24.917825 | ba3e1c25-2a54-47df-95ca-282bdf652f8f ==============================
13:21:24.917825 [info ] [MainThread]: Running with dbt=1.0.1
13:21:24.924753 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:21:24.927448 [debug] [MainThread]: Tracking: tracking
13:21:24.956664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728cd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728cdf0>]}
13:21:25.306437 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
13:21:25.311149 [debug] [MainThread]: Partial parsing: update schema file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter.yml
13:21:25.314077 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
13:21:25.420559 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
13:21:25.603893 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

13:21:25.643323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba3e1c25-2a54-47df-95ca-282bdf652f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c1b0d0>]}
13:21:25.695636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba3e1c25-2a54-47df-95ca-282bdf652f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400730fb20>]}
13:21:25.698775 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
13:21:25.708096 [info ] [MainThread]: 
13:21:25.714066 [debug] [MainThread]: Acquiring new materialize connection "master"
13:21:25.723649 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
13:21:25.793782 [debug] [ThreadPool]: Using materialize connection "list_materialize"
13:21:25.796642 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
13:21:25.798731 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:21:25.828723 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
13:21:25.840848 [debug] [ThreadPool]: On list_materialize: Close
13:21:25.850927 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
13:21:25.875844 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
13:21:25.878423 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
13:21:25.880630 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:21:25.887556 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
13:21:25.897526 [debug] [ThreadPool]: On list_materialize_public: Close
13:21:25.904223 [debug] [MainThread]: Using materialize connection "master"
13:21:25.907006 [debug] [MainThread]: On master: BEGIN
13:21:25.909211 [debug] [MainThread]: Opening a new connection, currently in state init
13:21:25.915271 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:21:25.917870 [debug] [MainThread]: Using materialize connection "master"
13:21:25.920252 [debug] [MainThread]: On master: COMMIT
13:21:25.923513 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:21:25.925774 [debug] [MainThread]: On master: Close
13:21:25.928940 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:21:25.931925 [info ] [MainThread]: 
13:21:25.949004 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
13:21:25.954116 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
13:21:25.958628 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
13:21:25.961855 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
13:21:25.964490 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
13:21:25.995026 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
13:21:26.002116 [debug] [Thread-1  ]: finished collecting timing info
13:21:26.004510 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
13:21:26.061565 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
13:21:26.064021 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
13:21:26.066412 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:21:26.076623 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
13:21:26.115177 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
13:21:26.121487 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
13:21:26.123917 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
13:21:26.135504 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
13:21:26.184950 [debug] [Thread-1  ]: finished collecting timing info
13:21:26.187392 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
13:21:26.191065 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba3e1c25-2a54-47df-95ca-282bdf652f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400738f8b0>]}
13:21:26.194948 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.23s]
13:21:26.198324 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
13:21:26.201116 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
13:21:26.204176 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
13:21:26.208269 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
13:21:26.211171 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
13:21:26.213909 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
13:21:26.237103 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
13:21:26.245382 [debug] [Thread-1  ]: finished collecting timing info
13:21:26.248491 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
13:21:26.260921 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
13:21:26.264329 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
13:21:26.270468 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:21:26.279645 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
13:21:26.289666 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
13:21:26.295150 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
13:21:26.297137 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
13:21:26.306005 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
13:21:26.315505 [debug] [Thread-1  ]: finished collecting timing info
13:21:26.317848 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
13:21:26.321283 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba3e1c25-2a54-47df-95ca-282bdf652f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c48a90>]}
13:21:26.324605 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.11s]
13:21:26.327696 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
13:21:26.330153 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
13:21:26.333110 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
13:21:26.336963 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
13:21:26.339353 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
13:21:26.341936 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
13:21:26.360670 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
13:21:26.383827 [debug] [Thread-1  ]: finished collecting timing info
13:21:26.386000 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
13:21:26.454644 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
13:21:26.458609 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
13:21:26.460641 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:21:26.466504 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:21:26.492001 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
13:21:26.498882 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
13:21:26.500992 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'trends'->0->'trends')::jsonb as trends
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        jsonb_array_elements(trends)->>'name' as trend_name,
        jsonb_array_elements(trends)->>'tweet_volume' as trend_volume
    FROM renamed
)

SELECT * FROM final
  );
13:21:26.511084 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:21:26.520738 [debug] [Thread-1  ]: finished collecting timing info
13:21:26.523119 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
13:21:26.526775 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba3e1c25-2a54-47df-95ca-282bdf652f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d87cd0>]}
13:21:26.529909 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.19s]
13:21:26.532780 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
13:21:26.535231 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
13:21:26.538404 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
13:21:26.541903 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
13:21:26.544566 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
13:21:26.547319 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
13:21:26.565752 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
13:21:26.572955 [debug] [Thread-1  ]: finished collecting timing info
13:21:26.575511 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
13:21:26.591997 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
13:21:26.594827 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
13:21:26.596830 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:21:26.602912 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:21:26.612749 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
13:21:26.618989 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
13:21:26.621301 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
13:21:26.629666 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:21:26.639984 [debug] [Thread-1  ]: finished collecting timing info
13:21:26.642453 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
13:21:26.645831 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba3e1c25-2a54-47df-95ca-282bdf652f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d72e50>]}
13:21:26.649064 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.10s]
13:21:26.652111 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
13:21:26.657174 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
13:21:26.660062 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
13:21:26.663828 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
13:21:26.665885 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
13:21:26.668178 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
13:21:26.688619 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
13:21:26.695484 [debug] [Thread-1  ]: finished collecting timing info
13:21:26.697863 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
13:21:26.747477 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
13:21:26.750434 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
13:21:26.753662 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:21:26.759511 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:21:26.776123 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
13:21:26.783074 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
13:21:26.785631 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


SELECT tt.location_name, tt.location_country, tt.trend_name, tt.trend_volume,
       wc.lat as location_latitude, wc.lng as location_longiture
FROM "materialize"."public"."stg_twitter_trending" tt
JOIN "materialize"."public"."stg_worldcities" wc ON tt.location_name = wc.city
WHERE trend_volume > 0
  );
13:21:26.789625 [debug] [Thread-1  ]: Postgres adapter: Postgres error: WHERE clause error: no overload for text > integer: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts

13:21:26.792101 [debug] [Thread-1  ]: finished collecting timing info
13:21:26.794186 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
13:21:26.797326 [debug] [Thread-1  ]: Database Error in model fct_twitter_trending (models/twitter_trending/marts/twitter/fct_twitter_trending.sql)
  WHERE clause error: no overload for text > integer: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/marts/twitter/fct_twitter_trending.sql
13:21:26.801068 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba3e1c25-2a54-47df-95ca-282bdf652f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f57a60>]}
13:21:26.804336 [error] [Thread-1  ]: 5 of 5 ERROR creating materializedview model public.fct_twitter_trending........ [[31mERROR[0m in 0.14s]
13:21:26.807433 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
13:21:26.813238 [debug] [MainThread]: Acquiring new materialize connection "master"
13:21:26.816237 [debug] [MainThread]: Using materialize connection "master"
13:21:26.818437 [debug] [MainThread]: On master: BEGIN
13:21:26.820668 [debug] [MainThread]: Opening a new connection, currently in state closed
13:21:26.826464 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:21:26.830560 [debug] [MainThread]: Using materialize connection "master"
13:21:26.833042 [debug] [MainThread]: On master: COMMIT
13:21:26.835930 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:21:26.838395 [debug] [MainThread]: On master: Close
13:21:26.842059 [info ] [MainThread]: 
13:21:26.845681 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.13s.
13:21:26.848931 [debug] [MainThread]: Connection 'master' was properly closed.
13:21:26.851319 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
13:21:26.887646 [info ] [MainThread]: 
13:21:26.890310 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
13:21:26.892928 [info ] [MainThread]: 
13:21:26.895171 [error] [MainThread]: [33mDatabase Error in model fct_twitter_trending (models/twitter_trending/marts/twitter/fct_twitter_trending.sql)[0m
13:21:26.898075 [error] [MainThread]:   WHERE clause error: no overload for text > integer: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
13:21:26.900759 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/marts/twitter/fct_twitter_trending.sql
13:21:26.903209 [info ] [MainThread]: 
13:21:26.905788 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
13:21:26.908873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d60f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ef2640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f57790>]}


============================== 2022-02-23 13:22:30.181323 | 1adb0666-3442-4a3e-950d-c814c4524c63 ==============================
13:22:30.181323 [info ] [MainThread]: Running with dbt=1.0.1
13:22:30.187881 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:22:30.190642 [debug] [MainThread]: Tracking: tracking
13:22:30.219938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aadc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aaeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aae50>]}
13:22:30.570693 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:22:30.575340 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
13:22:30.678879 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
13:22:30.857709 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

13:22:30.896674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1adb0666-3442-4a3e-950d-c814c4524c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c010d0>]}
13:22:30.946095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1adb0666-3442-4a3e-950d-c814c4524c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400730fdc0>]}
13:22:30.949616 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
13:22:30.958796 [info ] [MainThread]: 
13:22:30.963026 [debug] [MainThread]: Acquiring new materialize connection "master"
13:22:30.973858 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
13:22:31.042022 [debug] [ThreadPool]: Using materialize connection "list_materialize"
13:22:31.045147 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
13:22:31.047918 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:22:31.077353 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
13:22:31.087557 [debug] [ThreadPool]: On list_materialize: Close
13:22:31.096917 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
13:22:31.120122 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
13:22:31.123287 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
13:22:31.125445 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:22:31.132439 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
13:22:31.142084 [debug] [ThreadPool]: On list_materialize_public: Close
13:22:31.149361 [debug] [MainThread]: Using materialize connection "master"
13:22:31.151808 [debug] [MainThread]: On master: BEGIN
13:22:31.153894 [debug] [MainThread]: Opening a new connection, currently in state init
13:22:31.159560 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:22:31.162239 [debug] [MainThread]: Using materialize connection "master"
13:22:31.164411 [debug] [MainThread]: On master: COMMIT
13:22:31.167419 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:22:31.170038 [debug] [MainThread]: On master: Close
13:22:31.173220 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:22:31.176074 [info ] [MainThread]: 
13:22:31.192344 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
13:22:31.196436 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
13:22:31.201475 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
13:22:31.205133 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
13:22:31.207689 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
13:22:31.238977 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
13:22:31.246302 [debug] [Thread-1  ]: finished collecting timing info
13:22:31.249062 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
13:22:31.308291 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
13:22:31.311310 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
13:22:31.313820 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:22:31.323555 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
13:22:31.363999 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
13:22:31.371599 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
13:22:31.375005 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
13:22:31.389105 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
13:22:31.443568 [debug] [Thread-1  ]: finished collecting timing info
13:22:31.446583 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
13:22:31.450213 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1adb0666-3442-4a3e-950d-c814c4524c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ec5f10>]}
13:22:31.453455 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.25s]
13:22:31.456609 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
13:22:31.459044 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
13:22:31.461765 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
13:22:31.465613 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
13:22:31.468097 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
13:22:31.470306 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
13:22:31.493350 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
13:22:31.500639 [debug] [Thread-1  ]: finished collecting timing info
13:22:31.504251 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
13:22:31.514251 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
13:22:31.516506 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
13:22:31.518686 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:22:31.527953 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
13:22:31.535909 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
13:22:31.541602 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
13:22:31.543874 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
13:22:31.553509 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
13:22:31.563351 [debug] [Thread-1  ]: finished collecting timing info
13:22:31.565867 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
13:22:31.569671 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1adb0666-3442-4a3e-950d-c814c4524c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c41580>]}
13:22:31.576023 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.10s]
13:22:31.579981 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
13:22:31.583200 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
13:22:31.586206 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
13:22:31.590468 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
13:22:31.593596 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
13:22:31.596112 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
13:22:31.615985 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
13:22:31.623551 [debug] [Thread-1  ]: finished collecting timing info
13:22:31.625872 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
13:22:31.695702 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
13:22:31.698612 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
13:22:31.701008 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:22:31.707068 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:22:31.731573 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
13:22:31.737839 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
13:22:31.740045 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'trends'->0->'trends')::jsonb as trends
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        jsonb_array_elements(trends)->>'name'::string as trend_name,
        jsonb_array_elements(trends)->>'tweet_volume'::integer as trend_volume
    FROM renamed
)

SELECT * FROM final
  );
13:22:31.750043 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:22:31.760145 [debug] [Thread-1  ]: finished collecting timing info
13:22:31.762460 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
13:22:31.766023 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1adb0666-3442-4a3e-950d-c814c4524c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d81460>]}
13:22:31.769498 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.18s]
13:22:31.772609 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
13:22:31.775466 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
13:22:31.777904 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
13:22:31.782347 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
13:22:31.784989 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
13:22:31.787382 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
13:22:31.806817 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
13:22:31.813347 [debug] [Thread-1  ]: finished collecting timing info
13:22:31.816094 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
13:22:31.833554 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
13:22:31.835943 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
13:22:31.838243 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:22:31.844412 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:22:31.854452 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
13:22:31.860114 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
13:22:31.862569 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
13:22:31.869910 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:22:31.879487 [debug] [Thread-1  ]: finished collecting timing info
13:22:31.882153 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
13:22:31.886022 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1adb0666-3442-4a3e-950d-c814c4524c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d72b80>]}
13:22:31.890708 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.10s]
13:22:31.893636 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
13:22:31.899467 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
13:22:31.902952 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
13:22:31.907041 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
13:22:31.909649 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
13:22:31.911867 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
13:22:31.932573 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
13:22:31.938984 [debug] [Thread-1  ]: finished collecting timing info
13:22:31.941657 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
13:22:31.991862 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
13:22:31.994886 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
13:22:31.997617 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:22:32.003958 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:22:32.020855 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
13:22:32.026976 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
13:22:32.029107 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


SELECT tt.location_name, tt.location_country, tt.trend_name, tt.trend_volume,
       wc.lat as location_latitude, wc.lng as location_longiture
FROM "materialize"."public"."stg_twitter_trending" tt
JOIN "materialize"."public"."stg_worldcities" wc ON tt.location_name = wc.city
WHERE trend_volume > 0
  );
13:22:32.034090 [debug] [Thread-1  ]: Postgres adapter: Postgres error: WHERE clause error: no overload for text > integer: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts

13:22:32.037038 [debug] [Thread-1  ]: finished collecting timing info
13:22:32.038971 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
13:22:32.041669 [debug] [Thread-1  ]: Database Error in model fct_twitter_trending (models/twitter_trending/marts/twitter/fct_twitter_trending.sql)
  WHERE clause error: no overload for text > integer: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/marts/twitter/fct_twitter_trending.sql
13:22:32.044539 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1adb0666-3442-4a3e-950d-c814c4524c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f55a60>]}
13:22:32.047641 [error] [Thread-1  ]: 5 of 5 ERROR creating materializedview model public.fct_twitter_trending........ [[31mERROR[0m in 0.14s]
13:22:32.051257 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
13:22:32.056856 [debug] [MainThread]: Acquiring new materialize connection "master"
13:22:32.059416 [debug] [MainThread]: Using materialize connection "master"
13:22:32.061568 [debug] [MainThread]: On master: BEGIN
13:22:32.063560 [debug] [MainThread]: Opening a new connection, currently in state closed
13:22:32.069628 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:22:32.072276 [debug] [MainThread]: Using materialize connection "master"
13:22:32.074684 [debug] [MainThread]: On master: COMMIT
13:22:32.078128 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:22:32.080608 [debug] [MainThread]: On master: Close
13:22:32.084490 [info ] [MainThread]: 
13:22:32.087671 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.12s.
13:22:32.090807 [debug] [MainThread]: Connection 'master' was properly closed.
13:22:32.093018 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
13:22:32.129486 [info ] [MainThread]: 
13:22:32.132359 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
13:22:32.135046 [info ] [MainThread]: 
13:22:32.137955 [error] [MainThread]: [33mDatabase Error in model fct_twitter_trending (models/twitter_trending/marts/twitter/fct_twitter_trending.sql)[0m
13:22:32.142436 [error] [MainThread]:   WHERE clause error: no overload for text > integer: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
13:22:32.145915 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/marts/twitter/fct_twitter_trending.sql
13:22:32.148569 [info ] [MainThread]: 
13:22:32.151871 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
13:22:32.156919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d72430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d72ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f557c0>]}


============================== 2022-02-23 13:23:10.386260 | 1624f1ad-ed5f-4ca4-b058-ee725d156913 ==============================
13:23:10.386260 [info ] [MainThread]: Running with dbt=1.0.1
13:23:10.394521 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:23:10.397170 [debug] [MainThread]: Tracking: tracking
13:23:10.425235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abdc0>]}
13:23:10.752670 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:23:10.757012 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
13:23:10.864263 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
13:23:11.048397 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

13:23:11.088540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1624f1ad-ed5f-4ca4-b058-ee725d156913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027bff0d0>]}
13:23:11.138559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1624f1ad-ed5f-4ca4-b058-ee725d156913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400730fbe0>]}
13:23:11.141562 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
13:23:11.150481 [info ] [MainThread]: 
13:23:11.154382 [debug] [MainThread]: Acquiring new materialize connection "master"
13:23:11.164074 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
13:23:11.244465 [debug] [ThreadPool]: Using materialize connection "list_materialize"
13:23:11.247232 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
13:23:11.249469 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:23:11.276619 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
13:23:11.287069 [debug] [ThreadPool]: On list_materialize: Close
13:23:11.297191 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
13:23:11.319923 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
13:23:11.322600 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
13:23:11.325029 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:23:11.332526 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
13:23:11.342224 [debug] [ThreadPool]: On list_materialize_public: Close
13:23:11.349390 [debug] [MainThread]: Using materialize connection "master"
13:23:11.351947 [debug] [MainThread]: On master: BEGIN
13:23:11.353759 [debug] [MainThread]: Opening a new connection, currently in state init
13:23:11.359761 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:23:11.362270 [debug] [MainThread]: Using materialize connection "master"
13:23:11.364777 [debug] [MainThread]: On master: COMMIT
13:23:11.367647 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:23:11.369811 [debug] [MainThread]: On master: Close
13:23:11.373296 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:23:11.376038 [info ] [MainThread]: 
13:23:11.393012 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
13:23:11.397535 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
13:23:11.401807 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
13:23:11.404764 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
13:23:11.407078 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
13:23:11.438746 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
13:23:11.446496 [debug] [Thread-1  ]: finished collecting timing info
13:23:11.448976 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
13:23:11.506756 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
13:23:11.509479 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
13:23:11.511763 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:23:11.522218 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
13:23:11.560728 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
13:23:11.567387 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
13:23:11.569671 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
13:23:11.580389 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
13:23:11.629556 [debug] [Thread-1  ]: finished collecting timing info
13:23:11.632473 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
13:23:11.636108 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1624f1ad-ed5f-4ca4-b058-ee725d156913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400738dd90>]}
13:23:11.639157 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.23s]
13:23:11.642694 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
13:23:11.645323 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
13:23:11.648245 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
13:23:11.651736 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
13:23:11.654053 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
13:23:11.656365 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
13:23:11.680031 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
13:23:11.687350 [debug] [Thread-1  ]: finished collecting timing info
13:23:11.691044 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
13:23:11.701895 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
13:23:11.704260 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
13:23:11.707338 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:23:11.715794 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
13:23:11.724092 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
13:23:11.729906 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
13:23:11.731971 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
13:23:11.740710 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
13:23:11.750426 [debug] [Thread-1  ]: finished collecting timing info
13:23:11.752591 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
13:23:11.756133 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1624f1ad-ed5f-4ca4-b058-ee725d156913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c10a60>]}
13:23:11.759765 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.10s]
13:23:11.762992 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
13:23:11.765552 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
13:23:11.768380 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
13:23:11.771967 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
13:23:11.774051 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
13:23:11.776168 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
13:23:11.794514 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
13:23:11.800663 [debug] [Thread-1  ]: finished collecting timing info
13:23:11.803280 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
13:23:11.872418 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
13:23:11.875256 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
13:23:11.877557 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:23:11.883501 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:23:11.908717 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
13:23:11.914377 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
13:23:11.916887 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'trends'->0->'trends')::jsonb as trends
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        jsonb_array_elements(trends)->>'name'::string as trend_name,
        jsonb_array_elements(trends)->>'tweet_volume'::integer as trend_volume
    FROM renamed
)

SELECT * FROM final
  );
13:23:11.926573 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:23:11.936324 [debug] [Thread-1  ]: finished collecting timing info
13:23:11.938908 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
13:23:11.942318 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1624f1ad-ed5f-4ca4-b058-ee725d156913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d81b50>]}
13:23:11.945617 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.17s]
13:23:11.948665 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
13:23:11.951071 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
13:23:11.953491 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
13:23:11.957043 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
13:23:11.959425 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
13:23:11.962963 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
13:23:11.981443 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
13:23:11.988018 [debug] [Thread-1  ]: finished collecting timing info
13:23:11.990464 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
13:23:12.008078 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
13:23:12.010402 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
13:23:12.012797 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:23:12.019064 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:23:12.028597 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
13:23:12.035148 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
13:23:12.037780 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
13:23:12.045261 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:23:12.055143 [debug] [Thread-1  ]: finished collecting timing info
13:23:12.057556 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
13:23:12.061213 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1624f1ad-ed5f-4ca4-b058-ee725d156913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d70dc0>]}
13:23:12.064360 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.10s]
13:23:12.067269 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
13:23:12.071402 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
13:23:12.074325 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
13:23:12.077720 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
13:23:12.080882 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
13:23:12.083164 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
13:23:12.102364 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
13:23:12.109005 [debug] [Thread-1  ]: finished collecting timing info
13:23:12.111179 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
13:23:12.160778 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
13:23:12.163424 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
13:23:12.165677 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:23:12.172121 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:23:12.188296 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
13:23:12.194379 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
13:23:12.196377 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


SELECT tt.location_name, tt.location_country, tt.trend_name, tt.trend_volume,
       wc.lat as location_latitude, wc.lng as location_longiture
FROM "materialize"."public"."stg_twitter_trending" tt
JOIN "materialize"."public"."stg_worldcities" wc ON tt.location_name = wc.city
  );
13:23:12.209766 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:23:12.226228 [debug] [Thread-1  ]: finished collecting timing info
13:23:12.239564 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
13:23:12.250791 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1624f1ad-ed5f-4ca4-b058-ee725d156913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f3deb0>]}
13:23:12.261698 [info ] [Thread-1  ]: 5 of 5 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.17s]
13:23:12.277911 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
13:23:12.296248 [debug] [MainThread]: Acquiring new materialize connection "master"
13:23:12.305626 [debug] [MainThread]: Using materialize connection "master"
13:23:12.312470 [debug] [MainThread]: On master: BEGIN
13:23:12.321286 [debug] [MainThread]: Opening a new connection, currently in state closed
13:23:12.335558 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:23:12.343168 [debug] [MainThread]: Using materialize connection "master"
13:23:12.346430 [debug] [MainThread]: On master: COMMIT
13:23:12.349411 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:23:12.351620 [debug] [MainThread]: On master: Close
13:23:12.355660 [info ] [MainThread]: 
13:23:12.358948 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.20s.
13:23:12.361689 [debug] [MainThread]: Connection 'master' was properly closed.
13:23:12.364256 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
13:23:12.405941 [info ] [MainThread]: 
13:23:12.408682 [info ] [MainThread]: [32mCompleted successfully[0m
13:23:12.412103 [info ] [MainThread]: 
13:23:12.414938 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
13:23:12.418487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c432e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5de80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f55400>]}


============================== 2022-02-23 13:24:15.541217 | d6f951ed-8ac0-4f2d-955d-790ad2767fb7 ==============================
13:24:15.541217 [info ] [MainThread]: Running with dbt=1.0.1
13:24:15.548458 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:24:15.551052 [debug] [MainThread]: Tracking: tracking
13:24:15.578211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acdc0>]}
13:24:15.910795 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:24:15.915428 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
13:24:16.028901 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
13:24:16.214279 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

13:24:16.262718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6f951ed-8ac0-4f2d-955d-790ad2767fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c26f10>]}
13:24:16.314677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6f951ed-8ac0-4f2d-955d-790ad2767fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007310940>]}
13:24:16.317849 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
13:24:16.327607 [info ] [MainThread]: 
13:24:16.331359 [debug] [MainThread]: Acquiring new materialize connection "master"
13:24:16.340541 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
13:24:16.412281 [debug] [ThreadPool]: Using materialize connection "list_materialize"
13:24:16.415343 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
13:24:16.417820 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:24:16.449497 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
13:24:16.459653 [debug] [ThreadPool]: On list_materialize: Close
13:24:16.469911 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
13:24:16.494405 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
13:24:16.497328 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
13:24:16.499701 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:24:16.507051 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
13:24:16.516502 [debug] [ThreadPool]: On list_materialize_public: Close
13:24:16.523954 [debug] [MainThread]: Using materialize connection "master"
13:24:16.526290 [debug] [MainThread]: On master: BEGIN
13:24:16.528353 [debug] [MainThread]: Opening a new connection, currently in state init
13:24:16.534902 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:24:16.537564 [debug] [MainThread]: Using materialize connection "master"
13:24:16.539957 [debug] [MainThread]: On master: COMMIT
13:24:16.542754 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:24:16.545340 [debug] [MainThread]: On master: Close
13:24:16.548721 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:24:16.551946 [info ] [MainThread]: 
13:24:16.571304 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
13:24:16.576966 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
13:24:16.581632 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
13:24:16.585354 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
13:24:16.587926 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
13:24:16.620276 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
13:24:16.627527 [debug] [Thread-1  ]: finished collecting timing info
13:24:16.629855 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
13:24:16.686934 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
13:24:16.690299 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
13:24:16.692540 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:24:16.702718 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
13:24:16.743270 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
13:24:16.750208 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
13:24:16.752433 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
13:24:16.762486 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
13:24:16.811052 [debug] [Thread-1  ]: finished collecting timing info
13:24:16.813759 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
13:24:16.817981 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6f951ed-8ac0-4f2d-955d-790ad2767fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073907f0>]}
13:24:16.821214 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.24s]
13:24:16.824783 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
13:24:16.827458 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
13:24:16.830673 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
13:24:16.834682 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
13:24:16.836868 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
13:24:16.839523 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
13:24:16.862689 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
13:24:16.869435 [debug] [Thread-1  ]: finished collecting timing info
13:24:16.871569 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
13:24:16.882803 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
13:24:16.885576 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
13:24:16.887701 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:24:16.897371 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
13:24:16.905937 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
13:24:16.912306 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
13:24:16.914329 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
13:24:16.923438 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
13:24:16.932845 [debug] [Thread-1  ]: finished collecting timing info
13:24:16.935072 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
13:24:16.938312 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6f951ed-8ac0-4f2d-955d-790ad2767fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c11520>]}
13:24:16.941609 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.10s]
13:24:16.944884 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
13:24:16.947482 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
13:24:16.950325 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
13:24:16.954580 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
13:24:16.957753 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
13:24:16.960157 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
13:24:16.979445 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
13:24:16.986307 [debug] [Thread-1  ]: finished collecting timing info
13:24:16.989394 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
13:24:17.058627 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
13:24:17.061158 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
13:24:17.063264 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:24:17.069408 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:24:17.095379 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
13:24:17.101976 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
13:24:17.104146 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'trends'->0->'trends')::jsonb as trends
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        jsonb_array_elements(trends)->>'name' as trend_name,
        jsonb_array_elements(trends)->>'tweet_volume' as trend_volume
    FROM renamed
)

SELECT * FROM final
  );
13:24:17.114106 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:24:17.124125 [debug] [Thread-1  ]: finished collecting timing info
13:24:17.126445 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
13:24:17.130459 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6f951ed-8ac0-4f2d-955d-790ad2767fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d7fb50>]}
13:24:17.133608 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.18s]
13:24:17.136816 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
13:24:17.139093 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
13:24:17.141821 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
13:24:17.145468 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
13:24:17.148138 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
13:24:17.150438 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
13:24:17.168542 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
13:24:17.175564 [debug] [Thread-1  ]: finished collecting timing info
13:24:17.181126 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
13:24:17.198362 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
13:24:17.201171 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
13:24:17.203523 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:24:17.210260 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:24:17.220283 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
13:24:17.226086 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
13:24:17.228086 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
13:24:17.236729 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:24:17.246405 [debug] [Thread-1  ]: finished collecting timing info
13:24:17.249289 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
13:24:17.252939 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6f951ed-8ac0-4f2d-955d-790ad2767fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d74af0>]}
13:24:17.256307 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.11s]
13:24:17.259698 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
13:24:17.267840 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
13:24:17.273184 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
13:24:17.279193 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
13:24:17.282210 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
13:24:17.284479 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
13:24:17.308418 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
13:24:17.317743 [debug] [Thread-1  ]: finished collecting timing info
13:24:17.320544 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
13:24:17.373680 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
13:24:17.376677 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
13:24:17.379465 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:24:17.386386 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:24:17.403967 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
13:24:17.409738 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
13:24:17.411936 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


SELECT tt.location_name, tt.location_country, tt.trend_name, tt.trend_volume,
       wc.lat as location_latitude, wc.lng as location_longiture
FROM "materialize"."public"."stg_twitter_trending" tt
JOIN "materialize"."public"."stg_worldcities" wc ON tt.location_name = wc.city
  );
13:24:17.423968 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:24:17.436492 [debug] [Thread-1  ]: finished collecting timing info
13:24:17.439165 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
13:24:17.443141 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6f951ed-8ac0-4f2d-955d-790ad2767fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f3deb0>]}
13:24:17.446887 [info ] [Thread-1  ]: 5 of 5 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.16s]
13:24:17.449911 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
13:24:17.455467 [debug] [MainThread]: Acquiring new materialize connection "master"
13:24:17.458376 [debug] [MainThread]: Using materialize connection "master"
13:24:17.460468 [debug] [MainThread]: On master: BEGIN
13:24:17.462419 [debug] [MainThread]: Opening a new connection, currently in state closed
13:24:17.468748 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:24:17.471410 [debug] [MainThread]: Using materialize connection "master"
13:24:17.474604 [debug] [MainThread]: On master: COMMIT
13:24:17.478147 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:24:17.480854 [debug] [MainThread]: On master: Close
13:24:17.484869 [info ] [MainThread]: 
13:24:17.488176 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.15s.
13:24:17.490978 [debug] [MainThread]: Connection 'master' was properly closed.
13:24:17.493203 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
13:24:17.530878 [info ] [MainThread]: 
13:24:17.534382 [info ] [MainThread]: [32mCompleted successfully[0m
13:24:17.537608 [info ] [MainThread]: 
13:24:17.540267 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
13:24:17.543424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d59c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d59b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f552e0>]}


============================== 2022-02-23 13:27:26.800091 | 3494622d-82d2-4347-8816-aede17415f9a ==============================
13:27:26.800091 [info ] [MainThread]: Running with dbt=1.0.1
13:27:26.807055 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:27:26.809676 [debug] [MainThread]: Tracking: tracking
13:27:26.840481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe20>]}
13:27:27.176985 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:27:27.181342 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
13:27:27.287615 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
13:27:27.483144 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

13:27:27.522378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3494622d-82d2-4347-8816-aede17415f9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2a0d0>]}
13:27:27.572679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3494622d-82d2-4347-8816-aede17415f9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007310970>]}
13:27:27.576070 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
13:27:27.585237 [info ] [MainThread]: 
13:27:27.589547 [debug] [MainThread]: Acquiring new materialize connection "master"
13:27:27.599969 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
13:27:27.670574 [debug] [ThreadPool]: Using materialize connection "list_materialize"
13:27:27.673524 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
13:27:27.676439 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:27:27.704651 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
13:27:27.715272 [debug] [ThreadPool]: On list_materialize: Close
13:27:27.725092 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
13:27:27.748388 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
13:27:27.751459 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
13:27:27.753685 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:27:27.761672 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
13:27:27.771895 [debug] [ThreadPool]: On list_materialize_public: Close
13:27:27.778578 [debug] [MainThread]: Using materialize connection "master"
13:27:27.781361 [debug] [MainThread]: On master: BEGIN
13:27:27.783421 [debug] [MainThread]: Opening a new connection, currently in state init
13:27:27.789161 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:27:27.792232 [debug] [MainThread]: Using materialize connection "master"
13:27:27.794343 [debug] [MainThread]: On master: COMMIT
13:27:27.797388 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:27:27.799748 [debug] [MainThread]: On master: Close
13:27:27.802765 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:27:27.805679 [info ] [MainThread]: 
13:27:27.821714 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
13:27:27.825676 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
13:27:27.829941 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
13:27:27.833604 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
13:27:27.836407 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
13:27:27.867969 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
13:27:27.875155 [debug] [Thread-1  ]: finished collecting timing info
13:27:27.877875 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
13:27:27.934958 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
13:27:27.938028 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
13:27:27.940283 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:27:27.950761 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
13:27:27.990632 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
13:27:27.998284 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
13:27:28.000460 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
13:27:28.011338 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
13:27:28.061202 [debug] [Thread-1  ]: finished collecting timing info
13:27:28.064400 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
13:27:28.068094 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3494622d-82d2-4347-8816-aede17415f9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400738fe80>]}
13:27:28.071537 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.24s]
13:27:28.074767 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
13:27:28.077543 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
13:27:28.080591 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
13:27:28.084149 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
13:27:28.086181 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
13:27:28.088759 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
13:27:28.111997 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
13:27:28.119101 [debug] [Thread-1  ]: finished collecting timing info
13:27:28.121460 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
13:27:28.132493 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
13:27:28.135114 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
13:27:28.138012 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:27:28.147393 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
13:27:28.155755 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
13:27:28.161492 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
13:27:28.163556 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
13:27:28.172782 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
13:27:28.182587 [debug] [Thread-1  ]: finished collecting timing info
13:27:28.185149 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
13:27:28.188982 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3494622d-82d2-4347-8816-aede17415f9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c454f0>]}
13:27:28.192295 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.11s]
13:27:28.195197 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
13:27:28.197528 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
13:27:28.200417 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
13:27:28.203919 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
13:27:28.206222 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
13:27:28.208651 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
13:27:28.227456 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
13:27:28.233957 [debug] [Thread-1  ]: finished collecting timing info
13:27:28.236676 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
13:27:28.308165 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
13:27:28.311412 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
13:27:28.314019 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:27:28.320468 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:27:28.346664 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
13:27:28.354136 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
13:27:28.356515 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'trends'->0->'trends')::jsonb as trends
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        jsonb_array_elements(trends)->>'name' as trend_name,
        jsonb_array_elements(trends)->>'tweet_volume' as trend_volume
    FROM renamed
)

SELECT * FROM final
  );
13:27:28.367148 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:27:28.377397 [debug] [Thread-1  ]: finished collecting timing info
13:27:28.380187 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
13:27:28.383464 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3494622d-82d2-4347-8816-aede17415f9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d80bb0>]}
13:27:28.387395 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.18s]
13:27:28.390912 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
13:27:28.393865 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
13:27:28.396490 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
13:27:28.400908 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
13:27:28.404283 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
13:27:28.408322 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
13:27:28.429711 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
13:27:28.437224 [debug] [Thread-1  ]: finished collecting timing info
13:27:28.439868 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
13:27:28.459592 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
13:27:28.462550 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
13:27:28.464617 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:27:28.470833 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:27:28.481924 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
13:27:28.488659 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
13:27:28.491099 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
13:27:28.500088 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:27:28.510452 [debug] [Thread-1  ]: finished collecting timing info
13:27:28.513170 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
13:27:28.516621 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3494622d-82d2-4347-8816-aede17415f9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d72e20>]}
13:27:28.520412 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.12s]
13:27:28.524940 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
13:27:28.530767 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
13:27:28.534657 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
13:27:28.539097 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
13:27:28.541567 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
13:27:28.543848 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
13:27:28.564167 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
13:27:28.571712 [debug] [Thread-1  ]: finished collecting timing info
13:27:28.574301 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
13:27:28.624446 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
13:27:28.627291 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
13:27:28.629596 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:27:28.636146 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:27:28.653245 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
13:27:28.659315 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
13:27:28.661410 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


SELECT tt.location_name, tt.location_country, tt.trend_name, tt.trend_volume,
       wc.lat as location_latitude, wc.lng as location_longiture
FROM "materialize"."public"."stg_twitter_trending" tt
JOIN "materialize"."public"."stg_worldcities" wc ON tt.location_name = wc.city AND tt.location_country = wc.country
  );
13:27:28.672280 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:27:28.684615 [debug] [Thread-1  ]: finished collecting timing info
13:27:28.687662 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
13:27:28.692057 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3494622d-82d2-4347-8816-aede17415f9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e3ff10>]}
13:27:28.696131 [info ] [Thread-1  ]: 5 of 5 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.15s]
13:27:28.699916 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
13:27:28.706297 [debug] [MainThread]: Acquiring new materialize connection "master"
13:27:28.709942 [debug] [MainThread]: Using materialize connection "master"
13:27:28.712416 [debug] [MainThread]: On master: BEGIN
13:27:28.715156 [debug] [MainThread]: Opening a new connection, currently in state closed
13:27:28.721413 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:27:28.725157 [debug] [MainThread]: Using materialize connection "master"
13:27:28.728561 [debug] [MainThread]: On master: COMMIT
13:27:28.732417 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:27:28.734997 [debug] [MainThread]: On master: Close
13:27:28.739345 [info ] [MainThread]: 
13:27:28.743045 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.15s.
13:27:28.746134 [debug] [MainThread]: Connection 'master' was properly closed.
13:27:28.748440 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
13:27:28.789137 [info ] [MainThread]: 
13:27:28.792373 [info ] [MainThread]: [32mCompleted successfully[0m
13:27:28.795565 [info ] [MainThread]: 
13:27:28.798119 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
13:27:28.801602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d60ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049df0610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e57e20>]}


============================== 2022-02-23 13:29:05.782936 | 99a2f05e-309f-40d7-8539-e708ab1c5b7e ==============================
13:29:05.782936 [info ] [MainThread]: Running with dbt=1.0.1
13:29:05.790186 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:29:05.793107 [debug] [MainThread]: Tracking: tracking
13:29:05.820409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace20>]}
13:29:06.181822 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:29:06.186364 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
13:29:06.294908 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
13:29:06.473686 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

13:29:06.511744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99a2f05e-309f-40d7-8539-e708ab1c5b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c010d0>]}
13:29:06.561762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99a2f05e-309f-40d7-8539-e708ab1c5b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400730fc40>]}
13:29:06.565545 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
13:29:06.576033 [info ] [MainThread]: 
13:29:06.580400 [debug] [MainThread]: Acquiring new materialize connection "master"
13:29:06.591586 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
13:29:06.661078 [debug] [ThreadPool]: Using materialize connection "list_materialize"
13:29:06.663922 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
13:29:06.666112 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:29:06.694851 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
13:29:06.706356 [debug] [ThreadPool]: On list_materialize: Close
13:29:06.716907 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
13:29:06.742510 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
13:29:06.746873 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
13:29:06.753989 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:29:06.777073 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.02 seconds
13:29:06.794068 [debug] [ThreadPool]: On list_materialize_public: Close
13:29:06.804487 [debug] [MainThread]: Using materialize connection "master"
13:29:06.808869 [debug] [MainThread]: On master: BEGIN
13:29:06.814732 [debug] [MainThread]: Opening a new connection, currently in state init
13:29:06.823563 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:29:06.827933 [debug] [MainThread]: Using materialize connection "master"
13:29:06.831932 [debug] [MainThread]: On master: COMMIT
13:29:06.837006 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:29:06.840180 [debug] [MainThread]: On master: Close
13:29:06.846693 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:29:06.850361 [info ] [MainThread]: 
13:29:06.876664 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
13:29:06.881063 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
13:29:06.886676 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
13:29:06.889637 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
13:29:06.892673 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
13:29:06.931168 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
13:29:06.941508 [debug] [Thread-1  ]: finished collecting timing info
13:29:06.946028 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
13:29:07.019584 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
13:29:07.023769 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
13:29:07.027584 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:29:07.039428 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
13:29:07.099876 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
13:29:07.109477 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
13:29:07.111785 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
13:29:07.134780 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.02 seconds
13:29:07.200845 [debug] [Thread-1  ]: finished collecting timing info
13:29:07.205503 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
13:29:07.210314 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99a2f05e-309f-40d7-8539-e708ab1c5b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400738edf0>]}
13:29:07.216124 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.32s]
13:29:07.221829 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
13:29:07.224527 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
13:29:07.228681 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
13:29:07.233908 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
13:29:07.237308 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
13:29:07.240183 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
13:29:07.272478 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
13:29:07.285619 [debug] [Thread-1  ]: finished collecting timing info
13:29:07.289052 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
13:29:07.303410 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
13:29:07.306522 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
13:29:07.308993 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:29:07.322263 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
13:29:07.334622 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
13:29:07.341315 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
13:29:07.345505 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
13:29:07.356555 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
13:29:07.369667 [debug] [Thread-1  ]: finished collecting timing info
13:29:07.372956 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
13:29:07.378872 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99a2f05e-309f-40d7-8539-e708ab1c5b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c0d1c0>]}
13:29:07.383178 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.15s]
13:29:07.387944 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
13:29:07.390264 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
13:29:07.394676 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
13:29:07.400964 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
13:29:07.404381 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
13:29:07.407460 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
13:29:07.430286 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
13:29:07.439342 [debug] [Thread-1  ]: finished collecting timing info
13:29:07.442452 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
13:29:07.531382 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
13:29:07.535820 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
13:29:07.540023 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:29:07.548053 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:29:07.579317 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
13:29:07.589082 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
13:29:07.591932 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'trends'->0->'trends')::jsonb as trends
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume
    FROM renamed
)

SELECT * FROM final
  );
13:29:07.605096 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:29:07.615253 [debug] [Thread-1  ]: finished collecting timing info
13:29:07.619355 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
13:29:07.625179 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99a2f05e-309f-40d7-8539-e708ab1c5b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d81bb0>]}
13:29:07.628716 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.23s]
13:29:07.631663 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
13:29:07.634032 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
13:29:07.637128 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
13:29:07.642964 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
13:29:07.645342 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
13:29:07.648585 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
13:29:07.669695 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
13:29:07.678098 [debug] [Thread-1  ]: finished collecting timing info
13:29:07.682135 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
13:29:07.700393 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
13:29:07.702713 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
13:29:07.705065 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:29:07.711522 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:29:07.723677 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
13:29:07.730557 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
13:29:07.733131 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
13:29:07.742749 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:29:07.753021 [debug] [Thread-1  ]: finished collecting timing info
13:29:07.756309 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
13:29:07.760747 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99a2f05e-309f-40d7-8539-e708ab1c5b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d73b50>]}
13:29:07.767393 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.12s]
13:29:07.774368 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
13:29:07.780177 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
13:29:07.783308 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
13:29:07.789054 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
13:29:07.791565 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
13:29:07.793777 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
13:29:07.814741 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
13:29:07.822582 [debug] [Thread-1  ]: finished collecting timing info
13:29:07.824917 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
13:29:07.876405 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
13:29:07.879171 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
13:29:07.881596 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:29:07.887903 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:29:07.906923 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
13:29:07.916158 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
13:29:07.919579 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


SELECT tt.location_name, tt.location_country, tt.trend_name, tt.trend_volume,
       wc.lat as location_latitude, wc.lng as location_longiture
FROM "materialize"."public"."stg_twitter_trending" tt
JOIN "materialize"."public"."stg_worldcities" wc ON tt.location_name = wc.city AND tt.location_country = wc.country
  );
13:29:07.934747 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:29:07.949614 [debug] [Thread-1  ]: finished collecting timing info
13:29:07.952823 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
13:29:07.956985 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99a2f05e-309f-40d7-8539-e708ab1c5b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f3cf10>]}
13:29:07.961404 [info ] [Thread-1  ]: 5 of 5 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.17s]
13:29:07.964835 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
13:29:07.971641 [debug] [MainThread]: Acquiring new materialize connection "master"
13:29:07.975000 [debug] [MainThread]: Using materialize connection "master"
13:29:07.977382 [debug] [MainThread]: On master: BEGIN
13:29:07.979652 [debug] [MainThread]: Opening a new connection, currently in state closed
13:29:07.985432 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:29:07.989100 [debug] [MainThread]: Using materialize connection "master"
13:29:07.991419 [debug] [MainThread]: On master: COMMIT
13:29:07.998403 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:29:08.001680 [debug] [MainThread]: On master: Close
13:29:08.006643 [info ] [MainThread]: 
13:29:08.010077 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.43s.
13:29:08.013503 [debug] [MainThread]: Connection 'master' was properly closed.
13:29:08.017820 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
13:29:08.065770 [info ] [MainThread]: 
13:29:08.072454 [info ] [MainThread]: [32mCompleted successfully[0m
13:29:08.077852 [info ] [MainThread]: 
13:29:08.080873 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
13:29:08.083849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d59ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d59be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f55340>]}


============================== 2022-02-23 13:29:58.831000 | 9fb536bc-ea6b-449c-a1de-9f63fc6773a5 ==============================
13:29:58.831000 [info ] [MainThread]: Running with dbt=1.0.1
13:29:58.837043 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:29:58.840564 [debug] [MainThread]: Tracking: tracking
13:29:58.867322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728adc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728aeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728ae50>]}
13:29:59.201676 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
13:29:59.205817 [debug] [MainThread]: Partial parsing: update schema file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter.yml
13:29:59.209148 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
13:29:59.312868 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
13:29:59.496484 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

13:29:59.534637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fb536bc-ea6b-449c-a1de-9f63fc6773a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c270d0>]}
13:29:59.593847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fb536bc-ea6b-449c-a1de-9f63fc6773a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007393c40>]}
13:29:59.597001 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
13:29:59.605882 [info ] [MainThread]: 
13:29:59.610538 [debug] [MainThread]: Acquiring new materialize connection "master"
13:29:59.619775 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
13:29:59.692425 [debug] [ThreadPool]: Using materialize connection "list_materialize"
13:29:59.695195 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
13:29:59.697553 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:29:59.723707 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
13:29:59.734016 [debug] [ThreadPool]: On list_materialize: Close
13:29:59.743179 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
13:29:59.767096 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
13:29:59.769995 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
13:29:59.771995 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:29:59.779192 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
13:29:59.788825 [debug] [ThreadPool]: On list_materialize_public: Close
13:29:59.795889 [debug] [MainThread]: Using materialize connection "master"
13:29:59.798622 [debug] [MainThread]: On master: BEGIN
13:29:59.800989 [debug] [MainThread]: Opening a new connection, currently in state init
13:29:59.806991 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:29:59.809677 [debug] [MainThread]: Using materialize connection "master"
13:29:59.812831 [debug] [MainThread]: On master: COMMIT
13:29:59.815826 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:29:59.818200 [debug] [MainThread]: On master: Close
13:29:59.821474 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:29:59.824167 [info ] [MainThread]: 
13:29:59.842140 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
13:29:59.846348 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
13:29:59.850749 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
13:29:59.853209 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
13:29:59.855864 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
13:29:59.886037 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
13:29:59.893146 [debug] [Thread-1  ]: finished collecting timing info
13:29:59.895485 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
13:29:59.952227 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
13:29:59.955309 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
13:29:59.957903 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:29:59.969558 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
13:30:00.009559 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
13:30:00.016114 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
13:30:00.018349 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
13:30:00.027636 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
13:30:00.076597 [debug] [Thread-1  ]: finished collecting timing info
13:30:00.079228 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
13:30:00.082789 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fb536bc-ea6b-449c-a1de-9f63fc6773a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400738ee20>]}
13:30:00.086074 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.23s]
13:30:00.089604 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
13:30:00.091897 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
13:30:00.095458 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
13:30:00.099135 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
13:30:00.101144 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
13:30:00.103187 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
13:30:00.124967 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
13:30:00.131461 [debug] [Thread-1  ]: finished collecting timing info
13:30:00.133872 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
13:30:00.144092 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
13:30:00.146462 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
13:30:00.148198 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:00.157949 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
13:30:00.166750 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
13:30:00.172543 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
13:30:00.174625 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
13:30:00.184210 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
13:30:00.193975 [debug] [Thread-1  ]: finished collecting timing info
13:30:00.196484 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
13:30:00.199788 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fb536bc-ea6b-449c-a1de-9f63fc6773a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c480a0>]}
13:30:00.203214 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.10s]
13:30:00.206220 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
13:30:00.208351 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
13:30:00.211157 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
13:30:00.214916 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
13:30:00.217334 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
13:30:00.219493 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
13:30:00.237583 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
13:30:00.243059 [debug] [Thread-1  ]: finished collecting timing info
13:30:00.245618 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
13:30:00.314032 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
13:30:00.317159 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
13:30:00.319523 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:00.325443 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:30:00.350579 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
13:30:00.357596 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
13:30:00.360753 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'trends'->0->'trends')::jsonb as trends
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume
    FROM renamed
)

SELECT * FROM final
  );
13:30:00.370233 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:30:00.380118 [debug] [Thread-1  ]: finished collecting timing info
13:30:00.382639 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
13:30:00.386673 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fb536bc-ea6b-449c-a1de-9f63fc6773a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d927f0>]}
13:30:00.389818 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.17s]
13:30:00.392799 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
13:30:00.395019 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
13:30:00.397451 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
13:30:00.400729 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
13:30:00.402790 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
13:30:00.404956 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
13:30:00.423346 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
13:30:00.429833 [debug] [Thread-1  ]: finished collecting timing info
13:30:00.432506 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
13:30:00.450089 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
13:30:00.452477 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
13:30:00.454474 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:00.460358 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:30:00.469926 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
13:30:00.476303 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
13:30:00.478335 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
13:30:00.486027 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:30:00.495958 [debug] [Thread-1  ]: finished collecting timing info
13:30:00.498142 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
13:30:00.501601 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fb536bc-ea6b-449c-a1de-9f63fc6773a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d73ee0>]}
13:30:00.505216 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.10s]
13:30:00.508491 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
13:30:00.513455 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
13:30:00.515946 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
13:30:00.519282 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
13:30:00.521691 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
13:30:00.523891 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
13:30:00.543185 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
13:30:00.549921 [debug] [Thread-1  ]: finished collecting timing info
13:30:00.552617 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
13:30:00.606880 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
13:30:00.610098 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
13:30:00.613946 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:00.622955 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:30:00.640169 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
13:30:00.646918 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
13:30:00.649191 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


SELECT tt.location_name, tt.location_country, tt.trend_name, tt.trend_volume,
       wc.lat as location_latitude, wc.lng as location_longiture
FROM "materialize"."public"."stg_twitter_trending" tt
JOIN "materialize"."public"."stg_worldcities" wc ON tt.location_name = wc.city AND tt.location_country = wc.country
WHERE tt.trend_volume > 0
  );
13:30:00.660944 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:30:00.671513 [debug] [Thread-1  ]: finished collecting timing info
13:30:00.673796 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
13:30:00.677725 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fb536bc-ea6b-449c-a1de-9f63fc6773a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e3efd0>]}
13:30:00.681094 [info ] [Thread-1  ]: 5 of 5 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.16s]
13:30:00.684223 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
13:30:00.690158 [debug] [MainThread]: Acquiring new materialize connection "master"
13:30:00.693194 [debug] [MainThread]: Using materialize connection "master"
13:30:00.695676 [debug] [MainThread]: On master: BEGIN
13:30:00.699161 [debug] [MainThread]: Opening a new connection, currently in state closed
13:30:00.705039 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:30:00.707992 [debug] [MainThread]: Using materialize connection "master"
13:30:00.710107 [debug] [MainThread]: On master: COMMIT
13:30:00.713307 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:30:00.715964 [debug] [MainThread]: On master: Close
13:30:00.719658 [info ] [MainThread]: 
13:30:00.722670 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.11s.
13:30:00.725558 [debug] [MainThread]: Connection 'master' was properly closed.
13:30:00.727708 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
13:30:00.763780 [info ] [MainThread]: 
13:30:00.766519 [info ] [MainThread]: [32mCompleted successfully[0m
13:30:00.769183 [info ] [MainThread]: 
13:30:00.771854 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
13:30:00.775058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d61fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049df36d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e57a60>]}


============================== 2022-02-23 13:36:34.602880 | de0283f6-8d12-4f97-a4a5-1ed884035958 ==============================
13:36:34.602880 [info ] [MainThread]: Running with dbt=1.0.1
13:36:34.612337 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:36:34.615309 [debug] [MainThread]: Tracking: tracking
13:36:34.645531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe20>]}
13:36:34.993784 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
13:36:34.998317 [debug] [MainThread]: Partial parsing: update schema file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter.yml
13:36:35.002700 [debug] [MainThread]: Partial parsing: update schema file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter.yml
13:36:35.005506 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
13:36:35.007886 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
13:36:35.116554 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
13:36:35.203829 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
13:36:35.352840 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

13:36:35.394775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de0283f6-8d12-4f97-a4a5-1ed884035958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c290d0>]}
13:36:35.446915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de0283f6-8d12-4f97-a4a5-1ed884035958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073928e0>]}
13:36:35.450081 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
13:36:35.459111 [info ] [MainThread]: 
13:36:35.464474 [debug] [MainThread]: Acquiring new materialize connection "master"
13:36:35.478923 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
13:36:35.561969 [debug] [ThreadPool]: Using materialize connection "list_materialize"
13:36:35.565787 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
13:36:35.570513 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:36:35.602348 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
13:36:35.613625 [debug] [ThreadPool]: On list_materialize: Close
13:36:35.624818 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
13:36:35.649159 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
13:36:35.652503 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
13:36:35.654733 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:36:35.661952 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
13:36:35.672234 [debug] [ThreadPool]: On list_materialize_public: Close
13:36:35.679031 [debug] [MainThread]: Using materialize connection "master"
13:36:35.682277 [debug] [MainThread]: On master: BEGIN
13:36:35.684621 [debug] [MainThread]: Opening a new connection, currently in state init
13:36:35.690952 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:36:35.693902 [debug] [MainThread]: Using materialize connection "master"
13:36:35.695944 [debug] [MainThread]: On master: COMMIT
13:36:35.699148 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:36:35.701249 [debug] [MainThread]: On master: Close
13:36:35.704289 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:36:35.707223 [info ] [MainThread]: 
13:36:35.725229 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
13:36:35.730451 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
13:36:35.735539 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
13:36:35.738274 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
13:36:35.740649 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
13:36:35.773335 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
13:36:35.781285 [debug] [Thread-1  ]: finished collecting timing info
13:36:35.783947 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
13:36:35.841365 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
13:36:35.843912 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
13:36:35.846096 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:36:35.857054 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
13:36:35.898276 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
13:36:35.905582 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
13:36:35.907865 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
13:36:35.918515 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
13:36:35.968531 [debug] [Thread-1  ]: finished collecting timing info
13:36:35.972162 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
13:36:35.976176 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de0283f6-8d12-4f97-a4a5-1ed884035958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400738fe20>]}
13:36:35.979423 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.24s]
13:36:35.983060 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
13:36:35.985743 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
13:36:35.988825 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
13:36:35.992722 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
13:36:35.995554 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
13:36:35.998324 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
13:36:36.025553 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
13:36:36.032171 [debug] [Thread-1  ]: finished collecting timing info
13:36:36.035223 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
13:36:36.045964 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
13:36:36.048474 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
13:36:36.050529 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:36:36.059336 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
13:36:36.067697 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
13:36:36.073614 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
13:36:36.075475 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
13:36:36.084138 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
13:36:36.093771 [debug] [Thread-1  ]: finished collecting timing info
13:36:36.096148 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
13:36:36.100046 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de0283f6-8d12-4f97-a4a5-1ed884035958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c51760>]}
13:36:36.103128 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.11s]
13:36:36.106910 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
13:36:36.109873 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
13:36:36.112782 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
13:36:36.116333 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
13:36:36.118720 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
13:36:36.120958 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
13:36:36.139546 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
13:36:36.146081 [debug] [Thread-1  ]: finished collecting timing info
13:36:36.149233 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
13:36:36.219334 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
13:36:36.222168 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
13:36:36.224602 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:36:36.230842 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:36:36.257232 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
13:36:36.265012 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
13:36:36.267059 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'trends'->0->'trends')::jsonb as trends
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume,
        jsonb_array_elements(trends)->>'as_of' as trend_as_of
    FROM renamed
)

SELECT * FROM final
  );
13:36:36.277771 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:36:36.287711 [debug] [Thread-1  ]: finished collecting timing info
13:36:36.289999 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
13:36:36.293260 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de0283f6-8d12-4f97-a4a5-1ed884035958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d87e50>]}
13:36:36.296246 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.18s]
13:36:36.300512 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
13:36:36.303278 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
13:36:36.306503 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
13:36:36.310222 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
13:36:36.312216 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
13:36:36.314225 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
13:36:36.334117 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
13:36:36.341112 [debug] [Thread-1  ]: finished collecting timing info
13:36:36.343600 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
13:36:36.361466 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
13:36:36.364057 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
13:36:36.366229 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:36:36.372673 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:36:36.399853 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
13:36:36.406333 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
13:36:36.408523 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
13:36:36.416867 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:36:36.427369 [debug] [Thread-1  ]: finished collecting timing info
13:36:36.429883 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
13:36:36.433337 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de0283f6-8d12-4f97-a4a5-1ed884035958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d73f40>]}
13:36:36.436762 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.12s]
13:36:36.439687 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
13:36:36.444964 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
13:36:36.448116 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
13:36:36.452093 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
13:36:36.454451 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
13:36:36.456587 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
13:36:36.476639 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
13:36:36.483893 [debug] [Thread-1  ]: finished collecting timing info
13:36:36.486351 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
13:36:36.537397 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
13:36:36.539885 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
13:36:36.542362 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:36:36.548367 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:36:36.565343 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
13:36:36.572846 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
13:36:36.575370 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


SELECT tt.location_name, tt.location_country, tt.trend_name, tt.trend_volume, tt.trend_as_of as trend_date
       wc.lat as location_latitude, wc.lng as location_longiture
FROM "materialize"."public"."stg_twitter_trending" tt
JOIN "materialize"."public"."stg_worldcities" wc ON tt.location_name = wc.city AND tt.location_country = wc.country
WHERE tt.trend_volume > 0
  );
13:36:36.580977 [debug] [Thread-1  ]: Postgres adapter: Postgres error: Expected right parenthesis, found identifier "wc"
LINE 8:        wc.lat as location_latitude, wc.lng as location_longi...
               ^

13:36:36.585260 [debug] [Thread-1  ]: finished collecting timing info
13:36:36.588640 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
13:36:36.592858 [debug] [Thread-1  ]: Database Error in model fct_twitter_trending (models/twitter_trending/marts/twitter/fct_twitter_trending.sql)
  Expected right parenthesis, found identifier "wc"
  LINE 8:        wc.lat as location_latitude, wc.lng as location_longi...
                 ^
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/marts/twitter/fct_twitter_trending.sql
13:36:36.597094 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de0283f6-8d12-4f97-a4a5-1ed884035958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e5c9a0>]}
13:36:36.600313 [error] [Thread-1  ]: 5 of 5 ERROR creating materializedview model public.fct_twitter_trending........ [[31mERROR[0m in 0.15s]
13:36:36.604094 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
13:36:36.610640 [debug] [MainThread]: Acquiring new materialize connection "master"
13:36:36.614153 [debug] [MainThread]: Using materialize connection "master"
13:36:36.616911 [debug] [MainThread]: On master: BEGIN
13:36:36.622889 [debug] [MainThread]: Opening a new connection, currently in state closed
13:36:36.628482 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:36:36.631583 [debug] [MainThread]: Using materialize connection "master"
13:36:36.634244 [debug] [MainThread]: On master: COMMIT
13:36:36.637637 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:36:36.640486 [debug] [MainThread]: On master: Close
13:36:36.644191 [info ] [MainThread]: 
13:36:36.647293 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.18s.
13:36:36.650405 [debug] [MainThread]: Connection 'master' was properly closed.
13:36:36.652616 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
13:36:36.692350 [info ] [MainThread]: 
13:36:36.695024 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
13:36:36.697588 [info ] [MainThread]: 
13:36:36.700179 [error] [MainThread]: [33mDatabase Error in model fct_twitter_trending (models/twitter_trending/marts/twitter/fct_twitter_trending.sql)[0m
13:36:36.703034 [error] [MainThread]:   Expected right parenthesis, found identifier "wc"
13:36:36.705208 [error] [MainThread]:   LINE 8:        wc.lat as location_latitude, wc.lng as location_longi...
13:36:36.708203 [error] [MainThread]:                  ^
13:36:36.711190 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/marts/twitter/fct_twitter_trending.sql
13:36:36.713643 [info ] [MainThread]: 
13:36:36.717046 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
13:36:36.721087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e3c640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e41eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e41bb0>]}


============================== 2022-02-23 13:37:07.200356 | 4c35ed4a-d8d5-4f78-a9bb-527e378ba927 ==============================
13:37:07.200356 [info ] [MainThread]: Running with dbt=1.0.1
13:37:07.207153 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:37:07.210249 [debug] [MainThread]: Tracking: tracking
13:37:07.239637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace20>]}
13:37:07.580870 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:37:07.585111 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
13:37:07.694709 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
13:37:07.882802 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

13:37:07.921906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c35ed4a-d8d5-4f78-a9bb-527e378ba927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c290d0>]}
13:37:07.972518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c35ed4a-d8d5-4f78-a9bb-527e378ba927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007393c40>]}
13:37:07.975862 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
13:37:07.985609 [info ] [MainThread]: 
13:37:07.990260 [debug] [MainThread]: Acquiring new materialize connection "master"
13:37:08.004196 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
13:37:08.077024 [debug] [ThreadPool]: Using materialize connection "list_materialize"
13:37:08.080160 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
13:37:08.082569 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:37:08.109043 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
13:37:08.119832 [debug] [ThreadPool]: On list_materialize: Close
13:37:08.129426 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
13:37:08.152632 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
13:37:08.155123 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
13:37:08.157290 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:37:08.164364 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
13:37:08.174283 [debug] [ThreadPool]: On list_materialize_public: Close
13:37:08.181422 [debug] [MainThread]: Using materialize connection "master"
13:37:08.183872 [debug] [MainThread]: On master: BEGIN
13:37:08.185925 [debug] [MainThread]: Opening a new connection, currently in state init
13:37:08.191583 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:37:08.194223 [debug] [MainThread]: Using materialize connection "master"
13:37:08.196571 [debug] [MainThread]: On master: COMMIT
13:37:08.199604 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:37:08.202136 [debug] [MainThread]: On master: Close
13:37:08.205266 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:37:08.208418 [info ] [MainThread]: 
13:37:08.225478 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
13:37:08.230782 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
13:37:08.235358 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
13:37:08.238061 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
13:37:08.240232 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
13:37:08.272676 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
13:37:08.280584 [debug] [Thread-1  ]: finished collecting timing info
13:37:08.283339 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
13:37:08.340331 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
13:37:08.342938 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
13:37:08.344879 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:37:08.355367 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
13:37:08.395670 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
13:37:08.403193 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
13:37:08.405411 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
13:37:08.415267 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
13:37:08.464846 [debug] [Thread-1  ]: finished collecting timing info
13:37:08.467819 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
13:37:08.471610 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c35ed4a-d8d5-4f78-a9bb-527e378ba927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007390eb0>]}
13:37:08.475215 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.24s]
13:37:08.479392 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
13:37:08.482120 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
13:37:08.485293 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
13:37:08.489425 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
13:37:08.491618 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
13:37:08.493981 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
13:37:08.516862 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
13:37:08.524026 [debug] [Thread-1  ]: finished collecting timing info
13:37:08.526164 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
13:37:08.536960 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
13:37:08.539127 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
13:37:08.541648 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:37:08.552850 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
13:37:08.561317 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
13:37:08.567801 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
13:37:08.570094 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
13:37:08.578952 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
13:37:08.589032 [debug] [Thread-1  ]: finished collecting timing info
13:37:08.591018 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
13:37:08.594214 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c35ed4a-d8d5-4f78-a9bb-527e378ba927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c45550>]}
13:37:08.597846 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.11s]
13:37:08.600695 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
13:37:08.603400 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
13:37:08.606690 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
13:37:08.610540 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
13:37:08.612831 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
13:37:08.614944 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
13:37:08.634711 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
13:37:08.640858 [debug] [Thread-1  ]: finished collecting timing info
13:37:08.644026 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
13:37:08.713687 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
13:37:08.716955 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
13:37:08.718968 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:37:08.724901 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:37:08.750931 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
13:37:08.770875 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
13:37:08.772840 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'trends'->0->'trends')::jsonb as trends
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume,
        jsonb_array_elements(trends)->>'as_of' as trend_as_of
    FROM renamed
)

SELECT * FROM final
  );
13:37:08.780922 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:37:08.790896 [debug] [Thread-1  ]: finished collecting timing info
13:37:08.793108 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
13:37:08.796702 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c35ed4a-d8d5-4f78-a9bb-527e378ba927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d86ca0>]}
13:37:08.800025 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.19s]
13:37:08.804096 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
13:37:08.806327 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
13:37:08.808965 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
13:37:08.812549 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
13:37:08.814627 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
13:37:08.816624 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
13:37:08.834974 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
13:37:08.841136 [debug] [Thread-1  ]: finished collecting timing info
13:37:08.843639 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
13:37:08.861089 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
13:37:08.863242 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
13:37:08.865140 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:37:08.871215 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:37:08.880495 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
13:37:08.886532 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
13:37:08.888657 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
13:37:08.897342 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:37:08.907369 [debug] [Thread-1  ]: finished collecting timing info
13:37:08.909708 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
13:37:08.913181 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c35ed4a-d8d5-4f78-a9bb-527e378ba927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d71e80>]}
13:37:08.917073 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.10s]
13:37:08.920392 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
13:37:08.925839 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
13:37:08.928588 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
13:37:08.932619 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
13:37:08.935037 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
13:37:08.937153 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
13:37:08.957223 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
13:37:08.963637 [debug] [Thread-1  ]: finished collecting timing info
13:37:08.966126 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
13:37:09.018992 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
13:37:09.022113 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
13:37:09.025129 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:37:09.032279 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:37:09.053143 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
13:37:09.059226 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
13:37:09.061396 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


SELECT tt.location_name, tt.location_country, tt.trend_name, tt.trend_volume, tt.trend_as_of as trend_date,
       wc.lat as location_latitude, wc.lng as location_longiture
FROM "materialize"."public"."stg_twitter_trending" tt
JOIN "materialize"."public"."stg_worldcities" wc ON tt.location_name = wc.city AND tt.location_country = wc.country
WHERE tt.trend_volume > 0
  );
13:37:09.074776 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:37:09.087410 [debug] [Thread-1  ]: finished collecting timing info
13:37:09.090325 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
13:37:09.094559 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c35ed4a-d8d5-4f78-a9bb-527e378ba927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e2af40>]}
13:37:09.098146 [info ] [Thread-1  ]: 5 of 5 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.16s]
13:37:09.101797 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
13:37:09.107929 [debug] [MainThread]: Acquiring new materialize connection "master"
13:37:09.111179 [debug] [MainThread]: Using materialize connection "master"
13:37:09.113660 [debug] [MainThread]: On master: BEGIN
13:37:09.116129 [debug] [MainThread]: Opening a new connection, currently in state closed
13:37:09.122566 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:37:09.126484 [debug] [MainThread]: Using materialize connection "master"
13:37:09.129263 [debug] [MainThread]: On master: COMMIT
13:37:09.133251 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:37:09.135909 [debug] [MainThread]: On master: Close
13:37:09.139618 [info ] [MainThread]: 
13:37:09.144119 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.15s.
13:37:09.147346 [debug] [MainThread]: Connection 'master' was properly closed.
13:37:09.149416 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
13:37:09.185991 [info ] [MainThread]: 
13:37:09.188916 [info ] [MainThread]: [32mCompleted successfully[0m
13:37:09.192005 [info ] [MainThread]: 
13:37:09.194482 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
13:37:09.198064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007390b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049def670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e4f550>]}


============================== 2022-02-23 13:40:19.284531 | 022a4454-d77d-49e8-8c23-ea7b1dc8a73b ==============================
13:40:19.284531 [info ] [MainThread]: Running with dbt=1.0.1
13:40:19.291637 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:40:19.298080 [debug] [MainThread]: Tracking: tracking
13:40:19.329009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acdf0>]}
13:40:19.663560 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:40:19.667991 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
13:40:19.775262 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
13:40:19.959933 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

13:40:19.998874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '022a4454-d77d-49e8-8c23-ea7b1dc8a73b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c1b0d0>]}
13:40:20.050556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '022a4454-d77d-49e8-8c23-ea7b1dc8a73b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007393af0>]}
13:40:20.054480 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
13:40:20.064099 [info ] [MainThread]: 
13:40:20.069518 [debug] [MainThread]: Acquiring new materialize connection "master"
13:40:20.082667 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
13:40:20.155668 [debug] [ThreadPool]: Using materialize connection "list_materialize"
13:40:20.158807 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
13:40:20.161149 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:40:20.196954 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.04 seconds
13:40:20.208955 [debug] [ThreadPool]: On list_materialize: Close
13:40:20.219774 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
13:40:20.243418 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
13:40:20.245823 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
13:40:20.248118 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:40:20.255063 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
13:40:20.264561 [debug] [ThreadPool]: On list_materialize_public: Close
13:40:20.271646 [debug] [MainThread]: Using materialize connection "master"
13:40:20.275179 [debug] [MainThread]: On master: BEGIN
13:40:20.277618 [debug] [MainThread]: Opening a new connection, currently in state init
13:40:20.284074 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:40:20.287168 [debug] [MainThread]: Using materialize connection "master"
13:40:20.289285 [debug] [MainThread]: On master: COMMIT
13:40:20.291983 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:40:20.294345 [debug] [MainThread]: On master: Close
13:40:20.297990 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:40:20.300773 [info ] [MainThread]: 
13:40:20.320374 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
13:40:20.325743 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
13:40:20.330064 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
13:40:20.333619 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
13:40:20.336226 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
13:40:20.368646 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
13:40:20.375686 [debug] [Thread-1  ]: finished collecting timing info
13:40:20.378974 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
13:40:20.438811 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
13:40:20.441786 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
13:40:20.443966 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:40:20.455288 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
13:40:20.496369 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
13:40:20.503156 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
13:40:20.505175 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
13:40:20.515780 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
13:40:20.565086 [debug] [Thread-1  ]: finished collecting timing info
13:40:20.567982 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
13:40:20.571434 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '022a4454-d77d-49e8-8c23-ea7b1dc8a73b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400738f820>]}
13:40:20.574800 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.24s]
13:40:20.578585 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
13:40:20.580898 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
13:40:20.583948 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
13:40:20.587603 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
13:40:20.589946 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
13:40:20.592116 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
13:40:20.615150 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
13:40:20.621951 [debug] [Thread-1  ]: finished collecting timing info
13:40:20.624115 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
13:40:20.635250 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
13:40:20.637650 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
13:40:20.639814 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:40:20.649973 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
13:40:20.658510 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
13:40:20.664599 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
13:40:20.666979 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
13:40:20.677102 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
13:40:20.686484 [debug] [Thread-1  ]: finished collecting timing info
13:40:20.688671 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
13:40:20.692401 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '022a4454-d77d-49e8-8c23-ea7b1dc8a73b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c46220>]}
13:40:20.696376 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.11s]
13:40:20.699958 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
13:40:20.702480 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
13:40:20.705843 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
13:40:20.709597 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
13:40:20.712251 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
13:40:20.714350 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
13:40:20.733960 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
13:40:20.740763 [debug] [Thread-1  ]: finished collecting timing info
13:40:20.746788 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
13:40:20.821392 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
13:40:20.824228 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
13:40:20.826552 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:40:20.833601 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:40:20.859773 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
13:40:20.866169 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
13:40:20.868334 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'trends'->0->'trends')::jsonb as trends
       (data->'trends'->0->>'as_of')::timestamp as trends_as_of
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume,
        trends_as_of
    FROM renamed
)

SELECT * FROM final
  );
13:40:20.872356 [debug] [Thread-1  ]: Postgres adapter: Postgres error: Expected right parenthesis, found left parenthesis
LINE 28:        (data->'trends'->0->>'as_of')::timestamp as trends_as...
                ^

13:40:20.875197 [debug] [Thread-1  ]: finished collecting timing info
13:40:20.877441 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
13:40:20.881586 [debug] [Thread-1  ]: Database Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)
  Expected right parenthesis, found left parenthesis
  LINE 28:        (data->'trends'->0->>'as_of')::timestamp as trends_as...
                  ^
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
13:40:20.884915 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '022a4454-d77d-49e8-8c23-ea7b1dc8a73b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049df64c0>]}
13:40:20.888107 [error] [Thread-1  ]: 3 of 5 ERROR creating view model public.stg_twitter_trending.................... [[31mERROR[0m in 0.18s]
13:40:20.891045 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
13:40:20.893265 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
13:40:20.895810 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
13:40:20.899546 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
13:40:20.901814 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
13:40:20.904579 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
13:40:20.922649 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
13:40:20.930174 [debug] [Thread-1  ]: finished collecting timing info
13:40:20.932655 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
13:40:20.949927 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
13:40:20.952280 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
13:40:20.954552 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:40:20.960783 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:40:20.971172 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
13:40:20.977228 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
13:40:20.979307 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
13:40:20.987288 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:40:20.997511 [debug] [Thread-1  ]: finished collecting timing info
13:40:21.000007 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
13:40:21.003331 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '022a4454-d77d-49e8-8c23-ea7b1dc8a73b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d73b80>]}
13:40:21.006665 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.10s]
13:40:21.010066 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
13:40:21.015483 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
13:40:21.017982 [info ] [Thread-1  ]: 5 of 5 SKIP relation public.fct_twitter_trending................................ [[33mSKIP[0m]
13:40:21.020708 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
13:40:21.026344 [debug] [MainThread]: Acquiring new materialize connection "master"
13:40:21.029788 [debug] [MainThread]: Using materialize connection "master"
13:40:21.032956 [debug] [MainThread]: On master: BEGIN
13:40:21.034962 [debug] [MainThread]: Opening a new connection, currently in state closed
13:40:21.041368 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:40:21.046206 [debug] [MainThread]: Using materialize connection "master"
13:40:21.049129 [debug] [MainThread]: On master: COMMIT
13:40:21.052424 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:40:21.054844 [debug] [MainThread]: On master: Close
13:40:21.058466 [info ] [MainThread]: 
13:40:21.062465 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 0.99s.
13:40:21.065786 [debug] [MainThread]: Connection 'master' was properly closed.
13:40:21.068309 [debug] [MainThread]: Connection 'model.mz_hack_day.stg_worldcities' was properly closed.
13:40:21.111088 [info ] [MainThread]: 
13:40:21.115818 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
13:40:21.121297 [info ] [MainThread]: 
13:40:21.124734 [error] [MainThread]: [33mDatabase Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)[0m
13:40:21.130031 [error] [MainThread]:   Expected right parenthesis, found left parenthesis
13:40:21.133366 [error] [MainThread]:   LINE 28:        (data->'trends'->0->>'as_of')::timestamp as trends_as...
13:40:21.136199 [error] [MainThread]:                   ^
13:40:21.139985 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
13:40:21.143425 [info ] [MainThread]: 
13:40:21.146560 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
13:40:21.149907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049df6790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049df65b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e2fa30>]}


============================== 2022-02-23 13:41:01.722124 | f70a786a-374e-4440-8c98-3abe6a6cbf47 ==============================
13:41:01.722124 [info ] [MainThread]: Running with dbt=1.0.1
13:41:01.728967 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:41:01.732343 [debug] [MainThread]: Tracking: tracking
13:41:01.761576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aadc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aaeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aae50>]}
13:41:02.104702 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:41:02.108910 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
13:41:02.227048 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
13:41:02.421681 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

13:41:02.461692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f70a786a-374e-4440-8c98-3abe6a6cbf47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c04ac0>]}
13:41:02.512705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f70a786a-374e-4440-8c98-3abe6a6cbf47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007393c40>]}
13:41:02.516284 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
13:41:02.525085 [info ] [MainThread]: 
13:41:02.529455 [debug] [MainThread]: Acquiring new materialize connection "master"
13:41:02.539124 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
13:41:02.609139 [debug] [ThreadPool]: Using materialize connection "list_materialize"
13:41:02.612435 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
13:41:02.614576 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:41:02.643898 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
13:41:02.654315 [debug] [ThreadPool]: On list_materialize: Close
13:41:02.663850 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
13:41:02.687531 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
13:41:02.690198 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
13:41:02.692644 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:41:02.699767 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
13:41:02.709388 [debug] [ThreadPool]: On list_materialize_public: Close
13:41:02.715898 [debug] [MainThread]: Using materialize connection "master"
13:41:02.718532 [debug] [MainThread]: On master: BEGIN
13:41:02.720580 [debug] [MainThread]: Opening a new connection, currently in state init
13:41:02.726491 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:41:02.728945 [debug] [MainThread]: Using materialize connection "master"
13:41:02.731103 [debug] [MainThread]: On master: COMMIT
13:41:02.734357 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:41:02.736815 [debug] [MainThread]: On master: Close
13:41:02.740062 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:41:02.742744 [info ] [MainThread]: 
13:41:02.761363 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
13:41:02.765900 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
13:41:02.770422 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
13:41:02.774015 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
13:41:02.776443 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
13:41:02.807405 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
13:41:02.814004 [debug] [Thread-1  ]: finished collecting timing info
13:41:02.816683 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
13:41:02.875296 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
13:41:02.878519 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
13:41:02.880997 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:41:02.892027 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
13:41:02.932026 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
13:41:02.939952 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
13:41:02.942646 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
13:41:02.954880 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
13:41:03.004585 [debug] [Thread-1  ]: finished collecting timing info
13:41:03.007782 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
13:41:03.011763 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f70a786a-374e-4440-8c98-3abe6a6cbf47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d74fa0>]}
13:41:03.015390 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.24s]
13:41:03.020440 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
13:41:03.023462 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
13:41:03.026552 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
13:41:03.030382 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
13:41:03.032612 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
13:41:03.034843 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
13:41:03.059087 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
13:41:03.065863 [debug] [Thread-1  ]: finished collecting timing info
13:41:03.068319 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
13:41:03.079181 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
13:41:03.112175 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
13:41:03.117955 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:41:03.137062 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.02 seconds
13:41:03.149321 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
13:41:03.155372 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
13:41:03.157560 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
13:41:03.166895 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
13:41:03.177718 [debug] [Thread-1  ]: finished collecting timing info
13:41:03.181785 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
13:41:03.187098 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f70a786a-374e-4440-8c98-3abe6a6cbf47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c45250>]}
13:41:03.191509 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.16s]
13:41:03.195506 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
13:41:03.197890 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
13:41:03.200798 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
13:41:03.204368 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
13:41:03.207614 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
13:41:03.209940 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
13:41:03.233165 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
13:41:03.239598 [debug] [Thread-1  ]: finished collecting timing info
13:41:03.244402 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
13:41:03.317122 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
13:41:03.319897 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
13:41:03.322243 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:41:03.328558 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:41:03.353653 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
13:41:03.359958 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
13:41:03.362231 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'trends'->0->'trends')::jsonb as trends,
       (data->'trends'->0->>'as_of')::timestamp as trends_as_of
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume,
        trends_as_of
    FROM renamed
)

SELECT * FROM final
  );
13:41:03.372719 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:41:03.382640 [debug] [Thread-1  ]: finished collecting timing info
13:41:03.385004 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
13:41:03.388188 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f70a786a-374e-4440-8c98-3abe6a6cbf47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d81a90>]}
13:41:03.391647 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.18s]
13:41:03.394649 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
13:41:03.397203 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
13:41:03.400061 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
13:41:03.403821 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
13:41:03.406397 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
13:41:03.408761 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
13:41:03.427896 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
13:41:03.434742 [debug] [Thread-1  ]: finished collecting timing info
13:41:03.437371 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
13:41:03.455882 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
13:41:03.458458 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
13:41:03.460771 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:41:03.466963 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:41:03.476407 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
13:41:03.482788 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
13:41:03.485075 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
13:41:03.494388 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:41:03.503781 [debug] [Thread-1  ]: finished collecting timing info
13:41:03.506342 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
13:41:03.509600 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f70a786a-374e-4440-8c98-3abe6a6cbf47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d74be0>]}
13:41:03.512783 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.11s]
13:41:03.515783 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
13:41:03.520991 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
13:41:03.524435 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
13:41:03.527964 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
13:41:03.530545 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
13:41:03.532721 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
13:41:03.552860 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
13:41:03.559526 [debug] [Thread-1  ]: finished collecting timing info
13:41:03.562084 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
13:41:03.614085 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
13:41:03.616685 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
13:41:03.618691 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:41:03.625633 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:41:03.641833 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
13:41:03.647891 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
13:41:03.650319 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


SELECT tt.location_name, tt.location_country, tt.trend_name, tt.trend_volume, tt.trend_as_of as trend_date,
       wc.lat as location_latitude, wc.lng as location_longiture
FROM "materialize"."public"."stg_twitter_trending" tt
JOIN "materialize"."public"."stg_worldcities" wc ON tt.location_name = wc.city AND tt.location_country = wc.country
WHERE tt.trend_volume > 0
  );
13:41:03.655011 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "tt.trend_as_of" does not exist

13:41:03.657873 [debug] [Thread-1  ]: finished collecting timing info
13:41:03.660114 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
13:41:03.663556 [debug] [Thread-1  ]: Database Error in model fct_twitter_trending (models/twitter_trending/marts/twitter/fct_twitter_trending.sql)
  column "tt.trend_as_of" does not exist
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/marts/twitter/fct_twitter_trending.sql
13:41:03.666740 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f70a786a-374e-4440-8c98-3abe6a6cbf47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f4f7c0>]}
13:41:03.669972 [error] [Thread-1  ]: 5 of 5 ERROR creating materializedview model public.fct_twitter_trending........ [[31mERROR[0m in 0.14s]
13:41:03.673170 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
13:41:03.679599 [debug] [MainThread]: Acquiring new materialize connection "master"
13:41:03.682049 [debug] [MainThread]: Using materialize connection "master"
13:41:03.684273 [debug] [MainThread]: On master: BEGIN
13:41:03.686345 [debug] [MainThread]: Opening a new connection, currently in state closed
13:41:03.692206 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:41:03.696100 [debug] [MainThread]: Using materialize connection "master"
13:41:03.698599 [debug] [MainThread]: On master: COMMIT
13:41:03.701663 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:41:03.704244 [debug] [MainThread]: On master: Close
13:41:03.708147 [info ] [MainThread]: 
13:41:03.711159 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.18s.
13:41:03.713956 [debug] [MainThread]: Connection 'master' was properly closed.
13:41:03.716334 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
13:41:03.759565 [info ] [MainThread]: 
13:41:03.762981 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
13:41:03.765816 [info ] [MainThread]: 
13:41:03.769455 [error] [MainThread]: [33mDatabase Error in model fct_twitter_trending (models/twitter_trending/marts/twitter/fct_twitter_trending.sql)[0m
13:41:03.772707 [error] [MainThread]:   column "tt.trend_as_of" does not exist
13:41:03.775107 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/marts/twitter/fct_twitter_trending.sql
13:41:03.777897 [info ] [MainThread]: 
13:41:03.780390 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
13:41:03.783705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f3c460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f533a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f531f0>]}


============================== 2022-02-23 13:43:17.873561 | 0a065fe6-b062-4b63-802d-afc218b3cba1 ==============================
13:43:17.873561 [info ] [MainThread]: Running with dbt=1.0.1
13:43:17.881276 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:43:17.884343 [debug] [MainThread]: Tracking: tracking
13:43:17.914343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aad60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aadf0>]}
13:43:18.237974 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
13:43:18.243578 [debug] [MainThread]: Partial parsing: update schema file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter.yml
13:43:18.246922 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
13:43:18.351443 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
13:43:18.526678 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

13:43:18.563811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a065fe6-b062-4b63-802d-afc218b3cba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c250d0>]}
13:43:18.611636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a065fe6-b062-4b63-802d-afc218b3cba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007393a90>]}
13:43:18.614468 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
13:43:18.622699 [info ] [MainThread]: 
13:43:18.626459 [debug] [MainThread]: Acquiring new materialize connection "master"
13:43:18.638500 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
13:43:18.708050 [debug] [ThreadPool]: Using materialize connection "list_materialize"
13:43:18.711068 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
13:43:18.713517 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:43:18.744313 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
13:43:18.754524 [debug] [ThreadPool]: On list_materialize: Close
13:43:18.763747 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
13:43:18.787132 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
13:43:18.789823 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
13:43:18.792008 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:43:18.799740 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
13:43:18.809048 [debug] [ThreadPool]: On list_materialize_public: Close
13:43:18.815193 [debug] [MainThread]: Using materialize connection "master"
13:43:18.817710 [debug] [MainThread]: On master: BEGIN
13:43:18.819750 [debug] [MainThread]: Opening a new connection, currently in state init
13:43:18.825069 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:43:18.827707 [debug] [MainThread]: Using materialize connection "master"
13:43:18.830182 [debug] [MainThread]: On master: COMMIT
13:43:18.833149 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:43:18.835370 [debug] [MainThread]: On master: Close
13:43:18.838349 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:43:18.840914 [info ] [MainThread]: 
13:43:18.858673 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
13:43:18.863371 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
13:43:18.868188 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
13:43:18.871912 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
13:43:18.875247 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
13:43:18.905594 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
13:43:18.913318 [debug] [Thread-1  ]: finished collecting timing info
13:43:18.915867 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
13:43:18.971330 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
13:43:18.974486 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
13:43:18.977087 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:43:18.987917 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
13:43:19.026169 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
13:43:19.033597 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
13:43:19.035839 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
13:43:19.046447 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
13:43:19.098969 [debug] [Thread-1  ]: finished collecting timing info
13:43:19.101818 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
13:43:19.105552 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a065fe6-b062-4b63-802d-afc218b3cba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073908e0>]}
13:43:19.109546 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.24s]
13:43:19.114356 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
13:43:19.116813 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
13:43:19.119673 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
13:43:19.125118 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
13:43:19.127707 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
13:43:19.132850 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
13:43:19.157230 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
13:43:19.163695 [debug] [Thread-1  ]: finished collecting timing info
13:43:19.166320 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
13:43:19.177128 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
13:43:19.179452 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
13:43:19.181732 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:43:19.190754 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
13:43:19.200446 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
13:43:19.207075 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
13:43:19.209174 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
13:43:19.219343 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
13:43:19.230568 [debug] [Thread-1  ]: finished collecting timing info
13:43:19.233429 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
13:43:19.236687 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a065fe6-b062-4b63-802d-afc218b3cba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c4dd00>]}
13:43:19.239830 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.11s]
13:43:19.242652 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
13:43:19.245396 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
13:43:19.248825 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
13:43:19.252592 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
13:43:19.255265 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
13:43:19.257630 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
13:43:19.276337 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
13:43:19.284355 [debug] [Thread-1  ]: finished collecting timing info
13:43:19.287153 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
13:43:19.357835 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
13:43:19.360691 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
13:43:19.363021 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:43:19.368914 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:43:19.395010 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
13:43:19.402309 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
13:43:19.404391 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'trends'->0->'trends')::jsonb as trends,
       (data->'trends'->0->>'as_of')::timestamp as trend_as_of
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume,
        trend_as_of
    FROM renamed
)

SELECT * FROM final
  );
13:43:19.414336 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:43:19.424021 [debug] [Thread-1  ]: finished collecting timing info
13:43:19.426253 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
13:43:19.429500 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a065fe6-b062-4b63-802d-afc218b3cba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c4eca0>]}
13:43:19.433655 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.18s]
13:43:19.436831 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
13:43:19.438997 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
13:43:19.441744 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
13:43:19.445373 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
13:43:19.447471 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
13:43:19.449570 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
13:43:19.468286 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
13:43:19.475221 [debug] [Thread-1  ]: finished collecting timing info
13:43:19.477473 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
13:43:19.493585 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
13:43:19.496255 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
13:43:19.498282 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:43:19.504478 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:43:19.513938 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
13:43:19.520176 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
13:43:19.522266 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
13:43:19.529826 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:43:19.539917 [debug] [Thread-1  ]: finished collecting timing info
13:43:19.542580 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
13:43:19.546233 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a065fe6-b062-4b63-802d-afc218b3cba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d74eb0>]}
13:43:19.549820 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.10s]
13:43:19.552709 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
13:43:19.557623 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
13:43:19.563279 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
13:43:19.567565 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
13:43:19.570246 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
13:43:19.572663 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
13:43:19.591973 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
13:43:19.600136 [debug] [Thread-1  ]: finished collecting timing info
13:43:19.602598 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
13:43:19.651904 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
13:43:19.655281 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
13:43:19.658842 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:43:19.665869 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
13:43:19.681458 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
13:43:19.688527 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
13:43:19.690614 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


SELECT tt.location_name, tt.location_country, tt.trend_name, tt.trend_volume, tt.trend_as_of as trend_date,
       wc.lat as location_latitude, wc.lng as location_longiture
FROM "materialize"."public"."stg_twitter_trending" tt
JOIN "materialize"."public"."stg_worldcities" wc ON tt.location_name = wc.city AND tt.location_country = wc.country
WHERE tt.trend_volume > 0
  );
13:43:19.701663 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:43:19.714153 [debug] [Thread-1  ]: finished collecting timing info
13:43:19.716785 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
13:43:19.720910 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a065fe6-b062-4b63-802d-afc218b3cba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f2cf70>]}
13:43:19.724445 [info ] [Thread-1  ]: 5 of 5 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.15s]
13:43:19.727967 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
13:43:19.733658 [debug] [MainThread]: Acquiring new materialize connection "master"
13:43:19.736756 [debug] [MainThread]: Using materialize connection "master"
13:43:19.739459 [debug] [MainThread]: On master: BEGIN
13:43:19.742085 [debug] [MainThread]: Opening a new connection, currently in state closed
13:43:19.747677 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:43:19.750561 [debug] [MainThread]: Using materialize connection "master"
13:43:19.752777 [debug] [MainThread]: On master: COMMIT
13:43:19.756337 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:43:19.758984 [debug] [MainThread]: On master: Close
13:43:19.762634 [info ] [MainThread]: 
13:43:19.765921 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.14s.
13:43:19.768912 [debug] [MainThread]: Connection 'master' was properly closed.
13:43:19.771240 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
13:43:19.810525 [info ] [MainThread]: 
13:43:19.813785 [info ] [MainThread]: [32mCompleted successfully[0m
13:43:19.817296 [info ] [MainThread]: 
13:43:19.819983 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
13:43:19.823117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007390a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ef26a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f50e20>]}


============================== 2022-02-23 14:01:08.726821 | 3b4600ca-6c44-474a-924c-e270e9e2137b ==============================
14:01:08.726821 [info ] [MainThread]: Running with dbt=1.0.1
14:01:08.733655 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:01:08.737103 [debug] [MainThread]: Tracking: tracking
14:01:08.765509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acdf0>]}
14:01:09.134654 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
14:01:09.139723 [debug] [MainThread]: Partial parsing: update schema file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter.yml
14:01:09.143117 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:01:09.145871 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_worldcities.sql
14:01:09.250193 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_worldcities.sql
14:01:09.339627 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
14:01:09.471109 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

14:01:09.509752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b4600ca-6c44-474a-924c-e270e9e2137b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2d0d0>]}
14:01:09.564446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b4600ca-6c44-474a-924c-e270e9e2137b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007311e50>]}
14:01:09.567747 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:01:09.577090 [info ] [MainThread]: 
14:01:09.583481 [debug] [MainThread]: Acquiring new materialize connection "master"
14:01:09.594170 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
14:01:09.663374 [debug] [ThreadPool]: Using materialize connection "list_materialize"
14:01:09.666153 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
14:01:09.669130 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:01:09.706327 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.04 seconds
14:01:09.717048 [debug] [ThreadPool]: On list_materialize: Close
14:01:09.727078 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
14:01:09.750799 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
14:01:09.754643 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
14:01:09.757007 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:01:09.764235 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
14:01:09.773807 [debug] [ThreadPool]: On list_materialize_public: Close
14:01:09.781214 [debug] [MainThread]: Using materialize connection "master"
14:01:09.783625 [debug] [MainThread]: On master: BEGIN
14:01:09.785653 [debug] [MainThread]: Opening a new connection, currently in state init
14:01:09.792352 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:01:09.795021 [debug] [MainThread]: Using materialize connection "master"
14:01:09.797479 [debug] [MainThread]: On master: COMMIT
14:01:09.800448 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:01:09.802452 [debug] [MainThread]: On master: Close
14:01:09.805569 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:01:09.808951 [info ] [MainThread]: 
14:01:09.827822 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
14:01:09.831726 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
14:01:09.836052 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
14:01:09.839533 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
14:01:09.842496 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
14:01:09.876757 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
14:01:09.890034 [debug] [Thread-1  ]: finished collecting timing info
14:01:09.893139 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
14:01:09.956038 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:01:09.959260 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
14:01:09.961715 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:09.973000 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:01:10.014010 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
14:01:10.025095 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:01:10.027231 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
14:01:10.038226 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:01:10.090182 [debug] [Thread-1  ]: finished collecting timing info
14:01:10.093103 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
14:01:10.096912 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b4600ca-6c44-474a-924c-e270e9e2137b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049dc7fd0>]}
14:01:10.100666 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.26s]
14:01:10.104172 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
14:01:10.106825 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
14:01:10.109438 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
14:01:10.112748 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
14:01:10.115119 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
14:01:10.117693 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
14:01:10.140182 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
14:01:10.147898 [debug] [Thread-1  ]: finished collecting timing info
14:01:10.150543 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
14:01:10.160987 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:01:10.164144 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
14:01:10.166600 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:10.176395 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:01:10.185892 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
14:01:10.192488 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:01:10.194909 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
14:01:10.205118 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:01:10.214913 [debug] [Thread-1  ]: finished collecting timing info
14:01:10.217172 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
14:01:10.220619 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b4600ca-6c44-474a-924c-e270e9e2137b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d59940>]}
14:01:10.224041 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.11s]
14:01:10.227059 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
14:01:10.229168 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
14:01:10.231747 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
14:01:10.235237 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
14:01:10.237479 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
14:01:10.239755 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
14:01:10.259747 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
14:01:10.267137 [debug] [Thread-1  ]: finished collecting timing info
14:01:10.269618 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
14:01:10.340787 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:01:10.343658 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
14:01:10.345850 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:10.352461 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:01:10.378656 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
14:01:10.386885 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:01:10.389262 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'trends'->0->'trends')::jsonb as trends,
       (data->'trends'->0->>'as_of')::timestamp as trend_as_of
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume,
        trend_as_of
    FROM renamed
)

SELECT * FROM final
  );
14:01:10.399713 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:01:10.409353 [debug] [Thread-1  ]: finished collecting timing info
14:01:10.411852 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
14:01:10.415245 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b4600ca-6c44-474a-924c-e270e9e2137b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d7d610>]}
14:01:10.418621 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.18s]
14:01:10.422180 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
14:01:10.425136 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
14:01:10.427773 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
14:01:10.431375 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
14:01:10.433544 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
14:01:10.435770 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
14:01:10.453654 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
14:01:10.462958 [debug] [Thread-1  ]: finished collecting timing info
14:01:10.466260 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
14:01:10.482857 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:01:10.485153 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
14:01:10.487466 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:10.493560 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:01:10.505722 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
14:01:10.511580 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:01:10.513688 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

WITH converted AS (
    SELECT
        city::string AS city,
        country::string AS country,
        lat::float AS latitude,
        lng:float AS longitude
)

SELECT * FROM converted
  );
14:01:10.517374 [debug] [Thread-1  ]: Postgres adapter: Postgres error: Expected SELECT, VALUES, or a subquery in the query body, found WITH
LINE 11: WITH converted AS (
         ^

14:01:10.519835 [debug] [Thread-1  ]: finished collecting timing info
14:01:10.521906 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
14:01:10.524802 [debug] [Thread-1  ]: Database Error in model stg_worldcities (models/twitter_trending/staging/twitter/stg_worldcities.sql)
  Expected SELECT, VALUES, or a subquery in the query body, found WITH
  LINE 11: WITH converted AS (
           ^
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_worldcities.sql
14:01:10.528056 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b4600ca-6c44-474a-924c-e270e9e2137b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e29610>]}
14:01:10.531950 [error] [Thread-1  ]: 4 of 5 ERROR creating view model public.stg_worldcities......................... [[31mERROR[0m in 0.10s]
14:01:10.535155 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
14:01:10.541025 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
14:01:10.544206 [info ] [Thread-1  ]: 5 of 5 SKIP relation public.fct_twitter_trending................................ [[33mSKIP[0m]
14:01:10.547771 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
14:01:10.554070 [debug] [MainThread]: Acquiring new materialize connection "master"
14:01:10.557058 [debug] [MainThread]: Using materialize connection "master"
14:01:10.559716 [debug] [MainThread]: On master: BEGIN
14:01:10.562052 [debug] [MainThread]: Opening a new connection, currently in state closed
14:01:10.568194 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:01:10.571203 [debug] [MainThread]: Using materialize connection "master"
14:01:10.573635 [debug] [MainThread]: On master: COMMIT
14:01:10.576395 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:01:10.578861 [debug] [MainThread]: On master: Close
14:01:10.582721 [info ] [MainThread]: 
14:01:10.585580 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.00s.
14:01:10.588506 [debug] [MainThread]: Connection 'master' was properly closed.
14:01:10.590661 [debug] [MainThread]: Connection 'model.mz_hack_day.stg_worldcities' was properly closed.
14:01:10.628296 [info ] [MainThread]: 
14:01:10.631050 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:01:10.633680 [info ] [MainThread]: 
14:01:10.636173 [error] [MainThread]: [33mDatabase Error in model stg_worldcities (models/twitter_trending/staging/twitter/stg_worldcities.sql)[0m
14:01:10.638902 [error] [MainThread]:   Expected SELECT, VALUES, or a subquery in the query body, found WITH
14:01:10.641670 [error] [MainThread]:   LINE 11: WITH converted AS (
14:01:10.643961 [error] [MainThread]:            ^
14:01:10.646627 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_worldcities.sql
14:01:10.651988 [info ] [MainThread]: 
14:01:10.655495 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
14:01:10.658801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d7d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d7d1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e23520>]}


============================== 2022-02-23 14:01:37.413871 | dc4a2eaa-908f-46aa-9b81-cba2f6608932 ==============================
14:01:37.413871 [info ] [MainThread]: Running with dbt=1.0.1
14:01:37.421036 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:01:37.424226 [debug] [MainThread]: Tracking: tracking
14:01:37.453740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace20>]}
14:01:37.795020 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:01:37.799372 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_worldcities.sql
14:01:37.905520 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_worldcities.sql
14:01:38.081929 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

14:01:38.126771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc4a2eaa-908f-46aa-9b81-cba2f6608932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c23f40>]}
14:01:38.180024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc4a2eaa-908f-46aa-9b81-cba2f6608932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007321850>]}
14:01:38.184037 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:01:38.195286 [info ] [MainThread]: 
14:01:38.199994 [debug] [MainThread]: Acquiring new materialize connection "master"
14:01:38.209938 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
14:01:38.279966 [debug] [ThreadPool]: Using materialize connection "list_materialize"
14:01:38.282733 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
14:01:38.285002 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:01:38.318572 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
14:01:38.329194 [debug] [ThreadPool]: On list_materialize: Close
14:01:38.339686 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
14:01:38.362598 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
14:01:38.365532 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
14:01:38.367597 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:01:38.375623 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
14:01:38.384992 [debug] [ThreadPool]: On list_materialize_public: Close
14:01:38.392354 [debug] [MainThread]: Using materialize connection "master"
14:01:38.395170 [debug] [MainThread]: On master: BEGIN
14:01:38.396952 [debug] [MainThread]: Opening a new connection, currently in state init
14:01:38.402779 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:01:38.405746 [debug] [MainThread]: Using materialize connection "master"
14:01:38.408040 [debug] [MainThread]: On master: COMMIT
14:01:38.413050 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:01:38.415842 [debug] [MainThread]: On master: Close
14:01:38.419041 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:01:38.421970 [info ] [MainThread]: 
14:01:38.444753 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
14:01:38.448729 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
14:01:38.453214 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
14:01:38.456591 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
14:01:38.459050 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
14:01:38.490506 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
14:01:38.498994 [debug] [Thread-1  ]: finished collecting timing info
14:01:38.502054 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
14:01:38.562025 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:01:38.565341 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
14:01:38.568026 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:38.579029 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:01:38.619860 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
14:01:38.626796 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:01:38.628925 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
14:01:38.649844 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.02 seconds
14:01:38.699594 [debug] [Thread-1  ]: finished collecting timing info
14:01:38.703050 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
14:01:38.707250 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc4a2eaa-908f-46aa-9b81-cba2f6608932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ec2fa0>]}
14:01:38.710889 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.25s]
14:01:38.714657 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
14:01:38.717187 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
14:01:38.719865 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
14:01:38.725933 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
14:01:38.728355 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
14:01:38.731783 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
14:01:38.755962 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
14:01:38.762741 [debug] [Thread-1  ]: finished collecting timing info
14:01:38.765100 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
14:01:38.776002 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:01:38.778503 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
14:01:38.780590 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:38.790472 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:01:38.798710 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
14:01:38.805230 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:01:38.808351 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
14:01:38.818606 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:01:38.828877 [debug] [Thread-1  ]: finished collecting timing info
14:01:38.831661 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
14:01:38.836472 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc4a2eaa-908f-46aa-9b81-cba2f6608932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072a5b80>]}
14:01:38.839839 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.11s]
14:01:38.842964 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
14:01:38.845602 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
14:01:38.848531 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
14:01:38.852557 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
14:01:38.854892 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
14:01:38.857590 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
14:01:38.877608 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
14:01:38.884034 [debug] [Thread-1  ]: finished collecting timing info
14:01:38.886755 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
14:01:38.957372 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:01:38.960909 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
14:01:38.963124 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:38.969327 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:01:38.995994 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
14:01:39.004684 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:01:39.007600 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'trends'->0->'trends')::jsonb as trends,
       (data->'trends'->0->>'as_of')::timestamp as trend_as_of
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume,
        trend_as_of
    FROM renamed
)

SELECT * FROM final
  );
14:01:39.021326 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:01:39.032357 [debug] [Thread-1  ]: finished collecting timing info
14:01:39.035198 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
14:01:39.039111 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc4a2eaa-908f-46aa-9b81-cba2f6608932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d80af0>]}
14:01:39.042944 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.19s]
14:01:39.046881 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
14:01:39.050500 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
14:01:39.053841 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
14:01:39.057317 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
14:01:39.059978 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
14:01:39.062595 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
14:01:39.081806 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
14:01:39.088856 [debug] [Thread-1  ]: finished collecting timing info
14:01:39.091728 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
14:01:39.109609 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:01:39.112716 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
14:01:39.115804 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:39.123157 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:01:39.133293 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
14:01:39.139639 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:01:39.141914 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
),

converted AS (
    SELECT
        city::string AS city,
        country::string AS country,
        lat::float AS latitude,
        lng:float AS longitude
)

SELECT * FROM converted
  );
14:01:39.146146 [debug] [Thread-1  ]: Postgres adapter: Postgres error: Expected right parenthesis, found colon
LINE 16:         lng:float AS longitude
                    ^

14:01:39.149171 [debug] [Thread-1  ]: finished collecting timing info
14:01:39.151580 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
14:01:39.154853 [debug] [Thread-1  ]: Database Error in model stg_worldcities (models/twitter_trending/staging/twitter/stg_worldcities.sql)
  Expected right parenthesis, found colon
  LINE 16:         lng:float AS longitude
                      ^
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_worldcities.sql
14:01:39.158314 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc4a2eaa-908f-46aa-9b81-cba2f6608932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f27490>]}
14:01:39.161921 [error] [Thread-1  ]: 4 of 5 ERROR creating view model public.stg_worldcities......................... [[31mERROR[0m in 0.10s]
14:01:39.164881 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
14:01:39.170818 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
14:01:39.173270 [info ] [Thread-1  ]: 5 of 5 SKIP relation public.fct_twitter_trending................................ [[33mSKIP[0m]
14:01:39.177744 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
14:01:39.184519 [debug] [MainThread]: Acquiring new materialize connection "master"
14:01:39.188067 [debug] [MainThread]: Using materialize connection "master"
14:01:39.190736 [debug] [MainThread]: On master: BEGIN
14:01:39.192870 [debug] [MainThread]: Opening a new connection, currently in state closed
14:01:39.201545 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:01:39.205514 [debug] [MainThread]: Using materialize connection "master"
14:01:39.209040 [debug] [MainThread]: On master: COMMIT
14:01:39.215383 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:01:39.218079 [debug] [MainThread]: On master: Close
14:01:39.222758 [info ] [MainThread]: 
14:01:39.226657 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.02s.
14:01:39.229758 [debug] [MainThread]: Connection 'master' was properly closed.
14:01:39.232799 [debug] [MainThread]: Connection 'model.mz_hack_day.stg_worldcities' was properly closed.
14:01:39.274704 [info ] [MainThread]: 
14:01:39.277625 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:01:39.280281 [info ] [MainThread]: 
14:01:39.282742 [error] [MainThread]: [33mDatabase Error in model stg_worldcities (models/twitter_trending/staging/twitter/stg_worldcities.sql)[0m
14:01:39.285440 [error] [MainThread]:   Expected right parenthesis, found colon
14:01:39.288282 [error] [MainThread]:   LINE 16:         lng:float AS longitude
14:01:39.293252 [error] [MainThread]:                       ^
14:01:39.296642 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_worldcities.sql
14:01:39.299273 [info ] [MainThread]: 
14:01:39.302619 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
14:01:39.307180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c45b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d60d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f21e80>]}


============================== 2022-02-23 14:02:17.099034 | 54cd349d-86c2-48cd-8eef-2b36e21c9c55 ==============================
14:02:17.099034 [info ] [MainThread]: Running with dbt=1.0.1
14:02:17.105734 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:02:17.108380 [debug] [MainThread]: Tracking: tracking
14:02:17.137692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072add90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ade80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ade20>]}
14:02:17.470656 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:02:17.475372 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_worldcities.sql
14:02:17.584118 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_worldcities.sql
14:02:17.765580 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

14:02:17.804489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54cd349d-86c2-48cd-8eef-2b36e21c9c55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c27f40>]}
14:02:17.854441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54cd349d-86c2-48cd-8eef-2b36e21c9c55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007321850>]}
14:02:17.857577 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:02:17.867018 [info ] [MainThread]: 
14:02:17.870896 [debug] [MainThread]: Acquiring new materialize connection "master"
14:02:17.883394 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
14:02:17.955164 [debug] [ThreadPool]: Using materialize connection "list_materialize"
14:02:17.958888 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
14:02:17.964521 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:02:18.007484 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.04 seconds
14:02:18.019227 [debug] [ThreadPool]: On list_materialize: Close
14:02:18.031958 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
14:02:18.058386 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
14:02:18.061611 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
14:02:18.064137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:02:18.080666 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.02 seconds
14:02:18.091039 [debug] [ThreadPool]: On list_materialize_public: Close
14:02:18.098155 [debug] [MainThread]: Using materialize connection "master"
14:02:18.101114 [debug] [MainThread]: On master: BEGIN
14:02:18.103384 [debug] [MainThread]: Opening a new connection, currently in state init
14:02:18.109679 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:02:18.112589 [debug] [MainThread]: Using materialize connection "master"
14:02:18.114675 [debug] [MainThread]: On master: COMMIT
14:02:18.118154 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:02:18.120803 [debug] [MainThread]: On master: Close
14:02:18.123907 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:02:18.126904 [info ] [MainThread]: 
14:02:18.150797 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
14:02:18.154800 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
14:02:18.159112 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
14:02:18.161598 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
14:02:18.163651 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
14:02:18.195611 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
14:02:18.201944 [debug] [Thread-1  ]: finished collecting timing info
14:02:18.204488 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
14:02:18.262173 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:02:18.264889 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
14:02:18.267339 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:02:18.278831 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:02:18.320619 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
14:02:18.327848 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:02:18.330115 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
14:02:18.344622 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:02:18.398922 [debug] [Thread-1  ]: finished collecting timing info
14:02:18.403800 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
14:02:18.408581 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54cd349d-86c2-48cd-8eef-2b36e21c9c55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ec3fa0>]}
14:02:18.412137 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.25s]
14:02:18.415383 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
14:02:18.417771 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
14:02:18.420521 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
14:02:18.424079 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
14:02:18.426628 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
14:02:18.428671 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
14:02:18.451988 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
14:02:18.459384 [debug] [Thread-1  ]: finished collecting timing info
14:02:18.462167 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
14:02:18.473091 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:02:18.475789 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
14:02:18.477863 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:02:18.489088 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:02:18.497996 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
14:02:18.504579 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:02:18.506957 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
14:02:18.516171 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:02:18.526547 [debug] [Thread-1  ]: finished collecting timing info
14:02:18.528971 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
14:02:18.532568 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54cd349d-86c2-48cd-8eef-2b36e21c9c55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073a4c40>]}
14:02:18.536450 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.11s]
14:02:18.539481 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
14:02:18.542221 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
14:02:18.545715 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
14:02:18.549446 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
14:02:18.551855 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
14:02:18.553902 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
14:02:18.573591 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
14:02:18.581520 [debug] [Thread-1  ]: finished collecting timing info
14:02:18.584743 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
14:02:18.655052 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:02:18.657867 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
14:02:18.660143 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:02:18.667067 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:02:18.694034 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
14:02:18.701065 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:02:18.703450 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'trends'->0->'trends')::jsonb as trends,
       (data->'trends'->0->>'as_of')::timestamp as trend_as_of
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume,
        trend_as_of
    FROM renamed
)

SELECT * FROM final
  );
14:02:18.713699 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:02:18.723647 [debug] [Thread-1  ]: finished collecting timing info
14:02:18.726039 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
14:02:18.729635 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54cd349d-86c2-48cd-8eef-2b36e21c9c55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d93af0>]}
14:02:18.733940 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.18s]
14:02:18.736977 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
14:02:18.739772 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
14:02:18.742672 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
14:02:18.746593 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
14:02:18.749906 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
14:02:18.752529 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
14:02:18.772949 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
14:02:18.779694 [debug] [Thread-1  ]: finished collecting timing info
14:02:18.782679 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
14:02:18.800563 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:02:18.803545 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
14:02:18.806426 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:02:18.814368 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:02:18.824002 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
14:02:18.830412 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:02:18.832907 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
),

converted AS (
    SELECT
        city::string AS city,
        country::string AS country,
        lat::float AS latitude,
        lng::float AS longitude
)

SELECT * FROM converted
  );
14:02:18.836621 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "city" does not exist

14:02:18.839552 [debug] [Thread-1  ]: finished collecting timing info
14:02:18.841828 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
14:02:18.845425 [debug] [Thread-1  ]: Database Error in model stg_worldcities (models/twitter_trending/staging/twitter/stg_worldcities.sql)
  column "city" does not exist
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_worldcities.sql
14:02:18.848556 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54cd349d-86c2-48cd-8eef-2b36e21c9c55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f27490>]}
14:02:18.851777 [error] [Thread-1  ]: 4 of 5 ERROR creating view model public.stg_worldcities......................... [[31mERROR[0m in 0.10s]
14:02:18.854998 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
14:02:18.860714 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
14:02:18.863462 [info ] [Thread-1  ]: 5 of 5 SKIP relation public.fct_twitter_trending................................ [[33mSKIP[0m]
14:02:18.866318 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
14:02:18.871963 [debug] [MainThread]: Acquiring new materialize connection "master"
14:02:18.874717 [debug] [MainThread]: Using materialize connection "master"
14:02:18.876688 [debug] [MainThread]: On master: BEGIN
14:02:18.878836 [debug] [MainThread]: Opening a new connection, currently in state closed
14:02:18.894288 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
14:02:18.897684 [debug] [MainThread]: Using materialize connection "master"
14:02:18.899682 [debug] [MainThread]: On master: COMMIT
14:02:18.902472 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:02:18.904729 [debug] [MainThread]: On master: Close
14:02:18.908666 [info ] [MainThread]: 
14:02:18.912040 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.04s.
14:02:18.914875 [debug] [MainThread]: Connection 'master' was properly closed.
14:02:18.917055 [debug] [MainThread]: Connection 'model.mz_hack_day.stg_worldcities' was properly closed.
14:02:18.956863 [info ] [MainThread]: 
14:02:18.960099 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:02:18.963452 [info ] [MainThread]: 
14:02:18.966076 [error] [MainThread]: [33mDatabase Error in model stg_worldcities (models/twitter_trending/staging/twitter/stg_worldcities.sql)[0m
14:02:18.969870 [error] [MainThread]:   column "city" does not exist
14:02:18.973259 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_worldcities.sql
14:02:18.976060 [info ] [MainThread]: 
14:02:18.978757 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
14:02:18.983419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c43190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5fd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f20e20>]}


============================== 2022-02-23 14:05:17.534173 | 2cddcb5d-a7c7-44cf-8f3c-2d17ed629e66 ==============================
14:05:17.534173 [info ] [MainThread]: Running with dbt=1.0.1
14:05:17.541506 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:05:17.544719 [debug] [MainThread]: Tracking: tracking
14:05:17.576722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd90>]}
14:05:17.904715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
14:05:17.909044 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:05:17.912265 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_worldcities.sql
14:05:18.016380 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
14:05:18.100433 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_worldcities.sql
14:05:18.233252 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

14:05:18.270598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cddcb5d-a7c7-44cf-8f3c-2d17ed629e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2a0d0>]}
14:05:18.319407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cddcb5d-a7c7-44cf-8f3c-2d17ed629e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400731f9a0>]}
14:05:18.322559 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:05:18.331670 [info ] [MainThread]: 
14:05:18.336065 [debug] [MainThread]: Acquiring new materialize connection "master"
14:05:18.350188 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
14:05:18.418878 [debug] [ThreadPool]: Using materialize connection "list_materialize"
14:05:18.421910 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
14:05:18.424412 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:05:18.454116 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
14:05:18.465229 [debug] [ThreadPool]: On list_materialize: Close
14:05:18.475481 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
14:05:18.499236 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
14:05:18.502327 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
14:05:18.505421 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:05:18.513633 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
14:05:18.524678 [debug] [ThreadPool]: On list_materialize_public: Close
14:05:18.531896 [debug] [MainThread]: Using materialize connection "master"
14:05:18.534617 [debug] [MainThread]: On master: BEGIN
14:05:18.536865 [debug] [MainThread]: Opening a new connection, currently in state init
14:05:18.542566 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:05:18.545392 [debug] [MainThread]: Using materialize connection "master"
14:05:18.547450 [debug] [MainThread]: On master: COMMIT
14:05:18.550518 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:05:18.552832 [debug] [MainThread]: On master: Close
14:05:18.556244 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:05:18.558922 [info ] [MainThread]: 
14:05:18.577917 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
14:05:18.582379 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
14:05:18.586972 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
14:05:18.590183 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
14:05:18.592504 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
14:05:18.631180 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
14:05:18.637691 [debug] [Thread-1  ]: finished collecting timing info
14:05:18.640469 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
14:05:18.697267 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:05:18.700601 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
14:05:18.703271 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:05:18.713709 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:05:18.753092 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
14:05:18.759291 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:05:18.761482 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
14:05:18.774064 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:05:18.822514 [debug] [Thread-1  ]: finished collecting timing info
14:05:18.825728 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
14:05:18.829399 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cddcb5d-a7c7-44cf-8f3c-2d17ed629e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ec4dc0>]}
14:05:18.833252 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.24s]
14:05:18.836963 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
14:05:18.839445 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
14:05:18.842208 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
14:05:18.845872 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
14:05:18.848079 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
14:05:18.851729 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
14:05:18.873812 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
14:05:18.879889 [debug] [Thread-1  ]: finished collecting timing info
14:05:18.881888 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
14:05:18.892078 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:05:18.894306 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
14:05:18.896333 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:05:18.905476 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:05:18.914257 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
14:05:18.920577 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:05:18.923736 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
14:05:18.933323 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:05:18.942801 [debug] [Thread-1  ]: finished collecting timing info
14:05:18.945131 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
14:05:18.948437 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cddcb5d-a7c7-44cf-8f3c-2d17ed629e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c4d9a0>]}
14:05:18.951795 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.10s]
14:05:18.954829 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
14:05:18.957474 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
14:05:18.960191 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
14:05:18.963504 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
14:05:18.965682 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
14:05:18.970231 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
14:05:18.989105 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
14:05:18.994991 [debug] [Thread-1  ]: finished collecting timing info
14:05:18.997246 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
14:05:19.065853 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:05:19.068582 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
14:05:19.071289 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:05:19.077954 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:05:19.106060 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
14:05:19.113479 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:05:19.116001 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'trends'->0->'trends')::jsonb as trends,
       (data->'trends'->0->>'as_of')::timestamp as trend_as_of
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume,
        trend_as_of
    FROM renamed
)

SELECT * FROM final
  );
14:05:19.126052 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:05:19.136205 [debug] [Thread-1  ]: finished collecting timing info
14:05:19.139010 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
14:05:19.142696 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cddcb5d-a7c7-44cf-8f3c-2d17ed629e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d7a8b0>]}
14:05:19.145815 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.18s]
14:05:19.148743 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
14:05:19.151191 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
14:05:19.154633 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
14:05:19.158860 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
14:05:19.162269 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
14:05:19.166187 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
14:05:19.184000 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
14:05:19.191302 [debug] [Thread-1  ]: finished collecting timing info
14:05:19.193530 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
14:05:19.210699 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:05:19.213108 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
14:05:19.215644 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:05:19.222167 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:05:19.231390 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
14:05:19.237404 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:05:19.239686 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

-- converted AS (
--     SELECT
--         city::string AS city,
--         country::string AS country,
--         lat::float AS latitude,
--         lng::float AS longitude
-- )

SELECT * FROM source
  );
14:05:19.247981 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:05:19.257344 [debug] [Thread-1  ]: finished collecting timing info
14:05:19.260001 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
14:05:19.263725 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cddcb5d-a7c7-44cf-8f3c-2d17ed629e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d6ee50>]}
14:05:19.268118 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.11s]
14:05:19.271004 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
14:05:19.276524 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
14:05:19.279360 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
14:05:19.283344 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
14:05:19.285331 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
14:05:19.287219 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
14:05:19.307610 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
14:05:19.316053 [debug] [Thread-1  ]: finished collecting timing info
14:05:19.318425 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
14:05:19.367860 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:05:19.371044 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
14:05:19.373615 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:05:19.380426 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:05:19.396433 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
14:05:19.404413 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:05:19.407095 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


SELECT tt.location_name, tt.location_country, tt.trend_name, tt.trend_volume, tt.trend_as_of as trend_date,
       wc.lat::float as location_latitude, wc.lng::float as location_longiture
FROM "materialize"."public"."stg_twitter_trending" tt
JOIN "materialize"."public"."stg_worldcities" wc ON tt.location_name = wc.city AND tt.location_country = wc.country
WHERE tt.trend_volume > 0
# TODO: add temporal filter here if live
  );
14:05:19.410983 [debug] [Thread-1  ]: Postgres adapter: Postgres error: Expected right parenthesis, found colon
LINE 12: # TODO: add temporal filter here if live
               ^

14:05:19.413641 [debug] [Thread-1  ]: finished collecting timing info
14:05:19.416384 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
14:05:19.419470 [debug] [Thread-1  ]: Database Error in model fct_twitter_trending (models/twitter_trending/marts/twitter/fct_twitter_trending.sql)
  Expected right parenthesis, found colon
  LINE 12: # TODO: add temporal filter here if live
                 ^
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:05:19.422557 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cddcb5d-a7c7-44cf-8f3c-2d17ed629e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f515e0>]}
14:05:19.425877 [error] [Thread-1  ]: 5 of 5 ERROR creating materializedview model public.fct_twitter_trending........ [[31mERROR[0m in 0.14s]
14:05:19.428805 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
14:05:19.435021 [debug] [MainThread]: Acquiring new materialize connection "master"
14:05:19.437693 [debug] [MainThread]: Using materialize connection "master"
14:05:19.440201 [debug] [MainThread]: On master: BEGIN
14:05:19.442247 [debug] [MainThread]: Opening a new connection, currently in state closed
14:05:19.447920 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:05:19.450531 [debug] [MainThread]: Using materialize connection "master"
14:05:19.452732 [debug] [MainThread]: On master: COMMIT
14:05:19.456072 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:05:19.458531 [debug] [MainThread]: On master: Close
14:05:19.462500 [info ] [MainThread]: 
14:05:19.465392 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.13s.
14:05:19.468628 [debug] [MainThread]: Connection 'master' was properly closed.
14:05:19.471352 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
14:05:19.507796 [info ] [MainThread]: 
14:05:19.510555 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:05:19.513370 [info ] [MainThread]: 
14:05:19.516481 [error] [MainThread]: [33mDatabase Error in model fct_twitter_trending (models/twitter_trending/marts/twitter/fct_twitter_trending.sql)[0m
14:05:19.518740 [error] [MainThread]:   Expected right parenthesis, found colon
14:05:19.521131 [error] [MainThread]:   LINE 12: # TODO: add temporal filter here if live
14:05:19.523743 [error] [MainThread]:                  ^
14:05:19.526283 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:05:19.529110 [info ] [MainThread]: 
14:05:19.531595 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
14:05:19.535056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5ef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049eee640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f51550>]}


============================== 2022-02-23 14:05:48.471531 | bba25ded-5cfe-4632-921a-469f7aab8410 ==============================
14:05:48.471531 [info ] [MainThread]: Running with dbt=1.0.1
14:05:48.478143 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:05:48.480754 [debug] [MainThread]: Tracking: tracking
14:05:48.509151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abdf0>]}
14:05:48.849264 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
14:05:48.854591 [debug] [MainThread]: Partial parsing: update schema file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter.yml
14:05:48.857877 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:05:48.963815 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_worldcities.sql
14:05:49.053447 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
14:05:49.198953 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

14:05:49.238721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bba25ded-5cfe-4632-921a-469f7aab8410', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2c0d0>]}
14:05:49.296681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bba25ded-5cfe-4632-921a-469f7aab8410', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40073908e0>]}
14:05:49.300007 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:05:49.312094 [info ] [MainThread]: 
14:05:49.316505 [debug] [MainThread]: Acquiring new materialize connection "master"
14:05:49.327350 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
14:05:49.398734 [debug] [ThreadPool]: Using materialize connection "list_materialize"
14:05:49.402359 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
14:05:49.405153 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:05:49.432329 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
14:05:49.442738 [debug] [ThreadPool]: On list_materialize: Close
14:05:49.451947 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
14:05:49.474413 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
14:05:49.477327 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
14:05:49.479677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:05:49.486581 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
14:05:49.496004 [debug] [ThreadPool]: On list_materialize_public: Close
14:05:49.502469 [debug] [MainThread]: Using materialize connection "master"
14:05:49.505188 [debug] [MainThread]: On master: BEGIN
14:05:49.507456 [debug] [MainThread]: Opening a new connection, currently in state init
14:05:49.513939 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:05:49.516660 [debug] [MainThread]: Using materialize connection "master"
14:05:49.518854 [debug] [MainThread]: On master: COMMIT
14:05:49.521800 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:05:49.524190 [debug] [MainThread]: On master: Close
14:05:49.527689 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:05:49.530572 [info ] [MainThread]: 
14:05:49.546864 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
14:05:49.551404 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
14:05:49.555945 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
14:05:49.558974 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
14:05:49.562339 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
14:05:49.594181 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
14:05:49.600707 [debug] [Thread-1  ]: finished collecting timing info
14:05:49.602817 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
14:05:49.661037 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:05:49.664067 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
14:05:49.666473 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:05:49.677719 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:05:49.717150 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
14:05:49.724984 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:05:49.727404 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
14:05:49.738418 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:05:49.786920 [debug] [Thread-1  ]: finished collecting timing info
14:05:49.789707 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
14:05:49.794167 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bba25ded-5cfe-4632-921a-469f7aab8410', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049dc8f70>]}
14:05:49.797992 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.24s]
14:05:49.801629 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
14:05:49.803825 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
14:05:49.806813 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
14:05:49.810154 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
14:05:49.812517 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
14:05:49.814767 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
14:05:49.837156 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
14:05:49.843029 [debug] [Thread-1  ]: finished collecting timing info
14:05:49.845514 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
14:05:49.856629 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:05:49.859295 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
14:05:49.861465 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:05:49.871202 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:05:49.879548 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
14:05:49.885637 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:05:49.887781 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
14:05:49.897538 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:05:49.906637 [debug] [Thread-1  ]: finished collecting timing info
14:05:49.909033 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
14:05:49.912563 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bba25ded-5cfe-4632-921a-469f7aab8410', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d7bd90>]}
14:05:49.915974 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.10s]
14:05:49.918938 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
14:05:49.921022 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
14:05:49.924658 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
14:05:49.928440 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
14:05:49.930627 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
14:05:49.932909 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
14:05:49.951716 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
14:05:49.958104 [debug] [Thread-1  ]: finished collecting timing info
14:05:49.960772 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
14:05:50.030365 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:05:50.033672 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
14:05:50.035928 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:05:50.042883 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:05:50.068853 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
14:05:50.075263 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:05:50.077344 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'trends'->0->'trends')::jsonb as trends,
       (data->'trends'->0->>'as_of')::timestamp as trend_as_of
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume,
        trend_as_of
    FROM renamed
)

SELECT * FROM final
  );
14:05:50.086962 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:05:50.096622 [debug] [Thread-1  ]: finished collecting timing info
14:05:50.098626 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
14:05:50.102341 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bba25ded-5cfe-4632-921a-469f7aab8410', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049de7eb0>]}
14:05:50.106663 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.17s]
14:05:50.109804 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
14:05:50.112446 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
14:05:50.114823 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
14:05:50.118475 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
14:05:50.120611 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
14:05:50.122688 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
14:05:50.141101 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
14:05:50.148124 [debug] [Thread-1  ]: finished collecting timing info
14:05:50.150404 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
14:05:50.167707 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:05:50.170050 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
14:05:50.172018 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:05:50.178292 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:05:50.187823 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
14:05:50.193848 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:05:50.196281 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

-- converted AS (
--     SELECT
--         city::string AS city,
--         country::string AS country,
--         lat::float AS latitude,
--         lng::float AS longitude
-- )

SELECT * FROM source
  );
14:05:50.205280 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:05:50.215161 [debug] [Thread-1  ]: finished collecting timing info
14:05:50.217561 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
14:05:50.221167 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bba25ded-5cfe-4632-921a-469f7aab8410', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c4bd60>]}
14:05:50.224592 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.10s]
14:05:50.227481 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
14:05:50.233201 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
14:05:50.236028 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
14:05:50.239736 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
14:05:50.242520 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
14:05:50.244769 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
14:05:50.266342 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
14:05:50.273966 [debug] [Thread-1  ]: finished collecting timing info
14:05:50.276621 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
14:05:50.330714 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:05:50.334167 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
14:05:50.336661 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:05:50.343265 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:05:50.363071 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
14:05:50.370425 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:05:50.372596 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


SELECT tt.location_name, tt.location_country, tt.trend_name, tt.trend_volume, tt.trend_as_of as trend_date,
       wc.lat::float as location_latitude, wc.lng::float as location_longiture
FROM "materialize"."public"."stg_twitter_trending" tt
JOIN "materialize"."public"."stg_worldcities" wc ON tt.location_name = wc.city AND tt.location_country = wc.country
WHERE tt.trend_volume > 0
  );
14:05:50.386197 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:05:50.399557 [debug] [Thread-1  ]: finished collecting timing info
14:05:50.402382 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
14:05:50.406440 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bba25ded-5cfe-4632-921a-469f7aab8410', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e63eb0>]}
14:05:50.409979 [info ] [Thread-1  ]: 5 of 5 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.17s]
14:05:50.413700 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
14:05:50.420045 [debug] [MainThread]: Acquiring new materialize connection "master"
14:05:50.422883 [debug] [MainThread]: Using materialize connection "master"
14:05:50.425494 [debug] [MainThread]: On master: BEGIN
14:05:50.427640 [debug] [MainThread]: Opening a new connection, currently in state closed
14:05:50.434821 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:05:50.438318 [debug] [MainThread]: Using materialize connection "master"
14:05:50.440811 [debug] [MainThread]: On master: COMMIT
14:05:50.443547 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:05:50.446546 [debug] [MainThread]: On master: Close
14:05:50.450788 [info ] [MainThread]: 
14:05:50.454286 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.14s.
14:05:50.458008 [debug] [MainThread]: Connection 'master' was properly closed.
14:05:50.462305 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
14:05:50.505800 [info ] [MainThread]: 
14:05:50.509056 [info ] [MainThread]: [32mCompleted successfully[0m
14:05:50.512566 [info ] [MainThread]: 
14:05:50.516088 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
14:05:50.519620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e63850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e63640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e635e0>]}


============================== 2022-02-23 14:19:57.047489 | 97f773ea-39d6-43cb-977f-8957d3c399bc ==============================
14:19:57.047489 [info ] [MainThread]: Running with dbt=1.0.1
14:19:57.055001 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:19:57.057755 [debug] [MainThread]: Tracking: tracking
14:19:57.084713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072add00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072addf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072add90>]}
14:19:57.448387 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
14:19:57.454042 [debug] [MainThread]: Partial parsing: update schema file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter.yml
14:19:57.457957 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_worldcities.sql
14:19:57.460788 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
14:19:57.464436 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:19:57.583650 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
14:19:57.680098 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_worldcities.sql
14:19:57.698228 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
14:19:57.894977 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

14:19:57.933624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97f773ea-39d6-43cb-977f-8957d3c399bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2c0d0>]}
14:19:57.987147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97f773ea-39d6-43cb-977f-8957d3c399bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400727dca0>]}
14:19:57.990104 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:19:57.999089 [info ] [MainThread]: 
14:19:58.003435 [debug] [MainThread]: Acquiring new materialize connection "master"
14:19:58.012910 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
14:19:58.087711 [debug] [ThreadPool]: Using materialize connection "list_materialize"
14:19:58.091033 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
14:19:58.093816 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:19:58.124444 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
14:19:58.134938 [debug] [ThreadPool]: On list_materialize: Close
14:19:58.145192 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
14:19:58.171379 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
14:19:58.178677 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
14:19:58.182534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:19:58.202655 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.02 seconds
14:19:58.216015 [debug] [ThreadPool]: On list_materialize_public: Close
14:19:58.223285 [debug] [MainThread]: Using materialize connection "master"
14:19:58.225916 [debug] [MainThread]: On master: BEGIN
14:19:58.228109 [debug] [MainThread]: Opening a new connection, currently in state init
14:19:58.234890 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:19:58.238006 [debug] [MainThread]: Using materialize connection "master"
14:19:58.240040 [debug] [MainThread]: On master: COMMIT
14:19:58.242601 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:19:58.244734 [debug] [MainThread]: On master: Close
14:19:58.247966 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:19:58.251414 [info ] [MainThread]: 
14:19:58.271012 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
14:19:58.275543 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
14:19:58.279433 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
14:19:58.281750 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
14:19:58.284196 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
14:19:58.314826 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
14:19:58.323609 [debug] [Thread-1  ]: finished collecting timing info
14:19:58.326896 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
14:19:58.390970 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:19:58.394146 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
14:19:58.396785 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:19:58.409048 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:19:58.450159 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
14:19:58.457644 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:19:58.460358 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
14:19:58.473241 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:19:58.523970 [debug] [Thread-1  ]: finished collecting timing info
14:19:58.526829 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
14:19:58.530927 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97f773ea-39d6-43cb-977f-8957d3c399bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072d1a60>]}
14:19:58.537051 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.25s]
14:19:58.541198 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
14:19:58.545867 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
14:19:58.549191 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
14:19:58.553696 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
14:19:58.556482 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
14:19:58.558891 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
14:19:58.584194 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
14:19:58.592223 [debug] [Thread-1  ]: finished collecting timing info
14:19:58.595064 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
14:19:58.606353 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:19:58.608964 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
14:19:58.611672 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:19:58.621690 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:19:58.630363 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
14:19:58.637917 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:19:58.640168 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
14:19:58.650093 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:19:58.660042 [debug] [Thread-1  ]: finished collecting timing info
14:19:58.663747 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
14:19:58.667657 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97f773ea-39d6-43cb-977f-8957d3c399bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c52dc0>]}
14:19:58.671551 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.11s]
14:19:58.675772 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
14:19:58.678142 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
14:19:58.681215 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
14:19:58.685114 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
14:19:58.687512 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
14:19:58.689535 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
14:19:58.707869 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
14:19:58.715821 [debug] [Thread-1  ]: finished collecting timing info
14:19:58.717858 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
14:19:58.788642 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:19:58.791436 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
14:19:58.793631 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:19:58.799727 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:19:58.825261 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
14:19:58.833136 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:19:58.835536 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'location'->>'woeid')::string as woeid,
       (data->'trends'->0->'trends')::jsonb as trends,
       (data->'trends'->0->>'as_of')::timestamp as trend_as_of
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        woeid,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume,
        trend_as_of
    FROM renamed
)

SELECT * FROM final
  );
14:19:58.845648 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:19:58.855825 [debug] [Thread-1  ]: finished collecting timing info
14:19:58.858098 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
14:19:58.861547 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97f773ea-39d6-43cb-977f-8957d3c399bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f27fd0>]}
14:19:58.864881 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.18s]
14:19:58.868391 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
14:19:58.870715 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
14:19:58.873606 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
14:19:58.876899 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
14:19:58.879136 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
14:19:58.881242 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
14:19:58.899187 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
14:19:58.907369 [debug] [Thread-1  ]: finished collecting timing info
14:19:58.910836 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
14:19:58.928621 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:19:58.931786 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
14:19:58.934128 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:19:58.940170 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:19:58.950413 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
14:19:58.957267 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:19:58.959635 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
14:19:58.969106 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:19:58.979105 [debug] [Thread-1  ]: finished collecting timing info
14:19:58.981777 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
14:19:58.985551 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97f773ea-39d6-43cb-977f-8957d3c399bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f08d30>]}
14:19:58.988931 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.11s]
14:19:58.992206 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
14:19:58.997260 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
14:19:58.999990 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
14:19:59.003627 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
14:19:59.005644 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
14:19:59.007812 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
14:19:59.027049 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
14:19:59.034581 [debug] [Thread-1  ]: finished collecting timing info
14:19:59.037831 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
14:19:59.090648 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:19:59.093129 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
14:19:59.095468 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:19:59.101997 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:19:59.119074 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
14:19:59.126982 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:19:59.129298 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


select STRING_AGG(tt.location_name, ',' tt.location_country) as location_name,
     , json_agg(tt.trend_name, tt.trend_volume) as trends,
     , wc.lat::float as location_latitude, wc.lng::float as location_longiture
from "materialize"."public"."stg_twitter_trending" tt
    join "materialize"."public"."stg_worldcities" wc
on tt.location_name = wc.city and tt.location_country = wc.country
group by tt.woeid
where tt.trend_volume > 0
  );
14:19:59.133939 [debug] [Thread-1  ]: Postgres adapter: Postgres error: Expected right parenthesis, found identifier "tt"
LINE 7: select STRING_AGG(tt.location_name, ',' tt.location_country)...
                                                ^

14:19:59.136652 [debug] [Thread-1  ]: finished collecting timing info
14:19:59.138929 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
14:19:59.141988 [debug] [Thread-1  ]: Database Error in model fct_twitter_trending (models/twitter_trending/marts/twitter/fct_twitter_trending.sql)
  Expected right parenthesis, found identifier "tt"
  LINE 7: select STRING_AGG(tt.location_name, ',' tt.location_country)...
                                                  ^
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:19:59.145626 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97f773ea-39d6-43cb-977f-8957d3c399bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f9d6a0>]}
14:19:59.148868 [error] [Thread-1  ]: 5 of 5 ERROR creating materializedview model public.fct_twitter_trending........ [[31mERROR[0m in 0.14s]
14:19:59.152097 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
14:19:59.158915 [debug] [MainThread]: Acquiring new materialize connection "master"
14:19:59.161506 [debug] [MainThread]: Using materialize connection "master"
14:19:59.164048 [debug] [MainThread]: On master: BEGIN
14:19:59.166114 [debug] [MainThread]: Opening a new connection, currently in state closed
14:19:59.173079 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:19:59.175966 [debug] [MainThread]: Using materialize connection "master"
14:19:59.178112 [debug] [MainThread]: On master: COMMIT
14:19:59.181386 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:19:59.183672 [debug] [MainThread]: On master: Close
14:19:59.187168 [info ] [MainThread]: 
14:19:59.190507 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.18s.
14:19:59.193417 [debug] [MainThread]: Connection 'master' was properly closed.
14:19:59.195725 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
14:19:59.236205 [info ] [MainThread]: 
14:19:59.239813 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:19:59.243433 [info ] [MainThread]: 
14:19:59.246107 [error] [MainThread]: [33mDatabase Error in model fct_twitter_trending (models/twitter_trending/marts/twitter/fct_twitter_trending.sql)[0m
14:19:59.248752 [error] [MainThread]:   Expected right parenthesis, found identifier "tt"
14:19:59.251290 [error] [MainThread]:   LINE 7: select STRING_AGG(tt.location_name, ',' tt.location_country)...
14:19:59.253814 [error] [MainThread]:                                                   ^
14:19:59.256650 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:19:59.259156 [info ] [MainThread]: 
14:19:59.261580 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
14:19:59.264377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f0af70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027dadcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f7e4c0>]}


============================== 2022-02-23 14:20:30.866409 | b7797895-1b71-4355-8173-5de6d40b4b80 ==============================
14:20:30.866409 [info ] [MainThread]: Running with dbt=1.0.1
14:20:30.873569 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:20:30.877028 [debug] [MainThread]: Tracking: tracking
14:20:30.909338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acdf0>]}
14:20:31.310588 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:20:31.314663 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:20:31.430259 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
14:20:31.631578 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

14:20:31.669926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7797895-1b71-4355-8173-5de6d40b4b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c290d0>]}
14:20:31.722210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7797895-1b71-4355-8173-5de6d40b4b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007394c40>]}
14:20:31.725535 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:20:31.734809 [info ] [MainThread]: 
14:20:31.738955 [debug] [MainThread]: Acquiring new materialize connection "master"
14:20:31.750478 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
14:20:31.820509 [debug] [ThreadPool]: Using materialize connection "list_materialize"
14:20:31.823949 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
14:20:31.827726 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:20:31.857809 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
14:20:31.868143 [debug] [ThreadPool]: On list_materialize: Close
14:20:31.880018 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
14:20:31.902996 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
14:20:31.905961 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
14:20:31.908593 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:20:31.916448 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
14:20:31.926006 [debug] [ThreadPool]: On list_materialize_public: Close
14:20:31.932665 [debug] [MainThread]: Using materialize connection "master"
14:20:31.935371 [debug] [MainThread]: On master: BEGIN
14:20:31.937433 [debug] [MainThread]: Opening a new connection, currently in state init
14:20:31.943083 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:20:31.945661 [debug] [MainThread]: Using materialize connection "master"
14:20:31.948117 [debug] [MainThread]: On master: COMMIT
14:20:31.951454 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:20:31.953778 [debug] [MainThread]: On master: Close
14:20:31.956821 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:20:31.959657 [info ] [MainThread]: 
14:20:31.977728 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
14:20:31.981316 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
14:20:31.985079 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
14:20:31.987835 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
14:20:31.990309 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
14:20:32.021667 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
14:20:32.028498 [debug] [Thread-1  ]: finished collecting timing info
14:20:32.030915 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
14:20:32.089727 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:20:32.092612 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
14:20:32.094992 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:20:32.105340 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:20:32.153569 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
14:20:32.162539 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:20:32.164860 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
14:20:32.176264 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:20:32.226538 [debug] [Thread-1  ]: finished collecting timing info
14:20:32.230017 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
14:20:32.233711 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7797895-1b71-4355-8173-5de6d40b4b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049dc4220>]}
14:20:32.238200 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.25s]
14:20:32.241841 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
14:20:32.244504 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
14:20:32.247406 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
14:20:32.251484 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
14:20:32.253647 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
14:20:32.255858 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
14:20:32.277329 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
14:20:32.285020 [debug] [Thread-1  ]: finished collecting timing info
14:20:32.287681 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
14:20:32.298465 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:20:32.300724 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
14:20:32.302870 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:20:32.313344 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:20:32.322417 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
14:20:32.328344 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:20:32.330496 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
14:20:32.340236 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:20:32.350225 [debug] [Thread-1  ]: finished collecting timing info
14:20:32.352509 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
14:20:32.355957 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7797895-1b71-4355-8173-5de6d40b4b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c45550>]}
14:20:32.359457 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.11s]
14:20:32.362421 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
14:20:32.364949 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
14:20:32.367498 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
14:20:32.371071 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
14:20:32.373512 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
14:20:32.376022 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
14:20:32.394836 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
14:20:32.401258 [debug] [Thread-1  ]: finished collecting timing info
14:20:32.403372 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
14:20:32.473447 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:20:32.476662 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
14:20:32.479826 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:20:32.485856 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:20:32.511762 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
14:20:32.517706 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:20:32.520031 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'location'->>'woeid')::string as woeid,
       (data->'trends'->0->'trends')::jsonb as trends,
       (data->'trends'->0->>'as_of')::timestamp as trend_as_of
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        woeid,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume,
        trend_as_of
    FROM renamed
)

SELECT * FROM final
  );
14:20:32.529345 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:20:32.539203 [debug] [Thread-1  ]: finished collecting timing info
14:20:32.541663 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
14:20:32.545337 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7797895-1b71-4355-8173-5de6d40b4b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d86c70>]}
14:20:32.549018 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.17s]
14:20:32.552288 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
14:20:32.555227 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
14:20:32.558188 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
14:20:32.561832 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
14:20:32.563926 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
14:20:32.566237 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
14:20:32.584827 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
14:20:32.591038 [debug] [Thread-1  ]: finished collecting timing info
14:20:32.593446 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
14:20:32.610206 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:20:32.613236 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
14:20:32.615631 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:20:32.621722 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:20:32.631123 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
14:20:32.637278 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:20:32.639278 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
14:20:32.649042 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:20:32.659114 [debug] [Thread-1  ]: finished collecting timing info
14:20:32.661439 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
14:20:32.664982 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7797895-1b71-4355-8173-5de6d40b4b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d72e80>]}
14:20:32.668343 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.10s]
14:20:32.671328 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
14:20:32.676900 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
14:20:32.679391 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
14:20:32.682950 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
14:20:32.685182 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
14:20:32.687565 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
14:20:32.707228 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
14:20:32.713886 [debug] [Thread-1  ]: finished collecting timing info
14:20:32.716248 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
14:20:32.766296 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:20:32.769988 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
14:20:32.772059 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:20:32.778131 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:20:32.794888 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
14:20:32.801532 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:20:32.804004 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    

select STRING_AGG(tt.location_name, ',', tt.location_country) as location_name,
     , json_agg(tt.trend_name, tt.trend_volume) as trends,
     , wc.lat::float as location_latitude, wc.lng::float as location_longiture
from "materialize"."public"."stg_twitter_trending" tt
    join "materialize"."public"."stg_worldcities" wc
on tt.location_name = wc.city and tt.location_country = wc.country
group by tt.woeid
where tt.trend_volume > 0
  );
14:20:32.807729 [debug] [Thread-1  ]: Postgres adapter: Postgres error: Expected an expression, found comma
LINE 7:      , json_agg(tt.trend_name, tt.trend_volume) as trends,
             ^

14:20:32.810575 [debug] [Thread-1  ]: finished collecting timing info
14:20:32.813456 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
14:20:32.816659 [debug] [Thread-1  ]: Database Error in model fct_twitter_trending (models/twitter_trending/marts/twitter/fct_twitter_trending.sql)
  Expected an expression, found comma
  LINE 7:      , json_agg(tt.trend_name, tt.trend_volume) as trends,
               ^
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:20:32.820110 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7797895-1b71-4355-8173-5de6d40b4b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e5b7c0>]}
14:20:32.823240 [error] [Thread-1  ]: 5 of 5 ERROR creating materializedview model public.fct_twitter_trending........ [[31mERROR[0m in 0.14s]
14:20:32.826475 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
14:20:32.832477 [debug] [MainThread]: Acquiring new materialize connection "master"
14:20:32.835273 [debug] [MainThread]: Using materialize connection "master"
14:20:32.837558 [debug] [MainThread]: On master: BEGIN
14:20:32.839562 [debug] [MainThread]: Opening a new connection, currently in state closed
14:20:32.845540 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:20:32.848558 [debug] [MainThread]: Using materialize connection "master"
14:20:32.851056 [debug] [MainThread]: On master: COMMIT
14:20:32.854216 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:20:32.856286 [debug] [MainThread]: On master: Close
14:20:32.859497 [info ] [MainThread]: 
14:20:32.862274 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.12s.
14:20:32.865455 [debug] [MainThread]: Connection 'master' was properly closed.
14:20:32.867908 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
14:20:32.909603 [info ] [MainThread]: 
14:20:32.914888 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:20:32.920382 [info ] [MainThread]: 
14:20:32.925062 [error] [MainThread]: [33mDatabase Error in model fct_twitter_trending (models/twitter_trending/marts/twitter/fct_twitter_trending.sql)[0m
14:20:32.928574 [error] [MainThread]:   Expected an expression, found comma
14:20:32.933399 [error] [MainThread]:   LINE 7:      , json_agg(tt.trend_name, tt.trend_volume) as trends,
14:20:32.936641 [error] [MainThread]:                ^
14:20:32.943138 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:20:32.950525 [info ] [MainThread]: 
14:20:32.975035 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
14:20:32.978629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e3b460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e533d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e53520>]}


============================== 2022-02-23 14:21:09.143134 | 6567bd3f-6c31-40c3-aeb4-e1a59ce622d3 ==============================
14:21:09.143134 [info ] [MainThread]: Running with dbt=1.0.1
14:21:09.152473 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:21:09.157164 [debug] [MainThread]: Tracking: tracking
14:21:09.187052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace20>]}
14:21:09.567487 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:21:09.572527 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:21:09.683263 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
14:21:09.868060 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

14:21:09.906432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6567bd3f-6c31-40c3-aeb4-e1a59ce622d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2a0d0>]}
14:21:09.962910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6567bd3f-6c31-40c3-aeb4-e1a59ce622d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007393c70>]}
14:21:09.966737 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:21:09.977592 [info ] [MainThread]: 
14:21:09.982022 [debug] [MainThread]: Acquiring new materialize connection "master"
14:21:09.992695 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
14:21:10.070932 [debug] [ThreadPool]: Using materialize connection "list_materialize"
14:21:10.074758 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
14:21:10.078252 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:21:10.110365 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
14:21:10.121937 [debug] [ThreadPool]: On list_materialize: Close
14:21:10.133346 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
14:21:10.158539 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
14:21:10.161848 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
14:21:10.164297 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:21:10.173931 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
14:21:10.185744 [debug] [ThreadPool]: On list_materialize_public: Close
14:21:10.193873 [debug] [MainThread]: Using materialize connection "master"
14:21:10.197124 [debug] [MainThread]: On master: BEGIN
14:21:10.199527 [debug] [MainThread]: Opening a new connection, currently in state init
14:21:10.207832 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:21:10.211393 [debug] [MainThread]: Using materialize connection "master"
14:21:10.214044 [debug] [MainThread]: On master: COMMIT
14:21:10.217621 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:21:10.220367 [debug] [MainThread]: On master: Close
14:21:10.224914 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:21:10.229603 [info ] [MainThread]: 
14:21:10.248564 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
14:21:10.252697 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
14:21:10.258580 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
14:21:10.261414 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
14:21:10.265538 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
14:21:10.307522 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
14:21:10.317572 [debug] [Thread-1  ]: finished collecting timing info
14:21:10.321376 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
14:21:10.387375 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:21:10.393149 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
14:21:10.397276 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:21:10.408873 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:21:10.449151 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
14:21:10.456374 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:21:10.458755 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
14:21:10.469924 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:21:10.518593 [debug] [Thread-1  ]: finished collecting timing info
14:21:10.521489 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
14:21:10.525132 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6567bd3f-6c31-40c3-aeb4-e1a59ce622d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d93e20>]}
14:21:10.528474 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.27s]
14:21:10.531789 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
14:21:10.534040 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
14:21:10.536773 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
14:21:10.540632 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
14:21:10.542976 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
14:21:10.545595 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
14:21:10.567954 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
14:21:10.575053 [debug] [Thread-1  ]: finished collecting timing info
14:21:10.577543 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
14:21:10.587930 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:21:10.590134 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
14:21:10.593171 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:21:10.603277 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:21:10.612303 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
14:21:10.618665 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:21:10.622364 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
14:21:10.637407 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:21:10.647612 [debug] [Thread-1  ]: finished collecting timing info
14:21:10.651090 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
14:21:10.658178 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6567bd3f-6c31-40c3-aeb4-e1a59ce622d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c51940>]}
14:21:10.663654 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.12s]
14:21:10.667277 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
14:21:10.670766 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
14:21:10.675057 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
14:21:10.679581 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
14:21:10.681933 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
14:21:10.684015 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
14:21:10.703935 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
14:21:10.711200 [debug] [Thread-1  ]: finished collecting timing info
14:21:10.714108 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
14:21:10.785108 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:21:10.788243 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
14:21:10.790989 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:21:10.797346 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:21:10.822529 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
14:21:10.829628 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:21:10.832495 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'location'->>'woeid')::string as woeid,
       (data->'trends'->0->'trends')::jsonb as trends,
       (data->'trends'->0->>'as_of')::timestamp as trend_as_of
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        woeid,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume,
        trend_as_of
    FROM renamed
)

SELECT * FROM final
  );
14:21:10.842737 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:21:10.852240 [debug] [Thread-1  ]: finished collecting timing info
14:21:10.854659 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
14:21:10.858336 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6567bd3f-6c31-40c3-aeb4-e1a59ce622d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d8dd60>]}
14:21:10.861780 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.18s]
14:21:10.864628 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
14:21:10.866970 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
14:21:10.869989 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
14:21:10.874340 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
14:21:10.876916 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
14:21:10.879128 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
14:21:10.896514 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
14:21:10.904652 [debug] [Thread-1  ]: finished collecting timing info
14:21:10.907380 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
14:21:10.925646 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:21:10.928185 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
14:21:10.930535 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:21:10.938051 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:21:10.947801 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
14:21:10.954992 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:21:10.957892 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
14:21:10.965343 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:21:10.978184 [debug] [Thread-1  ]: finished collecting timing info
14:21:10.980994 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
14:21:10.986238 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6567bd3f-6c31-40c3-aeb4-e1a59ce622d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d70eb0>]}
14:21:10.990243 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.11s]
14:21:10.996378 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
14:21:11.003945 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
14:21:11.007133 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
14:21:11.013638 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
14:21:11.016302 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
14:21:11.018788 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
14:21:11.047693 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
14:21:11.055778 [debug] [Thread-1  ]: finished collecting timing info
14:21:11.058597 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
14:21:11.111608 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:21:11.118542 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
14:21:11.131679 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:21:11.147848 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.02 seconds
14:21:11.175435 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
14:21:11.181966 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:21:11.185239 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    

select string_agg(tt.location_name, ',', tt.location_country) as location_name
     , json_agg(tt.trend_name, tt.trend_volume)               as trends
     , wc.lat::float as location_latitude
     , wc.lng::float as location_longiture
from "materialize"."public"."stg_twitter_trending" tt
    join "materialize"."public"."stg_worldcities" wc
on tt.location_name = wc.city and tt.location_country = wc.country
group by tt.woeid
where tt.trend_volume > 0
  );
14:21:11.189356 [debug] [Thread-1  ]: Postgres adapter: Postgres error: Expected right parenthesis, found WHERE
LINE 14: where tt.trend_volume > 0
         ^

14:21:11.193766 [debug] [Thread-1  ]: finished collecting timing info
14:21:11.197367 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
14:21:11.200856 [debug] [Thread-1  ]: Database Error in model fct_twitter_trending (models/twitter_trending/marts/twitter/fct_twitter_trending.sql)
  Expected right parenthesis, found WHERE
  LINE 14: where tt.trend_volume > 0
           ^
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:21:11.204058 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6567bd3f-6c31-40c3-aeb4-e1a59ce622d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e4e820>]}
14:21:11.208003 [error] [Thread-1  ]: 5 of 5 ERROR creating materializedview model public.fct_twitter_trending........ [[31mERROR[0m in 0.19s]
14:21:11.212327 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
14:21:11.218279 [debug] [MainThread]: Acquiring new materialize connection "master"
14:21:11.221245 [debug] [MainThread]: Using materialize connection "master"
14:21:11.223416 [debug] [MainThread]: On master: BEGIN
14:21:11.225647 [debug] [MainThread]: Opening a new connection, currently in state closed
14:21:11.232160 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:21:11.235070 [debug] [MainThread]: Using materialize connection "master"
14:21:11.237363 [debug] [MainThread]: On master: COMMIT
14:21:11.240118 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:21:11.242845 [debug] [MainThread]: On master: Close
14:21:11.246410 [info ] [MainThread]: 
14:21:11.249778 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.27s.
14:21:11.252998 [debug] [MainThread]: Connection 'master' was properly closed.
14:21:11.255172 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
14:21:11.294588 [info ] [MainThread]: 
14:21:11.297821 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:21:11.300909 [info ] [MainThread]: 
14:21:11.303654 [error] [MainThread]: [33mDatabase Error in model fct_twitter_trending (models/twitter_trending/marts/twitter/fct_twitter_trending.sql)[0m
14:21:11.307244 [error] [MainThread]:   Expected right parenthesis, found WHERE
14:21:11.310721 [error] [MainThread]:   LINE 14: where tt.trend_volume > 0
14:21:11.313524 [error] [MainThread]:            ^
14:21:11.318121 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:21:11.321174 [info ] [MainThread]: 
14:21:11.324059 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
14:21:11.327601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e3b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e54640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e54790>]}


============================== 2022-02-23 14:22:03.902046 | 135a96ba-a317-41e2-b377-8076c73ed732 ==============================
14:22:03.902046 [info ] [MainThread]: Running with dbt=1.0.1
14:22:03.909543 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:22:03.911904 [debug] [MainThread]: Tracking: tracking
14:22:03.938239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace20>]}
14:22:04.267687 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:22:04.272039 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:22:04.377591 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
14:22:04.568356 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

14:22:04.610869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '135a96ba-a317-41e2-b377-8076c73ed732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c250d0>]}
14:22:04.662871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '135a96ba-a317-41e2-b377-8076c73ed732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007393c70>]}
14:22:04.666112 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:22:04.675194 [info ] [MainThread]: 
14:22:04.679057 [debug] [MainThread]: Acquiring new materialize connection "master"
14:22:04.688556 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
14:22:04.758908 [debug] [ThreadPool]: Using materialize connection "list_materialize"
14:22:04.762968 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
14:22:04.767269 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:22:04.798107 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
14:22:04.809341 [debug] [ThreadPool]: On list_materialize: Close
14:22:04.819835 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
14:22:04.844953 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
14:22:04.847560 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
14:22:04.850572 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:22:04.858712 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
14:22:04.868337 [debug] [ThreadPool]: On list_materialize_public: Close
14:22:04.875085 [debug] [MainThread]: Using materialize connection "master"
14:22:04.878434 [debug] [MainThread]: On master: BEGIN
14:22:04.880834 [debug] [MainThread]: Opening a new connection, currently in state init
14:22:04.886613 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:22:04.889290 [debug] [MainThread]: Using materialize connection "master"
14:22:04.891728 [debug] [MainThread]: On master: COMMIT
14:22:04.894512 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:22:04.896808 [debug] [MainThread]: On master: Close
14:22:04.899902 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:22:04.903659 [info ] [MainThread]: 
14:22:04.921357 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
14:22:04.924934 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
14:22:04.928720 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
14:22:04.931295 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
14:22:04.933657 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
14:22:04.964453 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
14:22:04.971796 [debug] [Thread-1  ]: finished collecting timing info
14:22:04.974229 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
14:22:05.030271 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:22:05.033099 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
14:22:05.035404 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:22:05.048792 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:22:05.087955 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
14:22:05.095130 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:22:05.097780 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
14:22:05.110588 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:22:05.158307 [debug] [Thread-1  ]: finished collecting timing info
14:22:05.160906 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
14:22:05.164952 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '135a96ba-a317-41e2-b377-8076c73ed732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ec3700>]}
14:22:05.168516 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.24s]
14:22:05.172203 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
14:22:05.174508 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
14:22:05.177286 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
14:22:05.180910 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
14:22:05.183069 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
14:22:05.185391 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
14:22:05.207077 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
14:22:05.213907 [debug] [Thread-1  ]: finished collecting timing info
14:22:05.216207 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
14:22:05.226326 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:22:05.229498 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
14:22:05.231501 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:22:05.241926 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:22:05.249867 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
14:22:05.256213 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:22:05.258240 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
14:22:05.267671 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:22:05.277257 [debug] [Thread-1  ]: finished collecting timing info
14:22:05.279322 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
14:22:05.282392 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '135a96ba-a317-41e2-b377-8076c73ed732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c51940>]}
14:22:05.285449 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.10s]
14:22:05.288382 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
14:22:05.290736 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
14:22:05.293312 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
14:22:05.297067 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
14:22:05.299271 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
14:22:05.301399 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
14:22:05.319893 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
14:22:05.326121 [debug] [Thread-1  ]: finished collecting timing info
14:22:05.328440 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
14:22:05.399623 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:22:05.402683 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
14:22:05.405630 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:22:05.412279 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:22:05.437068 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
14:22:05.443911 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:22:05.446294 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'location'->>'woeid')::string as woeid,
       (data->'trends'->0->'trends')::jsonb as trends,
       (data->'trends'->0->>'as_of')::timestamp as trend_as_of
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        woeid,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume,
        trend_as_of
    FROM renamed
)

SELECT * FROM final
  );
14:22:05.457881 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:22:05.467430 [debug] [Thread-1  ]: finished collecting timing info
14:22:05.469748 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
14:22:05.473273 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '135a96ba-a317-41e2-b377-8076c73ed732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d8e3a0>]}
14:22:05.477710 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.18s]
14:22:05.481622 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
14:22:05.484024 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
14:22:05.486571 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
14:22:05.490620 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
14:22:05.492806 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
14:22:05.494946 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
14:22:05.512636 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
14:22:05.518976 [debug] [Thread-1  ]: finished collecting timing info
14:22:05.521404 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
14:22:05.537871 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:22:05.540259 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
14:22:05.542330 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:22:05.548710 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:22:05.557896 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
14:22:05.564324 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:22:05.566268 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
14:22:05.575491 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:22:05.586547 [debug] [Thread-1  ]: finished collecting timing info
14:22:05.589919 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
14:22:05.593890 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '135a96ba-a317-41e2-b377-8076c73ed732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d69eb0>]}
14:22:05.599632 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.10s]
14:22:05.603245 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
14:22:05.609642 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
14:22:05.614200 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
14:22:05.618641 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
14:22:05.622219 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
14:22:05.624936 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
14:22:05.645182 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
14:22:05.651979 [debug] [Thread-1  ]: finished collecting timing info
14:22:05.655621 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
14:22:05.705493 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:22:05.708343 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
14:22:05.710370 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:22:05.719141 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:22:05.735422 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
14:22:05.741891 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:22:05.744331 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    

select string_agg(tt.location_name, ',', tt.location_country) as location_name
     , json_agg(tt.trend_name, tt.trend_volume)               as trends
     , wc.lat::float as location_latitude
     , wc.lng::float as location_longiture
from "materialize"."public"."stg_twitter_trending" tt
    join "materialize"."public"."stg_worldcities" wc
on tt.location_name = wc.city and tt.location_country = wc.country
where tt.trend_volume > 0
group by tt.woeid
  );
14:22:05.748803 [debug] [Thread-1  ]: Postgres adapter: Postgres error: Cannot call function string_agg(text, unknown, text): arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts

14:22:05.751722 [debug] [Thread-1  ]: finished collecting timing info
14:22:05.753853 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
14:22:05.756971 [debug] [Thread-1  ]: Database Error in model fct_twitter_trending (models/twitter_trending/marts/twitter/fct_twitter_trending.sql)
  Cannot call function string_agg(text, unknown, text): arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:22:05.759921 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '135a96ba-a317-41e2-b377-8076c73ed732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f507f0>]}
14:22:05.762961 [error] [Thread-1  ]: 5 of 5 ERROR creating materializedview model public.fct_twitter_trending........ [[31mERROR[0m in 0.14s]
14:22:05.766544 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
14:22:05.772621 [debug] [MainThread]: Acquiring new materialize connection "master"
14:22:05.775203 [debug] [MainThread]: Using materialize connection "master"
14:22:05.777455 [debug] [MainThread]: On master: BEGIN
14:22:05.779805 [debug] [MainThread]: Opening a new connection, currently in state closed
14:22:05.785041 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:22:05.787595 [debug] [MainThread]: Using materialize connection "master"
14:22:05.789662 [debug] [MainThread]: On master: COMMIT
14:22:05.792090 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:22:05.794837 [debug] [MainThread]: On master: Close
14:22:05.798387 [info ] [MainThread]: 
14:22:05.801427 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.12s.
14:22:05.804482 [debug] [MainThread]: Connection 'master' was properly closed.
14:22:05.806491 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
14:22:05.844625 [info ] [MainThread]: 
14:22:05.847330 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:22:05.849971 [info ] [MainThread]: 
14:22:05.852841 [error] [MainThread]: [33mDatabase Error in model fct_twitter_trending (models/twitter_trending/marts/twitter/fct_twitter_trending.sql)[0m
14:22:05.855631 [error] [MainThread]:   Cannot call function string_agg(text, unknown, text): arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
14:22:05.858214 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:22:05.861972 [info ] [MainThread]: 
14:22:05.865558 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
14:22:05.869226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f3b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f53a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f53e20>]}


============================== 2022-02-23 14:23:50.716850 | 62db9a43-cc9f-46e4-88f9-59c2e747aa49 ==============================
14:23:50.716850 [info ] [MainThread]: Running with dbt=1.0.1
14:23:50.724348 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:23:50.727620 [debug] [MainThread]: Tracking: tracking
14:23:50.757644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728cdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728ceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728ce50>]}
14:23:51.085099 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:23:51.101632 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:23:51.208145 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
14:23:51.396357 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

14:23:51.440405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62db9a43-cc9f-46e4-88f9-59c2e747aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2c0d0>]}
14:23:51.492203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62db9a43-cc9f-46e4-88f9-59c2e747aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007395b20>]}
14:23:51.496095 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:23:51.505583 [info ] [MainThread]: 
14:23:51.509693 [debug] [MainThread]: Acquiring new materialize connection "master"
14:23:51.522893 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
14:23:51.591141 [debug] [ThreadPool]: Using materialize connection "list_materialize"
14:23:51.594117 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
14:23:51.597220 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:23:51.627172 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
14:23:51.637937 [debug] [ThreadPool]: On list_materialize: Close
14:23:51.648125 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
14:23:51.674271 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
14:23:51.677695 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
14:23:51.681302 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:23:51.690837 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
14:23:51.702698 [debug] [ThreadPool]: On list_materialize_public: Close
14:23:51.710634 [debug] [MainThread]: Using materialize connection "master"
14:23:51.713247 [debug] [MainThread]: On master: BEGIN
14:23:51.715769 [debug] [MainThread]: Opening a new connection, currently in state init
14:23:51.721620 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:23:51.724303 [debug] [MainThread]: Using materialize connection "master"
14:23:51.726457 [debug] [MainThread]: On master: COMMIT
14:23:51.729856 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:23:51.732216 [debug] [MainThread]: On master: Close
14:23:51.735347 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:23:51.738834 [info ] [MainThread]: 
14:23:51.755719 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
14:23:51.759131 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
14:23:51.763691 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
14:23:51.765846 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
14:23:51.768281 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
14:23:51.802854 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
14:23:51.809550 [debug] [Thread-1  ]: finished collecting timing info
14:23:51.812141 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
14:23:51.904156 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:23:51.916037 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
14:23:51.920929 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:23:51.938171 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.02 seconds
14:23:51.978767 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
14:23:51.985881 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:23:51.987899 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
14:23:52.000964 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:23:52.048843 [debug] [Thread-1  ]: finished collecting timing info
14:23:52.051647 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
14:23:52.056626 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62db9a43-cc9f-46e4-88f9-59c2e747aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ec51c0>]}
14:23:52.060267 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.29s]
14:23:52.063931 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
14:23:52.066708 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
14:23:52.069792 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
14:23:52.073903 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
14:23:52.076229 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
14:23:52.078521 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
14:23:52.101460 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
14:23:52.108681 [debug] [Thread-1  ]: finished collecting timing info
14:23:52.111117 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
14:23:52.121956 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:23:52.124324 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
14:23:52.126446 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:23:52.136771 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:23:52.145105 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
14:23:52.170354 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:23:52.175014 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
14:23:52.189441 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:23:52.199901 [debug] [Thread-1  ]: finished collecting timing info
14:23:52.203206 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
14:23:52.207714 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62db9a43-cc9f-46e4-88f9-59c2e747aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c4f640>]}
14:23:52.212429 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.13s]
14:23:52.215579 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
14:23:52.218818 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
14:23:52.222852 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
14:23:52.227304 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
14:23:52.230877 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
14:23:52.233108 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
14:23:52.254427 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
14:23:52.261799 [debug] [Thread-1  ]: finished collecting timing info
14:23:52.265377 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
14:23:52.341231 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:23:52.344367 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
14:23:52.348156 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:23:52.356983 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:23:52.386038 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
14:23:52.395199 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:23:52.398338 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'location'->>'woeid')::string as woeid,
       (data->'trends'->0->'trends')::jsonb as trends,
       (data->'trends'->0->>'as_of')::timestamp as trend_as_of
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        woeid,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume,
        trend_as_of
    FROM renamed
)

SELECT * FROM final
  );
14:23:52.409043 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:23:52.422245 [debug] [Thread-1  ]: finished collecting timing info
14:23:52.425800 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
14:23:52.432467 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62db9a43-cc9f-46e4-88f9-59c2e747aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d80cd0>]}
14:23:52.437137 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.21s]
14:23:52.440415 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
14:23:52.442976 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
14:23:52.446911 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
14:23:52.458292 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
14:23:52.463235 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
14:23:52.467085 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
14:23:52.489464 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
14:23:52.497031 [debug] [Thread-1  ]: finished collecting timing info
14:23:52.499331 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
14:23:52.519397 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:23:52.522414 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
14:23:52.526250 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:23:52.533237 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:23:52.543726 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
14:23:52.550336 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:23:52.552716 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
14:23:52.562836 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:23:52.574069 [debug] [Thread-1  ]: finished collecting timing info
14:23:52.576935 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
14:23:52.580206 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62db9a43-cc9f-46e4-88f9-59c2e747aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d72ee0>]}
14:23:52.583421 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.12s]
14:23:52.587031 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
14:23:52.592728 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
14:23:52.595576 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
14:23:52.598832 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
14:23:52.601060 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
14:23:52.603517 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
14:23:52.623690 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
14:23:52.630373 [debug] [Thread-1  ]: finished collecting timing info
14:23:52.632632 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
14:23:52.682812 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:23:52.685555 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
14:23:52.687953 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:23:52.693929 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:23:52.711033 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
14:23:52.717199 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:23:52.719583 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    

select string_agg(CONCAT(tt.location_name, ',', tt.location_country), ', ') as location_name
     , json_agg(tt.trend_name, tt.trend_volume)               as trends
     , wc.lat::float as location_latitude
     , wc.lng::float as location_longiture
from "materialize"."public"."stg_twitter_trending" tt
    join "materialize"."public"."stg_worldcities" wc
on tt.location_name = wc.city and tt.location_country = wc.country
where tt.trend_volume > 0
group by tt.woeid
  );
14:23:52.724271 [debug] [Thread-1  ]: Postgres adapter: Postgres error: Cannot call function json_agg(text, integer): arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts

14:23:52.728098 [debug] [Thread-1  ]: finished collecting timing info
14:23:52.730383 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
14:23:52.733616 [debug] [Thread-1  ]: Database Error in model fct_twitter_trending (models/twitter_trending/marts/twitter/fct_twitter_trending.sql)
  Cannot call function json_agg(text, integer): arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:23:52.736743 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62db9a43-cc9f-46e4-88f9-59c2e747aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f5c820>]}
14:23:52.739888 [error] [Thread-1  ]: 5 of 5 ERROR creating materializedview model public.fct_twitter_trending........ [[31mERROR[0m in 0.14s]
14:23:52.742734 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
14:23:52.748842 [debug] [MainThread]: Acquiring new materialize connection "master"
14:23:52.752168 [debug] [MainThread]: Using materialize connection "master"
14:23:52.754975 [debug] [MainThread]: On master: BEGIN
14:23:52.757399 [debug] [MainThread]: Opening a new connection, currently in state closed
14:23:52.765072 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:23:52.768389 [debug] [MainThread]: Using materialize connection "master"
14:23:52.771396 [debug] [MainThread]: On master: COMMIT
14:23:52.778738 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:23:52.781582 [debug] [MainThread]: On master: Close
14:23:52.786212 [info ] [MainThread]: 
14:23:52.790630 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.28s.
14:23:52.793875 [debug] [MainThread]: Connection 'master' was properly closed.
14:23:52.796139 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
14:23:52.839298 [info ] [MainThread]: 
14:23:52.842646 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:23:52.845465 [info ] [MainThread]: 
14:23:52.849446 [error] [MainThread]: [33mDatabase Error in model fct_twitter_trending (models/twitter_trending/marts/twitter/fct_twitter_trending.sql)[0m
14:23:52.853589 [error] [MainThread]:   Cannot call function json_agg(text, integer): arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
14:23:52.857183 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:23:52.860387 [info ] [MainThread]: 
14:23:52.863439 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
14:23:52.867907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f3d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f547f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f546d0>]}


============================== 2022-02-23 14:25:22.653984 | 9170f0f0-b2ad-48d9-b320-cd2e283454f3 ==============================
14:25:22.653984 [info ] [MainThread]: Running with dbt=1.0.1
14:25:22.661084 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:25:22.663677 [debug] [MainThread]: Tracking: tracking
14:25:22.692536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acdf0>]}
14:25:23.029721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:25:23.034329 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:25:23.149763 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
14:25:23.331273 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

14:25:23.371546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9170f0f0-b2ad-48d9-b320-cd2e283454f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2a0d0>]}
14:25:23.421963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9170f0f0-b2ad-48d9-b320-cd2e283454f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007393c40>]}
14:25:23.425401 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:25:23.435035 [info ] [MainThread]: 
14:25:23.446206 [debug] [MainThread]: Acquiring new materialize connection "master"
14:25:23.457801 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
14:25:23.527481 [debug] [ThreadPool]: Using materialize connection "list_materialize"
14:25:23.530437 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
14:25:23.533397 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:25:23.563138 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
14:25:23.573398 [debug] [ThreadPool]: On list_materialize: Close
14:25:23.583717 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
14:25:23.606740 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
14:25:23.609563 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
14:25:23.611794 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:25:23.619299 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
14:25:23.628597 [debug] [ThreadPool]: On list_materialize_public: Close
14:25:23.635349 [debug] [MainThread]: Using materialize connection "master"
14:25:23.637913 [debug] [MainThread]: On master: BEGIN
14:25:23.640351 [debug] [MainThread]: Opening a new connection, currently in state init
14:25:23.645974 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:25:23.648642 [debug] [MainThread]: Using materialize connection "master"
14:25:23.650638 [debug] [MainThread]: On master: COMMIT
14:25:23.653661 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:25:23.656323 [debug] [MainThread]: On master: Close
14:25:23.659438 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:25:23.662372 [info ] [MainThread]: 
14:25:23.679970 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
14:25:23.683690 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
14:25:23.687621 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
14:25:23.691485 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
14:25:23.694183 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
14:25:23.723718 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
14:25:23.731445 [debug] [Thread-1  ]: finished collecting timing info
14:25:23.734162 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
14:25:23.789899 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:25:23.793102 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
14:25:23.795319 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:25:23.806400 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:25:23.847257 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
14:25:23.854439 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:25:23.856557 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
14:25:23.868091 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:25:23.916760 [debug] [Thread-1  ]: finished collecting timing info
14:25:23.919603 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
14:25:23.923676 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9170f0f0-b2ad-48d9-b320-cd2e283454f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049dc4730>]}
14:25:23.927344 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.24s]
14:25:23.930912 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
14:25:23.933793 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
14:25:23.936487 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
14:25:23.940410 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
14:25:23.942746 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
14:25:23.944861 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
14:25:23.967533 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
14:25:23.974948 [debug] [Thread-1  ]: finished collecting timing info
14:25:23.977365 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
14:25:23.987974 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:25:23.990245 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
14:25:23.992275 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:25:24.002377 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:25:24.010958 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
14:25:24.019044 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:25:24.021176 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
14:25:24.031672 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:25:24.041287 [debug] [Thread-1  ]: finished collecting timing info
14:25:24.043437 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
14:25:24.046648 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9170f0f0-b2ad-48d9-b320-cd2e283454f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c41250>]}
14:25:24.049865 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.11s]
14:25:24.052945 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
14:25:24.055488 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
14:25:24.058029 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
14:25:24.061544 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
14:25:24.063784 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
14:25:24.066455 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
14:25:24.085313 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
14:25:24.092293 [debug] [Thread-1  ]: finished collecting timing info
14:25:24.094852 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
14:25:24.175380 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:25:24.181241 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
14:25:24.183637 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:25:24.189880 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:25:24.215924 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
14:25:24.222933 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:25:24.225154 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'location'->>'woeid')::string as woeid,
       (data->'trends'->0->'trends')::jsonb as trends,
       (data->'trends'->0->>'as_of')::timestamp as trend_as_of
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        woeid,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume,
        trend_as_of
    FROM renamed
)

SELECT * FROM final
  );
14:25:24.234583 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:25:24.244294 [debug] [Thread-1  ]: finished collecting timing info
14:25:24.246460 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
14:25:24.250401 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9170f0f0-b2ad-48d9-b320-cd2e283454f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d82a90>]}
14:25:24.254726 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.19s]
14:25:24.257658 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
14:25:24.259969 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
14:25:24.262494 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
14:25:24.265893 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
14:25:24.268135 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
14:25:24.270327 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
14:25:24.287760 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
14:25:24.295280 [debug] [Thread-1  ]: finished collecting timing info
14:25:24.297586 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
14:25:24.316116 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:25:24.318580 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
14:25:24.320697 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:25:24.326762 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:25:24.336017 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
14:25:24.343583 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:25:24.345963 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
14:25:24.354798 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:25:24.365585 [debug] [Thread-1  ]: finished collecting timing info
14:25:24.373639 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
14:25:24.377721 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9170f0f0-b2ad-48d9-b320-cd2e283454f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d70e80>]}
14:25:24.381573 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.11s]
14:25:24.384452 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
14:25:24.390168 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
14:25:24.393118 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
14:25:24.397594 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
14:25:24.400292 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
14:25:24.402868 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
14:25:24.422883 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
14:25:24.429944 [debug] [Thread-1  ]: finished collecting timing info
14:25:24.432669 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
14:25:24.482184 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:25:24.484984 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
14:25:24.488036 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:25:24.494215 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:25:24.510541 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
14:25:24.516692 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:25:24.518872 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    

select string_agg(CONCAT(tt.location_name, ',', tt.location_country), ', ') as location_name
     , jsonb_agg(to_jsonb(tt.trend_name, tt.trend_volume))               as trends
     , wc.lat::float as location_latitude
     , wc.lng::float as location_longiture
from "materialize"."public"."stg_twitter_trending" tt
    join "materialize"."public"."stg_worldcities" wc
on tt.location_name = wc.city and tt.location_country = wc.country
where tt.trend_volume > 0
group by tt.woeid
  );
14:25:24.523210 [debug] [Thread-1  ]: Postgres adapter: Postgres error: Cannot call function to_jsonb(text, integer): arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts

14:25:24.525772 [debug] [Thread-1  ]: finished collecting timing info
14:25:24.527823 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
14:25:24.531586 [debug] [Thread-1  ]: Database Error in model fct_twitter_trending (models/twitter_trending/marts/twitter/fct_twitter_trending.sql)
  Cannot call function to_jsonb(text, integer): arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:25:24.537662 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9170f0f0-b2ad-48d9-b320-cd2e283454f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e557c0>]}
14:25:24.541204 [error] [Thread-1  ]: 5 of 5 ERROR creating materializedview model public.fct_twitter_trending........ [[31mERROR[0m in 0.14s]
14:25:24.544227 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
14:25:24.549678 [debug] [MainThread]: Acquiring new materialize connection "master"
14:25:24.552211 [debug] [MainThread]: Using materialize connection "master"
14:25:24.554181 [debug] [MainThread]: On master: BEGIN
14:25:24.555956 [debug] [MainThread]: Opening a new connection, currently in state closed
14:25:24.561950 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:25:24.564496 [debug] [MainThread]: Using materialize connection "master"
14:25:24.566630 [debug] [MainThread]: On master: COMMIT
14:25:24.569691 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:25:24.572613 [debug] [MainThread]: On master: Close
14:25:24.576535 [info ] [MainThread]: 
14:25:24.580807 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.13s.
14:25:24.583865 [debug] [MainThread]: Connection 'master' was properly closed.
14:25:24.585970 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
14:25:24.626669 [info ] [MainThread]: 
14:25:24.629797 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:25:24.632929 [info ] [MainThread]: 
14:25:24.635589 [error] [MainThread]: [33mDatabase Error in model fct_twitter_trending (models/twitter_trending/marts/twitter/fct_twitter_trending.sql)[0m
14:25:24.638189 [error] [MainThread]:   Cannot call function to_jsonb(text, integer): arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
14:25:24.641135 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:25:24.643757 [info ] [MainThread]: 
14:25:24.646598 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
14:25:24.649743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e3c460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e54670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e54f10>]}


============================== 2022-02-23 14:25:57.204301 | b5364006-f736-4c2c-84ac-5a274464340f ==============================
14:25:57.204301 [info ] [MainThread]: Running with dbt=1.0.1
14:25:57.210838 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:25:57.213902 [debug] [MainThread]: Tracking: tracking
14:25:57.242583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acdc0>]}
14:25:57.573283 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:25:57.577298 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:25:57.679532 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
14:25:57.861810 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

14:25:57.899351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5364006-f736-4c2c-84ac-5a274464340f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c290d0>]}
14:25:57.952657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5364006-f736-4c2c-84ac-5a274464340f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007394c40>]}
14:25:57.956117 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:25:57.964479 [info ] [MainThread]: 
14:25:57.969854 [debug] [MainThread]: Acquiring new materialize connection "master"
14:25:57.980488 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
14:25:58.052168 [debug] [ThreadPool]: Using materialize connection "list_materialize"
14:25:58.055276 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
14:25:58.058545 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:25:58.088778 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
14:25:58.098660 [debug] [ThreadPool]: On list_materialize: Close
14:25:58.108828 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
14:25:58.132307 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
14:25:58.135638 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
14:25:58.138147 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:25:58.145718 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
14:25:58.154714 [debug] [ThreadPool]: On list_materialize_public: Close
14:25:58.161325 [debug] [MainThread]: Using materialize connection "master"
14:25:58.163917 [debug] [MainThread]: On master: BEGIN
14:25:58.165869 [debug] [MainThread]: Opening a new connection, currently in state init
14:25:58.171147 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:25:58.173784 [debug] [MainThread]: Using materialize connection "master"
14:25:58.176008 [debug] [MainThread]: On master: COMMIT
14:25:58.178860 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:25:58.181075 [debug] [MainThread]: On master: Close
14:25:58.184260 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:25:58.187292 [info ] [MainThread]: 
14:25:58.205585 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
14:25:58.211056 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
14:25:58.218692 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
14:25:58.222211 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
14:25:58.225882 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
14:25:58.264110 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
14:25:58.271287 [debug] [Thread-1  ]: finished collecting timing info
14:25:58.273561 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
14:25:58.332266 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:25:58.335378 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
14:25:58.337566 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:25:58.347718 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:25:58.387770 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
14:25:58.395122 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:25:58.397205 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
14:25:58.408040 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:25:58.455313 [debug] [Thread-1  ]: finished collecting timing info
14:25:58.458169 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
14:25:58.462670 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5364006-f736-4c2c-84ac-5a274464340f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049dc7dc0>]}
14:25:58.466541 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.24s]
14:25:58.470115 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
14:25:58.472305 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
14:25:58.475356 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
14:25:58.480939 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
14:25:58.483060 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
14:25:58.485164 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
14:25:58.507057 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
14:25:58.515158 [debug] [Thread-1  ]: finished collecting timing info
14:25:58.517251 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
14:25:58.527722 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:25:58.529858 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
14:25:58.531810 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:25:58.540889 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:25:58.549348 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
14:25:58.555212 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:25:58.557272 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
14:25:58.568170 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:25:58.577676 [debug] [Thread-1  ]: finished collecting timing info
14:25:58.579985 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
14:25:58.583165 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5364006-f736-4c2c-84ac-5a274464340f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c46d00>]}
14:25:58.586534 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.10s]
14:25:58.589609 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
14:25:58.592103 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
14:25:58.595252 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
14:25:58.599645 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
14:25:58.601698 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
14:25:58.603925 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
14:25:58.622187 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
14:25:58.628473 [debug] [Thread-1  ]: finished collecting timing info
14:25:58.630905 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
14:25:58.704810 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:25:58.707990 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
14:25:58.710335 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:25:58.718367 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:25:58.743165 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
14:25:58.750395 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:25:58.758377 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'location'->>'woeid')::string as woeid,
       (data->'trends'->0->'trends')::jsonb as trends,
       (data->'trends'->0->>'as_of')::timestamp as trend_as_of
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        woeid,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume,
        trend_as_of
    FROM renamed
)

SELECT * FROM final
  );
14:25:58.769818 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:25:58.779532 [debug] [Thread-1  ]: finished collecting timing info
14:25:58.781656 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
14:25:58.785048 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5364006-f736-4c2c-84ac-5a274464340f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d83400>]}
14:25:58.788176 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.19s]
14:25:58.791166 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
14:25:58.793470 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
14:25:58.795977 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
14:25:58.799621 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
14:25:58.801924 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
14:25:58.804113 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
14:25:58.822431 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
14:25:58.829110 [debug] [Thread-1  ]: finished collecting timing info
14:25:58.831318 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
14:25:58.848489 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:25:58.850941 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
14:25:58.853374 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:25:58.859944 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:25:58.869625 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
14:25:58.875495 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:25:58.877689 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
14:25:58.888939 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:25:58.899297 [debug] [Thread-1  ]: finished collecting timing info
14:25:58.901956 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
14:25:58.905856 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5364006-f736-4c2c-84ac-5a274464340f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d72e50>]}
14:25:58.909051 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.11s]
14:25:58.911820 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
14:25:58.917502 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
14:25:58.920122 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
14:25:58.923648 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
14:25:58.925700 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
14:25:58.928090 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
14:25:58.947648 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
14:25:58.955269 [debug] [Thread-1  ]: finished collecting timing info
14:25:58.958310 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
14:25:59.008304 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:25:59.011197 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
14:25:59.014262 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:25:59.020345 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:25:59.036523 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
14:25:59.044060 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:25:59.047189 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    

select string_agg(CONCAT(tt.location_name, ',', tt.location_country), ', ') as location_name
     , jsonb_agg(to_jsonb(tt.trend_name, tt.trend_volume::string))               as trends
     , wc.lat::float as location_latitude
     , wc.lng::float as location_longiture
from "materialize"."public"."stg_twitter_trending" tt
    join "materialize"."public"."stg_worldcities" wc
on tt.location_name = wc.city and tt.location_country = wc.country
where tt.trend_volume > 0
group by tt.woeid
  );
14:25:59.052407 [debug] [Thread-1  ]: Postgres adapter: Postgres error: Cannot call function to_jsonb(text, text): arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts

14:25:59.055533 [debug] [Thread-1  ]: finished collecting timing info
14:25:59.057809 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
14:25:59.061465 [debug] [Thread-1  ]: Database Error in model fct_twitter_trending (models/twitter_trending/marts/twitter/fct_twitter_trending.sql)
  Cannot call function to_jsonb(text, text): arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:25:59.064525 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5364006-f736-4c2c-84ac-5a274464340f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e4f760>]}
14:25:59.067460 [error] [Thread-1  ]: 5 of 5 ERROR creating materializedview model public.fct_twitter_trending........ [[31mERROR[0m in 0.14s]
14:25:59.071065 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
14:25:59.077226 [debug] [MainThread]: Acquiring new materialize connection "master"
14:25:59.079873 [debug] [MainThread]: Using materialize connection "master"
14:25:59.081792 [debug] [MainThread]: On master: BEGIN
14:25:59.083604 [debug] [MainThread]: Opening a new connection, currently in state closed
14:25:59.089580 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:25:59.092368 [debug] [MainThread]: Using materialize connection "master"
14:25:59.094881 [debug] [MainThread]: On master: COMMIT
14:25:59.097980 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:25:59.100015 [debug] [MainThread]: On master: Close
14:25:59.103955 [info ] [MainThread]: 
14:25:59.106652 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.13s.
14:25:59.109239 [debug] [MainThread]: Connection 'master' was properly closed.
14:25:59.110941 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
14:25:59.149189 [info ] [MainThread]: 
14:25:59.151870 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:25:59.154416 [info ] [MainThread]: 
14:25:59.157144 [error] [MainThread]: [33mDatabase Error in model fct_twitter_trending (models/twitter_trending/marts/twitter/fct_twitter_trending.sql)[0m
14:25:59.159389 [error] [MainThread]:   Cannot call function to_jsonb(text, text): arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
14:25:59.161937 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:25:59.164380 [info ] [MainThread]: 
14:25:59.167447 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
14:25:59.172593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e3a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e53eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e53310>]}


============================== 2022-02-23 14:27:33.132325 | baa4c9cd-0471-4748-94c8-0fd0a65c5d10 ==============================
14:27:33.132325 [info ] [MainThread]: Running with dbt=1.0.1
14:27:33.140665 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:27:33.145328 [debug] [MainThread]: Tracking: tracking
14:27:33.187908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abdc0>]}
14:27:33.524694 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:27:33.528666 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:27:33.638470 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
14:27:33.827167 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

14:27:33.869496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'baa4c9cd-0471-4748-94c8-0fd0a65c5d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c290d0>]}
14:27:33.919400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'baa4c9cd-0471-4748-94c8-0fd0a65c5d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007393c40>]}
14:27:33.922813 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:27:33.931624 [info ] [MainThread]: 
14:27:33.935761 [debug] [MainThread]: Acquiring new materialize connection "master"
14:27:33.946475 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
14:27:34.014408 [debug] [ThreadPool]: Using materialize connection "list_materialize"
14:27:34.017626 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
14:27:34.020315 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:27:34.054398 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
14:27:34.064933 [debug] [ThreadPool]: On list_materialize: Close
14:27:34.074519 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
14:27:34.097489 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
14:27:34.100192 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
14:27:34.102263 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:27:34.109656 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
14:27:34.119533 [debug] [ThreadPool]: On list_materialize_public: Close
14:27:34.126454 [debug] [MainThread]: Using materialize connection "master"
14:27:34.129262 [debug] [MainThread]: On master: BEGIN
14:27:34.131712 [debug] [MainThread]: Opening a new connection, currently in state init
14:27:34.137991 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:27:34.140752 [debug] [MainThread]: Using materialize connection "master"
14:27:34.142429 [debug] [MainThread]: On master: COMMIT
14:27:34.145666 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:27:34.147786 [debug] [MainThread]: On master: Close
14:27:34.150796 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:27:34.153216 [info ] [MainThread]: 
14:27:34.172074 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
14:27:34.175393 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
14:27:34.179313 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
14:27:34.181909 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
14:27:34.184704 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
14:27:34.222687 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
14:27:34.229766 [debug] [Thread-1  ]: finished collecting timing info
14:27:34.232285 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
14:27:34.290713 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:27:34.293732 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
14:27:34.296035 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:27:34.306774 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:27:34.346171 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
14:27:34.355359 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:27:34.357858 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
14:27:34.370315 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:27:34.418491 [debug] [Thread-1  ]: finished collecting timing info
14:27:34.421532 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
14:27:34.425322 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baa4c9cd-0471-4748-94c8-0fd0a65c5d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049dc4760>]}
14:27:34.429257 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.25s]
14:27:34.432452 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
14:27:34.434960 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
14:27:34.437872 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
14:27:34.441230 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
14:27:34.443929 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
14:27:34.446050 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
14:27:34.469218 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
14:27:34.477100 [debug] [Thread-1  ]: finished collecting timing info
14:27:34.479821 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
14:27:34.490036 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:27:34.492369 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
14:27:34.494388 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:27:34.504288 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:27:34.513019 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
14:27:34.519096 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:27:34.521337 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
14:27:34.531334 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:27:34.540804 [debug] [Thread-1  ]: finished collecting timing info
14:27:34.543320 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
14:27:34.547221 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baa4c9cd-0471-4748-94c8-0fd0a65c5d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c42910>]}
14:27:34.550641 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.11s]
14:27:34.553987 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
14:27:34.556186 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
14:27:34.559578 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
14:27:34.563677 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
14:27:34.566061 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
14:27:34.568715 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
14:27:34.588204 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
14:27:34.595036 [debug] [Thread-1  ]: finished collecting timing info
14:27:34.597149 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
14:27:34.667522 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:27:34.670306 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
14:27:34.672392 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:27:34.678673 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:27:34.704741 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
14:27:34.711083 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:27:34.714553 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'location'->>'woeid')::string as woeid,
       (data->'trends'->0->'trends')::jsonb as trends,
       (data->'trends'->0->>'as_of')::timestamp as trend_as_of
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        woeid,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume,
        trend_as_of
    FROM renamed
)

SELECT * FROM final
  );
14:27:34.724864 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:27:34.734676 [debug] [Thread-1  ]: finished collecting timing info
14:27:34.736861 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
14:27:34.740113 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baa4c9cd-0471-4748-94c8-0fd0a65c5d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d833a0>]}
14:27:34.743771 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.18s]
14:27:34.746840 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
14:27:34.748927 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
14:27:34.751484 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
14:27:34.755418 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
14:27:34.758058 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
14:27:34.760464 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
14:27:34.778497 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
14:27:34.785998 [debug] [Thread-1  ]: finished collecting timing info
14:27:34.788692 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
14:27:34.806563 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:27:34.809244 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
14:27:34.811932 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:27:34.817913 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:27:34.827140 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
14:27:34.833087 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:27:34.834993 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
14:27:34.842487 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:27:34.852350 [debug] [Thread-1  ]: finished collecting timing info
14:27:34.856301 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
14:27:34.860842 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baa4c9cd-0471-4748-94c8-0fd0a65c5d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d70e50>]}
14:27:34.864749 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.11s]
14:27:34.867906 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
14:27:34.873521 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
14:27:34.876277 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
14:27:34.880241 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
14:27:34.882514 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
14:27:34.884897 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
14:27:34.905627 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
14:27:34.912136 [debug] [Thread-1  ]: finished collecting timing info
14:27:34.914883 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
14:27:34.964792 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:27:34.968075 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
14:27:34.970457 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:27:34.976381 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:27:34.992412 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
14:27:34.999345 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:27:35.002054 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


select tt.location_name
     , tt.location_country
     , tt.trend_name
     , tt.trend_volume
     , tt.trend_as_of as trend_date
     , wc.lat::float as location_latitude, wc.lng::float as location_longiture
from "materialize"."public"."stg_twitter_trending" tt
    join "materialize"."public"."stg_worldcities" wc
on tt.location_name = wc.city and tt.location_country = wc.country
group by woeid, tt.location_name, tt.location_country, tt.trend_name, tt.trend_volume, tt.trend_as_of, wc.lat, wc.lng
where tt.trend_volume > 0
  );
14:27:35.006738 [debug] [Thread-1  ]: Postgres adapter: Postgres error: Expected right parenthesis, found WHERE
LINE 17: where tt.trend_volume > 0
         ^

14:27:35.009349 [debug] [Thread-1  ]: finished collecting timing info
14:27:35.011654 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
14:27:35.014742 [debug] [Thread-1  ]: Database Error in model fct_twitter_trending (models/twitter_trending/marts/twitter/fct_twitter_trending.sql)
  Expected right parenthesis, found WHERE
  LINE 17: where tt.trend_volume > 0
           ^
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:27:35.017714 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baa4c9cd-0471-4748-94c8-0fd0a65c5d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e4e760>]}
14:27:35.020756 [error] [Thread-1  ]: 5 of 5 ERROR creating materializedview model public.fct_twitter_trending........ [[31mERROR[0m in 0.14s]
14:27:35.023998 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
14:27:35.029984 [debug] [MainThread]: Acquiring new materialize connection "master"
14:27:35.032855 [debug] [MainThread]: Using materialize connection "master"
14:27:35.034759 [debug] [MainThread]: On master: BEGIN
14:27:35.036913 [debug] [MainThread]: Opening a new connection, currently in state closed
14:27:35.042922 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:27:35.045889 [debug] [MainThread]: Using materialize connection "master"
14:27:35.048106 [debug] [MainThread]: On master: COMMIT
14:27:35.051241 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:27:35.053437 [debug] [MainThread]: On master: Close
14:27:35.057080 [info ] [MainThread]: 
14:27:35.060152 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.12s.
14:27:35.063091 [debug] [MainThread]: Connection 'master' was properly closed.
14:27:35.065536 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
14:27:35.106552 [info ] [MainThread]: 
14:27:35.110433 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:27:35.114260 [info ] [MainThread]: 
14:27:35.118334 [error] [MainThread]: [33mDatabase Error in model fct_twitter_trending (models/twitter_trending/marts/twitter/fct_twitter_trending.sql)[0m
14:27:35.121635 [error] [MainThread]:   Expected right parenthesis, found WHERE
14:27:35.124922 [error] [MainThread]:   LINE 17: where tt.trend_volume > 0
14:27:35.128172 [error] [MainThread]:            ^
14:27:35.131704 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:27:35.135711 [info ] [MainThread]: 
14:27:35.138384 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
14:27:35.142003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e3a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e54370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e54850>]}


============================== 2022-02-23 14:28:07.057961 | ede19d72-944c-4378-943c-adbdedff27b5 ==============================
14:28:07.057961 [info ] [MainThread]: Running with dbt=1.0.1
14:28:07.064478 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:28:07.068281 [debug] [MainThread]: Tracking: tracking
14:28:07.096840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe20>]}
14:28:07.459339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:28:07.463738 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:28:07.567860 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
14:28:07.749027 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

14:28:07.786716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ede19d72-944c-4378-943c-adbdedff27b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c250d0>]}
14:28:07.836698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ede19d72-944c-4378-943c-adbdedff27b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007393c70>]}
14:28:07.840050 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:28:07.848552 [info ] [MainThread]: 
14:28:07.852925 [debug] [MainThread]: Acquiring new materialize connection "master"
14:28:07.862151 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
14:28:07.929237 [debug] [ThreadPool]: Using materialize connection "list_materialize"
14:28:07.932555 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
14:28:07.934954 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:28:07.964755 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
14:28:07.975076 [debug] [ThreadPool]: On list_materialize: Close
14:28:07.985301 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
14:28:08.008786 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
14:28:08.011522 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
14:28:08.013633 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:28:08.021208 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
14:28:08.030441 [debug] [ThreadPool]: On list_materialize_public: Close
14:28:08.037104 [debug] [MainThread]: Using materialize connection "master"
14:28:08.039525 [debug] [MainThread]: On master: BEGIN
14:28:08.041608 [debug] [MainThread]: Opening a new connection, currently in state init
14:28:08.047334 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:28:08.049878 [debug] [MainThread]: Using materialize connection "master"
14:28:08.052468 [debug] [MainThread]: On master: COMMIT
14:28:08.056355 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:28:08.059162 [debug] [MainThread]: On master: Close
14:28:08.062342 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:28:08.064963 [info ] [MainThread]: 
14:28:08.083244 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
14:28:08.086684 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
14:28:08.090615 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
14:28:08.092657 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
14:28:08.095023 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
14:28:08.124563 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
14:28:08.131335 [debug] [Thread-1  ]: finished collecting timing info
14:28:08.133513 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
14:28:08.188908 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:28:08.191497 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
14:28:08.193618 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:28:08.205073 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:28:08.245280 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
14:28:08.252448 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:28:08.254550 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
14:28:08.266380 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:28:08.314686 [debug] [Thread-1  ]: finished collecting timing info
14:28:08.317455 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
14:28:08.321415 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ede19d72-944c-4378-943c-adbdedff27b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d93e20>]}
14:28:08.324509 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.23s]
14:28:08.327957 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
14:28:08.330525 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
14:28:08.333501 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
14:28:08.337404 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
14:28:08.339940 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
14:28:08.342386 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
14:28:08.372326 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
14:28:08.380126 [debug] [Thread-1  ]: finished collecting timing info
14:28:08.382948 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
14:28:08.395122 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:28:08.398828 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
14:28:08.402128 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:28:08.411053 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:28:08.419295 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
14:28:08.424561 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:28:08.426339 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
14:28:08.435437 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:28:08.445757 [debug] [Thread-1  ]: finished collecting timing info
14:28:08.448440 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
14:28:08.452099 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ede19d72-944c-4378-943c-adbdedff27b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c51940>]}
14:28:08.456583 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.12s]
14:28:08.459884 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
14:28:08.462198 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
14:28:08.465098 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
14:28:08.468572 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
14:28:08.470870 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
14:28:08.473260 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
14:28:08.491269 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
14:28:08.497210 [debug] [Thread-1  ]: finished collecting timing info
14:28:08.499282 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
14:28:08.567136 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:28:08.570212 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
14:28:08.572619 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:28:08.578829 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:28:08.603824 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
14:28:08.610728 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:28:08.613507 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'location'->>'woeid')::string as woeid,
       (data->'trends'->0->'trends')::jsonb as trends,
       (data->'trends'->0->>'as_of')::timestamp as trend_as_of
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        woeid,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume,
        trend_as_of
    FROM renamed
)

SELECT * FROM final
  );
14:28:08.623722 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:28:08.633299 [debug] [Thread-1  ]: finished collecting timing info
14:28:08.635663 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
14:28:08.639542 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ede19d72-944c-4378-943c-adbdedff27b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d8e400>]}
14:28:08.643249 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.17s]
14:28:08.646478 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
14:28:08.649048 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
14:28:08.651543 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
14:28:08.654994 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
14:28:08.657622 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
14:28:08.659784 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
14:28:08.677996 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
14:28:08.684505 [debug] [Thread-1  ]: finished collecting timing info
14:28:08.687040 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
14:28:08.705054 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:28:08.707496 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
14:28:08.709584 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:28:08.715615 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:28:08.725814 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
14:28:08.731220 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:28:08.733342 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
14:28:08.740329 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:28:08.750164 [debug] [Thread-1  ]: finished collecting timing info
14:28:08.752333 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
14:28:08.756330 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ede19d72-944c-4378-943c-adbdedff27b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d69eb0>]}
14:28:08.759756 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.10s]
14:28:08.762718 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
14:28:08.768350 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
14:28:08.770987 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
14:28:08.774334 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
14:28:08.776816 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
14:28:08.779717 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
14:28:08.798590 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
14:28:08.807193 [debug] [Thread-1  ]: finished collecting timing info
14:28:08.809493 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
14:28:08.858266 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:28:08.861235 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
14:28:08.863910 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:28:08.870137 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:28:08.886686 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
14:28:08.893426 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:28:08.896156 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    


select tt.location_name
     , tt.location_country
     , tt.trend_name
     , tt.trend_volume
     , tt.trend_as_of as trend_date
     , wc.lat::float as location_latitude
     , wc.lng::float as location_longiture
from "materialize"."public"."stg_twitter_trending" tt
    join "materialize"."public"."stg_worldcities" wc
on tt.location_name = wc.city and tt.location_country = wc.country
where tt.trend_volume > 0
  );
14:28:08.908870 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:28:08.921973 [debug] [Thread-1  ]: finished collecting timing info
14:28:08.924884 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
14:28:08.928768 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ede19d72-944c-4378-943c-adbdedff27b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f2afa0>]}
14:28:08.932438 [info ] [Thread-1  ]: 5 of 5 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.15s]
14:28:08.935560 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
14:28:08.941327 [debug] [MainThread]: Acquiring new materialize connection "master"
14:28:08.944432 [debug] [MainThread]: Using materialize connection "master"
14:28:08.946416 [debug] [MainThread]: On master: BEGIN
14:28:08.948621 [debug] [MainThread]: Opening a new connection, currently in state closed
14:28:08.954147 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:28:08.957468 [debug] [MainThread]: Using materialize connection "master"
14:28:08.959684 [debug] [MainThread]: On master: COMMIT
14:28:08.962575 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:28:08.964927 [debug] [MainThread]: On master: Close
14:28:08.968745 [info ] [MainThread]: 
14:28:08.971762 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.12s.
14:28:08.974381 [debug] [MainThread]: Connection 'master' was properly closed.
14:28:08.977095 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
14:28:09.013517 [info ] [MainThread]: 
14:28:09.016243 [info ] [MainThread]: [32mCompleted successfully[0m
14:28:09.019111 [info ] [MainThread]: 
14:28:09.021542 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
14:28:09.024449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d60f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d7a0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f4f5e0>]}


============================== 2022-02-23 14:31:58.581142 | 9ecf0ad4-df21-4838-b493-15417f9d1d71 ==============================
14:31:58.581142 [info ] [MainThread]: Running with dbt=1.0.1
14:31:58.587866 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:31:58.590441 [debug] [MainThread]: Tracking: tracking
14:31:58.619586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace20>]}
14:31:58.954453 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:31:58.958585 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:31:59.063429 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
14:31:59.253190 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

14:31:59.299229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ecf0ad4-df21-4838-b493-15417f9d1d71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2c0d0>]}
14:31:59.350313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ecf0ad4-df21-4838-b493-15417f9d1d71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007393c70>]}
14:31:59.353860 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:31:59.363728 [info ] [MainThread]: 
14:31:59.368307 [debug] [MainThread]: Acquiring new materialize connection "master"
14:31:59.379071 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
14:31:59.448339 [debug] [ThreadPool]: Using materialize connection "list_materialize"
14:31:59.451254 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
14:31:59.453617 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:31:59.483291 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
14:31:59.493798 [debug] [ThreadPool]: On list_materialize: Close
14:31:59.504026 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
14:31:59.526883 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
14:31:59.529686 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
14:31:59.531901 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:31:59.541566 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
14:31:59.551180 [debug] [ThreadPool]: On list_materialize_public: Close
14:31:59.558383 [debug] [MainThread]: Using materialize connection "master"
14:31:59.560978 [debug] [MainThread]: On master: BEGIN
14:31:59.563600 [debug] [MainThread]: Opening a new connection, currently in state init
14:31:59.572316 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:31:59.574876 [debug] [MainThread]: Using materialize connection "master"
14:31:59.576835 [debug] [MainThread]: On master: COMMIT
14:31:59.579388 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:31:59.581437 [debug] [MainThread]: On master: Close
14:31:59.584251 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:31:59.586938 [info ] [MainThread]: 
14:31:59.609174 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
14:31:59.613028 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
14:31:59.617179 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
14:31:59.620660 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
14:31:59.623013 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
14:31:59.654523 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
14:31:59.661244 [debug] [Thread-1  ]: finished collecting timing info
14:31:59.663697 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
14:31:59.720476 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:31:59.723189 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
14:31:59.725523 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:31:59.737269 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:31:59.777869 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
14:31:59.785551 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:31:59.787881 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
14:31:59.800342 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:31:59.849293 [debug] [Thread-1  ]: finished collecting timing info
14:31:59.852127 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
14:31:59.855726 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ecf0ad4-df21-4838-b493-15417f9d1d71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ec51f0>]}
14:31:59.859461 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.24s]
14:31:59.863048 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
14:31:59.865508 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
14:31:59.868220 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
14:31:59.871907 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
14:31:59.874582 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
14:31:59.878146 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
14:31:59.901746 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
14:31:59.909340 [debug] [Thread-1  ]: finished collecting timing info
14:31:59.912615 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
14:31:59.923619 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:31:59.926074 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
14:31:59.928435 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:31:59.937902 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:31:59.946282 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
14:31:59.952095 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:31:59.954115 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
14:31:59.963195 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:31:59.972878 [debug] [Thread-1  ]: finished collecting timing info
14:31:59.976162 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
14:31:59.979845 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ecf0ad4-df21-4838-b493-15417f9d1d71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c51940>]}
14:31:59.983714 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.11s]
14:31:59.986745 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
14:31:59.989040 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
14:31:59.992246 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
14:31:59.995649 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
14:31:59.997617 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
14:31:59.999709 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
14:32:00.019074 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
14:32:00.026213 [debug] [Thread-1  ]: finished collecting timing info
14:32:00.028724 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
14:32:00.099538 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:32:00.103086 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
14:32:00.105241 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:32:00.111280 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:32:00.136976 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
14:32:00.142921 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:32:00.145647 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'location'->>'woeid')::string as woeid,
       (data->'trends'->0->'trends')::jsonb as trends,
       (data->'trends'->0->>'as_of')::timestamp as trend_as_of
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        woeid,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume,
        trend_as_of
    FROM renamed
)

SELECT * FROM final
  );
14:32:00.156293 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:32:00.166167 [debug] [Thread-1  ]: finished collecting timing info
14:32:00.168710 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
14:32:00.172278 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ecf0ad4-df21-4838-b493-15417f9d1d71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d8e400>]}
14:32:00.175845 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.18s]
14:32:00.178897 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
14:32:00.181604 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
14:32:00.184661 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
14:32:00.188490 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
14:32:00.190794 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
14:32:00.192783 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
14:32:00.210379 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
14:32:00.217525 [debug] [Thread-1  ]: finished collecting timing info
14:32:00.219642 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
14:32:00.236314 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:32:00.238628 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
14:32:00.240734 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:32:00.246897 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:32:00.256864 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
14:32:00.262114 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:32:00.264385 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
14:32:00.272269 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:32:00.282183 [debug] [Thread-1  ]: finished collecting timing info
14:32:00.284727 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
14:32:00.288292 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ecf0ad4-df21-4838-b493-15417f9d1d71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d72eb0>]}
14:32:00.292027 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.10s]
14:32:00.295189 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
14:32:00.303241 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
14:32:00.306105 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
14:32:00.311115 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
14:32:00.315574 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
14:32:00.319050 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
14:32:00.343799 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
14:32:00.352031 [debug] [Thread-1  ]: finished collecting timing info
14:32:00.354647 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
14:32:00.405676 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:32:00.409108 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
14:32:00.411672 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:32:00.417724 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:32:00.434293 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
14:32:00.441109 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:32:00.444764 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    

with ranked_trends as (
    select tt.location_name
         , tt.location_country
         , tt.trend_name
         , tt.trend_volume
         , tt.trend_as_of as trend_date
         , wc.lat::float as location_latitude
         , wc.lng::float as location_longiture
         , ROW_NUMBER() over (partition by tt.woeid order by tt.trend_volume desc) as trend_rank
from "materialize"."public"."stg_twitter_trending" tt
    join "materialize"."public"."stg_worldcities" wc
on tt.location_name = wc.city and tt.location_country = wc.country
where tt.trend_volume > 0
    )

select * from ranked_trends
where trend_rank = 1
  );
14:32:00.458947 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:32:00.471305 [debug] [Thread-1  ]: finished collecting timing info
14:32:00.474145 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
14:32:00.478123 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ecf0ad4-df21-4838-b493-15417f9d1d71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f2bfa0>]}
14:32:00.481763 [info ] [Thread-1  ]: 5 of 5 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.17s]
14:32:00.484987 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
14:32:00.491401 [debug] [MainThread]: Acquiring new materialize connection "master"
14:32:00.494190 [debug] [MainThread]: Using materialize connection "master"
14:32:00.496495 [debug] [MainThread]: On master: BEGIN
14:32:00.498625 [debug] [MainThread]: Opening a new connection, currently in state closed
14:32:00.504419 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:32:00.507452 [debug] [MainThread]: Using materialize connection "master"
14:32:00.510091 [debug] [MainThread]: On master: COMMIT
14:32:00.513854 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:32:00.516606 [debug] [MainThread]: On master: Close
14:32:00.520433 [info ] [MainThread]: 
14:32:00.523591 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.15s.
14:32:00.527161 [debug] [MainThread]: Connection 'master' was properly closed.
14:32:00.529501 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
14:32:00.568617 [info ] [MainThread]: 
14:32:00.572174 [info ] [MainThread]: [32mCompleted successfully[0m
14:32:00.575752 [info ] [MainThread]: 
14:32:00.578726 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
14:32:00.583134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d61f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d7b0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f4f5e0>]}


============================== 2022-02-23 14:33:47.342206 | 70483e3f-de87-45c3-acef-dd965b297906 ==============================
14:33:47.342206 [info ] [MainThread]: Running with dbt=1.0.1
14:33:47.350603 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:33:47.356884 [debug] [MainThread]: Tracking: tracking
14:33:47.388512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe20>]}
14:33:47.780445 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:33:47.784852 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:33:47.902664 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
14:33:48.106370 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

14:33:48.149062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70483e3f-de87-45c3-acef-dd965b297906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c280d0>]}
14:33:48.203456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70483e3f-de87-45c3-acef-dd965b297906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007393c70>]}
14:33:48.206573 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:33:48.217369 [info ] [MainThread]: 
14:33:48.222506 [debug] [MainThread]: Acquiring new materialize connection "master"
14:33:48.233294 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
14:33:48.302642 [debug] [ThreadPool]: Using materialize connection "list_materialize"
14:33:48.305996 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
14:33:48.308662 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:33:48.342364 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
14:33:48.365072 [debug] [ThreadPool]: On list_materialize: Close
14:33:48.375498 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
14:33:48.398680 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
14:33:48.401339 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
14:33:48.403593 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:33:48.411610 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
14:33:48.421782 [debug] [ThreadPool]: On list_materialize_public: Close
14:33:48.428686 [debug] [MainThread]: Using materialize connection "master"
14:33:48.431510 [debug] [MainThread]: On master: BEGIN
14:33:48.433859 [debug] [MainThread]: Opening a new connection, currently in state init
14:33:48.439928 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:33:48.443338 [debug] [MainThread]: Using materialize connection "master"
14:33:48.445410 [debug] [MainThread]: On master: COMMIT
14:33:48.448514 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:33:48.450964 [debug] [MainThread]: On master: Close
14:33:48.455257 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:33:48.459761 [info ] [MainThread]: 
14:33:48.483244 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
14:33:48.488578 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
14:33:48.497128 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
14:33:48.502683 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
14:33:48.505866 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
14:33:48.553241 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
14:33:48.560799 [debug] [Thread-1  ]: finished collecting timing info
14:33:48.563364 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
14:33:48.630768 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:33:48.635218 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
14:33:48.637428 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:33:48.650375 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:33:48.698364 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
14:33:48.707454 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:33:48.710059 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
14:33:48.721752 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:33:48.774992 [debug] [Thread-1  ]: finished collecting timing info
14:33:48.778448 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
14:33:48.783387 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70483e3f-de87-45c3-acef-dd965b297906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049dc41f0>]}
14:33:48.787602 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.29s]
14:33:48.793229 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
14:33:48.798381 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
14:33:48.801854 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
14:33:48.807695 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
14:33:48.810381 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
14:33:48.812634 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
14:33:48.840098 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
14:33:48.848928 [debug] [Thread-1  ]: finished collecting timing info
14:33:48.851497 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
14:33:48.865666 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:33:48.868622 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
14:33:48.872001 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:33:48.882865 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:33:48.892838 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
14:33:48.900244 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:33:48.902634 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
14:33:48.912836 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:33:48.922910 [debug] [Thread-1  ]: finished collecting timing info
14:33:48.925751 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
14:33:48.930311 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70483e3f-de87-45c3-acef-dd965b297906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c51640>]}
14:33:48.933700 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.12s]
14:33:48.937839 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
14:33:48.940981 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
14:33:48.943746 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
14:33:48.947484 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
14:33:48.949984 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
14:33:48.952501 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
14:33:48.970657 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
14:33:48.977967 [debug] [Thread-1  ]: finished collecting timing info
14:33:48.980563 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
14:33:49.057668 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:33:49.061946 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
14:33:49.064598 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:33:49.073409 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:33:49.103219 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
14:33:49.114804 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:33:49.119429 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'location'->>'woeid')::string as woeid,
       (data->'trends'->0->'trends')::jsonb as trends,
       (data->'trends'->0->>'as_of')::timestamp as trend_as_of
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        woeid,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume,
        trend_as_of
    FROM renamed
)

SELECT * FROM final
  );
14:33:49.134401 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:33:49.145550 [debug] [Thread-1  ]: finished collecting timing info
14:33:49.148953 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
14:33:49.153260 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70483e3f-de87-45c3-acef-dd965b297906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d8a1c0>]}
14:33:49.158180 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.21s]
14:33:49.161668 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
14:33:49.164222 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
14:33:49.167401 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
14:33:49.171385 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
14:33:49.174733 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
14:33:49.178232 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
14:33:49.199415 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
14:33:49.206324 [debug] [Thread-1  ]: finished collecting timing info
14:33:49.209212 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
14:33:49.228196 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:33:49.231925 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
14:33:49.234851 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:33:49.242080 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:33:49.253153 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
14:33:49.260342 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:33:49.263846 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
14:33:49.274092 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:33:49.285372 [debug] [Thread-1  ]: finished collecting timing info
14:33:49.289641 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
14:33:49.295992 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70483e3f-de87-45c3-acef-dd965b297906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d71eb0>]}
14:33:49.299952 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.13s]
14:33:49.303082 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
14:33:49.309714 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
14:33:49.313158 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
14:33:49.318340 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
14:33:49.320942 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
14:33:49.323531 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
14:33:49.345396 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
14:33:49.353523 [debug] [Thread-1  ]: finished collecting timing info
14:33:49.356388 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
14:33:49.411296 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:33:49.415420 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
14:33:49.418782 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:33:49.425561 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:33:49.444146 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
14:33:49.451380 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:33:49.454913 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    

with ranked_trends as (
    select tt.location_name
         , tt.location_country
         , tt.trend_name
         , tt.trend_volume
         , tt.trend_as_of as trend_date
         , wc.lat::float as location_latitude
         , wc.lng::float as location_longitude
         , ROW_NUMBER() over (partition by tt.woeid order by tt.trend_volume desc) as trend_rank
from "materialize"."public"."stg_twitter_trending" tt
    join "materialize"."public"."stg_worldcities" wc
on tt.location_name = wc.city and tt.location_country = wc.country
where tt.trend_volume > 0
    )

select location_name, location_country, trend_name, location_latitude, location_longitude from ranked_trends
where trend_rank = 1
  );
14:33:49.469948 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:33:49.483932 [debug] [Thread-1  ]: finished collecting timing info
14:33:49.486963 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
14:33:49.490408 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70483e3f-de87-45c3-acef-dd965b297906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e2afa0>]}
14:33:49.494718 [info ] [Thread-1  ]: 5 of 5 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.17s]
14:33:49.500577 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
14:33:49.507568 [debug] [MainThread]: Acquiring new materialize connection "master"
14:33:49.511587 [debug] [MainThread]: Using materialize connection "master"
14:33:49.515204 [debug] [MainThread]: On master: BEGIN
14:33:49.518111 [debug] [MainThread]: Opening a new connection, currently in state closed
14:33:49.523905 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:33:49.527527 [debug] [MainThread]: Using materialize connection "master"
14:33:49.529970 [debug] [MainThread]: On master: COMMIT
14:33:49.533279 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:33:49.535607 [debug] [MainThread]: On master: Close
14:33:49.539441 [info ] [MainThread]: 
14:33:49.542632 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.32s.
14:33:49.546449 [debug] [MainThread]: Connection 'master' was properly closed.
14:33:49.548912 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
14:33:49.592130 [info ] [MainThread]: 
14:33:49.596191 [info ] [MainThread]: [32mCompleted successfully[0m
14:33:49.600434 [info ] [MainThread]: 
14:33:49.604202 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
14:33:49.608371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d61f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d7b0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e4edf0>]}


============================== 2022-02-23 14:34:13.484492 | ef00d8c4-799e-45ea-9b58-b5a3681abb6c ==============================
14:34:13.484492 [info ] [MainThread]: Running with dbt=1.0.1
14:34:13.491759 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:34:13.494238 [debug] [MainThread]: Tracking: tracking
14:34:13.523932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728adc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728aeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728ae50>]}
14:34:13.876138 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:34:13.880407 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:34:13.988625 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
14:34:14.173138 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

14:34:14.213817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef00d8c4-799e-45ea-9b58-b5a3681abb6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c280d0>]}
14:34:14.263429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef00d8c4-799e-45ea-9b58-b5a3681abb6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007393b20>]}
14:34:14.266848 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:34:14.275633 [info ] [MainThread]: 
14:34:14.280440 [debug] [MainThread]: Acquiring new materialize connection "master"
14:34:14.290068 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
14:34:14.361902 [debug] [ThreadPool]: Using materialize connection "list_materialize"
14:34:14.365146 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
14:34:14.368044 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:34:14.397876 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
14:34:14.408166 [debug] [ThreadPool]: On list_materialize: Close
14:34:14.418617 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
14:34:14.442556 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
14:34:14.445046 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
14:34:14.447273 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:34:14.454346 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
14:34:14.463468 [debug] [ThreadPool]: On list_materialize_public: Close
14:34:14.470754 [debug] [MainThread]: Using materialize connection "master"
14:34:14.473082 [debug] [MainThread]: On master: BEGIN
14:34:14.475374 [debug] [MainThread]: Opening a new connection, currently in state init
14:34:14.481366 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:34:14.484345 [debug] [MainThread]: Using materialize connection "master"
14:34:14.486615 [debug] [MainThread]: On master: COMMIT
14:34:14.490077 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:34:14.492410 [debug] [MainThread]: On master: Close
14:34:14.495748 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:34:14.498634 [info ] [MainThread]: 
14:34:14.516837 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
14:34:14.521290 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
14:34:14.525262 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
14:34:14.528837 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
14:34:14.530959 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
14:34:14.562669 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
14:34:14.570158 [debug] [Thread-1  ]: finished collecting timing info
14:34:14.572469 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
14:34:14.629746 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:34:14.632618 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
14:34:14.634879 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:34:14.645840 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:34:14.695484 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
14:34:14.702136 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:34:14.704866 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
14:34:14.715672 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:34:14.766372 [debug] [Thread-1  ]: finished collecting timing info
14:34:14.769242 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
14:34:14.773130 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef00d8c4-799e-45ea-9b58-b5a3681abb6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049dc36d0>]}
14:34:14.777038 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.25s]
14:34:14.780400 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
14:34:14.782543 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
14:34:14.785388 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
14:34:14.789300 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
14:34:14.791830 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
14:34:14.794073 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
14:34:14.817391 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
14:34:14.823654 [debug] [Thread-1  ]: finished collecting timing info
14:34:14.832839 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
14:34:14.843782 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:34:14.846206 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
14:34:14.848276 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:34:14.858837 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:34:14.867444 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
14:34:14.873330 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:34:14.875326 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
14:34:14.884894 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:34:14.894564 [debug] [Thread-1  ]: finished collecting timing info
14:34:14.896830 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
14:34:14.900343 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef00d8c4-799e-45ea-9b58-b5a3681abb6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c4e730>]}
14:34:14.903779 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.11s]
14:34:14.906951 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
14:34:14.909269 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
14:34:14.912286 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
14:34:14.916028 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
14:34:14.918321 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
14:34:14.920187 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
14:34:14.940044 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
14:34:14.947248 [debug] [Thread-1  ]: finished collecting timing info
14:34:14.949955 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
14:34:15.021043 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:34:15.023921 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
14:34:15.026218 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:34:15.032142 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:34:15.058533 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
14:34:15.064749 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:34:15.067192 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'location'->>'woeid')::string as woeid,
       (data->'trends'->0->'trends')::jsonb as trends,
       (data->'trends'->0->>'as_of')::timestamp as trend_as_of
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        woeid,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume,
        trend_as_of
    FROM renamed
)

SELECT * FROM final
  );
14:34:15.077083 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:34:15.087174 [debug] [Thread-1  ]: finished collecting timing info
14:34:15.089433 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
14:34:15.093155 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef00d8c4-799e-45ea-9b58-b5a3681abb6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d82970>]}
14:34:15.096949 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.18s]
14:34:15.099924 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
14:34:15.102626 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
14:34:15.105193 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
14:34:15.109121 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
14:34:15.111536 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
14:34:15.113984 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
14:34:15.133174 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
14:34:15.139313 [debug] [Thread-1  ]: finished collecting timing info
14:34:15.141453 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
14:34:15.158639 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:34:15.173287 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
14:34:15.175614 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:34:15.182545 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:34:15.191802 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
14:34:15.197171 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:34:15.199790 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
14:34:15.208301 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:34:15.218572 [debug] [Thread-1  ]: finished collecting timing info
14:34:15.220841 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
14:34:15.224407 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef00d8c4-799e-45ea-9b58-b5a3681abb6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d71ee0>]}
14:34:15.227785 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.12s]
14:34:15.230879 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
14:34:15.236187 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
14:34:15.239125 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
14:34:15.244340 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
14:34:15.246902 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
14:34:15.248847 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
14:34:15.269380 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
14:34:15.275910 [debug] [Thread-1  ]: finished collecting timing info
14:34:15.278097 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
14:34:15.327449 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:34:15.329979 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
14:34:15.333606 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:34:15.341141 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:34:15.358369 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
14:34:15.366593 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:34:15.369072 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    

with ranked_trends as (
    select tt.location_name
         , tt.location_country
         , tt.trend_name
         , tt.trend_volume
         , tt.trend_as_of as trend_date
         , wc.lat::float as location_latitude
         , wc.lng::float as location_longitude
         , ROW_NUMBER() over (partition by tt.woeid order by tt.trend_volume desc) as trend_rank
from "materialize"."public"."stg_twitter_trending" tt
    join "materialize"."public"."stg_worldcities" wc
on tt.location_name = wc.city and tt.location_country = wc.country
where tt.trend_volume > 0
    )

select location_name, location_country, trend_name, location_latitude, location_longitude, trend_date from ranked_trends
where trend_rank = 1
  );
14:34:15.383907 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:34:15.397831 [debug] [Thread-1  ]: finished collecting timing info
14:34:15.400840 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
14:34:15.405057 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef00d8c4-799e-45ea-9b58-b5a3681abb6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e414c0>]}
14:34:15.409389 [info ] [Thread-1  ]: 5 of 5 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.16s]
14:34:15.412920 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
14:34:15.419340 [debug] [MainThread]: Acquiring new materialize connection "master"
14:34:15.422635 [debug] [MainThread]: Using materialize connection "master"
14:34:15.425357 [debug] [MainThread]: On master: BEGIN
14:34:15.428332 [debug] [MainThread]: Opening a new connection, currently in state closed
14:34:15.434094 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:34:15.437127 [debug] [MainThread]: Using materialize connection "master"
14:34:15.439117 [debug] [MainThread]: On master: COMMIT
14:34:15.442057 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:34:15.444422 [debug] [MainThread]: On master: Close
14:34:15.448809 [info ] [MainThread]: 
14:34:15.452632 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.17s.
14:34:15.455810 [debug] [MainThread]: Connection 'master' was properly closed.
14:34:15.458127 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
14:34:15.495381 [info ] [MainThread]: 
14:34:15.498228 [info ] [MainThread]: [32mCompleted successfully[0m
14:34:15.501530 [info ] [MainThread]: 
14:34:15.504139 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
14:34:15.507053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5cc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e4f730>]}


============================== 2022-02-23 14:35:47.276496 | 22ec3bb9-8734-4286-b05e-143df837596a ==============================
14:35:47.276496 [info ] [MainThread]: Running with dbt=1.0.1
14:35:47.283113 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:35:47.285845 [debug] [MainThread]: Tracking: tracking
14:35:47.313668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace20>]}
14:35:47.660882 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:35:47.664736 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:35:47.773126 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
14:35:47.983377 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

14:35:48.031341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22ec3bb9-8734-4286-b05e-143df837596a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2a0d0>]}
14:35:48.089868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22ec3bb9-8734-4286-b05e-143df837596a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007393c70>]}
14:35:48.093145 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:35:48.102045 [info ] [MainThread]: 
14:35:48.107335 [debug] [MainThread]: Acquiring new materialize connection "master"
14:35:48.119048 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
14:35:48.199023 [debug] [ThreadPool]: Using materialize connection "list_materialize"
14:35:48.201908 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
14:35:48.204342 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:35:48.235293 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
14:35:48.245888 [debug] [ThreadPool]: On list_materialize: Close
14:35:48.256457 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
14:35:48.280307 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
14:35:48.283040 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
14:35:48.285097 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:35:48.292771 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
14:35:48.302347 [debug] [ThreadPool]: On list_materialize_public: Close
14:35:48.309025 [debug] [MainThread]: Using materialize connection "master"
14:35:48.311597 [debug] [MainThread]: On master: BEGIN
14:35:48.314397 [debug] [MainThread]: Opening a new connection, currently in state init
14:35:48.320138 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:35:48.322888 [debug] [MainThread]: Using materialize connection "master"
14:35:48.325163 [debug] [MainThread]: On master: COMMIT
14:35:48.328414 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:35:48.330802 [debug] [MainThread]: On master: Close
14:35:48.334314 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:35:48.337560 [info ] [MainThread]: 
14:35:48.355341 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
14:35:48.358796 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
14:35:48.363274 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
14:35:48.365603 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
14:35:48.368454 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
14:35:48.401685 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
14:35:48.407828 [debug] [Thread-1  ]: finished collecting timing info
14:35:48.410205 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
14:35:48.468608 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:35:48.471556 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
14:35:48.474216 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:35:48.484480 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:35:48.524677 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
14:35:48.531122 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:35:48.533136 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
14:35:48.544592 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:35:48.593747 [debug] [Thread-1  ]: finished collecting timing info
14:35:48.596798 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
14:35:48.600592 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22ec3bb9-8734-4286-b05e-143df837596a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ec4700>]}
14:35:48.604203 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.24s]
14:35:48.607821 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
14:35:48.610459 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
14:35:48.613346 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
14:35:48.617314 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
14:35:48.619331 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
14:35:48.621342 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
14:35:48.642773 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
14:35:48.648522 [debug] [Thread-1  ]: finished collecting timing info
14:35:48.650583 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
14:35:48.661006 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:35:48.663152 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
14:35:48.665221 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:35:48.675573 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:35:48.684220 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
14:35:48.690336 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:35:48.692854 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
14:35:48.701559 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:35:48.711396 [debug] [Thread-1  ]: finished collecting timing info
14:35:48.713770 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
14:35:48.717073 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22ec3bb9-8734-4286-b05e-143df837596a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c51940>]}
14:35:48.720285 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.10s]
14:35:48.723559 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
14:35:48.726175 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
14:35:48.729347 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
14:35:48.732810 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
14:35:48.734736 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
14:35:48.737000 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
14:35:48.755315 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
14:35:48.762245 [debug] [Thread-1  ]: finished collecting timing info
14:35:48.764549 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
14:35:48.839403 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:35:48.842142 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
14:35:48.844251 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:35:48.850369 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:35:48.876470 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
14:35:48.882600 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:35:48.884745 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'location'->>'woeid')::string as woeid,
       (data->'trends'->0->'trends')::jsonb as trends,
       (data->'trends'->0->>'as_of')::timestamp as trend_as_of
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        woeid,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume,
        trend_as_of
    FROM renamed
)

SELECT * FROM final
  );
14:35:48.894905 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:35:48.904574 [debug] [Thread-1  ]: finished collecting timing info
14:35:48.907147 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
14:35:48.911033 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22ec3bb9-8734-4286-b05e-143df837596a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d8dcd0>]}
14:35:48.914259 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.18s]
14:35:48.917344 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
14:35:48.920423 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
14:35:48.923200 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
14:35:48.926620 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
14:35:48.928880 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
14:35:48.931126 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
14:35:48.948563 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
14:35:48.955476 [debug] [Thread-1  ]: finished collecting timing info
14:35:48.957913 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
14:35:48.974879 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:35:48.977277 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
14:35:48.979504 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:35:48.985588 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:35:48.994878 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
14:35:49.000601 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:35:49.002689 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
14:35:49.012612 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:35:49.022607 [debug] [Thread-1  ]: finished collecting timing info
14:35:49.025130 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
14:35:49.028686 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22ec3bb9-8734-4286-b05e-143df837596a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d70eb0>]}
14:35:49.032300 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.10s]
14:35:49.035588 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
14:35:49.040662 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
14:35:49.043732 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
14:35:49.047566 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
14:35:49.050148 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
14:35:49.052522 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
14:35:49.071915 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
14:35:49.078792 [debug] [Thread-1  ]: finished collecting timing info
14:35:49.081127 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
14:35:49.130691 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:35:49.133568 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
14:35:49.137499 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:35:49.143831 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:35:49.162651 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
14:35:49.169702 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:35:49.172694 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    

with ranked_trends as (
    select tt.location_name
         , tt.location_country
         , tt.trend_name
         , tt.trend_volume
         , tt.trend_as_of as trend_date
         , wc.lat::float as location_latitude
         , wc.lng::float as location_longitude
         , ROW_NUMBER() over (partition by tt.woeid order by tt.trend_volume desc) as trend_rank
from "materialize"."public"."stg_twitter_trending" tt
    join "materialize"."public"."stg_worldcities" wc
on tt.location_name = wc.city and tt.location_country = wc.country
where tt.trend_volume > 0
    )

select location_name, location_country, trend_volume, trend_name, location_latitude, location_longitude, trend_date
from ranked_trends
where trend_rank = 1
  );
14:35:49.188200 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:35:49.201129 [debug] [Thread-1  ]: finished collecting timing info
14:35:49.204584 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
14:35:49.210853 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22ec3bb9-8734-4286-b05e-143df837596a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f2afa0>]}
14:35:49.217029 [info ] [Thread-1  ]: 5 of 5 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.16s]
14:35:49.220823 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
14:35:49.227105 [debug] [MainThread]: Acquiring new materialize connection "master"
14:35:49.229936 [debug] [MainThread]: Using materialize connection "master"
14:35:49.232128 [debug] [MainThread]: On master: BEGIN
14:35:49.234309 [debug] [MainThread]: Opening a new connection, currently in state closed
14:35:49.240076 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:35:49.242859 [debug] [MainThread]: Using materialize connection "master"
14:35:49.245122 [debug] [MainThread]: On master: COMMIT
14:35:49.248268 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:35:49.250804 [debug] [MainThread]: On master: Close
14:35:49.254811 [info ] [MainThread]: 
14:35:49.258204 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.15s.
14:35:49.261186 [debug] [MainThread]: Connection 'master' was properly closed.
14:35:49.263681 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
14:35:49.301593 [info ] [MainThread]: 
14:35:49.304209 [info ] [MainThread]: [32mCompleted successfully[0m
14:35:49.307376 [info ] [MainThread]: 
14:35:49.310072 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
14:35:49.315092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d60f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ef16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f4f5e0>]}


============================== 2022-02-23 14:50:00.799029 | f856d392-1859-4fa0-9791-448d678ddda3 ==============================
14:50:00.799029 [info ] [MainThread]: Running with dbt=1.0.1
14:50:00.807030 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:50:00.810578 [debug] [MainThread]: Tracking: tracking
14:50:00.839623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe50>]}
14:50:01.231477 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:50:01.235872 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:50:01.352832 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
14:50:01.571184 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

14:50:01.615041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f856d392-1859-4fa0-9791-448d678ddda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2a0d0>]}
14:50:01.673196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f856d392-1859-4fa0-9791-448d678ddda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007393b20>]}
14:50:01.676219 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:50:01.685665 [info ] [MainThread]: 
14:50:01.690897 [debug] [MainThread]: Acquiring new materialize connection "master"
14:50:01.702795 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
14:50:01.781820 [debug] [ThreadPool]: Using materialize connection "list_materialize"
14:50:01.785682 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
14:50:01.788659 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:50:01.827077 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.04 seconds
14:50:01.840672 [debug] [ThreadPool]: On list_materialize: Close
14:50:01.853197 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
14:50:01.885664 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
14:50:01.890106 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
14:50:01.893637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:50:01.923268 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.03 seconds
14:50:01.933887 [debug] [ThreadPool]: On list_materialize_public: Close
14:50:01.941465 [debug] [MainThread]: Using materialize connection "master"
14:50:01.944374 [debug] [MainThread]: On master: BEGIN
14:50:01.947126 [debug] [MainThread]: Opening a new connection, currently in state init
14:50:01.955404 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:50:01.959075 [debug] [MainThread]: Using materialize connection "master"
14:50:01.962184 [debug] [MainThread]: On master: COMMIT
14:50:02.032294 [debug] [MainThread]: SQL status: COMMIT in 0.07 seconds
14:50:02.036874 [debug] [MainThread]: On master: Close
14:50:02.041242 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:50:02.044806 [info ] [MainThread]: 
14:50:02.064475 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
14:50:02.068157 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
14:50:02.073346 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
14:50:02.076100 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
14:50:02.079055 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
14:50:02.114167 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
14:50:02.123531 [debug] [Thread-1  ]: finished collecting timing info
14:50:02.126676 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
14:50:02.192754 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:50:02.195814 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
14:50:02.198464 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:50:02.263837 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.07 seconds
14:50:02.308140 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
14:50:02.316393 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:50:02.319490 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
14:50:02.390032 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.07 seconds
14:50:02.443865 [debug] [Thread-1  ]: finished collecting timing info
14:50:02.447069 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
14:50:02.451155 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f856d392-1859-4fa0-9791-448d678ddda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ec31c0>]}
14:50:02.454911 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.38s]
14:50:02.459130 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
14:50:02.462109 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
14:50:02.465684 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
14:50:02.469917 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
14:50:02.471904 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
14:50:02.474208 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
14:50:02.498729 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
14:50:02.506361 [debug] [Thread-1  ]: finished collecting timing info
14:50:02.509196 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
14:50:02.521058 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:50:02.523725 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
14:50:02.526263 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:50:02.576236 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.05 seconds
14:50:02.588378 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
14:50:02.596324 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:50:02.599345 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
14:50:02.619842 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.02 seconds
14:50:02.636633 [debug] [Thread-1  ]: finished collecting timing info
14:50:02.639679 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
14:50:02.643621 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f856d392-1859-4fa0-9791-448d678ddda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c4e640>]}
14:50:02.647160 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.17s]
14:50:02.650691 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
14:50:02.653535 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
14:50:02.657079 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
14:50:02.662021 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
14:50:02.665610 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
14:50:02.668431 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
14:50:02.689776 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
14:50:02.696728 [debug] [Thread-1  ]: finished collecting timing info
14:50:02.699360 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
14:50:02.778076 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:50:02.781660 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
14:50:02.784537 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:50:02.833026 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.05 seconds
14:50:02.862699 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
14:50:02.870791 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:50:02.873337 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'location'->>'woeid')::string as woeid,
       (data->'trends'->0->'trends')::jsonb as trends,
       (data->'trends'->0->>'as_of')::timestamp as trend_as_of
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        woeid,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume,
        trend_as_of
    FROM renamed
)

SELECT * FROM final
  );
14:50:02.949856 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.07 seconds
14:50:02.960445 [debug] [Thread-1  ]: finished collecting timing info
14:50:02.964054 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
14:50:02.968288 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f856d392-1859-4fa0-9791-448d678ddda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d8e220>]}
14:50:02.972401 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.31s]
14:50:02.976137 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
14:50:02.979491 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
14:50:02.982706 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
14:50:02.987460 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
14:50:02.990164 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
14:50:02.992348 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
14:50:03.013325 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
14:50:03.023828 [debug] [Thread-1  ]: finished collecting timing info
14:50:03.027741 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
14:50:03.048536 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:50:03.052331 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
14:50:03.055361 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:50:03.073699 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.02 seconds
14:50:03.084259 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
14:50:03.091089 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:50:03.094768 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
14:50:03.112190 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:50:03.124918 [debug] [Thread-1  ]: finished collecting timing info
14:50:03.128362 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
14:50:03.132892 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f856d392-1859-4fa0-9791-448d678ddda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d71ee0>]}
14:50:03.136763 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.15s]
14:50:03.140942 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
14:50:03.147765 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
14:50:03.151011 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
14:50:03.155676 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
14:50:03.158558 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
14:50:03.161602 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
14:50:03.184007 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
14:50:03.191408 [debug] [Thread-1  ]: finished collecting timing info
14:50:03.194064 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
14:50:03.249904 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:50:03.253378 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
14:50:03.257596 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:50:03.306704 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.05 seconds
14:50:03.324701 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
14:50:03.331946 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:50:03.334272 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    

with ranked_trends as (
    select tt.location_name
         , tt.location_country
         , tt.trend_name
         , tt.trend_volume
         , tt.trend_as_of as trend_date
         , wc.lat::float as location_latitude
         , wc.lng::float as location_longitude
         , ROW_NUMBER() over (partition by tt.woeid order by tt.trend_volume, tt.trend_as_of desc) as trend_rank
from "materialize"."public"."stg_twitter_trending" tt
    join "materialize"."public"."stg_worldcities" wc
on tt.location_name = wc.city and tt.location_country = wc.country
where tt.trend_volume > 0
    )

select location_name, location_country, trend_volume, trend_name, location_latitude, location_longitude, trend_date
from ranked_trends
where trend_rank = 1
  );
14:50:03.353610 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.02 seconds
14:50:03.370567 [debug] [Thread-1  ]: finished collecting timing info
14:50:03.373739 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
14:50:03.378401 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f856d392-1859-4fa0-9791-448d678ddda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f414c0>]}
14:50:03.383042 [info ] [Thread-1  ]: 5 of 5 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.22s]
14:50:03.388096 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
14:50:03.395722 [debug] [MainThread]: Acquiring new materialize connection "master"
14:50:03.399498 [debug] [MainThread]: Using materialize connection "master"
14:50:03.402682 [debug] [MainThread]: On master: BEGIN
14:50:03.405744 [debug] [MainThread]: Opening a new connection, currently in state closed
14:50:03.443749 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
14:50:03.447501 [debug] [MainThread]: Using materialize connection "master"
14:50:03.450220 [debug] [MainThread]: On master: COMMIT
14:50:03.453768 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:50:03.456641 [debug] [MainThread]: On master: Close
14:50:03.460418 [info ] [MainThread]: 
14:50:03.463604 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.77s.
14:50:03.467083 [debug] [MainThread]: Connection 'master' was properly closed.
14:50:03.469375 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
14:50:03.516084 [info ] [MainThread]: 
14:50:03.520244 [info ] [MainThread]: [32mCompleted successfully[0m
14:50:03.525081 [info ] [MainThread]: 
14:50:03.528833 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
14:50:03.532453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5cc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f4e670>]}


============================== 2022-02-23 14:56:34.461126 | fe7e4e21-3ca1-4c9d-ac97-abd45bf6f1b1 ==============================
14:56:34.461126 [info ] [MainThread]: Running with dbt=1.0.1
14:56:34.467857 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:56:34.471273 [debug] [MainThread]: Tracking: tracking
14:56:34.499614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072add30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ade20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072addc0>]}
14:56:34.836502 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:56:34.841063 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:56:34.949396 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
14:56:35.134257 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

14:56:35.173320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe7e4e21-3ca1-4c9d-ac97-abd45bf6f1b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2a0d0>]}
14:56:35.225518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe7e4e21-3ca1-4c9d-ac97-abd45bf6f1b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007393c40>]}
14:56:35.228780 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:56:35.237957 [info ] [MainThread]: 
14:56:35.241664 [debug] [MainThread]: Acquiring new materialize connection "master"
14:56:35.252098 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
14:56:35.324282 [debug] [ThreadPool]: Using materialize connection "list_materialize"
14:56:35.327141 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
14:56:35.330292 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:56:35.363288 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
14:56:35.388356 [debug] [ThreadPool]: On list_materialize: Close
14:56:35.401627 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
14:56:35.426364 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
14:56:35.429230 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
14:56:35.431773 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:56:35.439767 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
14:56:35.449065 [debug] [ThreadPool]: On list_materialize_public: Close
14:56:35.455767 [debug] [MainThread]: Using materialize connection "master"
14:56:35.458399 [debug] [MainThread]: On master: BEGIN
14:56:35.460746 [debug] [MainThread]: Opening a new connection, currently in state init
14:56:35.466913 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:56:35.469903 [debug] [MainThread]: Using materialize connection "master"
14:56:35.472070 [debug] [MainThread]: On master: COMMIT
14:56:35.475597 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:56:35.477585 [debug] [MainThread]: On master: Close
14:56:35.480847 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:56:35.483572 [info ] [MainThread]: 
14:56:35.500545 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
14:56:35.504736 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
14:56:35.509347 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
14:56:35.512261 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
14:56:35.515823 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
14:56:35.546272 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
14:56:35.553528 [debug] [Thread-1  ]: finished collecting timing info
14:56:35.556362 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
14:56:35.614323 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:56:35.617534 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
14:56:35.620036 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:56:35.631299 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:56:35.674211 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
14:56:35.680307 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:56:35.682424 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
14:56:35.692508 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:56:35.742696 [debug] [Thread-1  ]: finished collecting timing info
14:56:35.745351 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
14:56:35.749465 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe7e4e21-3ca1-4c9d-ac97-abd45bf6f1b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ec4250>]}
14:56:35.752873 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.24s]
14:56:35.756096 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
14:56:35.758427 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
14:56:35.761078 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
14:56:35.764792 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
14:56:35.767278 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
14:56:35.769427 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
14:56:35.792677 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
14:56:35.798716 [debug] [Thread-1  ]: finished collecting timing info
14:56:35.800900 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
14:56:35.811759 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:56:35.814117 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
14:56:35.817328 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:56:35.826628 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:56:35.835195 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
14:56:35.840965 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:56:35.842967 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
14:56:35.851415 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:56:35.861353 [debug] [Thread-1  ]: finished collecting timing info
14:56:35.863855 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
14:56:35.867305 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe7e4e21-3ca1-4c9d-ac97-abd45bf6f1b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c450d0>]}
14:56:35.870593 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.10s]
14:56:35.873818 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
14:56:35.876696 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
14:56:35.879566 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
14:56:35.883222 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
14:56:35.885522 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
14:56:35.887872 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
14:56:35.906882 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
14:56:35.914769 [debug] [Thread-1  ]: finished collecting timing info
14:56:35.917465 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
14:56:35.989507 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:56:35.992613 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
14:56:35.995460 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:56:36.002573 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:56:36.029411 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
14:56:36.035756 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:56:36.037977 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'location'->>'woeid')::string as woeid,
       (data->'trends'->0->'trends')::jsonb as trends,
       (data->'trends'->0->>'as_of')::timestamp as trend_as_of
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        woeid,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume,
        trend_as_of
    FROM renamed
)

SELECT * FROM final
  );
14:56:36.048678 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:56:36.060672 [debug] [Thread-1  ]: finished collecting timing info
14:56:36.062903 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
14:56:36.066524 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe7e4e21-3ca1-4c9d-ac97-abd45bf6f1b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d93820>]}
14:56:36.070092 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.18s]
14:56:36.073183 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
14:56:36.075452 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
14:56:36.078191 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
14:56:36.082017 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
14:56:36.084487 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
14:56:36.086960 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
14:56:36.105465 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
14:56:36.113260 [debug] [Thread-1  ]: finished collecting timing info
14:56:36.115860 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
14:56:36.133977 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:56:36.136711 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
14:56:36.139405 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:56:36.145437 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:56:36.155195 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
14:56:36.160874 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:56:36.163103 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
14:56:36.172168 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:56:36.182546 [debug] [Thread-1  ]: finished collecting timing info
14:56:36.184800 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
14:56:36.188311 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe7e4e21-3ca1-4c9d-ac97-abd45bf6f1b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d71e50>]}
14:56:36.191262 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.11s]
14:56:36.194107 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
14:56:36.199568 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
14:56:36.201941 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
14:56:36.205447 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
14:56:36.207339 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
14:56:36.210236 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
14:56:36.231285 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
14:56:36.238239 [debug] [Thread-1  ]: finished collecting timing info
14:56:36.240275 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
14:56:36.290899 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:56:36.293812 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
14:56:36.296291 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:56:36.302415 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:56:36.320006 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
14:56:36.326944 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:56:36.329150 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    

with ranked_trends as (
    select tt.location_name
         , tt.location_country
         , tt.trend_name
         , tt.trend_volume
         , tt.trend_as_of as trend_date
         , wc.lat::float as location_latitude
         , wc.lng::float as location_longitude
         , ROW_NUMBER() over (partition by tt.woeid order by tt.trend_volume desc) as trend_rank
from "materialize"."public"."stg_twitter_trending" tt
    join "materialize"."public"."stg_worldcities" wc
on tt.location_name = wc.city and tt.location_country = wc.country
where tt.trend_volume > 0
    )

select location_name, location_country, trend_volume, trend_name, location_latitude, location_longitude, trend_date
from ranked_trends
where trend_rank = 1
  );
14:56:36.344873 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:56:36.358726 [debug] [Thread-1  ]: finished collecting timing info
14:56:36.361418 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
14:56:36.365431 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe7e4e21-3ca1-4c9d-ac97-abd45bf6f1b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f2bf40>]}
14:56:36.369421 [info ] [Thread-1  ]: 5 of 5 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.16s]
14:56:36.374062 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
14:56:36.380972 [debug] [MainThread]: Acquiring new materialize connection "master"
14:56:36.385663 [debug] [MainThread]: Using materialize connection "master"
14:56:36.389334 [debug] [MainThread]: On master: BEGIN
14:56:36.392115 [debug] [MainThread]: Opening a new connection, currently in state closed
14:56:36.398512 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:56:36.402927 [debug] [MainThread]: Using materialize connection "master"
14:56:36.406194 [debug] [MainThread]: On master: COMMIT
14:56:36.411142 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:56:36.414893 [debug] [MainThread]: On master: Close
14:56:36.419604 [info ] [MainThread]: 
14:56:36.423295 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.18s.
14:56:36.429327 [debug] [MainThread]: Connection 'master' was properly closed.
14:56:36.433152 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
14:56:36.474652 [info ] [MainThread]: 
14:56:36.477432 [info ] [MainThread]: [32mCompleted successfully[0m
14:56:36.480788 [info ] [MainThread]: 
14:56:36.483282 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
14:56:36.488123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ef1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f4fe80>]}


============================== 2022-02-23 14:58:04.280638 | 28da405b-b0a7-4eb5-b9a2-a7f883a5261e ==============================
14:58:04.280638 [info ] [MainThread]: Running with dbt=1.0.1
14:58:04.287343 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:58:04.289919 [debug] [MainThread]: Tracking: tracking
14:58:04.319948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728cd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400728cdf0>]}
14:58:04.673393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:58:04.677283 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
14:58:04.783266 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
14:58:04.971388 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

14:58:05.010137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28da405b-b0a7-4eb5-b9a2-a7f883a5261e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c280d0>]}
14:58:05.060795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28da405b-b0a7-4eb5-b9a2-a7f883a5261e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007393e50>]}
14:58:05.063857 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:58:05.072816 [info ] [MainThread]: 
14:58:05.077206 [debug] [MainThread]: Acquiring new materialize connection "master"
14:58:05.087605 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
14:58:05.158393 [debug] [ThreadPool]: Using materialize connection "list_materialize"
14:58:05.161381 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
14:58:05.163917 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:58:05.199056 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
14:58:05.209479 [debug] [ThreadPool]: On list_materialize: Close
14:58:05.220739 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
14:58:05.244201 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
14:58:05.246914 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
14:58:05.249622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:58:05.258792 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
14:58:05.268148 [debug] [ThreadPool]: On list_materialize_public: Close
14:58:05.275172 [debug] [MainThread]: Using materialize connection "master"
14:58:05.277959 [debug] [MainThread]: On master: BEGIN
14:58:05.280134 [debug] [MainThread]: Opening a new connection, currently in state init
14:58:05.286215 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:58:05.288925 [debug] [MainThread]: Using materialize connection "master"
14:58:05.290998 [debug] [MainThread]: On master: COMMIT
14:58:05.293845 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:58:05.295864 [debug] [MainThread]: On master: Close
14:58:05.299300 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:58:05.302178 [info ] [MainThread]: 
14:58:05.320085 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
14:58:05.324332 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
14:58:05.328828 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
14:58:05.331427 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
14:58:05.334423 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
14:58:05.366891 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
14:58:05.374939 [debug] [Thread-1  ]: finished collecting timing info
14:58:05.377182 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
14:58:05.434557 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:58:05.437580 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
14:58:05.439930 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:58:05.450297 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:58:05.491111 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
14:58:05.504629 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:58:05.507272 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
14:58:05.540298 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.03 seconds
14:58:05.597993 [debug] [Thread-1  ]: finished collecting timing info
14:58:05.602887 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
14:58:05.607142 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28da405b-b0a7-4eb5-b9a2-a7f883a5261e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049dc4730>]}
14:58:05.610816 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.28s]
14:58:05.614532 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
14:58:05.617241 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
14:58:05.620200 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
14:58:05.624258 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
14:58:05.627024 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
14:58:05.629706 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
14:58:05.654583 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
14:58:05.667035 [debug] [Thread-1  ]: finished collecting timing info
14:58:05.669221 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
14:58:05.679776 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:58:05.682037 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
14:58:05.684322 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:58:05.698584 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:58:05.706961 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
14:58:05.714421 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:58:05.716681 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
14:58:05.747246 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.03 seconds
14:58:05.757320 [debug] [Thread-1  ]: finished collecting timing info
14:58:05.759668 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
14:58:05.763396 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28da405b-b0a7-4eb5-b9a2-a7f883a5261e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c463d0>]}
14:58:05.766923 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.14s]
14:58:05.770210 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
14:58:05.773033 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
14:58:05.775795 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
14:58:05.779572 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
14:58:05.781742 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
14:58:05.784407 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
14:58:05.805046 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
14:58:05.818562 [debug] [Thread-1  ]: finished collecting timing info
14:58:05.821264 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
14:58:05.893359 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:58:05.896308 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
14:58:05.898726 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:58:05.905447 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:58:05.931240 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
14:58:05.937995 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:58:05.940747 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'location'->>'woeid')::string as woeid,
       (data->'trends'->0->'trends')::jsonb as trends,
       (data->'trends'->0->>'as_of')::timestamp as trend_as_of
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        woeid,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume,
        trend_as_of,
        ROW_NUMBER() over (partition by woeid order by trend_as_of desc) as trend_rank
    FROM renamed
)

SELECT * FROM final
where trend_rank = 1
  );
14:58:05.959323 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.02 seconds
14:58:05.969231 [debug] [Thread-1  ]: finished collecting timing info
14:58:05.972053 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
14:58:05.975573 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28da405b-b0a7-4eb5-b9a2-a7f883a5261e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d88c70>]}
14:58:05.979123 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.20s]
14:58:05.982063 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
14:58:05.984289 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
14:58:05.986833 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
14:58:05.991079 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
14:58:05.993119 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
14:58:05.995353 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
14:58:06.014966 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
14:58:06.024817 [debug] [Thread-1  ]: finished collecting timing info
14:58:06.027009 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
14:58:06.044169 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:58:06.046660 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
14:58:06.048488 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:58:06.055039 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:58:06.065116 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
14:58:06.070781 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:58:06.072948 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
14:58:06.092158 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.02 seconds
14:58:06.101963 [debug] [Thread-1  ]: finished collecting timing info
14:58:06.104611 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
14:58:06.108138 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28da405b-b0a7-4eb5-b9a2-a7f883a5261e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d72e80>]}
14:58:06.112912 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.12s]
14:58:06.115917 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
14:58:06.121097 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
14:58:06.124109 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
14:58:06.128083 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
14:58:06.130649 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
14:58:06.132850 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
14:58:06.155184 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
14:58:06.162780 [debug] [Thread-1  ]: finished collecting timing info
14:58:06.165518 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
14:58:06.216707 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:58:06.220250 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
14:58:06.222570 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:58:06.228353 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:58:06.244387 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
14:58:06.251727 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:58:06.253702 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    

with ranked_trends as (
    select tt.location_name
         , tt.location_country
         , tt.trend_name
         , tt.trend_volume
         , tt.trend_as_of as trend_date
         , wc.lat::float as location_latitude
         , wc.lng::float as location_longitude
         , ROW_NUMBER() over (partition by tt.woeid order by tt.trend_volume desc) as trend_rank
from "materialize"."public"."stg_twitter_trending" tt
    join "materialize"."public"."stg_worldcities" wc
on tt.location_name = wc.city and tt.location_country = wc.country
where tt.trend_volume > 0
    )

select location_name, location_country, trend_volume, trend_name, location_latitude, location_longitude, trend_date
from ranked_trends
where trend_rank = 1
  );
14:58:06.288530 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.03 seconds
14:58:06.300856 [debug] [Thread-1  ]: finished collecting timing info
14:58:06.304051 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
14:58:06.307906 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28da405b-b0a7-4eb5-b9a2-a7f883a5261e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e2bf70>]}
14:58:06.311869 [info ] [Thread-1  ]: 5 of 5 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.18s]
14:58:06.318595 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
14:58:06.324370 [debug] [MainThread]: Acquiring new materialize connection "master"
14:58:06.327608 [debug] [MainThread]: Using materialize connection "master"
14:58:06.329869 [debug] [MainThread]: On master: BEGIN
14:58:06.333020 [debug] [MainThread]: Opening a new connection, currently in state closed
14:58:06.343302 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:58:06.346767 [debug] [MainThread]: Using materialize connection "master"
14:58:06.349092 [debug] [MainThread]: On master: COMMIT
14:58:06.352328 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:58:06.355066 [debug] [MainThread]: On master: Close
14:58:06.359961 [info ] [MainThread]: 
14:58:06.363067 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.28s.
14:58:06.367620 [debug] [MainThread]: Connection 'master' was properly closed.
14:58:06.372631 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
14:58:06.414994 [info ] [MainThread]: 
14:58:06.418071 [info ] [MainThread]: [32mCompleted successfully[0m
14:58:06.421884 [info ] [MainThread]: 
14:58:06.424951 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
14:58:06.428159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e4f580>]}


============================== 2022-02-23 14:59:31.056867 | 6cf8cb91-7c79-4b26-886a-fd6fb62fff5d ==============================
14:59:31.056867 [info ] [MainThread]: Running with dbt=1.0.1
14:59:31.064220 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:59:31.066705 [debug] [MainThread]: Tracking: tracking
14:59:31.095955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acdc0>]}
14:59:31.436621 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
14:59:31.440659 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
14:59:31.443804 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
14:59:31.551240 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
14:59:31.636939 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
14:59:31.786726 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

14:59:31.826288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6cf8cb91-7c79-4b26-886a-fd6fb62fff5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c290d0>]}
14:59:31.876432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6cf8cb91-7c79-4b26-886a-fd6fb62fff5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007395dc0>]}
14:59:31.879544 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:59:31.889563 [info ] [MainThread]: 
14:59:31.893683 [debug] [MainThread]: Acquiring new materialize connection "master"
14:59:31.904198 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
14:59:31.979698 [debug] [ThreadPool]: Using materialize connection "list_materialize"
14:59:31.982448 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
14:59:31.984618 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:59:32.019137 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
14:59:32.029619 [debug] [ThreadPool]: On list_materialize: Close
14:59:32.039920 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
14:59:32.063071 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
14:59:32.065780 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
14:59:32.068139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:59:32.075476 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
14:59:32.085516 [debug] [ThreadPool]: On list_materialize_public: Close
14:59:32.092448 [debug] [MainThread]: Using materialize connection "master"
14:59:32.095184 [debug] [MainThread]: On master: BEGIN
14:59:32.097477 [debug] [MainThread]: Opening a new connection, currently in state init
14:59:32.103325 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:59:32.105562 [debug] [MainThread]: Using materialize connection "master"
14:59:32.107579 [debug] [MainThread]: On master: COMMIT
14:59:32.110900 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:59:32.113268 [debug] [MainThread]: On master: Close
14:59:32.116169 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:59:32.118883 [info ] [MainThread]: 
14:59:32.136799 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
14:59:32.141156 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
14:59:32.144988 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
14:59:32.147978 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
14:59:32.151294 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
14:59:32.182974 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
14:59:32.190556 [debug] [Thread-1  ]: finished collecting timing info
14:59:32.192685 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
14:59:32.250258 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:59:32.253651 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
14:59:32.255979 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:59:32.266615 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:59:32.307924 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
14:59:32.316129 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
14:59:32.318412 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
14:59:32.329590 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:59:32.378641 [debug] [Thread-1  ]: finished collecting timing info
14:59:32.381979 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
14:59:32.385943 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf8cb91-7c79-4b26-886a-fd6fb62fff5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ec3280>]}
14:59:32.389448 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.24s]
14:59:32.393333 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
14:59:32.396405 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
14:59:32.399735 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
14:59:32.403694 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
14:59:32.406664 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
14:59:32.409669 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
14:59:32.432965 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
14:59:32.445175 [debug] [Thread-1  ]: finished collecting timing info
14:59:32.447801 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
14:59:32.458374 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:59:32.460676 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
14:59:32.462816 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:59:32.472964 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
14:59:32.482330 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
14:59:32.491473 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
14:59:32.493754 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
14:59:32.504249 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
14:59:32.514609 [debug] [Thread-1  ]: finished collecting timing info
14:59:32.517766 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
14:59:32.521737 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf8cb91-7c79-4b26-886a-fd6fb62fff5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c49d00>]}
14:59:32.525295 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.12s]
14:59:32.528898 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
14:59:32.532495 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
14:59:32.535639 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
14:59:32.540317 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
14:59:32.542885 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
14:59:32.545335 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
14:59:32.567199 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
14:59:32.573458 [debug] [Thread-1  ]: finished collecting timing info
14:59:32.575737 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
14:59:32.646957 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:59:32.650131 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
14:59:32.652236 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:59:32.658365 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:59:32.684801 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
14:59:32.694591 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
14:59:32.697509 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'location'->>'woeid')::string as woeid,
       (data->'trends'->0->'trends')::jsonb as trends,
       (data->'trends'->0->>'as_of')::timestamp as trend_as_of
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        woeid,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume,
        trend_as_of,
        ROW_NUMBER() over (partition by woeid order by trend_as_of desc) as trend_date_rank
    FROM renamed
)

SELECT * FROM final
  );
14:59:32.708839 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:59:32.719472 [debug] [Thread-1  ]: finished collecting timing info
14:59:32.722212 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
14:59:32.725899 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf8cb91-7c79-4b26-886a-fd6fb62fff5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d7b790>]}
14:59:32.730701 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.19s]
14:59:32.736628 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
14:59:32.739231 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
14:59:32.741624 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
14:59:32.745711 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
14:59:32.748558 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
14:59:32.750904 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
14:59:32.769223 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
14:59:32.775940 [debug] [Thread-1  ]: finished collecting timing info
14:59:32.779129 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
14:59:32.796261 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:59:32.798577 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
14:59:32.801500 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:59:32.807494 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:59:32.817716 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
14:59:32.823779 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
14:59:32.826192 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
14:59:32.833862 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:59:32.843734 [debug] [Thread-1  ]: finished collecting timing info
14:59:32.846267 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
14:59:32.850080 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf8cb91-7c79-4b26-886a-fd6fb62fff5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d73e20>]}
14:59:32.853451 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.11s]
14:59:32.856373 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
14:59:32.861545 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
14:59:32.864417 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
14:59:32.868150 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
14:59:32.870272 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
14:59:32.872290 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
14:59:32.892766 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
14:59:32.899634 [debug] [Thread-1  ]: finished collecting timing info
14:59:32.902095 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
14:59:32.954743 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:59:32.957450 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
14:59:32.959765 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:59:32.965601 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:59:32.983102 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
14:59:32.991120 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
14:59:32.993253 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    

with ranked_trends as (
    select tt.location_name
         , tt.location_country
         , tt.trend_name
         , tt.trend_volume
         , tt.trend_date_rank
         , tt.trend_as_of as trend_date
         , wc.lat::float as location_latitude
         , wc.lng::float as location_longitude
         , ROW_NUMBER() over (partition by tt.woeid order by tt.trend_volume desc) as trend_rank
from "materialize"."public"."stg_twitter_trending" tt
    join "materialize"."public"."stg_worldcities" wc
on tt.location_name = wc.city and tt.location_country = wc.country
where tt.trend_volume > 0
    )

select location_name, location_country, trend_volume, trend_name, location_latitude, location_longitude, trend_date
from ranked_trends
where trend_rank = 1
  );
14:59:33.007890 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:59:33.020952 [debug] [Thread-1  ]: finished collecting timing info
14:59:33.023697 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
14:59:33.027819 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf8cb91-7c79-4b26-886a-fd6fb62fff5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f41550>]}
14:59:33.031417 [info ] [Thread-1  ]: 5 of 5 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.16s]
14:59:33.034824 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
14:59:33.041533 [debug] [MainThread]: Acquiring new materialize connection "master"
14:59:33.044945 [debug] [MainThread]: Using materialize connection "master"
14:59:33.047284 [debug] [MainThread]: On master: BEGIN
14:59:33.049240 [debug] [MainThread]: Opening a new connection, currently in state closed
14:59:33.054854 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:59:33.058309 [debug] [MainThread]: Using materialize connection "master"
14:59:33.060658 [debug] [MainThread]: On master: COMMIT
14:59:33.063900 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:59:33.067814 [debug] [MainThread]: On master: Close
14:59:33.072242 [info ] [MainThread]: 
14:59:33.075517 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.18s.
14:59:33.079606 [debug] [MainThread]: Connection 'master' was properly closed.
14:59:33.083990 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
14:59:33.120401 [info ] [MainThread]: 
14:59:33.123361 [info ] [MainThread]: [32mCompleted successfully[0m
14:59:33.126405 [info ] [MainThread]: 
14:59:33.129347 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
14:59:33.132663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5ffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f4f850>]}


============================== 2022-02-23 15:00:06.204956 | 64cc092e-aa05-49b1-a75a-538981f9efa6 ==============================
15:00:06.204956 [info ] [MainThread]: Running with dbt=1.0.1
15:00:06.213436 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
15:00:06.217321 [debug] [MainThread]: Tracking: tracking
15:00:06.249081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aad00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aadf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aad90>]}
15:00:06.594567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:00:06.599111 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
15:00:06.706164 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
15:00:06.897224 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

15:00:06.938415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64cc092e-aa05-49b1-a75a-538981f9efa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c280d0>]}
15:00:06.989772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64cc092e-aa05-49b1-a75a-538981f9efa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007393bb0>]}
15:00:06.993250 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:00:07.002164 [info ] [MainThread]: 
15:00:07.006808 [debug] [MainThread]: Acquiring new materialize connection "master"
15:00:07.021379 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
15:00:07.095768 [debug] [ThreadPool]: Using materialize connection "list_materialize"
15:00:07.100521 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
15:00:07.102758 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:00:07.133526 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
15:00:07.144293 [debug] [ThreadPool]: On list_materialize: Close
15:00:07.154590 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
15:00:07.178937 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
15:00:07.181738 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
15:00:07.183716 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:00:07.190696 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
15:00:07.200108 [debug] [ThreadPool]: On list_materialize_public: Close
15:00:07.206733 [debug] [MainThread]: Using materialize connection "master"
15:00:07.209177 [debug] [MainThread]: On master: BEGIN
15:00:07.212037 [debug] [MainThread]: Opening a new connection, currently in state init
15:00:07.217851 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:00:07.220936 [debug] [MainThread]: Using materialize connection "master"
15:00:07.222951 [debug] [MainThread]: On master: COMMIT
15:00:07.225951 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:00:07.228203 [debug] [MainThread]: On master: Close
15:00:07.231761 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:00:07.234782 [info ] [MainThread]: 
15:00:07.257014 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
15:00:07.261197 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
15:00:07.266795 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
15:00:07.270573 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
15:00:07.273396 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
15:00:07.311421 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
15:00:07.317615 [debug] [Thread-1  ]: finished collecting timing info
15:00:07.320108 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
15:00:07.380112 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
15:00:07.383638 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
15:00:07.386780 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:00:07.397279 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
15:00:07.438593 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
15:00:07.446909 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
15:00:07.449620 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
15:00:07.464195 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
15:00:07.514486 [debug] [Thread-1  ]: finished collecting timing info
15:00:07.517487 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
15:00:07.521179 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64cc092e-aa05-49b1-a75a-538981f9efa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ec4280>]}
15:00:07.524695 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.26s]
15:00:07.528646 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
15:00:07.531263 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
15:00:07.534638 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
15:00:07.538394 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
15:00:07.540674 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
15:00:07.543291 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
15:00:07.566673 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
15:00:07.573369 [debug] [Thread-1  ]: finished collecting timing info
15:00:07.575739 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
15:00:07.586529 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
15:00:07.588909 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
15:00:07.591173 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:00:07.601636 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
15:00:07.611022 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
15:00:07.618084 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
15:00:07.620655 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
15:00:07.629958 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
15:00:07.640680 [debug] [Thread-1  ]: finished collecting timing info
15:00:07.642918 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
15:00:07.646618 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64cc092e-aa05-49b1-a75a-538981f9efa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c45c10>]}
15:00:07.649829 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.11s]
15:00:07.653702 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
15:00:07.656154 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
15:00:07.659303 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
15:00:07.662979 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
15:00:07.665140 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
15:00:07.667366 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
15:00:07.686630 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
15:00:07.693318 [debug] [Thread-1  ]: finished collecting timing info
15:00:07.695617 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
15:00:07.764887 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
15:00:07.767568 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
15:00:07.769823 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:00:07.775978 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
15:00:07.802592 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
15:00:07.808893 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
15:00:07.811078 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'location'->>'woeid')::string as woeid,
       (data->'trends'->0->'trends')::jsonb as trends,
       (data->'trends'->0->>'as_of')::timestamp as trend_as_of
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        woeid,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume,
        trend_as_of,
        ROW_NUMBER() over (partition by woeid order by trend_as_of desc) as trend_date_rank
    FROM renamed
)

SELECT * FROM final
  );
15:00:07.826788 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
15:00:07.837159 [debug] [Thread-1  ]: finished collecting timing info
15:00:07.839427 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
15:00:07.842862 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64cc092e-aa05-49b1-a75a-538981f9efa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d81b50>]}
15:00:07.845967 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.18s]
15:00:07.848830 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
15:00:07.851183 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
15:00:07.854239 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
15:00:07.860089 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
15:00:07.862726 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
15:00:07.865742 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
15:00:07.885025 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
15:00:07.891642 [debug] [Thread-1  ]: finished collecting timing info
15:00:07.893813 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
15:00:07.911101 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
15:00:07.913886 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
15:00:07.916262 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:00:07.922665 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
15:00:07.932873 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
15:00:07.939042 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
15:00:07.941306 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
15:00:07.949882 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
15:00:07.960385 [debug] [Thread-1  ]: finished collecting timing info
15:00:07.963019 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
15:00:07.966716 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64cc092e-aa05-49b1-a75a-538981f9efa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d72e20>]}
15:00:07.969786 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.11s]
15:00:07.972282 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
15:00:07.977744 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
15:00:07.980254 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
15:00:07.984181 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
15:00:07.986810 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
15:00:07.988854 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
15:00:08.009753 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
15:00:08.017380 [debug] [Thread-1  ]: finished collecting timing info
15:00:08.019799 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
15:00:08.070280 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
15:00:08.073299 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
15:00:08.075597 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:00:08.082043 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
15:00:08.098816 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
15:00:08.112245 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
15:00:08.115034 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    

with ranked_trends as (
    select tt.location_name
         , tt.location_country
         , tt.trend_name
         , tt.trend_volume
         , tt.trend_date_rank
         , tt.trend_as_of as trend_date
         , wc.lat::float as location_latitude
         , wc.lng::float as location_longitude
         , ROW_NUMBER() over (partition by tt.woeid order by tt.trend_volume desc) as trend_rank
from "materialize"."public"."stg_twitter_trending" tt
    join "materialize"."public"."stg_worldcities" wc
on tt.location_name = wc.city and tt.location_country = wc.country
where tt.trend_volume > 0
    )

select location_name, location_country, trend_volume, trend_name, location_latitude, location_longitude, trend_date, trend_date_rank
from ranked_trends
where trend_rank = 1
  );
15:00:08.132098 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
15:00:08.144251 [debug] [Thread-1  ]: finished collecting timing info
15:00:08.147710 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
15:00:08.151198 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64cc092e-aa05-49b1-a75a-538981f9efa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f3ffa0>]}
15:00:08.155126 [info ] [Thread-1  ]: 5 of 5 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.17s]
15:00:08.158619 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
15:00:08.165044 [debug] [MainThread]: Acquiring new materialize connection "master"
15:00:08.167804 [debug] [MainThread]: Using materialize connection "master"
15:00:08.169954 [debug] [MainThread]: On master: BEGIN
15:00:08.171800 [debug] [MainThread]: Opening a new connection, currently in state closed
15:00:08.178086 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:00:08.181674 [debug] [MainThread]: Using materialize connection "master"
15:00:08.183991 [debug] [MainThread]: On master: COMMIT
15:00:08.186828 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:00:08.189337 [debug] [MainThread]: On master: Close
15:00:08.193324 [info ] [MainThread]: 
15:00:08.196995 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.19s.
15:00:08.201054 [debug] [MainThread]: Connection 'master' was properly closed.
15:00:08.203531 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
15:00:08.244931 [info ] [MainThread]: 
15:00:08.247833 [info ] [MainThread]: [32mCompleted successfully[0m
15:00:08.251578 [info ] [MainThread]: 
15:00:08.256299 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
15:00:08.261724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5d340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5dfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f4feb0>]}


============================== 2022-02-23 15:00:52.198517 | c21efc52-671e-4901-8b85-872a31ae84e8 ==============================
15:00:52.198517 [info ] [MainThread]: Running with dbt=1.0.1
15:00:52.205098 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
15:00:52.208318 [debug] [MainThread]: Tracking: tracking
15:00:52.237663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe20>]}
15:00:52.586334 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:00:52.590873 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
15:00:52.696413 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
15:00:52.892782 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

15:00:52.934185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c21efc52-671e-4901-8b85-872a31ae84e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c280d0>]}
15:00:52.990662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c21efc52-671e-4901-8b85-872a31ae84e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007394c70>]}
15:00:52.993847 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:00:53.003583 [info ] [MainThread]: 
15:00:53.007990 [debug] [MainThread]: Acquiring new materialize connection "master"
15:00:53.018139 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
15:00:53.089798 [debug] [ThreadPool]: Using materialize connection "list_materialize"
15:00:53.093044 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
15:00:53.095373 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:00:53.126169 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
15:00:53.136746 [debug] [ThreadPool]: On list_materialize: Close
15:00:53.146719 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
15:00:53.171701 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
15:00:53.174798 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
15:00:53.177109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:00:53.185241 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
15:00:53.197106 [debug] [ThreadPool]: On list_materialize_public: Close
15:00:53.204078 [debug] [MainThread]: Using materialize connection "master"
15:00:53.206522 [debug] [MainThread]: On master: BEGIN
15:00:53.208512 [debug] [MainThread]: Opening a new connection, currently in state init
15:00:53.214304 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:00:53.217215 [debug] [MainThread]: Using materialize connection "master"
15:00:53.220238 [debug] [MainThread]: On master: COMMIT
15:00:53.223555 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:00:53.225821 [debug] [MainThread]: On master: Close
15:00:53.228969 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:00:53.232375 [info ] [MainThread]: 
15:00:53.254583 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
15:00:53.259554 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
15:00:53.266177 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
15:00:53.269136 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
15:00:53.271879 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
15:00:53.304850 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
15:00:53.317674 [debug] [Thread-1  ]: finished collecting timing info
15:00:53.320900 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
15:00:53.388473 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
15:00:53.391928 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
15:00:53.395058 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:00:53.413977 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.02 seconds
15:00:53.458047 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
15:00:53.464628 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
15:00:53.466865 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
15:00:53.478311 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
15:00:53.527966 [debug] [Thread-1  ]: finished collecting timing info
15:00:53.530979 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
15:00:53.535045 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c21efc52-671e-4901-8b85-872a31ae84e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049dc41f0>]}
15:00:53.538619 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.27s]
15:00:53.542169 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
15:00:53.544864 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
15:00:53.547839 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
15:00:53.551629 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
15:00:53.553769 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
15:00:53.556130 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
15:00:53.579339 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
15:00:53.586789 [debug] [Thread-1  ]: finished collecting timing info
15:00:53.589681 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
15:00:53.600791 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
15:00:53.603418 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
15:00:53.605523 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:00:53.617471 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
15:00:53.625849 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
15:00:53.632060 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
15:00:53.634162 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
15:00:53.645095 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
15:00:53.654706 [debug] [Thread-1  ]: finished collecting timing info
15:00:53.657203 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
15:00:53.660497 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c21efc52-671e-4901-8b85-872a31ae84e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c50640>]}
15:00:53.663538 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.11s]
15:00:53.666542 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
15:00:53.668977 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
15:00:53.672484 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
15:00:53.676279 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
15:00:53.679793 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
15:00:53.682523 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
15:00:53.702232 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
15:00:53.722657 [debug] [Thread-1  ]: finished collecting timing info
15:00:53.725657 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
15:00:53.796680 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
15:00:53.800105 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
15:00:53.803157 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:00:53.809429 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
15:00:53.835511 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
15:00:53.842310 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
15:00:53.844502 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'location'->>'woeid')::string as woeid,
       (data->'trends'->0->'trends')::jsonb as trends,
       (data->'trends'->0->>'as_of')::timestamp as trend_as_of
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        woeid,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume,
        trend_as_of,
        ROW_NUMBER() over (partition by woeid order by trend_as_of desc) as trend_date_rank
    FROM renamed
)

SELECT * FROM final
  );
15:00:53.854519 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
15:00:53.868497 [debug] [Thread-1  ]: finished collecting timing info
15:00:53.871570 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
15:00:53.875194 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c21efc52-671e-4901-8b85-872a31ae84e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d7fca0>]}
15:00:53.878648 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.20s]
15:00:53.881815 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
15:00:53.884246 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
15:00:53.887446 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
15:00:53.890956 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
15:00:53.893181 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
15:00:53.895482 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
15:00:53.915565 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
15:00:53.923746 [debug] [Thread-1  ]: finished collecting timing info
15:00:53.926634 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
15:00:53.944544 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
15:00:53.947579 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
15:00:53.949811 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:00:53.956516 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
15:00:53.966758 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
15:00:53.974115 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
15:00:53.976677 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
15:00:53.984337 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
15:00:53.994434 [debug] [Thread-1  ]: finished collecting timing info
15:00:53.996969 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
15:00:54.001594 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c21efc52-671e-4901-8b85-872a31ae84e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d71eb0>]}
15:00:54.005710 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.11s]
15:00:54.008770 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
15:00:54.014195 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
15:00:54.017400 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
15:00:54.021191 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
15:00:54.023302 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
15:00:54.025835 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
15:00:54.047431 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
15:00:54.054222 [debug] [Thread-1  ]: finished collecting timing info
15:00:54.056706 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
15:00:54.110168 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
15:00:54.112807 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
15:00:54.115149 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:00:54.121426 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
15:00:54.137805 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
15:00:54.144171 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
15:00:54.146747 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    

with ranked_trends as (
    select tt.location_name
         , tt.location_country
         , tt.trend_name
         , tt.trend_volume
         , tt.trend_date_rank
         , tt.trend_as_of as trend_date
         , wc.lat::float as location_latitude
         , wc.lng::float as location_longitude
         , ROW_NUMBER() over (partition by tt.woeid order by tt.trend_volume desc) as trend_rank
from "materialize"."public"."stg_twitter_trending" tt
    left join "materialize"."public"."stg_worldcities" wc
on tt.location_name = wc.city and tt.location_country = wc.country
where tt.trend_volume > 0
    )

select location_name, location_country, trend_volume, trend_name, location_latitude, location_longitude, trend_date, trend_date_rank
from ranked_trends
where trend_rank = 1
  );
15:00:54.161889 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
15:00:54.174603 [debug] [Thread-1  ]: finished collecting timing info
15:00:54.177533 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
15:00:54.180960 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c21efc52-671e-4901-8b85-872a31ae84e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e2cfa0>]}
15:00:54.184823 [info ] [Thread-1  ]: 5 of 5 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.16s]
15:00:54.188128 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
15:00:54.194091 [debug] [MainThread]: Acquiring new materialize connection "master"
15:00:54.197034 [debug] [MainThread]: Using materialize connection "master"
15:00:54.199330 [debug] [MainThread]: On master: BEGIN
15:00:54.202488 [debug] [MainThread]: Opening a new connection, currently in state closed
15:00:54.208176 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:00:54.211327 [debug] [MainThread]: Using materialize connection "master"
15:00:54.213297 [debug] [MainThread]: On master: COMMIT
15:00:54.216100 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:00:54.218314 [debug] [MainThread]: On master: Close
15:00:54.221861 [info ] [MainThread]: 
15:00:54.225310 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.21s.
15:00:54.229772 [debug] [MainThread]: Connection 'master' was properly closed.
15:00:54.232772 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
15:00:54.270322 [info ] [MainThread]: 
15:00:54.273485 [info ] [MainThread]: [32mCompleted successfully[0m
15:00:54.276501 [info ] [MainThread]: 
15:00:54.280811 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
15:00:54.284982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d61f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d790a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e4f5e0>]}


============================== 2022-02-23 15:02:48.476392 | 42a4842a-af32-4db4-9b08-353ddbd524f7 ==============================
15:02:48.476392 [info ] [MainThread]: Running with dbt=1.0.1
15:02:48.483047 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
15:02:48.485748 [debug] [MainThread]: Tracking: tracking
15:02:48.513117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aadc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aaeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072aae50>]}
15:02:48.858197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:02:48.862407 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
15:02:48.975482 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
15:02:49.163187 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

15:02:49.205057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42a4842a-af32-4db4-9b08-353ddbd524f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c270d0>]}
15:02:49.255625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42a4842a-af32-4db4-9b08-353ddbd524f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007393b20>]}
15:02:49.258828 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:02:49.267749 [info ] [MainThread]: 
15:02:49.271843 [debug] [MainThread]: Acquiring new materialize connection "master"
15:02:49.286223 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
15:02:49.357355 [debug] [ThreadPool]: Using materialize connection "list_materialize"
15:02:49.360115 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
15:02:49.362332 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:02:49.395244 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
15:02:49.405634 [debug] [ThreadPool]: On list_materialize: Close
15:02:49.416341 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
15:02:49.440070 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
15:02:49.443276 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
15:02:49.446339 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:02:49.453615 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
15:02:49.464174 [debug] [ThreadPool]: On list_materialize_public: Close
15:02:49.471003 [debug] [MainThread]: Using materialize connection "master"
15:02:49.473800 [debug] [MainThread]: On master: BEGIN
15:02:49.476032 [debug] [MainThread]: Opening a new connection, currently in state init
15:02:49.482928 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:02:49.486213 [debug] [MainThread]: Using materialize connection "master"
15:02:49.488333 [debug] [MainThread]: On master: COMMIT
15:02:49.491298 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:02:49.493694 [debug] [MainThread]: On master: Close
15:02:49.496898 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:02:49.500302 [info ] [MainThread]: 
15:02:49.517615 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
15:02:49.522446 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
15:02:49.527143 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
15:02:49.530309 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
15:02:49.534122 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
15:02:49.565127 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
15:02:49.578293 [debug] [Thread-1  ]: finished collecting timing info
15:02:49.581328 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
15:02:49.638555 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
15:02:49.641302 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
15:02:49.643558 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:02:49.654118 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
15:02:49.696358 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
15:02:49.709035 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
15:02:49.711704 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
15:02:49.733032 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.02 seconds
15:02:49.785991 [debug] [Thread-1  ]: finished collecting timing info
15:02:49.788870 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
15:02:49.792423 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42a4842a-af32-4db4-9b08-353ddbd524f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ec51c0>]}
15:02:49.795777 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.27s]
15:02:49.799936 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
15:02:49.802368 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
15:02:49.805513 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
15:02:49.809278 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
15:02:49.811543 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
15:02:49.813751 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
15:02:49.838711 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
15:02:49.845634 [debug] [Thread-1  ]: finished collecting timing info
15:02:49.848504 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
15:02:49.860314 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
15:02:49.862666 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
15:02:49.864709 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:02:49.873790 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
15:02:49.881977 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
15:02:49.887638 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
15:02:49.889702 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
15:02:49.899640 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
15:02:49.909269 [debug] [Thread-1  ]: finished collecting timing info
15:02:49.912017 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
15:02:49.915493 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42a4842a-af32-4db4-9b08-353ddbd524f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c4f640>]}
15:02:49.918945 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.11s]
15:02:49.922167 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
15:02:49.924711 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
15:02:49.927266 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
15:02:49.930927 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
15:02:49.933600 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
15:02:49.935970 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
15:02:49.954986 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
15:02:49.962999 [debug] [Thread-1  ]: finished collecting timing info
15:02:49.965140 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
15:02:50.034910 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
15:02:50.037737 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
15:02:50.040575 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:02:50.047465 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
15:02:50.073968 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
15:02:50.082405 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
15:02:50.084812 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'location'->>'woeid')::string as woeid,
       (data->'trends'->0->'trends')::jsonb as trends,
       (data->'trends'->0->>'as_of')::timestamp as trend_as_of
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        woeid,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume,
        trend_as_of,
        ROW_NUMBER() over (partition by woeid order by trend_as_of desc) as trend_date_rank
    FROM renamed
)

SELECT * FROM final
  );
15:02:50.095370 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
15:02:50.105131 [debug] [Thread-1  ]: finished collecting timing info
15:02:50.107488 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
15:02:50.110801 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42a4842a-af32-4db4-9b08-353ddbd524f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d81cd0>]}
15:02:50.114441 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.18s]
15:02:50.117408 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
15:02:50.120360 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
15:02:50.123337 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
15:02:50.127010 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
15:02:50.129452 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
15:02:50.131775 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
15:02:50.150482 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
15:02:50.158390 [debug] [Thread-1  ]: finished collecting timing info
15:02:50.160845 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
15:02:50.179039 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
15:02:50.181500 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
15:02:50.183547 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:02:50.189965 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
15:02:50.200443 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
15:02:50.207828 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
15:02:50.210057 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
15:02:50.218637 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
15:02:50.228232 [debug] [Thread-1  ]: finished collecting timing info
15:02:50.230304 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
15:02:50.233498 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42a4842a-af32-4db4-9b08-353ddbd524f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d6aee0>]}
15:02:50.236769 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.11s]
15:02:50.240753 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
15:02:50.244927 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
15:02:50.247949 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
15:02:50.252134 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
15:02:50.256850 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
15:02:50.259967 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
15:02:50.281491 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
15:02:50.288356 [debug] [Thread-1  ]: finished collecting timing info
15:02:50.290652 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
15:02:50.341252 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
15:02:50.343981 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
15:02:50.346129 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:02:50.352314 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
15:02:50.368661 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
15:02:50.377917 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
15:02:50.380385 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    

with ranked_trends as (
    select tt.location_name
         , tt.location_country
         , tt.trend_name
         , tt.trend_volume
         , tt.trend_date_rank
         , tt.trend_as_of as trend_date
         , wc.lat::float as location_latitude
         , wc.lng::float as location_longitude
         , ROW_NUMBER() over (partition by tt.woeid order by tt.trend_volume desc) as trend_rank
from "materialize"."public"."stg_twitter_trending" tt
    left join "materialize"."public"."stg_worldcities" wc
on tt.location_name = wc.city and tt.location_country = wc.country
where tt.trend_volume > 0
    )

select location_name, location_country, trend_volume, trend_name, location_latitude, location_longitude, trend_date, trend_date_rank
from ranked_trends
-- where trend_rank = 1
  );
15:02:50.395509 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
15:02:50.408646 [debug] [Thread-1  ]: finished collecting timing info
15:02:50.413492 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
15:02:50.417944 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42a4842a-af32-4db4-9b08-353ddbd524f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f404c0>]}
15:02:50.421671 [info ] [Thread-1  ]: 5 of 5 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.17s]
15:02:50.425160 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
15:02:50.431711 [debug] [MainThread]: Acquiring new materialize connection "master"
15:02:50.434877 [debug] [MainThread]: Using materialize connection "master"
15:02:50.438543 [debug] [MainThread]: On master: BEGIN
15:02:50.441238 [debug] [MainThread]: Opening a new connection, currently in state closed
15:02:50.447455 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:02:50.451148 [debug] [MainThread]: Using materialize connection "master"
15:02:50.453523 [debug] [MainThread]: On master: COMMIT
15:02:50.456882 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:02:50.459224 [debug] [MainThread]: On master: Close
15:02:50.462798 [info ] [MainThread]: 
15:02:50.467541 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.19s.
15:02:50.470939 [debug] [MainThread]: Connection 'master' was properly closed.
15:02:50.472833 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
15:02:50.508855 [info ] [MainThread]: 
15:02:50.511930 [info ] [MainThread]: [32mCompleted successfully[0m
15:02:50.515531 [info ] [MainThread]: 
15:02:50.519312 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
15:02:50.522994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5d340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d5dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f4f730>]}


============================== 2022-02-23 15:04:17.293056 | 2bcc298b-d49c-42b9-8688-75b94d5afc70 ==============================
15:04:17.293056 [info ] [MainThread]: Running with dbt=1.0.1
15:04:17.299867 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
15:04:17.302589 [debug] [MainThread]: Tracking: tracking
15:04:17.329388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abdc0>]}
15:04:17.680700 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:04:17.685114 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
15:04:17.803530 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
15:04:17.996146 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

15:04:18.035114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2bcc298b-d49c-42b9-8688-75b94d5afc70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2a0d0>]}
15:04:18.091151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2bcc298b-d49c-42b9-8688-75b94d5afc70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007393c40>]}
15:04:18.094298 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:04:18.105397 [info ] [MainThread]: 
15:04:18.109891 [debug] [MainThread]: Acquiring new materialize connection "master"
15:04:18.121116 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
15:04:18.205548 [debug] [ThreadPool]: Using materialize connection "list_materialize"
15:04:18.208361 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
15:04:18.211582 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:04:18.247437 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.04 seconds
15:04:18.258399 [debug] [ThreadPool]: On list_materialize: Close
15:04:18.271169 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
15:04:18.297311 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
15:04:18.300028 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
15:04:18.302182 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:04:18.309984 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
15:04:18.319980 [debug] [ThreadPool]: On list_materialize_public: Close
15:04:18.326731 [debug] [MainThread]: Using materialize connection "master"
15:04:18.329379 [debug] [MainThread]: On master: BEGIN
15:04:18.331289 [debug] [MainThread]: Opening a new connection, currently in state init
15:04:18.336930 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:04:18.339746 [debug] [MainThread]: Using materialize connection "master"
15:04:18.341626 [debug] [MainThread]: On master: COMMIT
15:04:18.344999 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:04:18.347385 [debug] [MainThread]: On master: Close
15:04:18.350725 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:04:18.353593 [info ] [MainThread]: 
15:04:18.371820 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
15:04:18.375145 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
15:04:18.378756 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
15:04:18.380969 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
15:04:18.383369 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
15:04:18.414854 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
15:04:18.422368 [debug] [Thread-1  ]: finished collecting timing info
15:04:18.425296 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
15:04:18.485107 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
15:04:18.488131 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
15:04:18.490449 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:04:18.500037 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
15:04:18.540339 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
15:04:18.547506 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
15:04:18.549894 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
15:04:18.567498 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.02 seconds
15:04:18.624783 [debug] [Thread-1  ]: finished collecting timing info
15:04:18.628515 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
15:04:18.632270 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bcc298b-d49c-42b9-8688-75b94d5afc70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ec4760>]}
15:04:18.637263 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.25s]
15:04:18.641618 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
15:04:18.644764 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
15:04:18.648480 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
15:04:18.652707 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
15:04:18.655187 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
15:04:18.657618 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
15:04:18.680342 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
15:04:18.688912 [debug] [Thread-1  ]: finished collecting timing info
15:04:18.691509 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
15:04:18.702316 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
15:04:18.705712 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
15:04:18.708302 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:04:18.718676 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
15:04:18.728167 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
15:04:18.735526 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
15:04:18.738051 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
15:04:18.749421 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
15:04:18.760896 [debug] [Thread-1  ]: finished collecting timing info
15:04:18.765430 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
15:04:18.771459 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bcc298b-d49c-42b9-8688-75b94d5afc70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c44cd0>]}
15:04:18.775759 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.12s]
15:04:18.781305 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
15:04:18.784756 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
15:04:18.789276 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
15:04:18.794025 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
15:04:18.797900 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
15:04:18.801845 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
15:04:18.827007 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
15:04:18.833601 [debug] [Thread-1  ]: finished collecting timing info
15:04:18.836715 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
15:04:18.912735 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
15:04:18.915542 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
15:04:18.917809 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:04:18.925114 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
15:04:18.952639 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
15:04:18.959332 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
15:04:18.961534 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'location'->>'woeid')::string as woeid,
       (data->'trends'->0->'trends')::jsonb as trends,
       (data->'trends'->0->>'as_of')::timestamp as trend_as_of
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        woeid,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume,
        trend_as_of,
        ROW_NUMBER() over (partition by woeid order by trend_as_of desc) as trend_date_rank
    FROM renamed
)

SELECT * FROM final
  );
15:04:18.970669 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
15:04:18.980601 [debug] [Thread-1  ]: finished collecting timing info
15:04:18.983291 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
15:04:18.987716 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bcc298b-d49c-42b9-8688-75b94d5afc70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d83100>]}
15:04:18.992334 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.19s]
15:04:18.997098 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
15:04:19.000639 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
15:04:19.004150 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
15:04:19.008314 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
15:04:19.010582 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
15:04:19.012609 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
15:04:19.031770 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
15:04:19.039602 [debug] [Thread-1  ]: finished collecting timing info
15:04:19.041817 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
15:04:19.058667 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
15:04:19.061440 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
15:04:19.063481 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:04:19.070546 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
15:04:19.080685 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
15:04:19.088734 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
15:04:19.091119 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
15:04:19.100630 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
15:04:19.111032 [debug] [Thread-1  ]: finished collecting timing info
15:04:19.114463 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
15:04:19.121303 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bcc298b-d49c-42b9-8688-75b94d5afc70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d70e50>]}
15:04:19.126395 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.11s]
15:04:19.130132 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
15:04:19.134651 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
15:04:19.138673 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
15:04:19.142994 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
15:04:19.146059 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
15:04:19.149570 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
15:04:19.170804 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
15:04:19.177746 [debug] [Thread-1  ]: finished collecting timing info
15:04:19.180150 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
15:04:19.231958 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
15:04:19.245448 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
15:04:19.248387 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:04:19.254539 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
15:04:19.271754 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
15:04:19.278418 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
15:04:19.280479 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    

with ranked_trends as (
    select tt.location_name
         , tt.location_country
         , tt.trend_name
         , tt.trend_volume
         , tt.trend_date_rank
         , tt.trend_as_of as trend_date
         , wc.lat::float as location_latitude
         , wc.lng::float as location_longitude
         , ROW_NUMBER() over (partition by tt.woeid order by tt.trend_volume desc) as trend_rank
from "materialize"."public"."stg_twitter_trending" tt
    left join "materialize"."public"."stg_worldcities" wc
on tt.location_name = wc.city and tt.location_country = wc.country
-- where tt.trend_volume > 0
    )

select location_name, location_country, trend_volume, trend_name, location_latitude, location_longitude, trend_date, trend_date_rank
from ranked_trends
-- where trend_rank = 1
  );
15:04:19.294946 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
15:04:19.309615 [debug] [Thread-1  ]: finished collecting timing info
15:04:19.313126 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
15:04:19.317723 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bcc298b-d49c-42b9-8688-75b94d5afc70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f3dfd0>]}
15:04:19.321926 [info ] [Thread-1  ]: 5 of 5 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.18s]
15:04:19.327182 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
15:04:19.334409 [debug] [MainThread]: Acquiring new materialize connection "master"
15:04:19.338115 [debug] [MainThread]: Using materialize connection "master"
15:04:19.341213 [debug] [MainThread]: On master: BEGIN
15:04:19.343670 [debug] [MainThread]: Opening a new connection, currently in state closed
15:04:19.349515 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:04:19.352800 [debug] [MainThread]: Using materialize connection "master"
15:04:19.354816 [debug] [MainThread]: On master: COMMIT
15:04:19.357648 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:04:19.359977 [debug] [MainThread]: On master: Close
15:04:19.364157 [info ] [MainThread]: 
15:04:19.368236 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.25s.
15:04:19.371582 [debug] [MainThread]: Connection 'master' was properly closed.
15:04:19.373850 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
15:04:19.411249 [info ] [MainThread]: 
15:04:19.415155 [info ] [MainThread]: [32mCompleted successfully[0m
15:04:19.418818 [info ] [MainThread]: 
15:04:19.421551 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
15:04:19.425357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d79100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f2e040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049f4fe50>]}


============================== 2022-02-23 15:08:04.114742 | 0c605a2a-e86f-4199-893c-8f2916771bd7 ==============================
15:08:04.114742 [info ] [MainThread]: Running with dbt=1.0.1
15:08:04.121711 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
15:08:04.124396 [debug] [MainThread]: Tracking: tracking
15:08:04.152663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072acd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072ace20>]}
15:08:04.503152 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:08:04.507185 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
15:08:04.619892 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
15:08:04.807707 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

15:08:04.848578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c605a2a-e86f-4199-893c-8f2916771bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c280d0>]}
15:08:04.898620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c605a2a-e86f-4199-893c-8f2916771bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007393c40>]}
15:08:04.902160 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:08:04.911127 [info ] [MainThread]: 
15:08:04.915283 [debug] [MainThread]: Acquiring new materialize connection "master"
15:08:04.927254 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
15:08:04.996514 [debug] [ThreadPool]: Using materialize connection "list_materialize"
15:08:04.999467 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
15:08:05.001728 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:08:05.032379 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
15:08:05.043272 [debug] [ThreadPool]: On list_materialize: Close
15:08:05.054685 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
15:08:05.079133 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
15:08:05.082007 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
15:08:05.084546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:08:05.092341 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
15:08:05.102523 [debug] [ThreadPool]: On list_materialize_public: Close
15:08:05.109082 [debug] [MainThread]: Using materialize connection "master"
15:08:05.111537 [debug] [MainThread]: On master: BEGIN
15:08:05.113939 [debug] [MainThread]: Opening a new connection, currently in state init
15:08:05.119740 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:08:05.122443 [debug] [MainThread]: Using materialize connection "master"
15:08:05.124601 [debug] [MainThread]: On master: COMMIT
15:08:05.127938 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:08:05.130267 [debug] [MainThread]: On master: Close
15:08:05.133606 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:08:05.136654 [info ] [MainThread]: 
15:08:05.153376 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
15:08:05.156884 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
15:08:05.160637 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
15:08:05.165167 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
15:08:05.167419 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
15:08:05.199685 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
15:08:05.207067 [debug] [Thread-1  ]: finished collecting timing info
15:08:05.209504 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
15:08:05.267303 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
15:08:05.270194 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
15:08:05.272756 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:08:05.283284 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
15:08:05.327926 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
15:08:05.335155 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
15:08:05.338203 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
15:08:05.349626 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
15:08:05.399209 [debug] [Thread-1  ]: finished collecting timing info
15:08:05.403174 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
15:08:05.407394 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c605a2a-e86f-4199-893c-8f2916771bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ec61f0>]}
15:08:05.410895 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.25s]
15:08:05.414696 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
15:08:05.417651 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
15:08:05.420714 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
15:08:05.424936 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
15:08:05.428177 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
15:08:05.430710 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
15:08:05.454687 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
15:08:05.464317 [debug] [Thread-1  ]: finished collecting timing info
15:08:05.467048 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
15:08:05.478646 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
15:08:05.482108 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
15:08:05.484474 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:08:05.495188 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
15:08:05.504768 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
15:08:05.511836 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
15:08:05.514332 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
15:08:05.525210 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
15:08:05.535320 [debug] [Thread-1  ]: finished collecting timing info
15:08:05.537821 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
15:08:05.542021 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c605a2a-e86f-4199-893c-8f2916771bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c4de80>]}
15:08:05.545520 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.12s]
15:08:05.548288 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
15:08:05.550864 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
15:08:05.553874 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
15:08:05.557753 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
15:08:05.561099 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
15:08:05.563313 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
15:08:05.583502 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
15:08:05.593412 [debug] [Thread-1  ]: finished collecting timing info
15:08:05.596372 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
15:08:05.672933 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
15:08:05.675991 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
15:08:05.678413 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:08:05.685136 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
15:08:05.711074 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
15:08:05.719411 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
15:08:05.722285 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'location'->>'woeid')::string as woeid,
       (data->'trends'->0->'trends')::jsonb as trends,
       (data->'trends'->0->>'as_of')::timestamp as trend_as_of
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        woeid,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume,
        trend_as_of,
        DENSE_RANK() over (partition by tt.woeid order by tt.trend_volume desc) as trend_rank
    FROM renamed
)

SELECT * FROM final
WHERE trend_rank = 1
  );
15:08:05.726539 [debug] [Thread-1  ]: Postgres adapter: Postgres error: unknown catalog item 'dense_rank'

15:08:05.729683 [debug] [Thread-1  ]: finished collecting timing info
15:08:05.732249 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
15:08:05.736026 [debug] [Thread-1  ]: Database Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)
  unknown catalog item 'dense_rank'
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
15:08:05.740091 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c605a2a-e86f-4199-893c-8f2916771bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ef87f0>]}
15:08:05.743219 [error] [Thread-1  ]: 3 of 5 ERROR creating view model public.stg_twitter_trending.................... [[31mERROR[0m in 0.18s]
15:08:05.746157 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
15:08:05.749249 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
15:08:05.752525 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
15:08:05.756398 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
15:08:05.758768 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
15:08:05.761376 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
15:08:05.780331 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
15:08:05.789323 [debug] [Thread-1  ]: finished collecting timing info
15:08:05.792511 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
15:08:05.812977 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
15:08:05.815775 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
15:08:05.818055 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:08:05.824201 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
15:08:05.834375 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
15:08:05.840748 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
15:08:05.842641 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
15:08:05.850376 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
15:08:05.859982 [debug] [Thread-1  ]: finished collecting timing info
15:08:05.862209 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
15:08:05.867626 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c605a2a-e86f-4199-893c-8f2916771bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d73eb0>]}
15:08:05.871352 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.11s]
15:08:05.874649 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
15:08:05.880373 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
15:08:05.883370 [info ] [Thread-1  ]: 5 of 5 SKIP relation public.fct_twitter_trending................................ [[33mSKIP[0m]
15:08:05.886855 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
15:08:05.892564 [debug] [MainThread]: Acquiring new materialize connection "master"
15:08:05.895426 [debug] [MainThread]: Using materialize connection "master"
15:08:05.897700 [debug] [MainThread]: On master: BEGIN
15:08:05.900215 [debug] [MainThread]: Opening a new connection, currently in state closed
15:08:05.907099 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:08:05.910227 [debug] [MainThread]: Using materialize connection "master"
15:08:05.912764 [debug] [MainThread]: On master: COMMIT
15:08:05.916249 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:08:05.919162 [debug] [MainThread]: On master: Close
15:08:05.923439 [info ] [MainThread]: 
15:08:05.926654 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.01s.
15:08:05.929481 [debug] [MainThread]: Connection 'master' was properly closed.
15:08:05.931712 [debug] [MainThread]: Connection 'model.mz_hack_day.stg_worldcities' was properly closed.
15:08:05.975858 [info ] [MainThread]: 
15:08:05.978615 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:08:05.981440 [info ] [MainThread]: 
15:08:05.983839 [error] [MainThread]: [33mDatabase Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)[0m
15:08:05.986425 [error] [MainThread]:   unknown catalog item 'dense_rank'
15:08:05.989128 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
15:08:05.993731 [info ] [MainThread]: 
15:08:05.997752 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
15:08:06.001758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d62f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d7c040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d73b20>]}


============================== 2022-02-23 15:09:12.692248 | b765ef51-42b4-4aa4-bbc8-60ca2c4c04a3 ==============================
15:09:12.692248 [info ] [MainThread]: Running with dbt=1.0.1
15:09:12.699170 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
15:09:12.702418 [debug] [MainThread]: Tracking: tracking
15:09:12.732260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe20>]}
15:09:13.070162 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:09:13.074232 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
15:09:13.183660 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
15:09:13.367195 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

15:09:13.409410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b765ef51-42b4-4aa4-bbc8-60ca2c4c04a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c290d0>]}
15:09:13.460447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b765ef51-42b4-4aa4-bbc8-60ca2c4c04a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007393c40>]}
15:09:13.466073 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:09:13.475327 [info ] [MainThread]: 
15:09:13.479207 [debug] [MainThread]: Acquiring new materialize connection "master"
15:09:13.489518 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
15:09:13.563962 [debug] [ThreadPool]: Using materialize connection "list_materialize"
15:09:13.568893 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
15:09:13.577258 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:09:13.622437 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.04 seconds
15:09:13.638667 [debug] [ThreadPool]: On list_materialize: Close
15:09:13.652159 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
15:09:13.678122 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
15:09:13.680996 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
15:09:13.684188 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:09:13.691805 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
15:09:13.702138 [debug] [ThreadPool]: On list_materialize_public: Close
15:09:13.708927 [debug] [MainThread]: Using materialize connection "master"
15:09:13.711565 [debug] [MainThread]: On master: BEGIN
15:09:13.713720 [debug] [MainThread]: Opening a new connection, currently in state init
15:09:13.719805 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:09:13.722582 [debug] [MainThread]: Using materialize connection "master"
15:09:13.724762 [debug] [MainThread]: On master: COMMIT
15:09:13.727433 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:09:13.729682 [debug] [MainThread]: On master: Close
15:09:13.732924 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:09:13.735825 [info ] [MainThread]: 
15:09:13.761221 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
15:09:13.768196 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
15:09:13.774392 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
15:09:13.778309 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
15:09:13.782320 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
15:09:13.817689 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
15:09:13.824865 [debug] [Thread-1  ]: finished collecting timing info
15:09:13.827004 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
15:09:13.884354 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
15:09:13.887258 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
15:09:13.891542 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:09:13.901665 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
15:09:13.942117 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
15:09:13.949229 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
15:09:13.951731 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
15:09:13.963747 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
15:09:14.012420 [debug] [Thread-1  ]: finished collecting timing info
15:09:14.015167 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
15:09:14.019043 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b765ef51-42b4-4aa4-bbc8-60ca2c4c04a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ec41f0>]}
15:09:14.022782 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.25s]
15:09:14.026281 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
15:09:14.028367 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
15:09:14.031232 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
15:09:14.036280 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
15:09:14.039855 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
15:09:14.043244 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
15:09:14.065897 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
15:09:14.073911 [debug] [Thread-1  ]: finished collecting timing info
15:09:14.076229 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
15:09:14.087153 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
15:09:14.090213 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
15:09:14.093645 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:09:14.104346 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
15:09:14.112756 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
15:09:14.118145 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
15:09:14.120194 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
15:09:14.129221 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
15:09:14.139043 [debug] [Thread-1  ]: finished collecting timing info
15:09:14.141942 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
15:09:14.145476 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b765ef51-42b4-4aa4-bbc8-60ca2c4c04a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c50e80>]}
15:09:14.149233 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.11s]
15:09:14.152766 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
15:09:14.155264 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
15:09:14.158018 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
15:09:14.162144 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
15:09:14.164262 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
15:09:14.166810 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
15:09:14.185692 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
15:09:14.193059 [debug] [Thread-1  ]: finished collecting timing info
15:09:14.196386 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
15:09:14.268282 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
15:09:14.271193 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
15:09:14.273736 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:09:14.279718 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
15:09:14.305214 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
15:09:14.311579 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
15:09:14.313980 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'location'->>'woeid')::string as woeid,
       (data->'trends'->0->'trends')::jsonb as trends,
       (data->'trends'->0->>'as_of')::timestamp as trend_as_of
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        woeid,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume,
        trend_as_of,
        RANK() over (partition by tt.woeid order by tt.trend_volume desc) as trend_rank
    FROM renamed
)

SELECT * FROM final
WHERE trend_rank = 1
  );
15:09:14.319054 [debug] [Thread-1  ]: Postgres adapter: Postgres error: unknown catalog item 'rank'

15:09:14.321933 [debug] [Thread-1  ]: finished collecting timing info
15:09:14.324105 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
15:09:14.327164 [debug] [Thread-1  ]: Database Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)
  unknown catalog item 'rank'
  compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
15:09:14.330199 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b765ef51-42b4-4aa4-bbc8-60ca2c4c04a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049ef77f0>]}
15:09:14.333385 [error] [Thread-1  ]: 3 of 5 ERROR creating view model public.stg_twitter_trending.................... [[31mERROR[0m in 0.17s]
15:09:14.336595 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
15:09:14.339192 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
15:09:14.341780 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
15:09:14.345572 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
15:09:14.348387 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
15:09:14.350400 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
15:09:14.368535 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
15:09:14.375879 [debug] [Thread-1  ]: finished collecting timing info
15:09:14.379972 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
15:09:14.401994 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
15:09:14.405098 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
15:09:14.407523 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:09:14.413779 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
15:09:14.424028 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
15:09:14.430169 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
15:09:14.432290 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
15:09:14.440972 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
15:09:14.451094 [debug] [Thread-1  ]: finished collecting timing info
15:09:14.453237 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
15:09:14.456840 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b765ef51-42b4-4aa4-bbc8-60ca2c4c04a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d72eb0>]}
15:09:14.459916 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.11s]
15:09:14.462561 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
15:09:14.467646 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
15:09:14.470288 [info ] [Thread-1  ]: 5 of 5 SKIP relation public.fct_twitter_trending................................ [[33mSKIP[0m]
15:09:14.473239 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
15:09:14.479290 [debug] [MainThread]: Acquiring new materialize connection "master"
15:09:14.482363 [debug] [MainThread]: Using materialize connection "master"
15:09:14.485953 [debug] [MainThread]: On master: BEGIN
15:09:14.489576 [debug] [MainThread]: Opening a new connection, currently in state closed
15:09:14.495271 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:09:14.498099 [debug] [MainThread]: Using materialize connection "master"
15:09:14.500556 [debug] [MainThread]: On master: COMMIT
15:09:14.503562 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:09:14.506081 [debug] [MainThread]: On master: Close
15:09:14.509491 [info ] [MainThread]: 
15:09:14.512706 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.03s.
15:09:14.515675 [debug] [MainThread]: Connection 'master' was properly closed.
15:09:14.519090 [debug] [MainThread]: Connection 'model.mz_hack_day.stg_worldcities' was properly closed.
15:09:14.556803 [info ] [MainThread]: 
15:09:14.559540 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:09:14.562495 [info ] [MainThread]: 
15:09:14.565350 [error] [MainThread]: [33mDatabase Error in model stg_twitter_trending (models/twitter_trending/staging/twitter/stg_twitter_trending.sql)[0m
15:09:14.569824 [error] [MainThread]:   unknown catalog item 'rank'
15:09:14.573757 [error] [MainThread]:   compiled SQL at target/run/mz_hack_day/models/twitter_trending/staging/twitter/stg_twitter_trending.sql
15:09:14.577015 [info ] [MainThread]: 
15:09:14.579708 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
15:09:14.583191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d60f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d7b040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d72b20>]}


============================== 2022-02-23 15:10:52.676067 | 787ee5a6-fd7a-49a9-b7d9-2b8f15bcefc4 ==============================
15:10:52.676067 [info ] [MainThread]: Running with dbt=1.0.1
15:10:52.682980 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
15:10:52.687888 [debug] [MainThread]: Tracking: tracking
15:10:52.717093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40072abe20>]}
15:10:53.054032 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
15:10:53.058818 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/marts/twitter/fct_twitter_trending.sql
15:10:53.062299 [debug] [MainThread]: Partial parsing: updated file: mz_hack_day://models/twitter_trending/staging/twitter/stg_twitter_trending.sql
15:10:53.168407 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/marts/twitter/fct_twitter_trending.sql
15:10:53.254098 [debug] [MainThread]: 1699: static parser successfully parsed twitter_trending/staging/twitter/stg_twitter_trending.sql
15:10:53.388894 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.twitter_trending

15:10:53.427541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '787ee5a6-fd7a-49a9-b7d9-2b8f15bcefc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2b0d0>]}
15:10:53.478015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '787ee5a6-fd7a-49a9-b7d9-2b8f15bcefc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007395b20>]}
15:10:53.481060 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:10:53.491049 [info ] [MainThread]: 
15:10:53.495577 [debug] [MainThread]: Acquiring new materialize connection "master"
15:10:53.506228 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
15:10:53.586222 [debug] [ThreadPool]: Using materialize connection "list_materialize"
15:10:53.588875 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize"} */

    show schemas from "materialize"
  
15:10:53.591112 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:10:53.621503 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.03 seconds
15:10:53.631756 [debug] [ThreadPool]: On list_materialize: Close
15:10:53.640685 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
15:10:53.663903 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
15:10:53.666904 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "connection_name": "list_materialize_public"} */

    show extended schemas
  
15:10:53.669748 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:10:53.677563 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
15:10:53.687148 [debug] [ThreadPool]: On list_materialize_public: Close
15:10:53.694103 [debug] [MainThread]: Using materialize connection "master"
15:10:53.696925 [debug] [MainThread]: On master: BEGIN
15:10:53.699447 [debug] [MainThread]: Opening a new connection, currently in state init
15:10:53.705179 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:10:53.708011 [debug] [MainThread]: Using materialize connection "master"
15:10:53.710782 [debug] [MainThread]: On master: COMMIT
15:10:53.714079 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:10:53.716791 [debug] [MainThread]: On master: Close
15:10:53.720113 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:10:53.723747 [info ] [MainThread]: 
15:10:53.740111 [debug] [Thread-1  ]: Began running node model.mz_hack_day.rp_twitter_trending
15:10:53.744844 [info ] [Thread-1  ]: 1 of 5 START source model public.rp_twitter_trending............................ [RUN]
15:10:53.749597 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.rp_twitter_trending"
15:10:53.751672 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.rp_twitter_trending
15:10:53.753975 [debug] [Thread-1  ]: Compiling model.mz_hack_day.rp_twitter_trending
15:10:53.786931 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.rp_twitter_trending"
15:10:53.793603 [debug] [Thread-1  ]: finished collecting timing info
15:10:53.795764 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.rp_twitter_trending
15:10:53.852252 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
15:10:53.855400 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */
drop source if exists 
      materialize.public.rp_twitter_trending
   cascade
15:10:53.857525 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:10:53.867778 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
15:10:53.909948 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.rp_twitter_trending"
15:10:53.917141 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.rp_twitter_trending"
15:10:53.919925 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.rp_twitter_trending"} */




CREATE SOURCE 
    materialize.public.rp_twitter_trending

FROM KAFKA BROKER 'redpanda:9092' TOPIC 'trending_data'
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
ENVELOPE UPSERT;
15:10:53.930867 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
15:10:53.980775 [debug] [Thread-1  ]: finished collecting timing info
15:10:53.984215 [debug] [Thread-1  ]: On model.mz_hack_day.rp_twitter_trending: Close
15:10:53.988221 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '787ee5a6-fd7a-49a9-b7d9-2b8f15bcefc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049dc8df0>]}
15:10:53.992156 [info ] [Thread-1  ]: 1 of 5 OK created source model public.rp_twitter_trending....................... [[32mCREATE SOURCE[0m in 0.24s]
15:10:53.995769 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.rp_twitter_trending
15:10:53.998202 [debug] [Thread-1  ]: Began running node model.mz_hack_day.worldcities
15:10:54.001268 [info ] [Thread-1  ]: 2 of 5 START source model public.worldcities.................................... [RUN]
15:10:54.005081 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.worldcities"
15:10:54.007413 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.worldcities
15:10:54.009550 [debug] [Thread-1  ]: Compiling model.mz_hack_day.worldcities
15:10:54.032748 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.worldcities"
15:10:54.039201 [debug] [Thread-1  ]: finished collecting timing info
15:10:54.041576 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.worldcities
15:10:54.052185 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
15:10:54.054599 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */
drop source if exists 
      materialize.public.worldcities
   cascade
15:10:54.056710 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:10:54.067012 [debug] [Thread-1  ]: SQL status: DROP SOURCE in 0.01 seconds
15:10:54.075334 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.worldcities"
15:10:54.081942 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.worldcities"
15:10:54.085184 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.worldcities"} */




CREATE SOURCE 
    materialize.public.worldcities

FROM FILE '/tmp/worldcities.csv' COMPRESSION NONE
FORMAT CSV WITH HEADER
DELIMITED BY '|';
15:10:54.094306 [debug] [Thread-1  ]: SQL status: CREATE SOURCE in 0.01 seconds
15:10:54.104444 [debug] [Thread-1  ]: finished collecting timing info
15:10:54.106713 [debug] [Thread-1  ]: On model.mz_hack_day.worldcities: Close
15:10:54.110095 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '787ee5a6-fd7a-49a9-b7d9-2b8f15bcefc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c48d60>]}
15:10:54.113455 [info ] [Thread-1  ]: 2 of 5 OK created source model public.worldcities............................... [[32mCREATE SOURCE[0m in 0.11s]
15:10:54.116447 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.worldcities
15:10:54.119024 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_twitter_trending
15:10:54.122061 [info ] [Thread-1  ]: 3 of 5 START view model public.stg_twitter_trending............................. [RUN]
15:10:54.125949 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_twitter_trending"
15:10:54.128522 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_twitter_trending
15:10:54.130880 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_twitter_trending
15:10:54.150547 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_twitter_trending"
15:10:54.157431 [debug] [Thread-1  ]: finished collecting timing info
15:10:54.159848 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_twitter_trending
15:10:54.228266 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
15:10:54.231161 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
drop view if exists "materialize"."public"."stg_twitter_trending" cascade
15:10:54.233803 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:10:54.239780 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
15:10:54.265930 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_twitter_trending"
15:10:54.272028 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_twitter_trending"
15:10:54.274546 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_twitter_trending"} */
create view "materialize"."public"."stg_twitter_trending"
  as (
    /*

The purpose of this model is to create a flight_information staging model
with light transformations on top of the source.

*/




WITH source AS (
    SELECT * FROM "materialize"."public"."rp_twitter_trending"
),
converted AS (
    SELECT convert_from(data, 'utf8') AS data FROM source
),
casted AS (
    SELECT cast(data AS jsonb) AS data FROM converted
),
renamed AS (
    SELECT
       (data->'location'->>'name')::string as location_name,
       (data->'location'->>'country')::string as location_country,
       (data->'location'->>'woeid')::string as woeid,
       (data->'trends'->0->'trends')::jsonb as trends,
       (data->'trends'->0->>'as_of')::timestamp as trend_as_of
    FROM casted
),
final AS (
    SELECT
        location_name,
        location_country,
        woeid,
        jsonb_array_elements(trends)->>'name' as trend_name,
        TRIM(jsonb_array_elements(trends)->>'tweet_volume')::integer as trend_volume,
        trend_as_of
    FROM renamed
)

SELECT * FROM final
  );
15:10:54.284330 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
15:10:54.294392 [debug] [Thread-1  ]: finished collecting timing info
15:10:54.296849 [debug] [Thread-1  ]: On model.mz_hack_day.stg_twitter_trending: Close
15:10:54.300349 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '787ee5a6-fd7a-49a9-b7d9-2b8f15bcefc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d88b20>]}
15:10:54.303734 [info ] [Thread-1  ]: 3 of 5 OK created view model public.stg_twitter_trending........................ [[32mCREATE VIEW[0m in 0.18s]
15:10:54.306646 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_twitter_trending
15:10:54.309185 [debug] [Thread-1  ]: Began running node model.mz_hack_day.stg_worldcities
15:10:54.311873 [info ] [Thread-1  ]: 4 of 5 START view model public.stg_worldcities.................................. [RUN]
15:10:54.315396 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.stg_worldcities"
15:10:54.318106 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.stg_worldcities
15:10:54.320176 [debug] [Thread-1  ]: Compiling model.mz_hack_day.stg_worldcities
15:10:54.337650 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.stg_worldcities"
15:10:54.346737 [debug] [Thread-1  ]: finished collecting timing info
15:10:54.349226 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.stg_worldcities
15:10:54.365523 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
15:10:54.368007 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
drop view if exists "materialize"."public"."stg_worldcities" cascade
15:10:54.370042 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:10:54.375883 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
15:10:54.385876 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.stg_worldcities"
15:10:54.393139 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.stg_worldcities"
15:10:54.395713 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.stg_worldcities"} */
create view "materialize"."public"."stg_worldcities"
  as (
    


WITH source AS (
    SELECT * FROM "materialize"."public"."worldcities"
)

SELECT * FROM source
  );
15:10:54.404075 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
15:10:54.414747 [debug] [Thread-1  ]: finished collecting timing info
15:10:54.417585 [debug] [Thread-1  ]: On model.mz_hack_day.stg_worldcities: Close
15:10:54.421320 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '787ee5a6-fd7a-49a9-b7d9-2b8f15bcefc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d72e80>]}
15:10:54.424662 [info ] [Thread-1  ]: 4 of 5 OK created view model public.stg_worldcities............................. [[32mCREATE VIEW[0m in 0.11s]
15:10:54.428088 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.stg_worldcities
15:10:54.433533 [debug] [Thread-1  ]: Began running node model.mz_hack_day.fct_twitter_trending
15:10:54.436118 [info ] [Thread-1  ]: 5 of 5 START materializedview model public.fct_twitter_trending................. [RUN]
15:10:54.439214 [debug] [Thread-1  ]: Acquiring new materialize connection "model.mz_hack_day.fct_twitter_trending"
15:10:54.441219 [debug] [Thread-1  ]: Began compiling node model.mz_hack_day.fct_twitter_trending
15:10:54.443695 [debug] [Thread-1  ]: Compiling model.mz_hack_day.fct_twitter_trending
15:10:54.463997 [debug] [Thread-1  ]: Writing injected SQL for node "model.mz_hack_day.fct_twitter_trending"
15:10:54.471159 [debug] [Thread-1  ]: finished collecting timing info
15:10:54.473517 [debug] [Thread-1  ]: Began executing node model.mz_hack_day.fct_twitter_trending
15:10:54.524695 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
15:10:54.527724 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
drop view if exists "materialize"."public"."fct_twitter_trending" cascade
15:10:54.530005 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:10:54.535847 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
15:10:54.552355 [debug] [Thread-1  ]: Writing runtime SQL for node "model.mz_hack_day.fct_twitter_trending"
15:10:54.559969 [debug] [Thread-1  ]: Using materialize connection "model.mz_hack_day.fct_twitter_trending"
15:10:54.562244 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "twitter_trending", "target_name": "dev", "node_id": "model.mz_hack_day.fct_twitter_trending"} */
create materialized view "materialize"."public"."fct_twitter_trending"
  as (
    

with ranked_trends as (
    select tt.location_name
         , tt.location_country
         , tt.trend_name
         , tt.trend_volume
         , tt.trend_as_of as trend_date
         , wc.lat::float as location_latitude
         , wc.lng::float as location_longitude
         , ROW_NUMBER() over (partition by tt.woeid order by tt.trend_volume desc) as trend_rank
from "materialize"."public"."stg_twitter_trending" tt
    left join "materialize"."public"."stg_worldcities" wc
on tt.location_name = wc.city and tt.location_country = wc.country
where tt.trend_volume > 0
    )

select location_name, location_country, trend_volume, trend_name, location_latitude, location_longitude, trend_date
from ranked_trends
where trend_rank = 1
  );
15:10:54.576827 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
15:10:54.592232 [debug] [Thread-1  ]: finished collecting timing info
15:10:54.595252 [debug] [Thread-1  ]: On model.mz_hack_day.fct_twitter_trending: Close
15:10:54.602190 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '787ee5a6-fd7a-49a9-b7d9-2b8f15bcefc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e405b0>]}
15:10:54.606922 [info ] [Thread-1  ]: 5 of 5 OK created materializedview model public.fct_twitter_trending............ [[32mCREATE VIEW[0m in 0.16s]
15:10:54.610450 [debug] [Thread-1  ]: Finished running node model.mz_hack_day.fct_twitter_trending
15:10:54.617567 [debug] [MainThread]: Acquiring new materialize connection "master"
15:10:54.620923 [debug] [MainThread]: Using materialize connection "master"
15:10:54.624651 [debug] [MainThread]: On master: BEGIN
15:10:54.627527 [debug] [MainThread]: Opening a new connection, currently in state closed
15:10:54.634122 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:10:54.638418 [debug] [MainThread]: Using materialize connection "master"
15:10:54.643382 [debug] [MainThread]: On master: COMMIT
15:10:54.651455 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:10:54.654281 [debug] [MainThread]: On master: Close
15:10:54.658895 [info ] [MainThread]: 
15:10:54.662865 [info ] [MainThread]: Finished running 2 source models, 2 view models, 1 materializedview model in 1.16s.
15:10:54.666440 [debug] [MainThread]: Connection 'master' was properly closed.
15:10:54.669188 [debug] [MainThread]: Connection 'model.mz_hack_day.fct_twitter_trending' was properly closed.
15:10:54.707048 [info ] [MainThread]: 
15:10:54.711029 [info ] [MainThread]: [32mCompleted successfully[0m
15:10:54.715276 [info ] [MainThread]: 
15:10:54.718103 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
15:10:54.721312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027d61f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027c2b1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4049e4feb0>]}
